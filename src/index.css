/* Tailwind CSS v4 - Import the new CSS-first configuration */
@import "./styles/tailwind.css";

/* Keep custom glass design system (not covered by Tailwind) */

@layer base {
    html {
        /* Enables SF Pro Display vs Text auto-switching where supported */
        font-optical-sizing: auto;
        /* Apple uses subpixel antialiasing for crisp text */
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;

        /* Semantic Colors */
        --bg-primary: #ffffff;
        --text-primary: #000000;
        --vibrant-blend: multiply;

        /* Label Colors (Light Mode) */
        --label-primary: rgba(0, 0, 0, 0.95);
        --label-secondary: rgba(0, 0, 0, 0.60);
        --label-tertiary: rgba(0, 0, 0, 0.46);
        --label-quaternary: rgba(0, 0, 0, 0.15);

        /* Glass-Aware Label Colors (Light Mode) */
        --label-on-glass-primary: rgba(0, 0, 0, 0.90);
        --label-on-glass-secondary: rgba(0, 0, 0, 0.60);
        --label-on-glass-tertiary: rgba(0, 0, 0, 0.50);

        /* Text Shadow Defaults (Light Mode) */
        --text-shadow-base: 0 1px 2px rgba(0, 0, 0, 0.1);
        --text-shadow-strong: 0 1px 3px rgba(0, 0, 0, 0.2);

        background-color: var(--bg-primary);
        color: var(--text-primary);
        transition: background-color 0.5s ease, color 0.5s ease;
    }

    html.dark {
        --bg-primary: #000000;
        --text-primary: #ffffff;
        --vibrant-blend: overlay;

        /* Label Colors (Dark Mode) */
        --label-primary: rgba(255, 255, 255, 0.95);
        --label-secondary: rgba(255, 255, 255, 0.60);
        --label-tertiary: rgba(255, 255, 255, 0.46);
        --label-quaternary: rgba(255, 255, 255, 0.15);

        /* Glass-Aware Label Colors (Dark Mode) */
        --label-on-glass-primary: rgba(255, 255, 255, 0.95);
        --label-on-glass-secondary: rgba(255, 255, 255, 0.65);
        --label-on-glass-tertiary: rgba(255, 255, 255, 0.55);

        /* Text Shadow Defaults (Dark Mode) */
        --text-shadow-base: 0 1px 3px rgba(0, 0, 0, 0.35);
        --text-shadow-strong: 0 1px 4px rgba(0, 0, 0, 0.5);
    }

    /* Tinted Mode - Accessibility: Higher contrast for busy backgrounds */
    html.tinted-mode {
        --label-on-glass-primary: rgba(255, 255, 255, 1);
        --label-on-glass-secondary: rgba(255, 255, 255, 0.85);
        --label-on-glass-tertiary: rgba(255, 255, 255, 0.60);
    }

    html.tinted-mode:not(.dark) {
        --label-on-glass-primary: rgba(0, 0, 0, 1);
        --label-on-glass-secondary: rgba(0, 0, 0, 0.80);
        --label-on-glass-tertiary: rgba(0, 0, 0, 0.50);
    }

    /* ==========================================================================
       APPLE LIQUID GLASS CONFIGURATION
       
       Following Apple HIG:
       - Dark Mode = ALWAYS tinted glass with white text
       - Light Mode = ALWAYS frosted glass with dark text
       
       Background luminance only affects glass OPACITY, not the fundamental style.
       ========================================================================== */

    /* ==========================================================================
       DARK MODE - Always Tinted Glass
       Translucent dark overlay that preserves background vibrancy
       ========================================================================== */

    /* DARK MODE DEFAULT - Fallback tinted glass (assumes dark background) */
    html.dark {
        --glass-bg-thin: rgba(0, 0, 0, 0.25);
        --glass-bg-regular: rgba(0, 0, 0, 0.35);
        --glass-bg-thick: rgba(0, 0, 0, 0.50);
        /* Clear variant: For media overlays - highly translucent */
        --glass-bg-clear: rgba(0, 0, 0, 0.15);
        --glass-border-clear: rgba(255, 255, 255, 0.08);
        --glass-border: rgba(255, 255, 255, 0.18);
        --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
        --glass-surface: rgba(255, 255, 255, 0.05);
        --glass-surface-hover: rgba(255, 255, 255, 0.10);
        --glass-surface-active: rgba(255, 255, 255, 0.15);
        --glass-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.08);
        --glass-text-primary: rgba(255, 255, 255, 0.98);
        --glass-text-secondary: rgba(255, 255, 255, 0.70);
        --glass-text-tertiary: rgba(255, 255, 255, 0.50);
        --hero-text: #ffffff;
        --hero-text-secondary: rgba(255, 255, 255, 0.85);
    }

    /* DARK MODE + DARK BACKGROUND = Dark Tinted Glass */
    html.dark.dark-bg {
        --glass-bg-thin: rgba(0, 0, 0, 0.25);
        --glass-bg-regular: rgba(0, 0, 0, 0.35);
        --glass-bg-thick: rgba(0, 0, 0, 0.50);
        --glass-border: rgba(255, 255, 255, 0.18);
        --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
        --glass-surface: rgba(255, 255, 255, 0.05);
        --glass-surface-hover: rgba(255, 255, 255, 0.10);
        --glass-surface-active: rgba(255, 255, 255, 0.15);
        --glass-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.08);
        --glass-text-primary: rgba(255, 255, 255, 0.98);
        --glass-text-secondary: rgba(255, 255, 255, 0.70);
        --glass-text-tertiary: rgba(255, 255, 255, 0.50);
        --hero-text: #ffffff;
        --hero-text-secondary: rgba(255, 255, 255, 0.85);
    }

    /* DARK MODE + LIGHT BACKGROUND = Heavier Tinted Glass (more contrast) */
    html.dark.light-bg {
        --glass-bg-thin: rgba(0, 0, 0, 0.25);
        --glass-bg-regular: rgba(0, 0, 0, 0.40);
        --glass-bg-thick: rgba(0, 0, 0, 0.55);
        --glass-border: rgba(255, 255, 255, 0.22);
        --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        --glass-surface: rgba(255, 255, 255, 0.08);
        --glass-surface-hover: rgba(255, 255, 255, 0.15);
        --glass-surface-active: rgba(255, 255, 255, 0.22);
        --glass-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.12);
        --glass-text-primary: rgba(255, 255, 255, 0.98);
        --glass-text-secondary: rgba(255, 255, 255, 0.75);
        --glass-text-tertiary: rgba(255, 255, 255, 0.55);
        --hero-text: #ffffff;
        --hero-text-secondary: rgba(255, 255, 255, 0.85);
    }

    /* ==========================================================================
       LIGHT MODE - Always Frosted Glass
       High-opacity white acrylic for legibility
       ========================================================================== */

    /* LIGHT MODE DEFAULT - Fallback frosted glass (assumes light background) */
    html:not(.dark) {
        --glass-bg-thin: rgba(255, 255, 255, 0.65);
        --glass-bg-regular: rgba(255, 255, 255, 0.80);
        --glass-bg-thick: rgba(255, 255, 255, 0.92);
        /* Clear variant: For media overlays - highly translucent */
        --glass-bg-clear: rgba(0, 0, 0, 0.08);
        --glass-border-clear: rgba(0, 0, 0, 0.08);
        --glass-border: rgba(0, 0, 0, 0.20);
        --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.12);
        --glass-surface: rgba(0, 0, 0, 0.03);
        --glass-surface-hover: rgba(0, 0, 0, 0.06);
        --glass-surface-active: rgba(0, 0, 0, 0.10);
        --glass-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.6);
        --glass-text-primary: rgba(0, 0, 0, 0.92);
        --glass-text-secondary: rgba(0, 0, 0, 0.65);
        --glass-text-tertiary: rgba(0, 0, 0, 0.45);
        --hero-text: rgba(0, 0, 0, 0.92);
        --hero-text-secondary: rgba(0, 0, 0, 0.70);
    }

    /* LIGHT MODE + LIGHT BACKGROUND = Standard Frosted Glass */
    html:not(.dark).light-bg {
        --glass-bg-thin: rgba(255, 255, 255, 0.65);
        --glass-bg-regular: rgba(255, 255, 255, 0.80);
        --glass-bg-thick: rgba(255, 255, 255, 0.92);
        --glass-border: rgba(0, 0, 0, 0.20);
        --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.12);
        --glass-surface: rgba(0, 0, 0, 0.03);
        --glass-surface-hover: rgba(0, 0, 0, 0.06);
        --glass-surface-active: rgba(0, 0, 0, 0.10);
        --glass-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.6);
        --glass-text-primary: rgba(0, 0, 0, 0.92);
        --glass-text-secondary: rgba(0, 0, 0, 0.65);
        --glass-text-tertiary: rgba(0, 0, 0, 0.45);
        --hero-text: rgba(0, 0, 0, 0.92);
        --hero-text-secondary: rgba(0, 0, 0, 0.70);
    }

    /* LIGHT MODE + DARK BACKGROUND = Brighter Frosted Glass (more separation) */
    html:not(.dark).dark-bg {
        --glass-bg-thin: rgba(255, 255, 255, 0.70);
        --glass-bg-regular: rgba(255, 255, 255, 0.85);
        --glass-bg-thick: rgba(255, 255, 255, 0.95);
        --glass-border: rgba(0, 0, 0, 0.22);
        --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.20);
        --glass-surface: rgba(0, 0, 0, 0.04);
        --glass-surface-hover: rgba(0, 0, 0, 0.08);
        --glass-surface-active: rgba(0, 0, 0, 0.12);
        --glass-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.8);
        --glass-text-primary: rgba(0, 0, 0, 0.92);
        --glass-text-secondary: rgba(0, 0, 0, 0.68);
        --glass-text-tertiary: rgba(0, 0, 0, 0.48);
        --hero-text: rgba(0, 0, 0, 0.92);
        --hero-text-secondary: rgba(0, 0, 0, 0.70);
    }

    /* ==========================================================================
       APPLE SEMANTIC ACCENT COLORS
       Following Apple HIG color system
       ========================================================================== */



    :root {
        /* ==========================================================================
           DESIGN TOKENS (Tailwind Config Backing)
           ========================================================================== */

        /* 1. SPACING (4pt Grid) */
        --space-0: 0px;
        --space-px: 1px;
        --space-0-5: 0.125rem;
        /* 2px */
        --space-1: 0.25rem;
        /* 4px */
        --space-1-5: 0.375rem;
        /* 6px */
        --space-2: 0.5rem;
        /* 8px */
        --space-2-5: 0.625rem;
        /* 10px */
        --space-3: 0.75rem;
        /* 12px */
        --space-3-5: 0.875rem;
        /* 14px */
        --space-4: 1rem;
        /* 16px */
        --space-5: 1.25rem;
        /* 20px */
        --space-6: 1.5rem;
        /* 24px */
        --space-7: 1.75rem;
        /* 28px */
        --space-8: 2rem;
        /* 32px */
        --space-9: 2.25rem;
        /* 36px */
        --space-10: 2.5rem;
        /* 40px */
        --space-11: 2.75rem;
        /* 44px */
        --space-12: 3rem;
        /* 48px */
        --space-14: 3.5rem;
        /* 56px */
        --space-16: 4rem;
        /* 64px */
        --space-20: 5rem;
        /* 80px */
        --space-24: 6rem;
        /* 96px */
        --space-28: 7rem;
        /* 112px */
        --space-32: 8rem;
        /* 128px */

        /* 2. TYPOGRAPHY */
        /* Font Sizes */
        --font-size-xs: 0.75rem;
        /* 12px */
        --font-size-sm: 0.875rem;
        /* 14px */
        --font-size-base: 1rem;
        /* 16px */
        --font-size-lg: 1.125rem;
        /* 18px */
        --font-size-xl: 1.25rem;
        /* 20px */
        --font-size-2xl: 1.5rem;
        /* 24px */
        --font-size-3xl: 1.875rem;
        /* 30px */
        --font-size-4xl: 2.25rem;
        /* 36px */

        /* Line Heights */
        --line-height-tight: 1.25;
        --line-height-snug: 1.375;
        --line-height-normal: 1.5;
        --line-height-relaxed: 1.625;
        --line-height-loose: 2;

        /* Font Weights */
        --font-weight-normal: 400;
        --font-weight-medium: 500;
        --font-weight-semibold: 600;
        --font-weight-bold: 700;

        /* Letter Spacing */
        --letter-spacing-tighter: -0.05em;
        --letter-spacing-tight: -0.025em;
        --letter-spacing-normal: 0em;
        --letter-spacing-wide: 0.025em;
        --letter-spacing-wider: 0.05em;

        /* 3. RADIUS */
        --radius-none: 0px;
        --radius-sm: 0.25rem;
        /* 4px */
        --radius-md: 0.5rem;
        /* 8px */
        --radius-lg: 0.75rem;
        /* 12px */
        --radius-xl: 1rem;
        /* 16px */
        --radius-2xl: 1.5rem;
        /* 24px */
        --radius-3xl: 2rem;
        /* 32px */
        --radius-full: 9999px;

        /* System Colors - Dynamic, adapt to mode */
        --system-blue: #007AFF;
        --system-green: #34C759;
        --system-indigo: #5856D6;
        --system-orange: #FF9500;
        --system-pink: #FF2D55;
        --system-purple: #AF52DE;
        --system-red: #FF3B30;
        --system-teal: #5AC8FA;
        --system-yellow: #FFCC00;

        /* Semantic Intent Colors */
        --color-success: var(--system-green);
        --color-warning: var(--system-orange);
        --color-error: var(--system-red);
        --color-info: var(--system-blue);
        --color-accent: var(--system-blue);

        /* Destructive action (delete, remove) */
        --color-destructive: var(--system-red);

        /* Link color */
        --color-link: var(--system-blue);

        /* Muted variants for backgrounds (Light Mode) */
        --color-accent-muted: rgba(0, 122, 255, 0.15);
        --color-accent-hover: rgba(0, 122, 255, 0.25);
        --color-destructive-muted: rgba(255, 59, 48, 0.15);
        --color-success-muted: rgba(52, 199, 89, 0.15);
        --color-warning-muted: rgba(255, 149, 0, 0.15);

        /* ==========================================================================
           SHADOW SCALE - Apple HIG Aligned
           Semantic shadow tokens for elevation hierarchy
           ========================================================================== */
        --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.15);
        --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        --shadow-glow: 0 0 40px rgba(255, 255, 255, 0.1);

        /* ==========================================================================
           MOTION DURATIONS - Apple HIG Aligned
           Semantic timing tokens for animation consistency
           ========================================================================== */
        --duration-micro: 150ms;
        /* Hover states, small interactions */
        --duration-standard: 300ms;
        /* Default transitions */
        --duration-emphasis: 500ms;
        /* Modals, reveals, emphasis */
        --duration-ambient: 1000ms;
        /* Breathing, gentle loops */

        /* Easing Functions */
        --ease-glass: cubic-bezier(0.4, 0, 0.2, 1);
        --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* Dark mode accent color adjustments for vibrancy */
    html.dark {
        --system-blue: #0A84FF;
        --system-green: #30D158;
        --system-indigo: #5E5CE6;
        --system-orange: #FF9F0A;
        --system-pink: #FF375F;
        --system-purple: #BF5AF2;
        --system-red: #FF453A;
        --system-teal: #64D2FF;
        --system-yellow: #FFD60A;

        /* Muted variants for backgrounds (Dark Mode - higher opacity for visibility) */
        --color-accent-muted: rgba(10, 132, 255, 0.20);
        --color-accent-hover: rgba(10, 132, 255, 0.30);
        --color-destructive-muted: rgba(255, 69, 58, 0.20);
        --color-success-muted: rgba(48, 209, 88, 0.20);
        --color-warning-muted: rgba(255, 159, 10, 0.20);
    }

    /* ==========================================================================
       SYNTAX HIGHLIGHTING
       Theme-aware code syntax colors for GlassCode component
       ========================================================================== */

    /* Light Mode / Frosted Glass - Use dark, saturated colors for contrast */
    .syntax-keyword {
        color: #AD3DA4;
        font-weight: 600;
    }

    .syntax-string {
        color: #D12F1B;
    }

    .syntax-number {
        color: #1C00CF;
    }

    .syntax-comment {
        color: #6C7986;
        font-style: italic;
    }

    .syntax-property {
        color: #0F68A0;
    }

    /* Dark Mode / Tinted Glass - Use vibrant, light colors */
    html.dark .syntax-keyword {
        color: #FF7AB2;
        font-weight: 600;
    }

    html.dark .syntax-string {
        color: #FF8170;
    }

    html.dark .syntax-number {
        color: #D0BF69;
    }

    html.dark .syntax-comment {
        color: #7F8C98;
        font-style: italic;
    }

    html.dark .syntax-property {
        color: #6BDFFF;
    }


    /* HIG Guideline: Tighten tracking for large headers */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        /* @apply tracking-tight; - Removed to defer to system font optical sizing */
    }

    /* HIG Guideline: Loosen tracking for captions/labels */
    .caption,
    .text-xs,
    .text-sm {
        @apply tracking-wide;
    }

    /* ==========================================================================
       TEXT ON GLASS UTILITIES
       Subtle text-shadow for improved legibility on translucent surfaces
       ========================================================================== */

    .text-on-glass {
        text-shadow: var(--text-shadow-on-glass, var(--text-shadow-base));
    }

    html.dark .text-on-glass {
        text-shadow: var(--text-shadow-on-glass, var(--text-shadow-base));
    }

    /* Stronger variant for critical text */
    .text-on-glass-strong {
        text-shadow: var(--text-shadow-on-glass, var(--text-shadow-strong));
    }

    html.dark .text-on-glass-strong {
        text-shadow: var(--text-shadow-on-glass, var(--text-shadow-strong));
    }
}

/* ==========================================================================
   FONT WEIGHT UTILITIES FOR GLASS
   
   Apple HIG recommends medium (500) as minimum weight on translucent surfaces
   for optimal legibility. These utilities ensure text remains readable.
   ========================================================================== */

/* Enforce minimum font-weight on glass surfaces */
.font-glass {
    font-weight: 500;
}

.font-glass-heading {
    font-weight: 600;
}

.font-glass-bold {
    font-weight: 700;
}

/* Auto-apply minimum weight to common text elements on glass */
.glass-typography h1,
.glass-typography h2,
.glass-typography h3,
.glass-typography h4,
.glass-typography h5,
.glass-typography h6 {
    font-weight: 600;
}

.glass-typography p,
.glass-typography span,
.glass-typography label {
    font-weight: 500;
}

.glass-typography small,
.glass-typography .caption {
    font-weight: 500;
    letter-spacing: 0.01em;
    /* Slight tracking for small text legibility */
}

/* ==========================================================================
   GLASS INACTIVE STATE
   Elements recede visually when not focused for z-axis depth hierarchy
   ========================================================================== */

.glass-inactive {
    transform: scale(0.98);
    opacity: 0.7;
    filter: brightness(0.9);
    transition: all var(--duration-standard, 300ms) var(--ease-glass, ease-out);
}

@media (prefers-reduced-motion: reduce) {

    *,
    ::before,
    ::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    /* Disable scale transform for inactive state */
    .glass-inactive {
        transform: none;
    }
}

@media (prefers-reduced-transparency: reduce) {

    .backdrop-blur-ultra-thin,
    .backdrop-blur-thin,
    .backdrop-blur-regular,
    .backdrop-blur-thick,
    .backdrop-blur-ultra-thick {
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
        background-color: rgb(30, 30, 30) !important;
    }

    html:not(.dark) .backdrop-blur-ultra-thin,
    html:not(.dark) .backdrop-blur-thin,
    html:not(.dark) .backdrop-blur-regular,
    html:not(.dark) .backdrop-blur-thick,
    html:not(.dark) .backdrop-blur-ultra-thick {
        background-color: rgb(245, 245, 245) !important;
    }
}

/* ============================================
   @supports Fallback for Unsupported Browsers
   Firefox < 103 and older browsers without backdrop-filter
   ============================================ */

@supports not (backdrop-filter: blur(1px)) {
    html {
        --glass-bg-thin: rgba(255, 255, 255, 0.92);
        --glass-bg-regular: rgba(255, 255, 255, 0.95);
        --glass-bg-thick: rgba(255, 255, 255, 0.98);
    }

    html.dark {
        --glass-bg-thin: rgba(30, 30, 40, 0.92);
        --glass-bg-regular: rgba(30, 30, 40, 0.95);
        --glass-bg-thick: rgba(30, 30, 40, 0.98);
    }
}

/* ============================================
   High Contrast Mode Support (WCAG AAA)
   Provides maximum legibility for users who need it
   ============================================ */

@media (prefers-contrast: more) {
    html {
        --glass-bg-thin: rgba(255, 255, 255, 0.92);
        --glass-bg-regular: rgba(255, 255, 255, 0.96);
        --glass-bg-thick: #ffffff;
        --glass-border: rgba(0, 0, 0, 0.25);
        --glass-text-primary: rgba(0, 0, 0, 1);
        --glass-text-secondary: rgba(0, 0, 0, 0.85);
        --glass-text-tertiary: rgba(0, 0, 0, 0.70);
        --label-primary: rgba(0, 0, 0, 1);
        --label-secondary: rgba(0, 0, 0, 0.85);
        --label-tertiary: rgba(0, 0, 0, 0.70);
    }

    html.dark {
        --glass-bg-thin: rgba(0, 0, 0, 0.92);
        --glass-bg-regular: rgba(0, 0, 0, 0.96);
        --glass-bg-thick: #000000;
        --glass-border: rgba(255, 255, 255, 0.35);
        --glass-text-primary: rgba(255, 255, 255, 1);
        --glass-text-secondary: rgba(255, 255, 255, 0.90);
        --glass-text-tertiary: rgba(255, 255, 255, 0.75);
        --label-primary: rgba(255, 255, 255, 1);
        --label-secondary: rgba(255, 255, 255, 0.90);
        --label-tertiary: rgba(255, 255, 255, 0.75);
    }
}

/* ============================================
   Density Modes
   ============================================ */

/* Default: Comfortable - spacious, breathable design */
html.density-comfortable {
    --density-padding-xs: 0.5rem;
    --density-padding-sm: 0.75rem;
    --density-padding-md: 1rem;
    --density-padding-lg: 1.5rem;
    --density-padding-xl: 2rem;
    --density-gap: 1rem;
    --density-font-scale: 1;
}

/* Compact: Tighter spacing for power users */
html.density-compact {
    --density-padding-xs: 0.25rem;
    --density-padding-sm: 0.5rem;
    --density-padding-md: 0.75rem;
    --density-padding-lg: 1rem;
    --density-padding-xl: 1.5rem;
    --density-gap: 0.5rem;
    --density-font-scale: 0.95;
}

/* Apply compact scaling to common elements */
html.density-compact .p-4 {
    padding: 0.75rem;
}

html.density-compact .p-6 {
    padding: 1rem;
}

html.density-compact .p-8 {
    padding: 1.5rem;
}

html.density-compact .gap-4 {
    gap: 0.5rem;
}

html.density-compact .gap-6 {
    gap: 0.75rem;
}

html.density-compact .gap-8 {
    gap: 1rem;
}

html.density-compact .text-sm {
    font-size: 0.8125rem;
}

html.density-compact .text-base {
    font-size: 0.875rem;
}

/* ============================================
   MOBILE PERFORMANCE OPTIMIZATIONS
   Reduce glass complexity for better battery life and 60fps scroll
   ============================================ */

@media (max-width: 768px) {

    /* Reduce blur radius on mobile for performance */
    html {
        --glass-blur-mobile: 12px;
    }

    /* Simplify glass effects during touch/scroll */
    .glass-performance-mode {
        backdrop-filter: blur(8px) !important;
        -webkit-backdrop-filter: blur(8px) !important;
    }
}

/* Touch devices: Disable heavy filters during active scroll */
@media (pointer: coarse) {

    /* GPU optimization hint for glass containers */
    .backdrop-blur-thin,
    .backdrop-blur-regular,
    .backdrop-blur-thick {
        will-change: transform;
        transform: translateZ(0);
    }
}

/* Low-power mode hint (when battery saver is active) */
@media (prefers-reduced-data: reduce) {
    html {
        --glass-bg-thin: rgba(255, 255, 255, 0.85);
        --glass-bg-regular: rgba(255, 255, 255, 0.92);
        --glass-bg-thick: rgba(255, 255, 255, 0.98);
    }

    html.dark {
        --glass-bg-thin: rgba(30, 30, 40, 0.85);
        --glass-bg-regular: rgba(30, 30, 40, 0.92);
        --glass-bg-thick: rgba(30, 30, 40, 0.98);
    }
}

/* ==========================================================================
   GLASS NOISE/GRAIN TEXTURE
   
   Adds subtle film grain to glass surfaces for a realistic frosted effect.
   Controlled by --glass-noise-opacity CSS variable (0-1).
   ========================================================================== */

/* Global noise overlay - applied to glass containers when noise > 0 */
.glass-noise::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    opacity: var(--glass-noise-opacity, 0);
    pointer-events: none;
    z-index: 1;
    mix-blend-mode: overlay;
    /* SVG noise pattern - performant and resolution-independent */
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    background-size: 180px 180px;
}

/* Apply noise to all glass containers globally when noise is enabled */
html:not([style*="--glass-noise-opacity: 0"]) .backdrop-blur-thin,
html:not([style*="--glass-noise-opacity: 0"]) .backdrop-blur-regular,
html:not([style*="--glass-noise-opacity: 0"]) .backdrop-blur-thick {
    position: relative;
}

/* Utility class for explicit noise application */
.glass-with-noise {
    position: relative;
}

.glass-with-noise::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    opacity: var(--glass-noise-opacity, 0);
    pointer-events: none;
    z-index: 1;
    mix-blend-mode: overlay;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    background-size: 180px 180px;
}

/* ==========================================================================
   MOTION & ANIMATION EFFECTS
   
   CSS variables controlled by Settings:
   - --anim-bounce-enabled: 0 or 1
   - --anim-bounce-scale: Scale multiplier (1.0 - 1.15)
   - --anim-pulse-enabled: 0 or 1
   - --anim-pulse-opacity: Opacity delta (0 - 0.3)
   - --anim-scale-enabled: 0 or 1
   - --anim-scale-amount: Scale delta (0 - 0.2)
   - --anim-wiggle-enabled: 0 or 1
   - --anim-wiggle-deg: Rotation in degrees (0 - 5deg)
   ========================================================================== */

/* Preview animations for settings page icons */
@keyframes bounce-preview {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }
}

@keyframes pulse-preview {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.6;
    }
}

@keyframes scale-preview {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }
}

@keyframes wiggle-preview {

    0%,
    100% {
        transform: rotate(0deg);
    }

    25% {
        transform: rotate(5deg);
    }

    75% {
        transform: rotate(-5deg);
    }
}

/* Utility classes for interactive elements */
.anim-bounce {
    transition: transform var(--duration-standard, 300ms) var(--ease-spring, ease);
}

.anim-bounce:hover {
    transform: scale(var(--anim-bounce-scale, 1.05));
}

.anim-bounce:active {
    transform: scale(0.95);
}

.anim-pulse {
    animation: element-pulse calc(var(--duration-ambient, 1000ms) * 1.5) ease-in-out infinite;
}

@keyframes element-pulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: calc(1 - var(--anim-pulse-opacity, 0.2));
    }
}

.anim-scale {
    transition: transform var(--duration-standard, 300ms) var(--ease-spring, ease);
}

.anim-scale:hover {
    transform: scale(calc(1 + var(--anim-scale-amount, 0.1)));
}

.anim-wiggle:hover {
    animation: element-wiggle 0.4s ease-in-out;
}

@keyframes element-wiggle {

    0%,
    100% {
        transform: rotate(0deg);
    }

    25% {
        transform: rotate(var(--anim-wiggle-deg, 3deg));
    }

    75% {
        transform: rotate(calc(var(--anim-wiggle-deg, 3deg) * -1));
    }
}

/* Disable animations when effects are off (set to 0) */
html[style*="--anim-bounce-enabled: 0"] .anim-bounce:hover {
    transform: none;
}

html[style*="--anim-pulse-enabled: 0"] .anim-pulse {
    animation: none;
}

html[style*="--anim-scale-enabled: 0"] .anim-scale:hover {
    transform: none;
}

html[style*="--anim-wiggle-enabled: 0"] .anim-wiggle:hover {
    animation: none;
}

/* ==========================================================================
   APPLE ANIMATION CURVES (HIG PRESETS)
   Specific timing functions for Native Mode feel
   ========================================================================== */
:root {
    /* Use Tailwind values where possible, but add specific spring physics */

    /* Spring Physics (Apple-style) */
    --ease-spring-light: cubic-bezier(0.5, 1.8, 0.5, 1.0);
    --ease-spring-medium: cubic-bezier(0.5, 1.5, 0.5, 1.0);
    --ease-spring-heavy: cubic-bezier(0.5, 1.2, 0.5, 1.0);
    --ease-spring-snappy: cubic-bezier(0.34, 1.56, 0.64, 1.0);

    /* Modal / Sheet / Presentation */
    --ease-modal-present: cubic-bezier(0.32, 0.72, 0.0, 1.0);
    --ease-modal-dismiss: cubic-bezier(0.32, 0.72, 0.0, 1.0);
    --ease-sheet: cubic-bezier(0.2, 0.9, 0.3, 1.0);

    /* Interaction */
    --ease-press: cubic-bezier(0.2, 0.0, 0.4, 1.0);
    --ease-release: cubic-bezier(0.4, 0.0, 0.2, 1.0);
}

/* ==========================================================================
   ATMOSPHERIC ANIMATIONS (Neon Tokyo / Weather Effects)
   Floating orbs, rain drops, and snow particles
   ========================================================================== */

/* Floating orb animation - gentle drift motion */
@keyframes float {

    0%,
    100% {
        transform: translate(0, 0) scale(1);
    }

    25% {
        transform: translate(10px, -15px) scale(1.02);
    }

    50% {
        transform: translate(-5px, -25px) scale(1);
    }

    75% {
        transform: translate(-15px, -10px) scale(0.98);
    }
}

.animate-float {
    animation: float 6s ease-in-out infinite;
}

/* Rain drop falling animation */
@keyframes rain {
    0% {
        transform: translateY(0) scaleY(1);
        opacity: 0;
    }

    10% {
        opacity: 0.6;
    }

    90% {
        opacity: 0.6;
    }

    100% {
        transform: translateY(100vh) scaleY(1.5);
        opacity: 0;
    }
}

.animate-rain {
    animation: rain 1s linear infinite;
}

/* Snow falling animation - gentle drift with rotation */
@keyframes snow {
    0% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0;
    }

    10% {
        opacity: 0.8;
    }

    90% {
        opacity: 0.6;
    }

    100% {
        transform: translateY(100vh) translateX(30px) rotate(360deg);
        opacity: 0;
    }
}

.animate-snow {
    animation: snow 5s linear infinite;
}

/* Breathing glow animation for accent elements */
@keyframes breathe {

    0%,
    100% {
        opacity: 0.5;
        box-shadow: 0 0 20px var(--atmosphere-glow, rgba(236, 72, 153, 0.3));
    }

    50% {
        opacity: 0.8;
        box-shadow: 0 0 40px var(--atmosphere-glow, rgba(236, 72, 153, 0.5));
    }
}

.animate-breathe {
    animation: breathe 3s ease-in-out infinite;
}

/* Neon pulse for night mode */
@keyframes neon-pulse {

    0%,
    100% {
        filter: brightness(1) drop-shadow(0 0 2px var(--atmosphere-accent, #ec4899));
    }

    50% {
        filter: brightness(1.2) drop-shadow(0 0 8px var(--atmosphere-accent, #ec4899));
    }
}

.animate-neon-pulse {
    animation: neon-pulse 2s ease-in-out infinite;
}

/* Holographic shimmer animation for tickets */
@keyframes shimmer {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}

.animate-shimmer {
    animation: shimmer 3s ease-in-out infinite;
}

/* 3D transform utilities for card flip */
.perspective-1000 {
    perspective: 1000px;
}

.transform-style-3d {
    transform-style: preserve-3d;
}

.backface-hidden {
    backface-visibility: hidden;
}

.rotate-y-180 {
    transform: rotateY(180deg);
}

/* Confetti burst animation */
@keyframes confetti {
    0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }

    100% {
        transform: translate(calc(-50% + cos(var(--confetti-angle, 0deg)) * 20px),
                calc(-50% + sin(var(--confetti-angle, 0deg)) * 20px)) scale(0);
        opacity: 0;
    }
}

.animate-confetti {
    animation: confetti 0.6s ease-out forwards;
}

/* Scale in animation for checkmarks */
@keyframes scale-in {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.animate-scale-in {
    animation: scale-in 0.3s ease-out forwards;
}

/* ==========================================================================
   BREATHING BORDER ANIMATION
   Subtle glow pulse for atmospheric glass panels
   ========================================================================== */

@keyframes breathing-border {

    0%,
    100% {
        border-color: var(--breathing-border-color, rgba(255, 255, 255, 0.1));
        box-shadow: 0 0 0 0 var(--breathing-glow-color, rgba(236, 72, 153, 0));
    }

    50% {
        border-color: var(--breathing-border-color-active, rgba(255, 255, 255, 0.25));
        box-shadow: 0 0 20px 2px var(--breathing-glow-color, rgba(236, 72, 153, 0.2));
    }
}

.animate-breathing-border {
    animation: breathing-border 4s ease-in-out infinite;
}

/* Faster variant for active/focused elements */
.animate-breathing-border-fast {
    animation: breathing-border 2s ease-in-out infinite;
}

/* ==========================================================================
   GLASS REFRACTION EFFECT
   Creates depth illusion with offset background blur
   ========================================================================== */

.glass-refraction {
    position: relative;
    overflow: hidden;
}

.glass-refraction::before {
    content: '';
    position: absolute;
    inset: -10px;
    background: inherit;
    filter: blur(20px) saturate(1.5);
    transform: scale(1.1);
    opacity: 0.3;
    z-index: -1;
    pointer-events: none;
}

/* Chromatic aberration effect for premium glass feel */
.glass-chromatic {
    position: relative;
}

.glass-chromatic::before,
.glass-chromatic::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.glass-chromatic:hover::before {
    background: linear-gradient(135deg, rgba(255, 0, 100, 0.05) 0%, transparent 50%);
    opacity: 1;
}

.glass-chromatic:hover::after {
    background: linear-gradient(315deg, rgba(0, 200, 255, 0.05) 0%, transparent 50%);
    opacity: 1;
}

/* ==========================================================================
   RAIN DROPS ON GLASS EFFECT
   CSS-only water droplets for rainy atmosphere
   ========================================================================== */

.glass-rain-drops {
    position: relative;
}

.glass-rain-drops::after {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 2%),
        radial-gradient(circle at 30% 70%, rgba(255, 255, 255, 0.12) 0%, transparent 1.5%),
        radial-gradient(circle at 50% 40%, rgba(255, 255, 255, 0.1) 0%, transparent 2.5%),
        radial-gradient(circle at 70% 15%, rgba(255, 255, 255, 0.13) 0%, transparent 1.8%),
        radial-gradient(circle at 85% 55%, rgba(255, 255, 255, 0.11) 0%, transparent 2.2%),
        radial-gradient(circle at 15% 80%, rgba(255, 255, 255, 0.14) 0%, transparent 1.3%),
        radial-gradient(circle at 60% 85%, rgba(255, 255, 255, 0.09) 0%, transparent 2%),
        radial-gradient(circle at 90% 30%, rgba(255, 255, 255, 0.12) 0%, transparent 1.5%);
    pointer-events: none;
    border-radius: inherit;
    opacity: 0.7;
}

/* ==========================================================================
   FOCUS GLOW RING
   Accessible focus indicator with atmospheric styling
   ========================================================================== */

.focus-glow:focus-visible {
    outline: none;
    box-shadow:
        0 0 0 2px var(--glass-bg-regular),
        0 0 0 4px var(--atmosphere-accent, #ec4899),
        0 0 20px var(--atmosphere-glow, rgba(236, 72, 153, 0.4));
}

/* ==========================================================================
   FADE IN ANIMATION
   Smooth transition for view mode changes
   ========================================================================== */

@keyframes fade-in {
    from {
        opacity: 0;
        transform: translateY(4px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.animate-fade-in {
    animation: fade-in 0.3s ease-out forwards;
}

/* Line clamp utility for card descriptions */
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}