[Great question! Let me analyze what would be needed to port Aurora
Weather and the GlassMap to CarPlay based on that guide.]{.s1}

[CarPlay Porting Requirements]{.s1}

[For Aurora Weather App]{.s1}

[Category: This would likely fall under Driving Task apps since weather
is useful while driving but doesn\'t fit other categories
perfectly.]{.s1}

[Requirements:]{.s1}

1.  [Entitlement: ]{.s2}[com.apple.developer.carplay-driving-task]{.s3}
2.  [Template Depth Limit: Only 2 templates allowed]{.s3}
3.  [Suitable Templates:]{.s3}
    - [List Template - Show forecast days/hours]{.s3}
    - [Information Template - Current conditions display]{.s3}
    - [Grid Template - Quick weather overview]{.s3}

[Key Constraints:]{.s1}

- [No complex interactions (weather radar panning would need to be
  simplified)]{.s3}
- [Must work while iPhone is locked (need to check data protection on
  weather cache)]{.s3}
- [All flows must be meaningful while driving]{.s3}
- [Widget support is easier - just
  needs ]{.s3}[.supportedFamilies(\[.systemSmall\])]{.s4}[ for CarPlay
  Dashboard]{.s3}

[For GlassMap (Navigation App)]{.s1}

[Category: Navigation apps - most complex but full-featured]{.s1}

[Requirements:]{.s1}

1.  [Entitlement: ]{.s2}[com.apple.developer.carplay-maps]{.s3}
2.  [Multiple Scenes Required:]{.s3}
    - [Main CarPlay scene]{.s3}
    - [Dashboard scene (optional)]{.s3}
    - [Instrument cluster scene (optional)]{.s3}

[Implementation Checklist:]{.s1}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY NAVIGATION APP - PORTING
CHECKLIST[                    ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. ENTITLEMENTS & CONFIG [               
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Request
com.apple.developer.carplay-maps entitlement[     
]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Add CarPlay scenes to Info.plist[   
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Implement
CPTemplateApplicationSceneDelegate[             
]{.Apple-converted-space}│]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. MAP RENDERING (Base View) [           
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Create CPMapTemplate as root[       
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Draw map in window (NOT using UIKit
views on template)[    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Handle safe area insets [           
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Support 2x and 3x display scales[   
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Implement heading-up orientation for
dashboard/cluster[    ]{.Apple-converted-space}│]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. REQUIRED TEMPLATES[                   
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPMapTemplate (base map view) [     
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPSearchTemplate (destination search)
[                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPPointOfInterestTemplate (POI
display) [                  ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPTripPreviewPanel[                 
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPRouteChoicePanel[                 
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPNavigationAlert [                 
                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. NAVIGATION FEATURES [                 
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ CPNavigationSession management[     
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Maneuver updates (CPManeuver) [     
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Trip estimates (CPTravelEstimates)[ 
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Lane guidance metadata (iOS 17.4+)[ 
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Voice prompts via AVAudioSession[   
                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. INTERACTIONS[                         
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Pan button (REQUIRED if panning
supported)[                ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Zoom/pitch/rotate gesture callbacks
[                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Respect keyboard/list restrictions[ 
                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}6. LOCKED PHONE CONSIDERATIONS [         
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Use
NSFileProtectionCompleteUntilFirstUserAuth[           
]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Keychain:
kSecAttrAccessibleAfterFirstUnlock[             
]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}□ Cache map tiles appropriately [     
                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                               
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Key Technical Changes Needed]{.s1}

[1. Map Rendering Approach]{.s1}

[*// Current: React/pigeon-maps in browser*]{.s1}

[*// CarPlay: Need native Swift/Metal rendering*]{.s1}

[]{.s1}\

[*// Would need a native iOS module that:*]{.s1}

[*// - Uses MapKit or custom tile renderer*]{.s1}

[*// - Draws directly to CPWindow*]{.s1}

[*// - Handles CarPlay-specific safe areas*]{.s1}

[]{.s1}\

[2. Scene Configuration (Info.plist)]{.s1}

[\<]{.s1}[key]{.s5}[\>UIApplicationSceneManifest\</]{.s1}[key]{.s5}[\>]{.s1}

[\<]{.s6}[dict]{.s1}[\>]{.s6}

[[   
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurations\</]{.s1}[key]{.s5}[\>]{.s1}

[[    ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[       
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>CPTemplateApplicationSceneSessionRoleApplication\</]{.s1}[key]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\<]{.s1}[array]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneClassName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>CPTemplateApplicationScene\</]{.s1}[string]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurationName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>CarPlay\</]{.s1}[string]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneDelegateClassName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>\$(PRODUCT_MODULE_NAME).CarPlaySceneDelegate\</]{.s1}[string]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\</]{.s1}[array]{.s5}[\>]{.s1}

[[    ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[\</]{.s6}[dict]{.s1}[\>]{.s6}

[3. Architecture Decision]{.s3}

  ------------------------------------- ----------------------------------- ---------------------------------
  [Approach]{.s3}                       [Pros]{.s3}                         [Cons]{.s3}
  [React Native + Native Module]{.s3}   [Reuse business logic]{.s3}         [Complex bridging for map]{.s3}
  [Pure Native CarPlay]{.s3}            [Best performance, full API]{.s3}   [Separate codebase]{.s3}
  [Expo + Custom Dev Client]{.s3}       [Easier RN integration]{.s3}        [Limited CarPlay support]{.s3}
  ------------------------------------- ----------------------------------- ---------------------------------

[Recommended Path Forward]{.s3}

1.  [Phase 1: Widgets (Easiest)]{.s3}
    - [Add iOS widget target with SwiftUI]{.s3}
    - [Support ]{.s3}[.systemSmall]{.s4}[ family]{.s3}
    - [Shows current weather/destination on CarPlay Dashboard]{.s3}
2.  [Phase 2: Driving Task App (Aurora Weather)]{.s3}
    - [Request driving-task entitlement]{.s3}
    - [Build simple 2-template flow]{.s3}
    - [Current conditions + forecast list]{.s3}
3.  [Phase 3: Navigation App (GlassMap)]{.s3}
    - [Request maps entitlement (longer approval)]{.s3}
    - [Build native map renderer]{.s3}
    - [Full turn-by-turn capability]{.s3}

[Would you like me to start scaffolding any of these components, or
explore the native iOS/Swift side of this integration?]{.s3}

[provide a comprehensive implementation plan. don\'t code yet also
explain in deatil if the carapp client can access our current a2a server
implementations]{.s7}

[]{.s1}\

[CarPlay Implementation Plan for Liquid Glass UI]{.s3}

[Executive Summary]{.s3}

[This plan outlines a comprehensive strategy to port Aurora Weather and
GlassMap (Neon Tokyo navigation) to Apple CarPlay. The architecture
leverages our existing A2A (Agent-to-Agent) server infrastructure while
building native iOS components required by CarPlay.]{.s3}

[]{.s1}\

[Part 1: Architecture Analysis]{.s3}

[Current Stack]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[                        ]{.Apple-converted-space}CURRENT
ARCHITECTURE[                             
]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                     
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌──────────────────┐ [   
]{.Apple-converted-space}┌──────────────────┐ [   
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}React
Frontend │────▶│ [  ]{.Apple-converted-space}Vite Dev/Prod[ 
]{.Apple-converted-space}│────▶│[    ]{.Apple-converted-space}Browser[ 
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}(TypeScript)
[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}(Port 5173)[    ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└──────────────────┘ [   
]{.Apple-converted-space}└──────────────────┘ [   
]{.Apple-converted-space}└─────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}▼[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}A2A Service Layer [                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
AuroraWeather [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
TravelPlanner [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
Other Agents[    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
Service.ts[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
Service.ts[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
[                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}└─────────────────┘ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└───────────┼────────────────────┼─────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│[                                     
]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}▼[                   
]{.Apple-converted-space}▼[                                     
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}Elysia Backend (Port 3000) [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ /agents/[ 
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ /api/v1/[ 
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ WebSocket
[      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
aurora-weather[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
endpoints [      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Port 3001) [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────┘[ 
]{.Apple-converted-space}└─────────────────┘[ 
]{.Apple-converted-space}└─────────────────┘ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}│ [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}▼ [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}Data Layer [                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Redis [   
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
PostgreSQL[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
External APIs [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Cache/PubSub)[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Optional)[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Open-Meteo)[    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────┘[ 
]{.Apple-converted-space}└─────────────────┘[ 
]{.Apple-converted-space}└─────────────────┘ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                     
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[CarPlay Target Architecture]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[                      ]{.Apple-converted-space}CARPLAY ARCHITECTURE[ 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                     
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}CarPlay Head Unit [                         
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
CPMapTemplate [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
CPListTemplate[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
CPGridTemplate[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Navigation)[    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Weather List)[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
(Quick Actions) │[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [          ]{.Apple-converted-space}│[ 
                  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│ [          ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}└────────────────────┼────────────────────┘ [ 
        ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                               
]{.Apple-converted-space}▼ [                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}┌─────────────────────┐ [                     
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│ CPInterfaceController│[                     
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}└──────────┬──────────┘ [                     
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└───────────────────────────────┼──────────────────────────────────┘[ 
  ]{.Apple-converted-space}│]{.s1}

[│[                                  ]{.Apple-converted-space}│ [       
                              ]{.Apple-converted-space}│]{.s1}

[│[                                  ]{.Apple-converted-space}▼ [       
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}iPhone (Native App) [                       
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}CarPlay Scene Delegates [                   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌────────────────┐[ 
]{.Apple-converted-space}┌────────────────┐[ 
]{.Apple-converted-space}┌────────────┐ │[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ MainSceneDel.[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ DashboardDel.[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ClusterDel.│ │[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└───────┬────────┘[ 
]{.Apple-converted-space}└───────┬────────┘[ 
]{.Apple-converted-space}└─────┬──────┘ │[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────┼───────────────────┼─────────────────┼────────┘[ 
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│
[                  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│[              ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [            ]{.Apple-converted-space}▼
[                  ]{.Apple-converted-space}▼ [               
]{.Apple-converted-space}▼[              ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}Native Service Layer (Swift)[               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌────────────────┐[ 
]{.Apple-converted-space}┌────────────────┐[ 
]{.Apple-converted-space}┌────────────┐ │[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ WeatherService │[  ]{.Apple-converted-space}│
NavigationSvc[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
MapRenderer│ │[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└───────┬────────┘[ 
]{.Apple-converted-space}└───────┬────────┘[ 
]{.Apple-converted-space}└─────┬──────┘ │[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────┼───────────────────┼─────────────────┼────────┘[ 
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│
[                  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│[              ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [           
]{.Apple-converted-space}└───────────────────┼─────────────────┘[       
      ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                               
]{.Apple-converted-space}▼[                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}A2A Client (Swift)[                         
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌────────────────────────────────────────────────────┐
│[    ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ • HTTP/JSON-RPC to Elysia backend[           
      ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ • WebSocket for real-time updates[           
      ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ • Offline cache with Core Data [             
      ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ • Background refresh capability[             
      ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└────────────────────────────────────────────────────┘
│[    ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                               
]{.Apple-converted-space}│[                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────┼────────────────────────────────┘[ 
  ]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│ [     
                              ]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}▼ [     
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}Network (Wi-Fi/Cellular) [                     
  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────┬───────────────────────────────┘[ 
  ]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│ [     
                              ]{.Apple-converted-space}│]{.s1}

[└────────────────────────────────────┼─────────────────────────────────────┘]{.s1}

[[                                     ]{.Apple-converted-space}│]{.s1}

[[                                     ]{.Apple-converted-space}▼]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[                    ]{.Apple-converted-space}EXISTING A2A SERVER
(Unchanged) [                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}Elysia Backend (Port 3000) [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
/agents/aurora-weather/a2a[  ]{.Apple-converted-space}(Weather Agent) [ 
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
/agents/travel-planner/a2a[  ]{.Apple-converted-space}(Navigation
Agent)[                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• WebSocket
streaming on port 3001 [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Part 2: A2A Server Compatibility Analysis]{.s3}

[Can CarPlay Client Access Current A2A Server?]{.s3}

[Yes, with considerations. Here\'s the detailed analysis:]{.s3}

[Current A2A Protocol]{.s3}

[Looking at the existing services:]{.s3}

[*// AuroraWeatherService.ts - Current Implementation*]{.s1}

[class]{.s8}[ ]{.s6}[AuroraWeatherService]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ endpoint
]{.s6}[=]{.s9}[ ]{.s6}[\'/agents/aurora-weather/a2a\']{.s1}[;]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[async]{.s8}[
]{.s1}[sendMessage]{.s9}[(message]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[)]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[WeatherResponse]{.s1}[\>]{.s9}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[const]{.s8}[ response
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetch]{.s9}[(]{.s1}[this]{.s8}[.endpoint, {]{.s1}

[[            ]{.Apple-converted-space}method]{.s1}[:]{.s9}[
]{.s1}[\'POST\']{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}headers]{.s1}[:]{.s9}[ {
]{.s1}[\'Content-Type\']{.s5}[:]{.s9}[
]{.s1}[\'application/json\']{.s10}[ },]{.s1}

[[            ]{.Apple-converted-space}body]{.s1}[:]{.s9}[
]{.s1}[JSON]{.s11}[.]{.s1}[stringify]{.s9}[({]{.s1}

[[                ]{.Apple-converted-space}jsonrpc]{.s1}[:]{.s9}[
]{.s1}[\'2.0\']{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}method]{.s1}[:]{.s9}[
]{.s1}[\'message\']{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}params]{.s1}[:]{.s9}[ {
message, sessionId]{.s1}[:]{.s9}[ ]{.s1}[this]{.s8}[.sessionId },]{.s1}

[[                ]{.Apple-converted-space}id]{.s1}[:]{.s9}[
]{.s1}[Date]{.s11}[.]{.s1}[now]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}})]{.s1}

[[        ]{.Apple-converted-space}});]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
response.]{.s1}[json]{.s9}[();]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Swift A2A Client Implementation (Proposed)]{.s3}

[*// This would be the equivalent Swift client*]{.s1}

[class]{.s8}[ ]{.s6}[A2AClient]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ baseURL:
]{.s1}[URL]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ session:
]{.s1}[URLSession]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// CarPlay apps can make HTTP
requests normally*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// The A2A protocol is just
JSON-RPC over HTTP*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[sendMessage]{.s9}[(]{.s1}[\_]{.s8}[ message:
]{.s1}[String]{.s11}[, to agent: ]{.s1}[String]{.s11}[)
]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[ ]{.s1}[-\>]{.s9}[
]{.s1}[AgentResponse]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[URLRequest]{.s11}[(url:
baseURL.]{.s1}[appendingPathComponent]{.s9}[(]{.s1}[\"/agents/]{.s10}[\\(agent)]{.s1}[/a2a\"]{.s10}[))]{.s1}

[[        ]{.Apple-converted-space}request.httpMethod ]{.s1}[=]{.s9}[
]{.s1}[\"POST\"]{.s10}

[[       
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"application/json\"]{.s10}[,
forHTTPHeaderField: ]{.s1}[\"Content-Type\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ payload:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\] ]{.s1}[=]{.s9}[ \[]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"jsonrpc\"]{.s10}[:
]{.s1}[\"2.0\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"method\"]{.s1}[:
]{.s6}[\"message\"]{.s1}[,]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"params\"]{.s10}[:
\[]{.s1}[\"message\"]{.s10}[: message, ]{.s1}[\"sessionId\"]{.s10}[:
sessionId\],]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"id\"]{.s10}[:
]{.s1}[Int]{.s11}[(]{.s1}[Date]{.s11}[().timeIntervalSince1970
]{.s1}[\*]{.s9}[ ]{.s1}[1000]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}request.httpBody ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[
]{.s1}[JSONSerialization]{.s11}[.]{.s1}[data]{.s9}[(withJSONObject:
payload)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ (data,
]{.s1}[\_]{.s8}[) ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
session.]{.s1}[data]{.s9}[(]{.s1}[for]{.s8}[: request)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[AgentResponse]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Compatibility Matrix]{.s3}

  ---------------------------- ------------------- ----------------------- --------------------------------
  [Feature]{.s3}               [Web Client]{.s3}   [CarPlay Client]{.s3}   [Notes]{.s3}
  [HTTP POST to A2A]{.s3}      [✅]{.s3}           [✅]{.s3}               [Standard URLSession]{.s3}
  [JSON-RPC Protocol]{.s3}     [✅]{.s3}           [✅]{.s3}               [Same wire format]{.s3}
  [WebSocket Streaming]{.s3}   [✅]{.s3}           [✅]{.s3}               [URLSessionWebSocketTask]{.s3}
  [Session Management]{.s3}    [✅]{.s3}           [✅]{.s3}               [UUID-based, portable]{.s3}
  [Authentication]{.s3}        [✅]{.s3}           [✅]{.s3}               [Bearer tokens work same]{.s3}
  [Offline Support]{.s3}       [❌]{.s3}           [⚠️]{.s3}               [Need Core Data cache]{.s3}
  [Background Refresh]{.s3}    [N/A]{.s3}          [✅]{.s3}               [iOS BGTaskScheduler]{.s3}
  ---------------------------- ------------------- ----------------------- --------------------------------

[Key Considerations for CarPlay A2A Access]{.s3}

[1. Network Availability]{.s3}

[CarPlay → iPhone → Cellular/WiFi → Server]{.s1}

[]{.s1}\

[The CarPlay head unit doesn\'t have its own network stack.]{.s1}

[All network requests go through the paired iPhone.]{.s1}

[This is IDENTICAL to how the web app works - just different
client.]{.s1}

[]{.s1}\

[2. Locked Phone State]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│ CRITICAL: iPhone is often LOCKED during CarPlay use [           
]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│ ]{.s1}[✅]{.s12}[ CAN ACCESS: [                                     
            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Network requests (A2A calls work fine)
[                    ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Keychain with
kSecAttrAccessibleAfterFirstUnlock [         
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Files with
NSFileProtectionCompleteUntilFirstUserAuth[     
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• UserDefaults[                         
                      ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Core Data (with appropriate
protection)[                    ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│ ]{.s1}[❌]{.s12}[ CANNOT ACCESS:[                                   
            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Keychain with
kSecAttrAccessibleWhenUnlocked [             
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Files with NSFileProtectionComplete[ 
                      ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}• Face ID / Touch ID prompts [         
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│ RECOMMENDATION:[                                                 
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}Store API tokens with AfterFirstUnlock
attribute [            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}Cache weather/route data with
appropriate file protection[    ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[3. Server-Side Changes (Minimal)]{.s3}

[The A2A server requires NO changes for CarPlay compatibility. However,
we should add:]{.s3}

[*// Optional: CarPlay-optimized endpoints
(server/src/routes/carplay.ts)*]{.s1}

[]{.s1}\

[*// Lighter payload for constrained CarPlay UI*]{.s1}

[app.]{.s6}[get]{.s9}[(]{.s6}[\'/api/v1/carplay/weather/current\']{.s1}[,
]{.s6}[async]{.s8}[ ({ query }) ]{.s6}[=\>]{.s9}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ { lat, lng }
]{.s1}[=]{.s9}[ query;]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Return simplified weather
data*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[return]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}temperature]{.s1}[:]{.s9}[
]{.s1}[72]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}condition]{.s1}[:]{.s9}[
]{.s1}[\'partly_cloudy\']{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}icon]{.s6}[:]{.s9}[
]{.s6}[\'cloud.sun.fill\']{.s10}[, ]{.s6}[*// SF Symbol name for
CarPlay*]{.s1}

[[        ]{.Apple-converted-space}high]{.s1}[:]{.s9}[
]{.s1}[78]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}low]{.s1}[:]{.s9}[ ]{.s1}[65]{.s11}

[[    ]{.Apple-converted-space}};]{.s1}

[});]{.s1}

[]{.s1}\

[*// Pre-formatted maneuver data for navigation*]{.s1}

[app.]{.s6}[get]{.s9}[(]{.s6}[\'/api/v1/carplay/navigation/maneuvers\']{.s1}[,
]{.s6}[async]{.s8}[ ({ query }) ]{.s6}[=\>]{.s9}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ { routeId }
]{.s1}[=]{.s9}[ query;]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Return CPManeuver-compatible
format*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[return]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}maneuvers]{.s1}[:]{.s9}[ \[]{.s1}

[[            ]{.Apple-converted-space}{]{.s1}

[[                ]{.Apple-converted-space}instruction]{.s1}[:]{.s9}[
]{.s1}[\"Turn right onto Main St\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}distance]{.s1}[:]{.s9}[
]{.s1}[0.5]{.s11}[, ]{.s1}[*// miles*]{.s13}

[[                ]{.Apple-converted-space}maneuverType]{.s1}[:]{.s9}[
]{.s1}[\"turnRight\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}junctionType]{.s1}[:]{.s9}[
]{.s1}[\"intersection\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Matches
CPManeuverType enum*]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[    ]{.Apple-converted-space}};]{.s1}

[});]{.s1}

[]{.s1}\

[]{.s1}\

[Part 3: Detailed Implementation Plan]{.s3}

[Phase 1: Foundation (Weeks 1-2)]{.s3}

[1.1 Xcode Project Setup]{.s3}

[LiquidGlassCarPlay/]{.s1}

[├── LiquidGlassCarPlay.xcodeproj]{.s1}

[├── LiquidGlassCarPlay/]{.s1}

[│ [  ]{.Apple-converted-space}├── App/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
AppDelegate.swift]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
SceneDelegate.swift [          ]{.Apple-converted-space}\# iPhone
scenes]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Info.plist]{.s1}

[│ [  ]{.Apple-converted-space}├── CarPlay/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CarPlaySceneDelegate.swift[    ]{.Apple-converted-space}\# Main CarPlay
scene]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
DashboardSceneDelegate.swift[  ]{.Apple-converted-space}\# Dashboard
scene]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
ClusterSceneDelegate.swift[    ]{.Apple-converted-space}\# Instrument
cluster]{.s1}

[│ [  ]{.Apple-converted-space}├── Services/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
A2A/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── A2AClient.swift [         
]{.Apple-converted-space}\# Core A2A protocol]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── WeatherAgent.swift[       
]{.Apple-converted-space}\# Aurora Weather agent]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── NavigationAgent.swift [   
]{.Apple-converted-space}\# Travel Planner agent]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Weather/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── WeatherService.swift]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Navigation/]{.s1}

[│ [  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}├──
NavigationService.swift]{.s1}

[│ [  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}└──
MapTileProvider.swift]{.s1}

[│ [  ]{.Apple-converted-space}├── Models/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Weather.swift]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Route.swift]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Maneuver.swift]{.s1}

[│ [  ]{.Apple-converted-space}├── Views/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
MapRenderer/]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── GlassMapView.swift[       
]{.Apple-converted-space}\# Custom map renderer]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── MapStyleProvider.swift[   
]{.Apple-converted-space}\# Dark theme tiles]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Widgets/]{.s1}

[│ [  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}└──
WeatherWidget.swift]{.s1}

[│ [  ]{.Apple-converted-space}└── Resources/]{.s1}

[│ [      ]{.Apple-converted-space}├── Assets.xcassets]{.s1}

[│ [      ]{.Apple-converted-space}└── Entitlements/]{.s1}

[│ [          ]{.Apple-converted-space}└──
LiquidGlass.entitlements]{.s1}

[├── LiquidGlassCarPlayTests/]{.s1}

[└── LiquidGlassCarPlayUITests/]{.s1}

[]{.s1}\

[1.2 Entitlement Requests]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[                    ]{.Apple-converted-space}ENTITLEMENT TIMELINE[   
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEEK 1: Submit Applications [             
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ 1.
com.apple.developer.carplay-driving-task[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}• For:
Aurora Weather[                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}• Approval:
\~1-2 weeks [                                ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}•
Justification: Weather info for safe driving [       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ 2. com.apple.developer.carplay-maps[   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}• For: Neon
Tokyo Navigation (GlassMap) [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}• Approval:
\~2-4 weeks (stricter review)[              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}•
Justification: Turn-by-turn navigation app[         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WHILE WAITING: Use CarPlay Simulator (no
entitlement needed) [  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[1.3 Info.plist Configuration]{.s3}

[*\<!\-- CarPlay Scene Manifest \--\>*]{.s1}

[\<]{.s1}[key]{.s5}[\>UIApplicationSceneManifest\</]{.s1}[key]{.s5}[\>]{.s1}

[\<]{.s6}[dict]{.s1}[\>]{.s6}

[[   
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UIApplicationSupportsMultipleScenes\</]{.s1}[key]{.s5}[\>]{.s1}

[[    ]{.Apple-converted-space}\<]{.s1}[true]{.s5}[/\>]{.s1}

[[   
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurations\</]{.s1}[key]{.s5}[\>]{.s1}

[[    ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*\<!\-- iPhone Scene
\--\>*]{.s1}

[[       
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UIWindowSceneSessionRoleApplication\</]{.s1}[key]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\<]{.s1}[array]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurationName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>Default
Configuration\</]{.s1}[string]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneDelegateClassName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>\$(PRODUCT_MODULE_NAME).SceneDelegate\</]{.s1}[string]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\</]{.s1}[array]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*\<!\-- CarPlay Main Scene
\--\>*]{.s1}

[[       
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>CPTemplateApplicationSceneSessionRoleApplication\</]{.s1}[key]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\<]{.s1}[array]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurationName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>CarPlay\</]{.s1}[string]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneDelegateClassName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>\$(PRODUCT_MODULE_NAME).CarPlaySceneDelegate\</]{.s1}[string]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\</]{.s1}[array]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*\<!\-- CarPlay Dashboard
Scene (Navigation) \--\>*]{.s1}

[[       
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>CPTemplateApplicationDashboardSceneSessionRoleApplication\</]{.s1}[key]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\<]{.s1}[array]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurationName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>CarPlay
Dashboard\</]{.s1}[string]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneDelegateClassName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>\$(PRODUCT_MODULE_NAME).DashboardSceneDelegate\</]{.s1}[string]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\</]{.s1}[array]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*\<!\-- Instrument Cluster
Scene (Navigation) \--\>*]{.s1}

[[       
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>CPInstrumentClusterSceneSessionRoleApplication\</]{.s1}[key]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\<]{.s1}[array]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\<]{.s1}[dict]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneConfigurationName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>Instrument
Cluster\</]{.s1}[string]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[key]{.s5}[\>UISceneDelegateClassName\</]{.s1}[key]{.s5}[\>]{.s1}

[[               
]{.Apple-converted-space}\<]{.s1}[string]{.s5}[\>\$(PRODUCT_MODULE_NAME).ClusterSceneDelegate\</]{.s1}[string]{.s5}[\>]{.s1}

[[            ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[[        ]{.Apple-converted-space}\</]{.s1}[array]{.s5}[\>]{.s1}

[[    ]{.Apple-converted-space}\</]{.s1}[dict]{.s5}[\>]{.s1}

[\</]{.s6}[dict]{.s1}[\>]{.s6}

[]{.s1}\

[*\<!\-- Supported CarPlay Templates \--\>*]{.s1}

[\<]{.s1}[key]{.s5}[\>CPSupportsDashboard\</]{.s1}[key]{.s5}[\>]{.s1}

[\<]{.s6}[true]{.s1}[/\>]{.s6}

[\<]{.s1}[key]{.s5}[\>CPSupportsInstrumentClusterNavigationScene\</]{.s1}[key]{.s5}[\>]{.s1}

[\<]{.s6}[true]{.s1}[/\>]{.s6}

[]{.s1}\

[]{.s1}\

[Phase 2: A2A Client Implementation (Weeks 2-3)]{.s3}

[2.1 Core A2A Protocol Layer]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[                    ]{.Apple-converted-space}A2A CLIENT ARCHITECTURE
[                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}A2AClient (Core) [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• JSON-RPC
2.0 protocol implementation[                  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Session
management [                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
Request/response serialization[                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Error
handling and retry logic[                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└────────────────────────┬─────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                          ]{.Apple-converted-space}│[               
                      ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}┌───────────────┼───────────────┐
[                    ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}▼ [             
]{.Apple-converted-space}▼ [              ]{.Apple-converted-space}▼ [ 
                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────────────┐ ┌────────────────┐
┌────────────────┐[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ WeatherAgent [ 
]{.Apple-converted-space}│ │ NavigationAgent│ │ Future Agents[ 
]{.Apple-converted-space}│[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[               
]{.Apple-converted-space}│ │[                ]{.Apple-converted-space}│
│[                ]{.Apple-converted-space}│[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • getWeather() │ │ • planRoute()[ 
]{.Apple-converted-space}│ │ • \...[         
]{.Apple-converted-space}│[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • getForecast()│ │ • getManeuvers│ │[   
            ]{.Apple-converted-space}│[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • searchCity() │ │ • updateETA()[ 
]{.Apple-converted-space}│ │[               
]{.Apple-converted-space}│[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────────────┘ └────────────────┘
└────────────────┘[      ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}│ [             
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
                  ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}└───────────────┼───────────────┘
[                    ]{.Apple-converted-space}│]{.s1}

[│ [                          ]{.Apple-converted-space}▼[               
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}Offline Cache Layer[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Core Data
for structured data [                        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• File cache
for map tiles[                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Background
refresh scheduling [                        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[2.2 Protocol Definition (Matching TypeScript)]{.s3}

[*// Models/A2A/A2AProtocol.swift*]{.s1}

[]{.s1}\

[*/// JSON-RPC 2.0 Request (matches TypeScript implementation)*]{.s1}

[struct]{.s8}[ ]{.s6}[A2ARequest]{.s1}[: ]{.s6}[Encodable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ jsonrpc ]{.s1}[=]{.s9}[
]{.s1}[\"2.0\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ method:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ params:
]{.s1}[A2AParams]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id: ]{.s1}[Int]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[A2AParams]{.s1}[: ]{.s6}[Encodable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ sessionId:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[*/// Response types matching server responses*]{.s1}

[struct]{.s8}[ ]{.s6}[A2AResponse]{.s1}[\<]{.s9}[T]{.s1}[:
]{.s6}[Decodable]{.s1}[\>]{.s9}[: ]{.s6}[Decodable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ jsonrpc:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ result:
]{.s1}[T]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ error:
]{.s1}[A2AError]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id: ]{.s1}[Int]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[A2AError]{.s1}[: ]{.s6}[Decodable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ code: ]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[*// Weather-specific response (matches AuroraWeatherService)*]{.s1}

[struct]{.s8}[ ]{.s6}[WeatherResult]{.s1}[: ]{.s6}[Decodable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ current:
]{.s1}[CurrentWeather]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hourly:
\[]{.s1}[HourlyForecast]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ daily:
\[]{.s1}[DailyForecast]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ location:
]{.s1}[LocationInfo]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CurrentWeather]{.s1}[: ]{.s6}[Decodable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ temperature:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ feelsLike:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ humidity:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ windSpeed:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ conditionCode:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ conditionText:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[*// \... matches TypeScript
CurrentWeather interface*]{.s1}

[}]{.s1}

[]{.s1}\

[2.3 Server URL Configuration]{.s3}

[*// Services/A2A/A2AConfiguration.swift*]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[A2AConfiguration]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[*// Development (local
server)*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
developmentBaseURL ]{.s1}[=]{.s9}[ ]{.s1}[URL]{.s9}[(string:
]{.s1}[\"http://localhost:3000\"]{.s10}[)]{.s1}[!]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Production (deployed
server)*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
productionBaseURL ]{.s1}[=]{.s9}[ ]{.s1}[URL]{.s9}[(string:
]{.s1}[\"https://api.liquidcrypto.app\"]{.s10}[)]{.s1}[!]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Current environment*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[var]{.s8}[
baseURL: ]{.s1}[URL]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[#if DEBUG]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
developmentBaseURL]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[#else]{.s5}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
productionBaseURL]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[#endif]{.s5}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Agent endpoints (matches
vite.config.ts proxy paths)*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Agents]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[static]{.s8}[
]{.s6}[let]{.s8}[ auroraWeather ]{.s6}[=]{.s9}[
]{.s6}[\"/agents/aurora-weather/a2a\"]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[static]{.s8}[
]{.s6}[let]{.s8}[ travelPlanner ]{.s6}[=]{.s9}[
]{.s6}[\"/agents/travel-planner/a2a\"]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WebSocket for real-time
updates*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[var]{.s8}[
webSocketURL: ]{.s1}[URL]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ components
]{.s1}[=]{.s9}[ ]{.s1}[URLComponents]{.s11}[(url: baseURL,
resolvingAgainstBaseURL: ]{.s1}[false]{.s11}[)]{.s1}[!]{.s9}

[[        ]{.Apple-converted-space}components.scheme ]{.s1}[=]{.s9}[
baseURL.scheme ]{.s1}[==]{.s9}[ ]{.s1}[\"https\"]{.s10}[ ]{.s1}[?]{.s9}[
]{.s1}[\"wss\"]{.s10}[ : ]{.s1}[\"ws\"]{.s10}

[[        ]{.Apple-converted-space}components.port ]{.s1}[=]{.s9}[
]{.s1}[3001]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
components.url]{.s1}[!]{.s9}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[]{.s1}\

[Phase 3: Aurora Weather CarPlay App (Weeks 3-4)]{.s3}

[3.1 Template Structure]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}AURORA WEATHER - CARPLAY
TEMPLATE FLOW[              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ROOT: CPTabBarTemplate[                   
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}Tab 1:
Current[          ]{.Apple-converted-space}Tab 2: Forecast[             
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ [                       
]{.Apple-converted-space}│[                             
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}▼ [                       
]{.Apple-converted-space}▼[                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌──────────────────┐ [   
]{.Apple-converted-space}┌──────────────────┐[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ CPInformationTpl │ [   
]{.Apple-converted-space}│ CPListTemplate [ 
]{.Apple-converted-space}│[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                 
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│[             
    ]{.Apple-converted-space}│[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ┌──────────────┐ │ [   
]{.Apple-converted-space}│ ┌──────────────┐ │[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ 72°F [       
]{.Apple-converted-space}│ │ [    ]{.Apple-converted-space}│ │ Today [ 
]{.Apple-converted-space}78/65│ │[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Partly Cloudy│ │ [   
]{.Apple-converted-space}│ │ Wed [    ]{.Apple-converted-space}75/62│
│[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[             
]{.Apple-converted-space}│ │ [    ]{.Apple-converted-space}│ │ Thu [   
]{.Apple-converted-space}72/60│ │[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Feels: 75°F[ 
]{.Apple-converted-space}│ │ [    ]{.Apple-converted-space}│ │ Fri [   
]{.Apple-converted-space}70/58│ │[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Wind: 8 mph[ 
]{.Apple-converted-space}│ │ [    ]{.Apple-converted-space}│ │ Sat [   
]{.Apple-converted-space}73/61│ │[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Humidity: 65%│ │ [   
]{.Apple-converted-space}│ │ Sun [    ]{.Apple-converted-space}76/64│
│[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ └──────────────┘ │ [   
]{.Apple-converted-space}│ │ Mon [    ]{.Apple-converted-space}78/66│
│[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                 
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│
└──────────────┘ │[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ \[]{.s1}[📍]{.s12}[ Location\][   
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│[             
    ]{.Apple-converted-space}│[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└──────────────────┘ [   
]{.Apple-converted-space}└──────────────────┘[                 
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│[                                 
                      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}▼ (on location tap)[               
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌──────────────────┐ [                   
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ CPListTemplate [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}← Saved
Locations[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ (Search Results) │[ 
]{.Apple-converted-space}← Search via voice: \"Hey Siri, weather [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└──────────────────┘[   
]{.Apple-converted-space}in Tokyo\"[                             
]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TEMPLATE DEPTH: 2 (within driving-task
limit) [                  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[3.2 Data Flow]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}AURORA WEATHER - DATA FLOW[   
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. APP LAUNCH [                           
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
CarPlaySceneDelegate.templateApplicationScene([           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}\_:didConnect:)[                               
        ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ WeatherService.fetchCurrentWeather(for:
savedLocation)[    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ A2AClient.send(to: \"aurora-weather\",[ 
                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[               
]{.Apple-converted-space}message: \"weather for London\") [           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ HTTP POST to /agents/aurora-weather/a2a
[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Parse WeatherResult → Update
CPInformationTemplate[        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. BACKGROUND REFRESH [                   
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ BGAppRefreshTask (every 15 minutes) [   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Fetch latest weather → Cache in Core
Data [                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ If CarPlay connected: Update templates[ 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. VOICE SEARCH (Via SiriKit) [           
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User: \"Hey Siri, what\'s the weather in
Tokyo?\" [          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ SiriKit Intent → WeatherIntentHandler [ 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ A2AClient.send(message: \"weather for
Tokyo\")[              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Return result to Siri + Update CarPlay
UI [                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Phase 4: GlassMap Navigation App (Weeks 4-7)]{.s3}

[4.1 Navigation App Architecture]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}GLASSMAP NAVIGATION -
ARCHITECTURE[                  ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│ [                    ]{.Apple-converted-space}┌─────────────────┐[   
                      ]{.Apple-converted-space}│]{.s1}

[│ [                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}CarPlay Screen │[                         
]{.Apple-converted-space}│]{.s1}

[│ [                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}(CPWindow)[    ]{.Apple-converted-space}│[     
                    ]{.Apple-converted-space}│]{.s1}

[│ [                    ]{.Apple-converted-space}└────────┬────────┘[   
                      ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                        ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌───────────────────────────┼───────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                         
]{.Apple-converted-space}▼[                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
    ]{.Apple-converted-space}CPMapTemplate[                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [         
]{.Apple-converted-space}GlassMapRenderer [                 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────┐[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}• Dark CartoDB tiles[             
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}• Route polyline overlay[         
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}• Current position marker [       
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}• POI markers [                   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}• Heading-up rotation [           
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────────────────────────┘[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
                                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}Map Buttons
(CPMapButton) [          ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[ 
]{.Apple-converted-space}\[]{.s1}[🔍]{.s12}[ Search\]
\[]{.s1}[📍]{.s12}[ Recenter\] \[]{.s1}[🔄]{.s12}[ Pan Mode\] [ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}OVERLAYS
(shown during navigation): [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
CPNavigationAlert[    ]{.Apple-converted-space}│ CPTripPreviewPanel [   
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ \"Speed
camera ahead\" │ Route preview + Start button │[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ADDITIONAL DISPLAYS: [                   
                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────────────────────┐[ 
]{.Apple-converted-space}┌────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}CarPlay
Dashboard[    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
  ]{.Apple-converted-space}Instrument Cluster [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────┐[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────────────┐ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Mini-map [ 
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Next maneuver
icon [      ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ + Next
turn[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Distance: 0.5 mi
[        ]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ + ETA: 2:45
PM [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Street: Main
St[          ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────┘[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────────────┘ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────────────────────┘[ 
]{.Apple-converted-space}└────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                 
]{.Apple-converted-space}│]{.s1}

[└───────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[4.2 Map Rendering Strategy]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}MAP RENDERING OPTIONS [       
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OPTION A: MapKit (Recommended for Phase
1)[                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Pros: [                                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Native iOS
integration[                                ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Automatic
CarPlay optimization[                        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Built-in
turn-by-turn support[                        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• No tile
server costs[                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Cons: [                                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Limited
styling (can\'t fully match GlassMap dark)[   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Apple Maps
only [                                      ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Implementation: [                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}MKMapView
with MKMapConfiguration.imagery [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}+ Custom
MKPolylineRenderer for route[                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OPTION B: Custom Tile Renderer (Phase 2
enhancement)[            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Pros: [                                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Exact
GlassMap dark theme[                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Same
CartoDB tiles as web version[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Full
visual consistency[                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Cons: [                                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
Significant development effort [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Need tile
caching strategy [                          ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
Performance optimization required [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Implementation: [                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Metal-based
tile renderer[                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}+ Tile URL:
cartodb-basemaps-a.global.ssl.fastly.net [  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}+ Same URL
pattern as GlassMap.tsx [                    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OPTION C: Mapbox SDK[                     
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Pros: [                                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Excellent
styling support[                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
CarPlay-compatible SDK [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Vector
tiles for crisp rendering [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Cons: [                                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Licensing
costs at scale [                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
Third-party dependency [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}RECOMMENDATION: Start with MapKit (Option
A), add custom[        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}renderer (Option B) as enhancement in
Phase 2 [                  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[4.3 Navigation Flow]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}NAVIGATION USER FLOW[         
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. DESTINATION SEARCH [                   
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User taps Search button on
CPMapTemplate[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ CPSearchTemplate presented[             
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User types or uses voice: \"Shibuya
Crossing\" [            ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ A2AClient → TravelPlanner: \"search
Shibuya Crossing\" [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Display CPListItem results [           
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. ROUTE PREVIEW[                         
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User selects destination[               
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ A2AClient → TravelPlanner: \"route to
\[lat,lng\]\"[          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Server returns: routes\[\], estimated
time, distance[        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Show CPTripPreviewPanel with route
options [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Route 1:
25 min (fastest)[                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Route 2:
30 min (avoid tolls)[                        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Route 3:
35 min (scenic) [                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. ACTIVE NAVIGATION[                     
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User taps \"Go\" on selected route[     
                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ CPNavigationSession.startTrip()[       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}▼[   
                                              ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
┌─────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[             
]{.Apple-converted-space}NAVIGATION LOOP [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}Every 1
second:[                                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}1. Get
GPS location[                              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}2. Match
to route[                                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}3.
Calculate distance to next maneuver[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}4. Update
CPManeuver if approaching turn[        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}5. Update
CPTravelEstimates (ETA) [              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}6. Play
voice prompt if needed[                  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}7. Update
map position[                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}On
deviation:[                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}→
A2AClient: \"reroute from \[current\] to \[dest\]\" │[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}→ Update
CPNavigationSession with new route [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}On
arrival:[                                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}→
CPNavigationSession.finishTrip()[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[    ]{.Apple-converted-space}→ Show
\"You have arrived\" alert [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
└─────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[4.4 Maneuver Metadata (iOS 17.4+)]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}INSTRUMENT CLUSTER METADATA [ 
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}For cars with digital instrument clusters,
we provide:[          ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Maneuver Types (CPManeuverType)[       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.turnRight, .turnLeft[                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.turnSlightRight, .turnSlightLeft[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.turnSharpRight, .turnSharpLeft[                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• .uTurn [ 
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.straightAhead [                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.enterRoundabout, .exitRoundabout[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.takeHighway, .exitHighway [                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• .arrive[ 
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Junction Types (CPJunctionType)[       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.intersection[                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.roundabout[                                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
.highwayJunction [                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Lane Guidance[                         
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Number of
lanes[                                      ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
Highlighted lanes for maneuver [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Lane
restrictions (HOV, bus, etc.) [                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}A2A SERVER ENHANCEMENT (optional):[       
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ // server/src/routes/navigation.ts [   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ interface CarPlayManeuver {[           
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}instruction: string; [                         
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}distance:
number;[                                    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}maneuverType: string;[   
]{.Apple-converted-space}// Maps to CPManeuverType [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}junctionType: string;[   
]{.Apple-converted-space}// Maps to CPJunctionType [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}lanes?:
{[                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}count:
number; [                                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}highlighted: number\[\]; [                     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}}; [     
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ }[                                     
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s14}

[Phase 5: Widgets & Live Activities (Weeks 5-6)]{.s3}

[5.1 Widget Implementation]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}CARPLAY WIDGETS [             
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Widgets appear on CarPlay Dashboard (left
side) [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}No entitlement needed - just WidgetKit
support[                  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEATHER WIDGET (.systemSmall) [           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────────────────┐ [                 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────┐[  ]{.Apple-converted-space}│
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[☁️]{.s12}[ 72°[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [               
                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}London[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}H:78° L:65° │[  ]{.Apple-converted-space}│ [   
                                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────┘[  ]{.Apple-converted-space}│
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────────────────┘ [                 
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NAVIGATION WIDGET (.systemSmall)[         
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────────────────┐ [                 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────┐[  ]{.Apple-converted-space}│
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[↱]{.s15}[ 0.5 mi [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [               
                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Main St [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}ETA: 2:45 [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────┘[  ]{.Apple-converted-space}│
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────────────────┘ [                 
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}IMPLEMENTATION: [                         
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ // WeatherWidget.swift[                 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ struct WeatherWidget: Widget {[         
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}var body:
some WidgetConfiguration {[                  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}StaticConfiguration([                         
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [           
]{.Apple-converted-space}kind: \"WeatherWidget\",[                     
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [           
]{.Apple-converted-space}provider: WeatherTimelineProvider() [         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}) {
entry in[                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [           
]{.Apple-converted-space}WeatherWidgetView(entry: entry) [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}} [   
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}.supportedFamilies(\[.systemSmall\])[         
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}// NO
.disfavoredLocations - we WANT CarPlay[      ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}} [       
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[5.2 Live Activities]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}LIVE ACTIVITIES IN CARPLAY[   
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Live Activities show real-time updates on
Dashboard [            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Perfect for active navigation [           
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ // NavigationLiveActivity.swift[       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ struct NavigationAttributes:
ActivityAttributes {[        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}let
destinationName: String[                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}struct
ContentState: Codable, Hashable { [           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}let
nextManeuver: String [                        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}let
distanceToManeuver: Double [                  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}let
eta: Date[                                    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}let
remainingDistance: Double[                    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}} [       
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ struct NavigationLiveActivity: Widget
{[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}var body:
some WidgetConfiguration { [                ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}ActivityConfiguration(for:
NavigationAttributes.self) { context in │]{.s1}

[│[  ]{.Apple-converted-space}│ [            ]{.Apple-converted-space}//
Lock screen / banner view [                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [           
]{.Apple-converted-space}NavigationLiveActivityView(context: context) │
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}}
dynamicIsland: { context in[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [            ]{.Apple-converted-space}//
Dynamic Island (for iPhone 14 Pro+) [      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}} [   
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}.supplementalActivityFamilies(\[.small\]) //
CarPlay│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}} [       
                                            ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Phase 6: Testing & Quality Assurance (Weeks 6-7)]{.s3}

[6.1 Testing Matrix]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}TESTING REQUIREMENTS[         
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY SIMULATOR TESTING [               
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Screen Configurations to Test:[         
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ 800 x 480
(Minimum)[                                  ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ 1280 x 720
[                                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ 1920 x 720
(Wide)[                                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ 1920 x
1080[                                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Input Types:[                           
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□
Touchscreen[                                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ Rotary
controller (knob) [                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ Voice
(Siri) [                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ States: [                               
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ iPhone
locked[                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ iPhone
unlocked[                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ No network
[                                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ Slow
network (3G throttled)[                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}□ Background
audio playing [                            ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}A2A INTEGRATION TESTS [                   
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Weather fetch with valid location[   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Weather fetch with invalid location
(error handling) [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Route calculation with valid start/end
[                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Route calculation across countries [ 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Session persistence across CarPlay
reconnect [          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Offline cache fallback [             
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ WebSocket reconnection [             
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}REAL DEVICE TESTING [                     
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Test with actual CarPlay head unit (if
available) [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Test during actual driving (passenger
operates)[        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Test GPS accuracy and route
following[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Test voice prompt timing and clarity
[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ □ Test in tunnel (GPS loss recovery) [ 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Part 4: Timeline & Resources]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}PROJECT TIMELINE[             
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEEK 1-2: Foundation[                     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Submit entitlement requests[         
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Set up Xcode project structure [     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Implement A2A Swift client [         
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── Basic CarPlay scene delegates[       
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEEK 3-4: Aurora Weather[                 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Weather templates (Information + List)
[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── A2A integration for weather data [   
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Location selection [                 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── SiriKit intent handler [             
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── Weather widget [                     
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEEK 4-6: GlassMap Navigation [           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── CPMapTemplate setup[                 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Map renderer (MapKit or custom)[     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Search template[                     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Route calculation via A2A[           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── CPNavigationSession management [     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Voice prompts[                       
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Dashboard + Cluster scenes [         
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── Navigation Live Activity [           
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEEK 6-7: Testing & Polish[               
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── CarPlay Simulator testing[           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Edge case handling [                 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Performance optimization [           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Accessibility review [               
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── App Store submission preparation [   
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TOTAL: \~7 weeks [                       
                        ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Part 5: Server-Side Considerations]{.s3}

[Minimal Server Changes]{.s3}

[The existing A2A server requires no breaking changes. Optional
enhancements:]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[              ]{.Apple-converted-space}OPTIONAL SERVER ENHANCEMENTS[ 
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. CarPlay-optimized endpoints (lighter
payloads) [              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ GET /api/v1/carplay/weather/summary[   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ → Returns only essential weather
fields[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ GET
/api/v1/carplay/navigation/maneuvers?routeId=X [     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ → Returns CPManeuver-compatible format
[                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. Push notification support for
navigation alerts[              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • Traffic incidents on active route[   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • Weather warnings for destination [   
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • ETA changes \> 10 minutes [           
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. Route caching for offline support[     
                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • Pre-calculate common routes[         
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • Cache route geometry in Redis[       
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ • Return cached route if server
unavailable[              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Summary]{.s3}

[Key Takeaways]{.s3}

1.  [A2A Compatibility: ]{.s3}[✅]{.s16}[ The CarPlay app CAN access our
    existing A2A server with zero server changes. The JSON-RPC protocol
    works identically from Swift.]{.s3}
2.  [Architecture: The CarPlay app is a native iOS addition that shares
    the same backend, not a separate system.]{.s3}
3.  [Phased Approach: Start with Weather (simpler, faster approval),
    then Navigation (complex but high value).]{.s3}
4.  [Widgets First: Easiest win - widgets work in CarPlay without
    entitlements and showcase our apps.]{.s3}
5.  [Map Renderer: Start with MapKit for simplicity, enhance with custom
    dark tiles later.]{.s3}

[Want me to proceed with any specific phase, or would you like more
detail on any particular aspect?]{.s3}

[what tool do i need to get the app onto my iphone?]{.s7}

[]{.s1}\

[To get the CarPlay app onto your iPhone, you\'ll need:]{.s3}

[Required Tools]{.s3}

[1. Xcode (Free)]{.s3}

- [Download from Mac App Store]{.s3}
- [Includes iOS Simulator, CarPlay Simulator, and device
  deployment]{.s3}
- [Required for all iOS development]{.s3}

[2. Apple Developer Account]{.s3}

  -------------------------------- ------------------ -------------------------------------------------------------------------------------------------------------
  [Account Type]{.s3}              [Cost]{.s3}        [What You Get]{.s3}
  [Free Apple ID]{.s3}             [\$0]{.s3}         [Deploy to YOUR device only, 7-day certificate expiry, no App Store, no CarPlay entitlements]{.s3}
  [Apple Developer Program]{.s3}   [\$99/year]{.s3}   [Deploy to any device, 1-year certificates, App Store distribution, required for CarPlay entitlements]{.s3}
  -------------------------------- ------------------ -------------------------------------------------------------------------------------------------------------

[3. Physical Requirements]{.s3}

- [Mac computer (Xcode only runs on macOS)]{.s3}
- [Lightning or USB-C cable to connect iPhone]{.s3}
- [iPhone running iOS 17+ (for latest CarPlay features)]{.s3}

[Quick Start (Testing on Your iPhone)]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}OPTION A: Free Apple ID (Development
Only)[                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. Open Xcode [                           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. Xcode → Settings → Accounts → Add Apple
ID[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. Create new project or open existing [ 
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. Select your Apple ID as \"Team\" in
Signing [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. Connect iPhone via cable[             
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}6. Trust computer on iPhone (Settings →
General → VPN & Device)│]{.s1}

[│[  ]{.Apple-converted-space}7. Select your iPhone as run destination
[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}8. Press ]{.s1}[▶️]{.s12}[ Run [         
                                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[[ 
]{.Apple-converted-space}Limitations:[                                 
              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• App expires after 7 days (re-deploy
to refresh) [          ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• No CarPlay entitlements [           
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• No push notifications [             
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Can only install on 3 devices [     
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}OPTION B: Apple Developer Program
(\$99/year)[                    ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. Enroll at
developer.apple.com/programs/enroll [             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. Wait 24-48 hours for approval [       
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. Same Xcode steps as above [           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. Request CarPlay entitlements at
developer.apple.com/carplay │]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[✅]{.s12}[ Full capabilities: [   
                                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• CarPlay entitlements available[     
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• 1-year certificates [               
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• App Store distribution[             
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Push notifications[                 
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Unlimited test devices[             
                      ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[For CarPlay Specifically]{.s3}

[You MUST have the \$99/year Apple Developer Program to:]{.s3}

1.  [Request CarPlay entitlements (driving-task, maps, etc.)]{.s3}
2.  [Test on actual CarPlay hardware]{.s3}
3.  [Submit to App Store]{.s3}

[However, you CAN test with:]{.s3}

- [CarPlay Simulator (in Xcode) - No entitlement needed for
  simulator]{.s3}
- [Free account - For basic iOS app development (not CarPlay
  features)]{.s3}

[Summary]{.s3}

  ------------------------------------- -----------------------------------------------------------
  [What You Want]{.s3}                  [Minimum Requirement]{.s3}
  [Test basic iOS app on iPhone]{.s3}   [Free Apple ID + Xcode]{.s3}
  [Test CarPlay in Simulator]{.s3}      [Free Apple ID + Xcode]{.s3}
  [Test CarPlay on real car]{.s3}       [\$99/year Developer Program + Entitlement approval]{.s3}
  [Publish to App Store]{.s3}           [\$99/year Developer Program]{.s3}
  ------------------------------------- -----------------------------------------------------------

[Would you like me to help set up the Xcode project structure once you
have the tools ready?]{.s3}

[would i have a separate project from my current LiquidCrytro Project?
How my my design guidelines and all nowledge about by a2a server get to
the new project? What next steps would you propose?]{.s7}

[]{.s1}\

[Great question! Let me break this down:]{.s3}

[Project Structure Options]{.s3}

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}OPTION A: Monorepo (Recommended) [       
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LiquidCrypto/[                           
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── server/ [         
]{.Apple-converted-space}← Existing Elysia backend[               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── src/[             
]{.Apple-converted-space}← Existing web frontend (Vite) [         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── ios/[             
]{.Apple-converted-space}← NEW: Xcode project [                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
LiquidCrypto.xcodeproj[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
LiquidCrypto/ [                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── App.swift [                               
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── CarPlay/[                                 
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Services/ [                               
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── A2AClient.swift [ 
]{.Apple-converted-space}← Talks to your server[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
LiquidCryptoTests/[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── shared/ [         
]{.Apple-converted-space}← NEW: Shared types/contracts [         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
api-types.ts[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
api-types.swift[  ]{.Apple-converted-space}← Generated from TS[         
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidSkills/ [   
]{.Apple-converted-space}← Your existing design guidelines [     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── directives/ [     
]{.Apple-converted-space}← Your existing SOPs[                   
]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[✅]{.s12}[ Pros:[                 
                                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Single source of truth for
design/knowledge[              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Shared API contracts [               
                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• One git repo, coordinated releases [ 
                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Directives/skills apply to iOS too [ 
                    ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[[ 
]{.Apple-converted-space}Cons: [                                       
              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Xcode doesn\'t natively understand
monorepos[              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Slightly more complex CI/CD[         
                    ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[┌─────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}OPTION B: Separate Repo[                 
                      ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────┤]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LiquidCrypto/ [       
]{.Apple-converted-space}← Existing repo[                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LiquidCrypto-iOS/ [   
]{.Apple-converted-space}← New separate repo[                     
]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[❌]{.s12}[ Not recommended because:
[                                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Knowledge fragmentation [           
                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• API contracts drift apart[           
                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Design guidelines duplicated/out of
sync [                ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Harder to coordinate releases[       
                    ]{.Apple-converted-space}│]{.s1}

[│[                                                                 
]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[How Knowledge Transfers to iOS]{.s3}

[┌──────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}Your A2A Server[                   
]{.Apple-converted-space}iOS App[                     
]{.Apple-converted-space}│]{.s1}

[├──────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}server/src/[                       
]{.Apple-converted-space}ios/LiquidCrypto/[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── routes/api/[                   
]{.Apple-converted-space}├── Services/[               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── a2a.ts
──────────────────────→ A2AClient.swift [       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}(endpoints) [                   
]{.Apple-converted-space}(HTTP client) [         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── types/ [                       
]{.Apple-converted-space}└── Models/[                 
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}└── agent.ts ────────────────────→
Agent.swift [            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}(TypeScript types)[             
]{.Apple-converted-space}(Swift structs) [       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────┐
│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}BRIDGE:
shared/api-types[                                   
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                      ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Define once
in TypeScript[                                ]{.Apple-converted-space}│
│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Generate
Swift types automatically [                     
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Tools:
quicktype, swift-bridge, or manual[               
]{.Apple-converted-space}│ │]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────┘
│]{.s1}

[│ [                                                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LiquidSkills/[                     
]{.Apple-converted-space}ios/LiquidCrypto/[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Design/[                       
]{.Apple-converted-space}├── UI/[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
liquid-glass.md ───────────────→ Design tokens in code │]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}(glass
effects, [                ]{.Apple-converted-space}(SwiftUI styles) [   
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[        ]{.Apple-converted-space}colors,
spacing)[                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                 
]{.Apple-converted-space}│]{.s1}

[└──────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Proposed Next Steps]{.s3}

+-----------------------+--------------------------------------+-----------------------+
| [Phase]{.s3}          | [Task]{.s3}                          | [Effort]{.s3}         |
+-----------------------+--------------------------------------+-----------------------+
| [1. Setup]{.s3}       | [Create ]{.s3}[ios/]{.s4}[ directory | [10 min]{.s3}         |
|                       | in monorepo]{.s3}                    |                       |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Initialize Xcode project]{.s3}      | [15 min]{.s3}         |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Configure signing (free Apple ID    | [10 min]{.s3}         |
|                       | for now)]{.s3}                       |                       |
+-----------------------+--------------------------------------+-----------------------+
| [2. Foundation]{.s3}  | [Create A2AClient.swift (HTTP client | [2-3 hrs]{.s3}        |
|                       | to your server)]{.s3}                |                       |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Define Swift models matching your   | [1-2 hrs]{.s3}        |
|                       | TypeScript types]{.s3}               |                       |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Basic SwiftUI app shell]{.s3}       | [1 hr]{.s3}           |
+-----------------------+--------------------------------------+-----------------------+
| [3. Design            | [Port Liquid Glass tokens to         | [2-3 hrs]{.s3}        |
| System]{.s3}          | SwiftUI]{.s3}                        |                       |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Create reusable glass components    | [3-4 hrs]{.s3}        |
|                       | (GlassCard, GlassButton)]{.s3}       |                       |
+-----------------------+--------------------------------------+-----------------------+
| [4. CarPlay]{.s3}     | [Add CarPlay entitlement (needs \$99 | [1 hr]{.s3}           |
|                       | account)]{.s3}                       |                       |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Implement CPTemplate scenes]{.s3}   | [3-4 hrs]{.s3}        |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Connect to A2A server for agent     | [2-3 hrs]{.s3}        |
|                       | data]{.s3}                           |                       |
+-----------------------+--------------------------------------+-----------------------+
| [5. Polish]{.s3}      | [iOS app companion screens]{.s3}     | [4-6 hrs]{.s3}        |
+-----------------------+--------------------------------------+-----------------------+
| []{.s1}\              | [Testing on device + CarPlay]{.s3}   | [2-3 hrs]{.s3}        |
+-----------------------+--------------------------------------+-----------------------+

[Immediate Action (Today)]{.s3}

[Would you like me to:]{.s3}

1.  [Create the ]{.s3}[ios/]{.s4}[ directory structure and a starter
    Xcode project configuration?]{.s3}
2.  [Create a directive (]{.s3}[directives/ios_carplay_app.md]{.s4}[)
    documenting the iOS app requirements, A2A integration points, and
    how to apply your Liquid Glass design system in SwiftUI?]{.s3}
3.  [Generate Swift types from your existing TypeScript A2A types so the
    iOS app speaks the same language as your server?]{.s3}

[Let me know which direction you\'d like to start, and whether you have
Xcode installed yet!]{.s3}

[before that, maybe ruminate on how to make this a really great user
experience. e.g. show weather along a navigation route or a simulated
navigation route. where it tells you what day or our best to lave. also,
we may want to integrate a realtiem speech api? openai whisper or
sometjign similar from google? just create. a comprehensive concept,
don\'t code yet. also be aware, that we can create additional a2a
servers if needed]{.s7}

[]{.s1}\

[I love this direction. Let me think deeply about what would make this
genuinely delightful, not just functional.]{.s3}

[LiquidCrypto CarPlay: Comprehensive Concept]{.s3}

[Core Philosophy]{.s3}

[\"Your AI co-pilot that sees the road ahead---weather, traffic,
timing---and speaks with you naturally.\"]{.s3}

[The magic isn\'t in showing data. It\'s in anticipating
needs and reducing cognitive load while driving. The car is one of the
few places where voice-first isn\'t a gimmick---it\'s essential.]{.s3}

[]{.s1}\

[The Experience Vision]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}You get in your car on a Tuesday morning.
Before you even speak: [    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}\"Good
morning, Mario. Rain starts on I-280 around 9:15. [     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Leave by
8:40 for clear roads, or 9:30 after it passes.[     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Your 10am
meeting gives you flexibility.\" [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│ [ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}It KNOWS: [                             
                              ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}• Your calendar (10am meeting)[         
                              ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}• Your usual route (I-280) [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}• Weather radar (rain cell moving
through) [                          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}• Traffic patterns (Tuesday morning
typical congestion)[              ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}• Your preferences (you hate driving in
rain)[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}This isn\'t a weather app. It\'s an
INTELLIGENCE.[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Feature Concepts]{.s3}

[1. Route Weather Timeline]{.s3}

[Not just \"weather at destination\"---weather along every segment of
your route, at the time you\'ll be there.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ROUTE: Home → San Francisco[             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Departure: 8:30 AM [                     
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}──●────────●────────●────────●────────●────────●──
[                    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}8:30[    ]{.Apple-converted-space}8:45 [ 
  ]{.Apple-converted-space}9:00 [    ]{.Apple-converted-space}9:15 [   
]{.Apple-converted-space}9:30 [    ]{.Apple-converted-space}9:45[       
              ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}Home[    ]{.Apple-converted-space}I-280[ 
  ]{.Apple-converted-space}Daly[    ]{.Apple-converted-space}SF City [ 
]{.Apple-converted-space}Arrive[                           
]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}Junction[ 
]{.Apple-converted-space}City[                                         
      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58° [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 56° [ 
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ 54° [ 
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ 52° [ 
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ 54°[                         
  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}Clear [  ]{.Apple-converted-space}Clear
[  ]{.Apple-converted-space}RAIN [    ]{.Apple-converted-space}RAIN[   
]{.Apple-converted-space}Clearing[                           
]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}↓ [                             
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}┌────────────────────────────────┐[   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[ Rain on I-280 at 9:00-9:20
│[                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Intensity: Moderate [         
]{.Apple-converted-space}│[                               
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Visibility: Reduced [         
]{.Apple-converted-space}│[                               
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│[                               
]{.Apple-converted-space}│[                               
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[💡]{.s12}[ Leave 20 min earlier or[   
]{.Apple-converted-space}│[                               
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}30 min
later to avoid[      ]{.Apple-converted-space}│[                       
        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}└────────────────────────────────┘[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Key insight: Weather apps show weather at locations. We show weather
at location × time intersections along your specific route.]{.s3}

[]{.s1}\

[2. Departure Time Optimizer]{.s3}

[The killer feature. Don\'t just navigate---optimize when to
leave.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}WHEN SHOULD I LEAVE? [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Destination: Mountain View [             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Need to arrive by: 2:00 PM[               
                            ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}OPTIMAL
WINDOWS [                                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[★]{.s15}[ 12:15 PM[ 
]{.Apple-converted-space}\"Sweet spot\"[                         
]{.Apple-converted-space}45 min [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ Clear roads, light traffic,
arrive 1:00 PM[              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}○ 11:30 AM[ 
]{.Apple-converted-space}\"Early & safe\"[                       
]{.Apple-converted-space}50 min [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ Clear, moderate traffic,
buffer time[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}○ 1:00 PM [ 
]{.Apple-converted-space}\"Cutting it close\"[                   
]{.Apple-converted-space}55 min [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ Clouds building, heavier
traffic[                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}✗ 12:45 PM[ 
]{.Apple-converted-space}\"Avoid\" [                             
]{.Apple-converted-space}65 min [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ Rain starts, accident-prone
window[                      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}\"I recommend
leaving at 12:15. You\'ll have clear weather [     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}the entire
drive and arrive with an hour to spare.\" [         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Factors considered:]{.s3}

- [Weather radar predictions along route]{.s3}
- [Historical traffic patterns (Tuesday vs Saturday, 9am vs 2pm)]{.s3}
- [Real-time traffic incidents]{.s3}
- [Your calendar (hard deadlines vs flexible)]{.s3}
- [Personal preferences (learned over time: \"Mario avoids rain\")]{.s3}

[]{.s1}\

[3. Conversational Interface (Voice-First)]{.s3}

[This is where real-time speech transforms the experience.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CONVERSATION FLOW[                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}You: \"Hey, what\'s the weather looking
like for my drive to[            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}the office?\" [                     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}AI:[  ]{.Apple-converted-space}\"Right now
it\'s clear, but there\'s a rain cell moving in.[       
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}If you leave in the next 20 minutes,
you\'ll beat it.[            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}Otherwise, it\'ll hit Highway 101
around 9:15 and last [          ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}about 40 minutes. Want me to set a
reminder?\" [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}You: \"What about tomorrow? I have that
early meeting.\"[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}AI:[  ]{.Apple-converted-space}\"Tomorrow
looks better. Clear skies all morning, but [           
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}temperatures drop to 42 at
7am---might want to warm up[            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}the car. Traffic is typically
lighter on Wednesdays too.[        ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}Your 8am meeting means leaving by
7:15 to be safe.\" [            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}You: \"Remind me tonight to check the
weather before bed.\" [            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}AI:[  ]{.Apple-converted-space}\"Got it.
I\'ll ping you around 9pm with tomorrow\'s[               
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}driving conditions.\" [             
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Voice characteristics:]{.s3}

- [Low latency: \< 500ms response start (streaming)]{.s3}
- [Interruptible: User can cut in mid-response]{.s3}
- [Context-aware: Remembers conversation, knows your patterns]{.s3}
- [Concise while driving: Shorter responses when car is moving]{.s3}
- [Proactive: Speaks up for important alerts without being asked]{.s3}

[]{.s1}\

[4. Proactive Alerts (The Magic Moments)]{.s3}

[The AI doesn\'t wait to be asked. It anticipates.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}PROACTIVE INTELLIGENCE [                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO 1: Calendar-aware weather alert[ 
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}──────────────────────────────────────────[   
                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Saturday 6pm: You have \"Dinner at Chez
Panisse\" on calendar [        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Saturday 3pm: AI notices storm system
arriving 5-7pm[                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• AI proactively: \"Heads up---rain is
expected during your dinner [      ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}reservation tonight. Consider leaving 30
minutes early, or[          ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}I can check if they have valet
parking.\"[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO 2: Pattern-based suggestion[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────────────────[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• AI notices: You drive to the gym every
Tuesday/Thursday 6pm [        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tuesday 5:30pm: AI says \"Gym traffic
looks good right now.[          ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}Leave in the next 15 minutes to avoid
the 6pm rush.\"[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO 3: Real-time route adjustment[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────────────────[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• You\'re driving, rain starts heavier
than forecast [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• AI: \"Rain is heavier than expected
ahead. There\'s a covered [        ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}rest stop in 3 miles, or I can find an
alternate route that [        ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}stays on surface streets. What would you
prefer?\" [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO 4: Multi-day trip planning [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────────────────[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• You mention \"road trip to LA this
weekend\"[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• AI analyzes entire route over multiple
days [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Saturday looks perfect for the drive
down---clear skies, [            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}mild temps. Sunday has a storm system,
so if you\'re flexible, [      ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}I\'d suggest driving back Monday morning
instead.\" [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[5. Visual Design: Liquid Glass in Motion]{.s3}

[CarPlay has strict UI constraints, but we can make it beautiful.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY VISUAL LANGUAGE[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭─────────────────────────────────────────────────────────────╮│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░││
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}░░││ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}]{.s1}[☀️]{.s12}[
→ ]{.s1}[⛅]{.s12}[ → ]{.s1}[🌧️]{.s12}[ → ]{.s1}[⛅]{.s12}[[           
                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}░░││ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│ [                                           
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░││ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}\"Rain at 9:15 on
I-280\" [                        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}░░││ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│ [                                           
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░││ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┌─────────┐[ 
]{.Apple-converted-space}┌─────────┐ [                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░││ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ LEAVE [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ WAIT[   
]{.Apple-converted-space}│ [                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░││ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}NOW[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ 45 MIN[  ]{.Apple-converted-space}│ [       
              ]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░││
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}└─────────┘[ 
]{.Apple-converted-space}└─────────┘ [                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░││ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│░░[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}░░││ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░││
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰─────────────────────────────────────────────────────────────╯│
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}DESIGN
PRINCIPLES: [                                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Frosted
glass cards with subtle depth[                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Weather
state shown as fluid gradient transitions[           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Large touch
targets (driving safety) [                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Minimal
text, maximum glanceability[                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Dark mode
optimized (most cars have dark interiors)[         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Animated
weather icons (subtle, not distracting) [           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Technical Architecture: A2A Server Network]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [                       
]{.Apple-converted-space}┌─────────────────┐[                           
]{.Apple-converted-space}│]{.s1}

[│ [                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}iOS CarPlay [  ]{.Apple-converted-space}│[     
                      ]{.Apple-converted-space}│]{.s1}

[│ [                        ]{.Apple-converted-space}│[     
]{.Apple-converted-space}App[        ]{.Apple-converted-space}│[       
                    ]{.Apple-converted-space}│]{.s1}

[│ [                       
]{.Apple-converted-space}└────────┬────────┘[                           
]{.Apple-converted-space}│]{.s1}

[│[                                  ]{.Apple-converted-space}│[       
                              ]{.Apple-converted-space}│]{.s1}

[│[                   
]{.Apple-converted-space}┌─────────────┴─────────────┐ [               
      ]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}│ [                     
    ]{.Apple-converted-space}│ [                     
]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}▼ [                     
    ]{.Apple-converted-space}▼ [                     
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}┌─────────────────┐ [       
]{.Apple-converted-space}┌─────────────────┐ [             
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│[  ]{.Apple-converted-space}Voice
Gateway[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Main A2A Hub [ 
]{.Apple-converted-space}│ [             
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│[    ]{.Apple-converted-space}A2A
Server [  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}(Orchestrator) │
[              ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}└────────┬────────┘ [       
]{.Apple-converted-space}└────────┬────────┘ [             
]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}│ [                       
  ]{.Apple-converted-space}│ [                       
]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}│[             
]{.Apple-converted-space}┌────────────┼────────────┐[           
]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}│[             
]{.Apple-converted-space}│[            ]{.Apple-converted-space}│[     
      ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}▼[             
]{.Apple-converted-space}▼[            ]{.Apple-converted-space}▼[     
      ]{.Apple-converted-space}▼[           
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}┌───────────────┐ ┌─────────┐
┌─────────┐ ┌───────────┐ [      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ Speech-to-[   
]{.Apple-converted-space}│ │ Weather │ │ Traffic │ │ Calendar[ 
]{.Apple-converted-space}│ [      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ Speech Agent[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}Agent[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}Agent[ 
]{.Apple-converted-space}│ │ [  ]{.Apple-converted-space}Agent [ 
]{.Apple-converted-space}│ [      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ [             
]{.Apple-converted-space}│ │ [        ]{.Apple-converted-space}│ │ [   
    ]{.Apple-converted-space}│ │ [          ]{.Apple-converted-space}│
[      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ • OpenAI[     
]{.Apple-converted-space}│ │ • NWS [  ]{.Apple-converted-space}│ │ •
Google│ │ • Google[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Realtime[    ]{.Apple-converted-space}│ │ •
Open[  ]{.Apple-converted-space}│ │ [  ]{.Apple-converted-space}Maps[ 
]{.Apple-converted-space}│ │ [  ]{.Apple-converted-space}Cal [   
]{.Apple-converted-space}│ [      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ • Google[     
]{.Apple-converted-space}│ │ [  ]{.Apple-converted-space}Meteo │ │ •
Apple │ │ • Apple [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Gemini[      ]{.Apple-converted-space}│ │ •
Radar │ │ [  ]{.Apple-converted-space}Maps[  ]{.Apple-converted-space}│
│ [  ]{.Apple-converted-space}Cal [    ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}│ • Deepgram[   
]{.Apple-converted-space}│ │ [  ]{.Apple-converted-space}APIs[ 
]{.Apple-converted-space}│ │ • HERE[  ]{.Apple-converted-space}│ │ •
Outlook │ [      ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}└───────────────┘ └─────────┘
└─────────┘ └───────────┘ [      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}┌─────────┐ [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│ Route [ 
]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│ Intel [ 
]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│ Agent [ 
]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│Combines:│ [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│• Route[ 
]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│• Weather│ [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│• Traffic│ [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│• Time [ 
]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}└─────────┘ [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[A2A Server Breakdown]{.s3}

  -------------------------- ------------------------------------------------- ------------------------------------------------------------------------
  [Server]{.s3}              [Responsibility]{.s3}                             [Key Capabilities]{.s3}
  [Main Hub]{.s3}            [Orchestration, user context, preferences]{.s3}   [Routes requests, maintains conversation state, learns patterns]{.s3}
  [Voice Gateway]{.s3}       [Real-time speech processing]{.s3}                [STT, TTS, interrupt handling, streaming responses]{.s3}
  [Weather Agent]{.s3}       [Weather data aggregation]{.s3}                   [Point forecasts, radar nowcasting, severe alerts, route weather]{.s3}
  [Traffic Agent]{.s3}       [Traffic intelligence]{.s3}                       [Real-time conditions, historical patterns, incident detection]{.s3}
  [Calendar Agent]{.s3}      [Schedule awareness]{.s3}                         [Event extraction, travel time estimation, deadline awareness]{.s3}
  [Route Intel Agent]{.s3}   [The \"brain\" that combines everything]{.s3}     [Weather×Route×Time intersection, departure optimization]{.s3}
  -------------------------- ------------------------------------------------- ------------------------------------------------------------------------

[]{.s1}\

[Voice Technology Comparison]{.s3}

  ------------------------------- ---------------- ------------------ ----------------- -------------------------------------------------
  [Technology]{.s3}               [Latency]{.s3}   [Quality]{.s3}     [Cost]{.s3}       [Best For]{.s3}
  [OpenAI Realtime API]{.s3}      [\~300ms]{.s3}   [Excellent]{.s3}   [\$\$\$\$]{.s3}   [Premium experience, natural conversation]{.s3}
  [Google Gemini 2.0 Live]{.s3}   [\~400ms]{.s3}   [Excellent]{.s3}   [\$\$\$]{.s3}     [Multi-modal, sees/hears]{.s3}
  [Deepgram + ElevenLabs]{.s3}    [\~500ms]{.s3}   [Great]{.s3}       [\$\$]{.s3}       [Cost-effective, customizable]{.s3}
  [Whisper + TTS]{.s3}            [\~800ms]{.s3}   [Good]{.s3}        [\$]{.s3}         [Budget, offline-capable]{.s3}
  [On-device (Apple)]{.s3}        [\~200ms]{.s3}   [Good]{.s3}        [Free]{.s3}       [Privacy, no network needed]{.s3}
  ------------------------------- ---------------- ------------------ ----------------- -------------------------------------------------

[Recommendation: Hybrid approach]{.s3}

- [Primary: OpenAI Realtime or Gemini Live for natural
  conversation]{.s3}
- [Fallback: On-device Siri/Speech for network issues]{.s3}
- [Wake word: On-device detection, then stream to cloud]{.s3}

[]{.s1}\

[User Journey Map]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}A DAY WITH LIQUIDCRYPTO CARPLAY[         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}7:00 AM │ WAKE UP [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ iPhone notification: \"Clear
morning for your commute. [      ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ Leave by 8:15 for the smoothest
drive.\" [                    ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}8:10 AM │ GET IN CAR[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ CarPlay auto-launches
LiquidCrypto[                          ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Good morning! Perfect
timing---traffic is light. [        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ 28 minutes to the office.
Starting navigation.\" [            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}8:25 AM │ DURING DRIVE[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Heads up---there\'s a
slowdown ahead from an earlier [    ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ accident. I\'m routing you
through Oak Street instead. [      ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ Adds 3 minutes but avoids the
backup.\"[                      ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ You: \"What\'s the weather for
my lunch meeting in Palo Alto?\"│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Sunny and 68 at noon.
Great day for outdoor seating [  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ if the restaurant has it.\"[   
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}8:38 AM │ ARRIVE[                         
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"You\'ve arrived. Have a
great day! I\'ll check[          ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ conditions before your lunch
trip.\" [                        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}11:45AM │ LUNCH TRIP[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Ready for Palo Alto? 22
minutes, clear weather[        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ the whole way. I found street
parking near the restaurant[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ that\'s free until 2pm.\" [     
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5:30 PM │ HEADING HOME[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Evening commute looks
busy---42 minutes on 101. [        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ But if you wait 20 minutes, it
drops to 31. Coffee run?\" [  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ You: \"Sure, find me a
drive-through nearby.\" [              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Philz is 2 minutes away
with no line visible. [        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ Starting navigation.\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}6:15 PM │ HOME[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}────────┼──────────────────────────────────────────────────────────
[  ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ AI: \"Home safe. Tomorrow\'s
commute looks clear until [      ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ mid-morning---your 9am meeting
gives you flexibility.\"[        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[                               
                              ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Differentiation: Why This Wins]{.s3}

  ------------------------------------------------------------ -------------------------------------------------------------------------------------
  [Existing Solutions]{.s3}                                    [LiquidCrypto CarPlay]{.s3}
  [Weather apps show weather at destinations]{.s3}             [We show weather at every point along your route at the time you\'ll be there]{.s3}
  [Navigation apps react to current traffic]{.s3}              [We predict optimal departure times based on weather + traffic + calendar]{.s3}
  [Voice assistants wait for commands]{.s3}                    [We proactively inform when conditions change]{.s3}
  [Siri/Google require wake words + explicit questions]{.s3}   [Natural conversation with context memory]{.s3}
  [Single-purpose apps (weather OR maps OR calendar)]{.s3}     [Unified intelligence that connects all three]{.s3}
  ------------------------------------------------------------ -------------------------------------------------------------------------------------

[]{.s1}\

[Privacy Considerations]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}DATA HANDLING PRINCIPLES [               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WHAT WE NEED[                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}HOW WE PROTECT
IT[                ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Location history (for patterns) [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Processed
on-device, only[        ]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}aggregated patterns sent to cloud │]{.s1}

[│[                                    ]{.Apple-converted-space}│[     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Calendar events [                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Event titles/times
only, not [    ]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}full descriptions or attendees [ 
]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│[     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Voice recordings[                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Streamed, not
stored. Transcripts│]{.s1}

[│[                                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}retained only for context (24hr) │]{.s1}

[│[                                    ]{.Apple-converted-space}│[     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Routes driven [                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Anonymized for
traffic contrib.[  ]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Personal routes deletable[       
]{.Apple-converted-space}│]{.s1}

[│[                                    ]{.Apple-converted-space}│[     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}USER CONTROLS: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Forget my patterns\" - wipes learned
behavior [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Don\'t learn from this trip\" -
one-time privacy mode[                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Offline mode\" - on-device only, no
cloud [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Full data export/delete (GDPR/CCPA
compliant) [                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[MVP vs Full Vision]{.s3}

[Phase 1: MVP (What gets us to \"wow\")]{.s3}

- [ Route weather timeline (show weather along route)]{.s3}
- [ Simple departure suggestion (\"leave now vs wait\")]{.s3}
- [ Voice query: \"What\'s the weather for my drive?\"]{.s3}
- [ Proactive alert: rain incoming on route]{.s3}
- [ Liquid Glass CarPlay UI]{.s3}

[Phase 2: Intelligence]{.s3}

- [ Calendar integration]{.s3}
- [ Pattern learning (usual routes, times)]{.s3}
- [ Multi-day trip planning]{.s3}
- [ Traffic + weather combined optimization]{.s3}

[Phase 3: Delight]{.s3}

- [ Conversational memory (\"remember I hate driving in rain\")]{.s3}
- [ Parking suggestions]{.s3}
- [ EV charging weather (cold battery, range prediction)]{.s3}
- [ Multi-modal: \"Show me the radar\"]{.s3}

[]{.s1}\

[Open Questions for You]{.s3}

1.  [Voice provider preference? OpenAI Realtime is most natural but
    expensive. Hybrid approach?]{.s3}
2.  [Calendar integration scope? Just Apple Calendar, or also
    Google/Outlook?]{.s3}
3.  [Offline capability priority? Full offline mode, or graceful
    degradation?]{.s3}
4.  [Monetization model? This could be premium subscription-worthy.
    Thoughts?]{.s3}
5.  [Beta testing approach? TestFlight with weather enthusiasts?
    Commuters?]{.s3}

[]{.s1}\

[What aspects resonate most? I can dive deeper into any area---the voice
architecture, the route intelligence algorithms, the CarPlay UI
patterns, or the A2A server design.]{.s3}

[the carplay ui patterns]{.s7}

[]{.s1}\

[CarPlay UI Patterns: Deep Dive]{.s3}

[CarPlay Constraints & Opportunities]{.s3}

[First, let\'s understand what Apple allows and how we can work within
(and shine within) those constraints.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY TECHNICAL CONSTRAINTS[           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WHAT APPLE CONTROLS: [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Screen resolution varies (800×480 to
1920×720+) [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Touch target minimums (44pt)[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Template-based UI (not fully custom)[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Limited interaction while driving[     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• App must respond within 10 seconds[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Background audio/location allowed [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY APP TYPES: [                     
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌────────────────┬─────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Type [         
]{.Apple-converted-space}│ What We Can Build [                         
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├────────────────┼─────────────────────────────────────────────────┤[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Navigation [   
]{.Apple-converted-space}│ Full custom map UI, turn-by-turn, dashboard
[    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ (Requires[     
]{.Apple-converted-space}│ card, route planning, ETA. MOST FLEXIBLE. [ 
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ entitlement) [ 
]{.Apple-converted-space}│ ← THIS IS WHAT WE WANT[                     
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├────────────────┼─────────────────────────────────────────────────┤[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Audio[         
]{.Apple-converted-space}│ Now playing, playlists, podcasts[           
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├────────────────┼─────────────────────────────────────────────────┤[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Communication[ 
]{.Apple-converted-space}│ Contacts, messages, voicemail [             
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├────────────────┼─────────────────────────────────────────────────┤[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ EV Charging[   
]{.Apple-converted-space}│ Station finder, charging status [           
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├────────────────┼─────────────────────────────────────────────────┤[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Parking[       
]{.Apple-converted-space}│ Spot finder, payment[                       
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├────────────────┼─────────────────────────────────────────────────┤[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Quick Food [   
]{.Apple-converted-space}│ Ordering (very limited) [                   
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└────────────────┴─────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NAVIGATION APP CAPABILITIES:[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Custom map rendering (MapKit or own
tiles) [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Full-screen map with overlays[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Dashboard integration (compact view on
home) [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Custom UI panels alongside map [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Turn-by-turn voice guidance[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Trip preview screens [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ Search/POI interfaces[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Screen Anatomy]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY SCREEN REGIONS [                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
          ]{.Apple-converted-space}STATUS BAR[                         
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
]{.Apple-converted-space}(Apple controlled: time, signal, etc)[         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────────────────────┬───────────────────────┐
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│ [                   
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}SIDE PANEL [        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}PRIMARY CONTENT [         
]{.Apple-converted-space}│[    ]{.Apple-converted-space}(Contextual) [ 
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
]{.Apple-converted-space}(Map area) [           
]{.Apple-converted-space}│ [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• Weather card [    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• ETA info [        ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• Alerts [          ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• Voice status [    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│ [                   
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}├──────────────────────────────────┴───────────────────────┤
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}BOTTOM BAR [                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[         
]{.Apple-converted-space}(Navigation controls, quick actions) [         
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└───────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ASPECT RATIOS WE MUST SUPPORT:[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Standard:[  ]{.Apple-converted-space}800
× 480[  ]{.Apple-converted-space}(5:3) [  ]{.Apple-converted-space}-
Older head units [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Wide: [    ]{.Apple-converted-space}1200
× 480[  ]{.Apple-converted-space}(5:2) [  ]{.Apple-converted-space}-
Common modern[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Ultrawide: 1920 × 720 (8:3) [ 
]{.Apple-converted-space}- Premium vehicles [                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Core UI States]{.s3}

[State 1: Home / Idle]{.s3}

[When the app launches but no active navigation.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}HOME STATE [                             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[                                       
                      ]{.Apple-converted-space}9:41 ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}┌─────────────────────┐ [             
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Good
morning, [    ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│[     
]{.Apple-converted-space}Mario[          ]{.Apple-converted-space}│ [   
            ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58°F [         
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Clear
skies [      ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}└─────────────────────┘ [             
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭──────────────────╮[ 
]{.Apple-converted-space}╭──────────────────╮ [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ]{.s1}[🏢]{.s12}[ WORK[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🏠]{.s12}[ HOME[          ]{.Apple-converted-space}│ [           
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ 28 min • Clear [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ \-- [           
  ]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰──────────────────╯[ 
]{.Apple-converted-space}╰──────────────────╯ [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────╮
│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ]{.s1}[🎙️]{.s12}[[ 
]{.Apple-converted-space}\"Where would you like to go?\" [             
      ]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────╯
│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯[ 
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[🔍]{.s12}[ Search [   
]{.Apple-converted-space}]{.s1}[📍]{.s12}[ Recents [   
]{.Apple-converted-space}]{.s1}[⭐]{.s12}[ Favorites [   
]{.Apple-converted-space}]{.s1}[🎙️]{.s12}[ Voice[         
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DESIGN ELEMENTS: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Greeting + current weather (context
without asking) [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Smart suggestions (learned
destinations)[                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Immediate ETA + weather for common
places[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Prominent voice activation[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Frosted glass cards with subtle
shadows[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[State 2: Route Preview (The Killer Feature UI)]{.s3}

[This is where we differentiate. Show weather along the route
timeline.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ROUTE PREVIEW - WEATHER TIMELINE [       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[                                       
                      ]{.Apple-converted-space}9:41 ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭───────────────────────────────────╮╭─────────────────────────╮
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││ [                   
    ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}\[MAP VIEW\][             
]{.Apple-converted-space}││[  ]{.Apple-converted-space}San Francisco[   
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}45 min • 32 miles[     
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}Route with weather [         
]{.Apple-converted-space}││ [                       
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}overlay colors:[             
]{.Apple-converted-space}││[ 
]{.Apple-converted-space}┌───────────────────┐[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}│ WEATHER TIMELINE[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[🟢]{.s12}[ Clear [                   
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│ [             
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[🟡]{.s12}[ Light rain[               
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│ NOW[ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58° [     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[🟠]{.s12}[ Moderate rain [           
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}↓ [              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[🔴]{.s12}[ Heavy rain[               
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│ 9:15
]{.s1}[🌧️]{.s12}[ Rain [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}│[      ]{.Apple-converted-space}starts[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}● You are here[                 
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}↓ [              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[◉]{.s15}[ Weather transition points [   
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│ 9:35
]{.s1}[⛅]{.s12}[ 54°[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}○ Destination [                 
]{.Apple-converted-space}││[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}clearing[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}↓ [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}│ 10:00 ARRIVE [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}└───────────────────┘[ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}││ [                   
    ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰───────────────────────────────────╯╰─────────────────────────╯
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╭─────────────────────────────────────────────────────────────╮
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[[ 
]{.Apple-converted-space}Rain on I-280 in 20 min[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}LEAVE NOW[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}WAIT 45 MIN │ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╰─────────────────────────────────────────────────────────────╯
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[✕]{.s15}[ Cancel[                       
                      ]{.Apple-converted-space}GO → [   
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}KEY INNOVATIONS: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Route line colored by weather conditions
at arrival time[            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Vertical timeline showing weather state
changes [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Alert banner with actionable choices
(not just info)[                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"WAIT 45 MIN\" is a BUTTON - tap to
schedule departure [              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[State 3: Active Navigation]{.s3}

[During turn-by-turn, weather becomes ambient but ready.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ACTIVE NAVIGATION[                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃
╭────────────────────────────────────────────────────────────╮[   
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ │[        ]{.Apple-converted-space}↑[   
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ │[      ]{.Apple-converted-space}0.3 mi
[                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ │ [  ]{.Apple-converted-space}Turn right
onto [                                         
]{.Apple-converted-space}│[    ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ │ [  ]{.Apple-converted-space}Oak
Street[                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃
╰────────────────────────────────────────────────────────────╯[   
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────┐
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
          ]{.Apple-converted-space}\[FULL MAP VIEW\][                   
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}Route highlighted [                   
    ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
        ]{.Apple-converted-space}Weather colors on path[               
    ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}╭──────────────╮
[  ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│
]{.s1}[⛅]{.s12}[ 54° [      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│ Rain in 12mi │
[  ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}╰──────────────╯
[  ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────┘
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[🎙️]{.s12}[ Voice[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}32 min[   
]{.Apple-converted-space}│[   
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ Rain ahead[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}]{.s1}[✕]{.s15}[
End[    ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DESIGN PRINCIPLES: [                     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Minimal UI - driving requires focus [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather badge: small, glanceable, corner
position [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Rain ahead\" in bottom bar - tappable
for details [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Voice button always prominent [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Turn instructions follow Apple HIG for
familiarity[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[State 4: Weather Alert (Interruptive)]{.s3}

[When conditions change significantly, get attention safely.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}WEATHER ALERT OVERLAY[                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────┐
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
          ]{.Apple-converted-space}\[MAP - DIMMED\] [                   
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}╭──────────────────────────────────────╮ [     
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░│ [     
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [                               
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [ 
]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[[ 
]{.Apple-converted-space}HEAVY RAIN AHEAD [         
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [                               
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [  ]{.Apple-converted-space}Starting in 8
minutes [        ]{.Apple-converted-space}░░│ [           
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [  ]{.Apple-converted-space}Visibility will
be reduced[    ]{.Apple-converted-space}░░│ [           
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [                               
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░[  ]{.Apple-converted-space}╭────────────╮
╭────────────╮[  ]{.Apple-converted-space}░░│ [           
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░[  ]{.Apple-converted-space}│ PULL OVER[ 
]{.Apple-converted-space}│ │ CONTINUE [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░[  ]{.Apple-converted-space}│ Rest stop[ 
]{.Apple-converted-space}│ │ Carefully[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░[  ]{.Apple-converted-space}│ 2 mi ahead │
│[            ]{.Apple-converted-space}│[  ]{.Apple-converted-space}░░│
[            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░[  ]{.Apple-converted-space}╰────────────╯
╰────────────╯[  ]{.Apple-converted-space}░░│ [           
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░ [                               
]{.Apple-converted-space}░░│ [            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░│ [     
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}╰──────────────────────────────────────╯ [     
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────┘
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DESIGN NOTES:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Frosted glass modal over dimmed map [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Voice simultaneously: \"Heavy rain
starting in 8 minutes\...\" [        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Two clear actions, both safe choices[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Pull over\" includes helpful context
(rest stop distance) [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Auto-dismiss after 10 sec if no
interaction (continues nav) [        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[State 5: Voice Active]{.s3}

[When user is speaking or AI is responding.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}VOICE INTERACTION STATE[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────┐
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
          ]{.Apple-converted-space}\[MAP - SLIGHTLY DIMMED\][           
      ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────┘
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────────────╮
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[🎙️]{.s12}[[ 
]{.Apple-converted-space}═══════════════════════════[                   
        ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}▁ ▃ ▅ ▇ ▅ ▃ ▁ ▃ ▅ ▇ ▅ ▃ ▁[                     
        ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}\"What\'s the weather like in Palo Alto?\"[   
                ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────────────╯
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}THEN TRANSITIONS TO AI RESPONDING:[       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────────────╮
┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[🔊]{.s12}[[ 
]{.Apple-converted-space}════════════════════════════════════ [         
        ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}▁ ▂ ▃ ▂ ▁ ▂ ▄ ▃ ▂ ▁ ▃ ▅ ▃ ▂ ▁[                 
        ]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}\"Palo Alto is sunny and 72 degrees right
now.[              ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Perfect for your lunch meeting.\"[             
            ]{.Apple-converted-space}│ ┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
                                                 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────────────╯
┃[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DESIGN NOTES:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Waveform visualization - alive,
responsive[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Real-time transcription shows what was
heard[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tap anywhere to interrupt AI response [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Map stays visible (context) but dimmed
(focus on voice) [            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[State 6: Dashboard Widget]{.s3}

[When user is on CarPlay home with our app in background.]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY DASHBOARD INTEGRATION[           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}The Dashboard is the CarPlay home screen
where multiple apps [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}show compact widgets. We get a small
rectangle.[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[                       
]{.Apple-converted-space}CARPLAY DASHBOARD[                         
]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌─────────────┐ ┌─────────────┐ ┌─────────────┐
┌─────────────┐ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
  ]{.Apple-converted-space}│ │ [            ]{.Apple-converted-space}│ │
[            ]{.Apple-converted-space}│ │ [           
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[🎵]{.s12}[ Music[ 
]{.Apple-converted-space}│ │ [ 
]{.Apple-converted-space}]{.s1}[📞]{.s12}[ Phone[ 
]{.Apple-converted-space}│ │ ]{.s1}[💬]{.s12}[ Messages │ │ [ 
]{.Apple-converted-space}]{.s1}[📍]{.s12}[ Maps [ 
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
  ]{.Apple-converted-space}│ │ [            ]{.Apple-converted-space}│ │
[            ]{.Apple-converted-space}│ │ [           
]{.Apple-converted-space}│ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└─────────────┘ └─────────────┘ └─────────────┘
└─────────────┘ ┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌───────────────────────────────────────────────────────────────┐┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                                                   
]{.Apple-converted-space}│┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭─────────────────────────────────────────────────────────╮[ 
]{.Apple-converted-space}│┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                           
            ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🌤️]{.s12}[[ 
]{.Apple-converted-space}LiquidCrypto [                                 
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                           
            ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}]{.s1}[☀️]{.s12}[
58° → ]{.s1}[🌧️]{.s12}[ Rain in 25 min on your route[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                           
            ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Work: 28 min │
Leave by 8:40 to stay dry[              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [                                           
            ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰─────────────────────────────────────────────────────────╯[ 
]{.Apple-converted-space}│┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                                                   
]{.Apple-converted-space}│┃[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└───────────────────────────────────────────────────────────────┘┃[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                       
                          ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WIDGET STATES: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}IDLE (no destination):[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🌤️]{.s12}[ LiquidCrypto[         
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58° Clear [                 
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}Tap to plan
your drive [                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NAVIGATING: [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🌤️]{.s12}[ → Work [               
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ Rain starting on I-280 [     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}28 min
remaining[          ]{.Apple-converted-space}Arrives 10:15[             
          ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ALERT:[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[ LiquidCrypto [         
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ HEAVY RAIN in 8 min[         
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}Tap for
options[                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Liquid Glass Design System for CarPlay]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}DESIGN TOKENS[                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}COLORS (Dark Mode Primary - Cars are dark
interiors)[                  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}───────────────────────────────────────────────────
[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Background [                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────┐[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│████████│[ 
]{.Apple-converted-space}Base:[        ]{.Apple-converted-space}#0A0A0F
(near black, not pure) [              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────┘[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────┐[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▓▓▓▓▓▓▓▓│[ 
]{.Apple-converted-space}Surface: [    ]{.Apple-converted-space}#1A1A24
(cards, panels)[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────┘[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────┐[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▒▒▒▒▒▒▒▒│[ 
]{.Apple-converted-space}Elevated:[    ]{.Apple-converted-space}#252532
(modals, alerts) [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────┘[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Glass Effect [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────────┐[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│░▒▓█▓▒░│[  ]{.Apple-converted-space}Blur:
20px, Saturation: 1.2[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────────┘[ 
]{.Apple-converted-space}Background: rgba(255,255,255,0.05)[           
            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}Border: rgba(255,255,255,0.1)
1px[                          ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}Shadow: 0 8px 32px
rgba(0,0,0,0.3)[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather State Colors [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────── [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Clear/Sunny[   
]{.Apple-converted-space}#3B82F6 (blue)[                               
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[☀️]{.s12}[ │ Gradient: #60A5FA →
#3B82F6[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Cloudy [       
]{.Apple-converted-space}#94A3B8 (slate) [                             
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[⛅]{.s12}[ │ Gradient: #CBD5E1 →
#94A3B8[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Rain [         
]{.Apple-converted-space}#6366F1 (indigo)[                             
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🌧️]{.s12}[ │ Gradient: #818CF8 →
#6366F1 [                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Heavy Rain [   
]{.Apple-converted-space}#7C3AED (violet)[                             
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[⛈️]{.s12}[ │ Gradient: #A78BFA →
#7C3AED[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Snow [         
]{.Apple-converted-space}#E2E8F0 (light gray)[                         
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🌨️]{.s12}[ │ Gradient: #F8FAFC →
#E2E8F0 [                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Fog[           
]{.Apple-converted-space}#64748B (gray)[                               
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🌫️]{.s12}[ │ Gradient: #94A3B8 →
#64748B [                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Alert Colors [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────[                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Warning[       
]{.Apple-converted-space}#F59E0B (amber) [                             
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[⚠️]{.s12}[ │[                   
                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Danger [       
]{.Apple-converted-space}#EF4444 (red) [                               
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🚨]{.s12}[ │[                   
                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌────┐ Success[       
]{.Apple-converted-space}#10B981 (emerald) [                           
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ✓[  ]{.Apple-converted-space}│[         
                                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└────┘[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TYPOGRAPHY [                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Font: SF Pro (system) - required for
CarPlay[                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Hierarchy: [                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Headline: [   
]{.Apple-converted-space}SF Pro Display Semibold, 28pt (turn
instructions) [    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Title:[       
]{.Apple-converted-space}SF Pro Display Medium, 22pt (destination names)
[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Body: [       
]{.Apple-converted-space}SF Pro Text Regular, 17pt (descriptions)[     
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Caption:[     
]{.Apple-converted-space}SF Pro Text Regular, 13pt (secondary info)[   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tabular:[     
]{.Apple-converted-space}SF Pro Text Mono, 17pt (times, distances) [   
        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SPACING[                                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Base unit: 8px[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• xs: 4px [ 
]{.Apple-converted-space}(tight internal)[                             
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• sm: 8px [ 
]{.Apple-converted-space}(compact) [                                   
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• md: 16px[ 
]{.Apple-converted-space}(standard)[                                   
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• lg: 24px[ 
]{.Apple-converted-space}(section breaks)[                             
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• xl: 32px[ 
]{.Apple-converted-space}(major sections)[                             
            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TOUCH TARGETS[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Minimum: 44 × 44 pt (Apple requirement) [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Recommended: 60 × 60 pt (driving safety)[ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Button padding: 16px horizontal, 12px
vertical minimum[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CORNERS[                                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Cards: 16px radius (generous, soft) [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Buttons: 12px radius[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Modals: 20px radius [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Pills/badges: 999px (full round)[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Component Library]{.s3}

[GlassCard]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}GLASS CARD COMPONENT [                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}VARIANTS:[                               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Default[                       
]{.Apple-converted-space}Elevated (alerts)[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭──────────────────╮[         
]{.Apple-converted-space}╭──────────────────╮[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│░░░░░░░░░░░░░░░░░░│[         
]{.Apple-converted-space}│▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒│[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│░░[             
]{.Apple-converted-space}░░│[          ]{.Apple-converted-space}│▒▒[   
          ]{.Apple-converted-space}▒▒│[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│░░ [  ]{.Apple-converted-space}Content[ 
  ]{.Apple-converted-space}░░│[          ]{.Apple-converted-space}│▒▒ [ 
]{.Apple-converted-space}Content[    ]{.Apple-converted-space}▒▒│[     
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│░░[             
]{.Apple-converted-space}░░│[          ]{.Apple-converted-space}│▒▒[   
          ]{.Apple-converted-space}▒▒│[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│░░░░░░░░░░░░░░░░░░│[         
]{.Apple-converted-space}│▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒│[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰──────────────────╯[         
]{.Apple-converted-space}╰──────────────────╯[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}blur: 20px[                   
]{.Apple-converted-space}blur: 30px[                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}bg: rgba(255,255,255,0.05)[   
]{.Apple-converted-space}bg: rgba(255,255,255,0.08)[             
]{.Apple-converted-space}│]{.s1}

[│[                                ]{.Apple-converted-space}shadow:
stronger[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Tinted (weather state)[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭──────────────────╮[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓│ ← gradient tint based
on weather[                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▓▓[             
]{.Apple-converted-space}▓▓│[                                           
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▓▓ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ Clear[   
]{.Apple-converted-space}▓▓│[                                           
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▓▓[             
]{.Apple-converted-space}▓▓│[                                           
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓│[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰──────────────────╯[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}bg: linear-gradient(135deg, [             
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}rgba(59,130,246,0.15),[               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}rgba(59,130,246,0.05))[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SWIFT IMPLEMENTATION SKETCH:[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}struct GlassCard\<Content: View\>: View {
[                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}let variant: CardVariant[ 
]{.Apple-converted-space}// .default, .elevated, .tinted [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}let weatherState: WeatherState? [     
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\@ViewBuilder let content: Content [ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}var body: some View { [               
                            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}content [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}.padding(16)[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}.background(glassMaterial)[   
                            ]{.Apple-converted-space}│]{.s1}

[│[             
]{.Apple-converted-space}.clipShape(RoundedRectangle(cornerRadius:
16))[            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}.overlay( [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[                 
]{.Apple-converted-space}RoundedRectangle(cornerRadius: 16)[           
        ]{.Apple-converted-space}│]{.s1}

[│[                     
]{.Apple-converted-space}.stroke(Color.white.opacity(0.1), lineWidth: 1)
[  ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}) [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}.shadow(color:
.black.opacity(0.3), radius: 16) [         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[WeatherTimeline]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}WEATHER TIMELINE COMPONENT [             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Vertical (side panel)[             
]{.Apple-converted-space}Horizontal (dashboard widget)[     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌─────────────────┐ [             
]{.Apple-converted-space}┌────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│[   
                            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}● NOW[ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58°[ 
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[───]{.s1}[⛅]{.s12}[───]{.s1}[🌧️]{.s12}[───]{.s1}[⛅]{.s12}[───]{.s1}[☀️]{.s12}[[ 
        ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│
NOW [  ]{.Apple-converted-space}+15[  ]{.Apple-converted-space}+30[ 
]{.Apple-converted-space}+45[  ]{.Apple-converted-space}ARRIVE[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│[ 
                              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[◐]{.s15}[ 9:15[       
]{.Apple-converted-space}│ [             
]{.Apple-converted-space}└────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ Rain [   
]{.Apple-converted-space}│[                                             
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}starts [    ]{.Apple-converted-space}│ [       
      ]{.Apple-converted-space}DESIGN NOTES: [                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}│ [              ]{.Apple-converted-space}•
Horizontal for constrained space │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[◐]{.s15}[ 9:35[       
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}•
Icons on line, times below[        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ Clearing │ [             
]{.Apple-converted-space}• Gradient line shows transitions[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}│ [                                         
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}○ 10:00 [   
  ]{.Apple-converted-space}│ [                                         
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}ARRIVE [ 
  ]{.Apple-converted-space}│ [                                         
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ [                                           
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└─────────────────┘ [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LEGEND: [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}● = Current position[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[◐]{.s15}[ = Weather transition
point[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}○ = Destination [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LINE STYLING: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• 4px width, rounded caps [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Gradient color matches weather state[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Animated pulse at transition points [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[RouteWeatherOverlay]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}MAP ROUTE OVERLAY[                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}The route line on the map changes color
based on weather conditions [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}at each segment, at the time you\'ll pass
through. [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}╭─── Rain zone (gradient
transition)[                ]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}│[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}▼[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[       
]{.Apple-converted-space}●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━○[ 
                  ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}│[              ]{.Apple-converted-space}│ [   
          ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[  ]{.Apple-converted-space}BLUE [ 
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}PURPLE [   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}SLATE[     
]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Clear)[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}(Rain) [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}(Cloudy)[    ]{.Apple-converted-space}│[       
            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}│[              ]{.Apple-converted-space}│ [   
          ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}START [     
]{.Apple-converted-space}│[              ]{.Apple-converted-space}│ [   
          ]{.Apple-converted-space}DESTINATION[         
]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}│[             
]{.Apple-converted-space}│[                                   
]{.Apple-converted-space}│]{.s1}

[│ [                ]{.Apple-converted-space}9:15 AM[       
]{.Apple-converted-space}9:35 AM [                               
]{.Apple-converted-space}│]{.s1}

[│ [                ]{.Apple-converted-space}Rain starts [ 
]{.Apple-converted-space}Rain ends[                               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}IMPLEMENTATION:[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Segment route into \~1 mile chunks [   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Query weather for each chunk at ETA
time[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Color route polyline with gradient
stops[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Add subtle glow effect on rain/storm
segments [                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEATHER MARKER PINS: [                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}╭───╮ [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}│]{.s1}[🌧️]{.s12}[│[ 
]{.Apple-converted-space}Weather transition marker[                     
            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}╰─┬─╯ [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Shows
where conditions change [                             
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}▼ [  ]{.Apple-converted-space}Tap to
see details[                                         
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}● [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[DepartureOptimizer]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}DEPARTURE TIME SELECTOR[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────────────────╮[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}WHEN SHOULD
YOU LEAVE? [                                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Destination:
Work • Need to arrive by 10:00 AM [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[★]{.s15}[ 8:15 AM [                     
            ]{.Apple-converted-space}45 min[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ Clear entire route [         
                    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}✓ RECOMMENDED [                               
      ]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}○ 8:40 AM [                                 
]{.Apple-converted-space}38 min[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ Rain on I-280 for 15 min[   
                    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}○ 9:15 AM [                                 
]{.Apple-converted-space}40 min[    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ After rain, roads drying [   
                    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                               
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────────────────╯[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INTERACTION: [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tap option to select[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Selected option expands with \"GO NOW\"
/ \"SET REMINDER\" buttons[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Voice: \"The first option at 8:15 keeps
you dry the whole way\" [      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}FACTORS SHOWN: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather icon + brief description[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Total drive time[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Visual indicator for recommended
(]{.s1}[★]{.s15}[ vs ○) [                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Checkmark or highlight for best option[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[VoiceInterface]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}VOICE UI COMPONENT [                     
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}STATES: [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}IDLE[                             
]{.Apple-converted-space}LISTENING [                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭──────────────────────╮ [       
]{.Apple-converted-space}╭──────────────────────╮[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}]{.s1}[🎙️]{.s12}[ [         
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}▁ ▃ ▅ ▇ ▅ ▃ ▁[    ]{.Apple-converted-space}│[ 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}]{.s1}[🎙️]{.s12}[ [         
]{.Apple-converted-space}│[            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Tap or say
\"Hey\" [  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Listening\... [ 
    ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰──────────────────────╯ [       
]{.Apple-converted-space}╰──────────────────────╯[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Subtle pulse animation [         
]{.Apple-converted-space}Active waveform[                     
]{.Apple-converted-space}│]{.s1}

[│ [                                 
]{.Apple-converted-space}Transcription appearing[             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PROCESSING[                       
]{.Apple-converted-space}SPEAKING[                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭──────────────────────╮ [       
]{.Apple-converted-space}╭──────────────────────╮[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[◠]{.s15}[ ]{.s1}[◡]{.s15}[
]{.s1}[◠]{.s15}[ ]{.s1}[◡]{.s15}[ ]{.s1}[◠]{.s15}[ [     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}▂ ▅ ▃ ▇ ▂ ▅ ▃[    ]{.Apple-converted-space}│[ 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}]{.s1}[🔄]{.s12}[ [         
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}]{.s1}[🔊]{.s12}[ [         
]{.Apple-converted-space}│[            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Thinking\...[        ]{.Apple-converted-space}│
[        ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"It\'s
sunny\...\"[    ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰──────────────────────╯ [       
]{.Apple-converted-space}╰──────────────────────╯[           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Orbital animation [               
]{.Apple-converted-space}Different waveform (output) [       
]{.Apple-converted-space}│]{.s1}

[│ [                                  ]{.Apple-converted-space}Response
text shown[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                  ]{.Apple-converted-space}TAP
ANYWHERE to interrupt[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WAVEFORM RENDERING: [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• 12-16 bars[                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Height driven by audio amplitude[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Smooth interpolation (not jumpy)[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Different colors: listening (blue) vs
speaking (green)[              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}MICROPHONE BUTTON:[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• 60pt diameter minimum [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Prominent position (bottom right or
center) [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Glow effect when active [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Always accessible during navigation [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Animation Principles]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ANIMATION GUIDELINES [                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CORE PRINCIPLES FOR DRIVING CONTEXT:[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────────[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. SUBTLE over flashy (no distraction)[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. PURPOSEFUL (animation communicates
state)[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. SMOOTH (60fps, never janky)[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. QUICK (200-300ms for most transitions)
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TIMING CURVES: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Ease-out: 0.0, 0.0, 0.2, 1.0[ 
]{.Apple-converted-space}(elements appearing)[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Ease-in:[  ]{.Apple-converted-space}0.4,
0.0, 1.0, 1.0[  ]{.Apple-converted-space}(elements dismissing) [       
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Spring: [ 
]{.Apple-converted-space}damping 0.7, response 0.3 (interactive
feedback)[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SPECIFIC ANIMATIONS: [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather icon transitions:[               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ ─────────→
]{.s1}[⛅]{.s12}[ ─────────→ ]{.s1}[🌧️]{.s12}[[                         
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Crossfade: 400ms[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Icon morphs (Lottie or SF Symbols
animation)[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Background gradient shifts
simultaneously [                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Card appearance: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Fade in + scale from 0.95 to 1.0[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Duration: 250ms [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Stagger multiple cards by 50ms each [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Alert slide-in:[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Slide from top + fade [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Duration: 300ms [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Slight bounce at end (spring) [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Route line drawing:[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Animate stroke from start to end[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Duration: 800ms [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather colors fade in as line reaches
each segment [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Voice waveform:[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Continuous while active [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• 16ms frame updates (60fps)[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Bars interpolate smoothly between audio
samples [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WHAT TO AVOID: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✗ Parallax effects (disorienting while
driving) [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✗ Bouncy/playful animations (feels
unserious) [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✗ Long animations (\>500ms feels slow) [ 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✗ Anything that requires watching to
understand [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✗ Pulsing that could be mistaken for
emergency lights [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Accessibility & Safety]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ACCESSIBILITY FOR CARPLAY[               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}VISUAL: [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Minimum contrast ratio: 4.5:1 (WCAG AA)
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather colors chosen for colorblind
safety [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Icons always paired with text labels[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• No color-only information (shape +
color) [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TOUCH:[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• 60pt minimum touch targets (exceeds
Apple\'s 44pt) [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• 8pt minimum spacing between targets [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• No gestures required (all actions via
buttons)[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Critical actions at edges/corners
(easier to hit) [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}VOICE:[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• All screens fully navigable by voice[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Voice feedback for all actions[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Clear confirmation before destructive
actions [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Interrupt capability always available [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}COGNITIVE LOAD:[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Max 3 choices on any screen [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Progressive disclosure (details on
demand)[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Most important info in top-left
(scannable) [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• No time pressure on decisions [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SAFETY CONSIDERATIONS: [                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────── [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Car moving: Simplified UI, larger
targets, voice priority [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Car stopped: Full UI available, more
detail shown [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Night mode: Reduced brightness, higher
contrast [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Alerts: Audio + visual, never visual
only [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY DRIVER ATTENTION GUIDELINES:[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────────────[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Apple requires:[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tasks completable in \<2 seconds of
eyes-off-road[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• No video or rapidly changing content[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Audio feedback for actions when
possible[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Minimal required reading[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Screen Flow Diagram]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}USER FLOW[                               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[                          ]{.Apple-converted-space}┌──────────────┐[ 
                            ]{.Apple-converted-space}│]{.s1}

[│[                          ]{.Apple-converted-space}│[   
]{.Apple-converted-space}HOME[      ]{.Apple-converted-space}│[         
                    ]{.Apple-converted-space}│]{.s1}

[│[                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Weather +[  ]{.Apple-converted-space}│[       
                      ]{.Apple-converted-space}│]{.s1}

[│[                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Suggestions)│[                             
]{.Apple-converted-space}│]{.s1}

[│[                          ]{.Apple-converted-space}└──────┬───────┘[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                ]{.Apple-converted-space}│ [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [         
]{.Apple-converted-space}┌─────────────────────┼─────────────────────┐[ 
              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│[               
]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}▼ [                   
]{.Apple-converted-space}▼ [                   
]{.Apple-converted-space}▼[               
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}┌───────────────┐ [   
]{.Apple-converted-space}┌───────────────┐ [   
]{.Apple-converted-space}┌───────────────┐ [     
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}SEARCH [ 
  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}FAVORITES [  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}VOICE[     
]{.Apple-converted-space}│ [      ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [             
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│ [           
  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}COMMAND [    ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}└───────┬───────┘ [   
]{.Apple-converted-space}└───────┬───────┘ [   
]{.Apple-converted-space}└───────┬───────┘ [     
]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│[               
]{.Apple-converted-space}│]{.s1}

[│ [         
]{.Apple-converted-space}└─────────────────────┼─────────────────────┘[ 
              ]{.Apple-converted-space}│]{.s1}

[│ [                                ]{.Apple-converted-space}│ [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                ]{.Apple-converted-space}▼ [       
                              ]{.Apple-converted-space}│]{.s1}

[│[                   
]{.Apple-converted-space}┌────────────────────────┐[                   
      ]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}ROUTE PREVIEW [     
]{.Apple-converted-space}│[                         
]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Weather timeline + [ 
]{.Apple-converted-space}│[                         
]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Departure options) [ 
]{.Apple-converted-space}│[                         
]{.Apple-converted-space}│]{.s1}

[│[                   
]{.Apple-converted-space}└───────────┬────────────┘[                   
      ]{.Apple-converted-space}│]{.s1}

[│[                                ]{.Apple-converted-space}│ [         
                            ]{.Apple-converted-space}│]{.s1}

[│[             
]{.Apple-converted-space}┌─────────────────┼─────────────────┐ [       
            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}│
[                    ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}▼ [               
]{.Apple-converted-space}▼ [                ]{.Apple-converted-space}▼
[                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}┌─────────────┐ [ 
]{.Apple-converted-space}┌─────────────┐ [ 
]{.Apple-converted-space}┌─────────────┐ [             
]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}GO NOW [ 
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ WAIT/REMIND │
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}CANCEL[   
]{.Apple-converted-space}│ [             
]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}└──────┬──────┘ [ 
]{.Apple-converted-space}└──────┬──────┘ [ 
]{.Apple-converted-space}└─────────────┘ [             
]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ [                                       
]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}▼ [                                       
]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│[     
]{.Apple-converted-space}┌─────────────────────┐ [                     
      ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}REMINDER SET [   
  ]{.Apple-converted-space}│ → Push notification [       
]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}(Return to HOME)
[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}when time to
leave[        ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│[     
]{.Apple-converted-space}└─────────────────────┘ [                     
      ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}│ [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}▼ [                             
                            ]{.Apple-converted-space}│]{.s1}

[│ [ 
]{.Apple-converted-space}┌────────────────────────────────────────────────────┐[ 
            ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[                 
]{.Apple-converted-space}ACTIVE NAVIGATION[                 
]{.Apple-converted-space}│[             
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Turn-by-turn + ambient weather + voice
ready)[    ]{.Apple-converted-space}│[             
]{.Apple-converted-space}│]{.s1}

[│ [ 
]{.Apple-converted-space}└─────────────────────┬──────────────────────────────┘[ 
            ]{.Apple-converted-space}│]{.s1}

[│ [                        ]{.Apple-converted-space}│[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[       
]{.Apple-converted-space}┌────────────────┼────────────────┐[           
                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[               
]{.Apple-converted-space}│[                ]{.Apple-converted-space}│[ 
                          ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}▼[               
]{.Apple-converted-space}▼[                ]{.Apple-converted-space}▼[ 
                          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}┌─────────┐[   
]{.Apple-converted-space}┌────────────┐[   
]{.Apple-converted-space}┌─────────┐ [                     
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ WEATHER │[   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}VOICE[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}END[    ]{.Apple-converted-space}│ [           
          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ ALERT [  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}QUERY[   
]{.Apple-converted-space}│[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}NAV[    ]{.Apple-converted-space}│ [           
          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ (Modal) │[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}(Overlay) │[   
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
              ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}└────┬────┘[   
]{.Apple-converted-space}└──────┬─────┘[   
]{.Apple-converted-space}└────┬────┘ [                     
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[               
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
                          ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[               
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}▼ [ 
                          ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[               
]{.Apple-converted-space}│ [       
]{.Apple-converted-space}┌──────────┐[                       
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│[               
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}HOME[    ]{.Apple-converted-space}│[           
            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}└────────────────┴─────────┤[ 
]{.Apple-converted-space}(Trip [  ]{.Apple-converted-space}│[           
            ]{.Apple-converted-space}│]{.s1}

[│ [                                  ]{.Apple-converted-space}│
Summary) │[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                 
]{.Apple-converted-space}└──────────┘[                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Next Steps]{.s3}

[]{.s1}\

[**Next Steps**]{.s1}

[This gives you the complete UI pattern language. From here I
could:]{.s1}

1.  [**Create a Figma/design spec** - Detailed mockups for each screen
    state]{.s1}
2.  [**Write the SwiftUI component library** - Actual code for
    GlassCard, WeatherTimeline, etc.]{.s1}
3.  [**Create the CarPlay template configuration** - The CPTemplate
    structure that maps to these designs]{.s1}
4.  [**Design the iOS companion app** - What you see on phone when
    CarPlay is active]{.s1}

[Which direction would be most valuable?]{.s1}

[Design the iOS companion app . don\'t yet, just create the comprhensive
concept. also a ligt version, in case carplay is not activated yet.
(e.g. if i use a biek today or are not connect to my carplay yet).]{.s7}

[]{.s1}\

[**LiquidCrypto iOS Companion App: Comprehensive Concept**]{.s1}

[**Philosophy**]{.s1}

[***\"Your weather intelligence travels with you---whether you\'re
driving, biking, walking, or planning tomorrow\'s commute.\"***]{.s1}

[The iOS app is not a \"lite version\" of CarPlay. It\'s the **full
brain** that powers everything, with interfaces optimized for each
context. CarPlay is just one projection of this intelligence.]{.s1}

[]{.s1}\

[**The Three Modes**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}APP MODES[                               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}MODE 1:
STANDALONE[                                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}───────────────────── [                       
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}CarPlay not
connected. Full iOS experience. [                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Complete
weather route planning [                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
Multi-modal transport (car, bike, walk, transit)[           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Voice
interaction available [                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Widgets,
notifications, Apple Watch [                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Trip
history and patterns [                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}USE CASES:[ 
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Planning
tomorrow\'s commute from couch[                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Checking
if you should bike or drive today[                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Walking to
lunch---will it rain?[                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Weekend
trip planning [                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}MODE 2:
CARPLAY ACTIVE[                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}──────────────────────[                       
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Connected to
CarPlay. Phone becomes secondary display.[       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Detailed
information that doesn\'t fit on CarPlay[           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Passenger
controls (they can help navigate) [               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Settings
and preferences[                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Full
radar/map view [                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}USE CASES:[ 
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Passenger
checking detailed radar [                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Adjusting
route preferences mid-drive [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Viewing
full weather forecast for destination [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Quick
glance at phone mount for more context[               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}MODE 3:
BACKGROUND[                                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}────────────────────[                         
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}App not
open, but intelligence running. [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Proactive
notifications [                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Widget
updates[                                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}•
Location-aware suggestions[                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Calendar
integration[                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Siri
shortcuts[                                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}USE CASES:[ 
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• \"Rain
starting in 20 min---leave now for dry commute\" [       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• Lock
screen widget showing commute weather[                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}• \"Hey
Siri, should I bike to work today?\"[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Mode 1: Standalone App (Full Experience)**]{.s1}

[**Information Architecture**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}APP STRUCTURE[                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TAB BAR NAVIGATION [                     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌─────────┐[ 
]{.Apple-converted-space}┌─────────┐[ 
]{.Apple-converted-space}┌─────────┐[ 
]{.Apple-converted-space}┌─────────┐[ 
]{.Apple-converted-space}┌─────────┐[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[🏠]{.s12}[[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[🗺️]{.s12}[[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[📅]{.s12}[[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[📊]{.s12}[[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[⚙️]{.s12}[[   
]{.Apple-converted-space}│[      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}Today[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Plan [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Week [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Insights│[ 
]{.Apple-converted-space}│ Settings│[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Trip [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Ahead[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└─────────┘[ 
]{.Apple-converted-space}└─────────┘[ 
]{.Apple-converted-space}└─────────┘[ 
]{.Apple-converted-space}└─────────┘[ 
]{.Apple-converted-space}└─────────┘[     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TODAY: Current conditions, smart
suggestions, quick actions [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PLAN TRIP: Route weather planning,
departure optimizer[                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEEK AHEAD: 7-day commute forecast,
pattern insights[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INSIGHTS: Your travel patterns, weather
history, preferences[          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SETTINGS: Accounts, notifications,
transport modes, privacy [          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Tab 1: Today (Home)**]{.s1}

[The daily dashboard---what you need right now.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}TODAY TAB[                               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ ◀ 9:41[                       
]{.Apple-converted-space}▐▐▐▐▐ ◀┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}Good morning,
Mario[                  ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}58°F[                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Clear • Feels like 55°[       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}San Francisco [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}┌───┬───┬───┬───┬───┬───┐[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│NOW│10A│11A│12P│ 1P│ 2P│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}[☀️]{.s12}[ │]{.s1}[☀️]{.s12}[
│]{.s1}[⛅]{.s12}[│]{.s1}[⛅]{.s12}[│]{.s1}[🌧️]{.s12}[│]{.s1}[🌧️]{.s12}[│[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│58°│62°│64°│63°│61°│60°│[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└───┴───┴───┴───┴───┴───┘[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}YOUR
COMMUTES[                        ]{.Apple-converted-space}┃ [           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🏢]{.s12}[[  ]{.Apple-converted-space}WORK[                     
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ → ]{.s1}[🌧️]{.s12}[ [  ]{.Apple-converted-space}28 min
by car [        ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[⚠️]{.s12}[ Rain starts at 12:30 PM[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Leave by 11:45 to stay dry[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
┌──────────┐[  ]{.Apple-converted-space}┌──────────┐ [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ │
]{.s1}[🚗]{.s12}[ DRIVE │[  ]{.Apple-converted-space}│ ]{.s1}[🚴]{.s12}[
BIKE[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}28 min[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}45 min[ 
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ → ]{.s1}[🌧️]{.s12}[[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ DRY! │ [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
└──────────┘[  ]{.Apple-converted-space}└──────────┘ [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🏠]{.s12}[[  ]{.Apple-converted-space}HOME[                     
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Current
location • No trip[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}SMART
SUGGESTION [                    ]{.Apple-converted-space}┃ [           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚴]{.s12}[ BIKE TODAY?[                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Morning is
perfect for cycling. │[  ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ If you
leave by 8:30, you\'ll[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ beat the
afternoon rain both[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ways. [   
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[       
]{.Apple-converted-space}\[ PLAN BIKE ROUTE \][     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}]{.s1}[🏠]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[🗺️]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📅]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📊]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[⚙️]{.s12}[[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ Today [  ]{.Apple-converted-space}Plan[ 
  ]{.Apple-converted-space}Week [  ]{.Apple-converted-space}Insights[ 
]{.Apple-converted-space}More ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}KEY FEATURES:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Multi-modal comparison (car vs bike vs
walk)[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Proactive suggestion based on weather +
patterns[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Hourly forecast with weather state
transitions[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Quick action buttons on each commute
card [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Tab 2: Plan Trip**]{.s1}

[Deep route planning with weather intelligence.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}PLAN TRIP TAB[                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ ◀ 9:41[                       
]{.Apple-converted-space}▐▐▐▐▐ ◀┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}Plan Your
Trip [                      ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[📍]{.s12}[ FROM [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Current
Location[                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}├─────────────────────────────────┤[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🎯]{.s12}[ TO [                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Search
destination\... [          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🕐]{.s12}[ WHEN [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ○ Leave now
[                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ○ Leave
at\... [                  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ● Arrive
by\...[    ]{.Apple-converted-space}\[10:00 AM ▼\][ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ○ Best time
(let AI decide) [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚗]{.s12}[ HOW[                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ┌─────┐
┌─────┐ ┌─────┐ ┌─────┐│[  ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ │
]{.s1}[🚗]{.s12}[[  ]{.Apple-converted-space}│ │ ]{.s1}[🚴]{.s12}[[ 
]{.Apple-converted-space}│ │ ]{.s1}[🚶]{.s12}[[ 
]{.Apple-converted-space}│ │ ]{.s1}[🚇]{.s12}[[ 
]{.Apple-converted-space}││[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ │Drive│
│Bike │ │Walk │ │Trans││[  ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ │ ● [ 
]{.Apple-converted-space}│ │ [    ]{.Apple-converted-space}│ │ [   
]{.Apple-converted-space}│ │ [    ]{.Apple-converted-space}││[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ └─────┘
└─────┘ └─────┘ └─────┘│[  ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}RECENT
DESTINATIONS[                  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🏢]{.s12}[ Work[              ]{.Apple-converted-space}28 min
]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[│[  ]{.Apple-converted-space}┃ [     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}├─────────────────────────────────┤[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🏋️]{.s12}[ Gym [              ]{.Apple-converted-space}15 min
]{.s1}[☀️]{.s12}[ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}├─────────────────────────────────┤[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🛒]{.s12}[ Whole Foods [      ]{.Apple-converted-space}8 min[ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}├─────────────────────────────────┤[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[✈️]{.s12}[ SFO Airport [      ]{.Apple-converted-space}35 min
]{.s1}[⛅]{.s12}[ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}]{.s1}[🏠]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[🗺️]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📅]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📊]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[⚙️]{.s12}[[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Tab 2: Plan Trip** ]{.s1}[**→**]{.s17}[ **Route Results**]{.s1}

[After selecting destination, the magic happens.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ROUTE RESULTS[                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ ◀ Back[                       
]{.Apple-converted-space}▐▐▐▐▐ ◀┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}To: Work [   
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}Arrive by:
10:00 AM[                  ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌───────────────────────────────────┐┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}\[MAP WITH ROUTE\][         
]{.Apple-converted-space}│┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Route colored by weather:[     
]{.Apple-converted-space}│┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}]{.s1}[🟢]{.s12}[ Clear[ 
]{.Apple-converted-space}]{.s1}[🟡]{.s12}[ Light[ 
]{.Apple-converted-space}]{.s1}[🟠]{.s12}[ Moderate │┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Weather markers at transition[ 
]{.Apple-converted-space}│┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}points along route [           
]{.Apple-converted-space}│┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                        ]{.Apple-converted-space}│┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└───────────────────────────────────┘┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}DEPARTURE
OPTIONS[                    ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[★]{.s15}[ RECOMMENDED [                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Leave at
9:00 AM[                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Arrive 9:45
AM (15 min early) [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ Clear the entire route[       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚗]{.s12}[ 45 min • 32 miles • Light traffic│ ┃ [               
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ WEATHER
TIMELINE[                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[━━━━━━━━━━━━━━━━━━━━━━━━━━━━]{.s1}[☀️]{.s12}[ │[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ 9:00[     
                ]{.Apple-converted-space}9:45[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}\[ SET REMINDER \][ 
]{.Apple-converted-space}\[ GO NOW → \] │[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ○ Leave at
9:30 AM[              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[⚠️]{.s12}[ Rain on I-280 (9:45-10:00) [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚗]{.s12}[ 50 min • Moderate traffic[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[━━━━━━━━━━]{.s1}[🌧️]{.s12}[━━━━━]{.s1}[⛅]{.s12}[ [   
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [         
                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ 9:30 [     
    ]{.Apple-converted-space}9:45[      ]{.Apple-converted-space}10:00[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ ○ Leave at
10:15 AM [            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[⛅]{.s12}[ After rain, roads drying [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[⚠️]{.s12}[ Arrive 11:00 (late)[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚗]{.s12}[ 45 min • Light traffic [     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}OTHER
TRANSPORT MODES[                ]{.Apple-converted-space}┃ [           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}┌─────────┐
┌─────────┐ ┌─────────┐ ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚴]{.s12}[ BIKE │ │ ]{.s1}[🚇]{.s12}[ BART │ │ ]{.s1}[🚶]{.s12}[
WALK │ ┃ [                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ 55 min[ 
]{.Apple-converted-space}│ │ 40 min[  ]{.Apple-converted-space}│ │ 2h
10m[  ]{.Apple-converted-space}│ ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ Clear│ │ ]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[ [ 
]{.Apple-converted-space}│ │ ]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[ [ 
]{.Apple-converted-space}│ ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}└─────────┘
└─────────┘ └─────────┘ ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}]{.s1}[🏠]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[🗺️]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📅]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📊]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[⚙️]{.s12}[[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INTERACTIONS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tap any option to expand details[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tap map to see full-screen route with
weather overlay [              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"SET REMINDER\" creates notification
for optimal departure [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"GO NOW\" opens navigation (Apple
Maps/Google Maps/in-app) [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Transport mode chips scroll
horizontally[                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Tab 3: Week Ahead**]{.s1}

[Plan your entire week\'s commutes.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}WEEK AHEAD TAB [                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ ◀ 9:41[                       
]{.Apple-converted-space}▐▐▐▐▐ ◀┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}Your Week[   
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}COMMUTE OUTLOOK [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}MON[  ]{.Apple-converted-space}TUE[ 
]{.Apple-converted-space}WED[  ]{.Apple-converted-space}THU[ 
]{.Apple-converted-space}FRI[  ]{.Apple-converted-space}SAT[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}─────────────────────────────[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}●[    ]{.Apple-converted-space}●[   
]{.Apple-converted-space}]{.s1}[◐]{.s15}[[   
]{.Apple-converted-space}●[    ]{.Apple-converted-space}●[   
]{.Apple-converted-space}○ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}● Great[ 
]{.Apple-converted-space}]{.s1}[◐]{.s15}[ Okay[ 
]{.Apple-converted-space}○ No commute │[  ]{.Apple-converted-space}┃ [ 
                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}TODAY -
MONDAY [                      ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ Perfect commute day [         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ AM: Clear,
58°F [                ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ PM: Rain
arrives \~5pm [          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[💡]{.s12}[ Leave work by 4:30 to beat [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}the rain home[               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}TUESDAY[     
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ Clear all day [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Great day
to bike\![              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}WEDNESDAY[   
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🌧️]{.s12}[ Rainy day [                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ AM: Light
rain 7-9am[            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ PM: Heavy
rain 3-7pm[            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[💡]{.s12}[ Consider working from home,[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}or leave early (before 3pm)[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[📅]{.s12}[ You have: Team standup 10am[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}(in-person required) [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}\...
continues scrolling \...[          ]{.Apple-converted-space}┃ [         
                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}]{.s1}[🏠]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[🗺️]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📅]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📊]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[⚙️]{.s12}[[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}KEY FEATURES:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Calendar integration shows meetings that
require in-person[          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• AI suggestions for WFH days based on
weather[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Week-at-a-glance commute quality
indicators [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tap any day to see detailed breakdown [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Tab 4: Insights**]{.s1}

[Your travel patterns and preferences.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}INSIGHTS TAB [                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ ◀ 9:41[                       
]{.Apple-converted-space}▐▐▐▐▐ ◀┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}Your Travel
Insights [                ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}January 2026
[                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ THIS
MONTH[                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}23[          ]{.Apple-converted-space}4 [     
    ]{.Apple-converted-space}156 [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}trips[    ]{.Apple-converted-space}rain trips
[    ]{.Apple-converted-space}miles[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}12[          ]{.Apple-converted-space}85%[     
    ]{.Apple-converted-space}3[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ bike days[ 
]{.Apple-converted-space}on-time[    ]{.Apple-converted-space}alerts[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
]{.Apple-converted-space}departures[  ]{.Apple-converted-space}acted on
│[  ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}YOUR
PATTERNS[                        ]{.Apple-converted-space}┃ [           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚗]{.s12}[ Typical commute[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Leave: 8:15 AM [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Return: 5:45 PM[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚴]{.s12}[ You bike when: [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• Temp \> 55°F[               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• No rain in forecast[       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}• Tuesday or Thursday[       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🌧️]{.s12}[ Rain tolerance: LOW[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}You typically avoid rain [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}WEATHER
IMPACT [                      ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Time saved by weather alerts:[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[       
]{.Apple-converted-space}2 hrs 15 min [           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[       
]{.Apple-converted-space}this month [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌────────────────────────────┐ │[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ Jan 12: Left 20 min early[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ avoided 45 min delay from[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ accident + rain[           
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└────────────────────────────┘ │[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┠───────────────────────────────────────┨
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}]{.s1}[🏠]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[🗺️]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📅]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[📊]{.s12}[ [     
]{.Apple-converted-space}]{.s1}[⚙️]{.s12}[[  ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: [                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Show value of the app (time saved, rain
avoided)[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Surface learned patterns (builds trust)
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Gamification elements (bike days
streak)[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Privacy transparency (this is what we
know) [                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Multi-Modal Transport Deep Dive**]{.s1}

[The app isn\'t just for drivers. This is key differentiation.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}TRANSPORT MODE INTELLIGENCE[             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🚗]{.s12}[ DRIVING [               
                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather concerns:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Rain → reduced visibility, longer
braking [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Ice/snow → dangerous, suggest delay [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Fog → suggest alternate time[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Sun glare → warn about specific
times/directions[                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Unique features: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• CarPlay integration[                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Traffic + weather combined routing[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Parking conditions at destination [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌───────────────────────────────────────────────────────────────────┐
│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🚗]{.s12}[ DRIVE TO WORK [             
                                  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ → ]{.s1}[🌧️]{.s12}[[ 
]{.Apple-converted-space}Rain starts mid-route [                       
          ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ 8:00 AM │
45 min │ ]{.s1}[☀️]{.s12}[ entire route[             
]{.Apple-converted-space}]{.s1}[★]{.s15}[ BEST[   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}├────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ 8:30 AM │
52 min │ ]{.s1}[🌧️]{.s12}[ rain for last 15 min[               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}├────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ 9:00 AM │
48 min │ ]{.s1}[🌧️]{.s12}[ rain entire route [                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[ 
]{.Apple-converted-space}└───────────────────────────────────────────────────────────────────┘
│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🚴]{.s12}[ CYCLING [               
                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather concerns:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Rain → get wet, dangerous roads,
visibility [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Wind → headwind adds significant time [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Temperature → comfort and safety[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• UV → sunburn on long rides[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Unique features: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Bike-specific routes (bike lanes,
trails) [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Elevation + weather combined effort [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Should I bike today?\" decision
helper[                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Gear recommendations (jacket? lights?)[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌───────────────────────────────────────────────────────────────────┐
│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🚴]{.s12}[ BIKE TO WORK[               
                                  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}CONDITIONS[ 
                                                     
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🌡️]{.s12}[ 58°F (feels 55°) [    ]{.Apple-converted-space}Perfect
cycling weather[            ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[💨]{.s12}[ 8 mph headwind [      ]{.Apple-converted-space}Adds
\~5 min[                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🌧️]{.s12}[ Rain at 12pm [        ]{.Apple-converted-space}Return
trip affected [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ UV Index 6 [         
]{.Apple-converted-space}Sunscreen recommended[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}GEAR
SUGGESTION [                                                 
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🧥]{.s12}[ Light jacket (morning cool) [                         
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🌂]{.s12}[ Pack rain jacket (afternoon rain) [                   
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[💡]{.s12}[ Lights not needed (daylight both ways)[               
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}VERDICT [   
                                                     
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ ✓ BIKE IN
THE MORNING[                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[⚠️]{.s12}[ Consider driving home (rain at 5pm) [                 
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Or: Leave
work by 4pm to beat the rain [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[ 
]{.Apple-converted-space}└───────────────────────────────────────────────────────────────────┘
│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🚶]{.s12}[ WALKING [               
                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather concerns:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Rain → umbrella needed, puddles [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Heat → hydration, shade route [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Cold → exposure time matters more [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• UV → prolonged sun exposure [           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Unique features: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Pedestrian routes (shortcuts, covered
paths)[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Shade-optimized routing on hot days [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Walk or rideshare?\" decision helper[ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌───────────────────────────────────────────────────────────────────┐
│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🚶]{.s12}[ WALK TO LUNCH [             
                                  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}Chez Panisse
• 0.8 miles • 18 min[                               
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[ Sunny, 72°F[                                         
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[⚠️]{.s12}[ High UV (11-1pm)[                                     
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[💡]{.s12}[ Shaded route available[                               
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}+3 min but 80% tree cover[                     
        ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
                                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ \[ STANDARD
ROUTE \][  ]{.Apple-converted-space}\[ SHADED ROUTE \][                 
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[ 
]{.Apple-converted-space}└───────────────────────────────────────────────────────────────────┘
│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🚇]{.s12}[ TRANSIT [               
                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather concerns:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Walk to/from station exposed[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Delays from weather events[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Underground vs. surface lines [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Unique features: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather for walking segments only [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Transit delay predictions [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Is it worth driving today?\"
comparison [                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌───────────────────────────────────────────────────────────────────┐
│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🚇]{.s12}[ BART TO WORK[               
                                  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}SEGMENTS[   
                                                     
]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╭────────────────────────────────────────────────────────────╮
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🚶]{.s12}[ Walk to 16th St Station[    ]{.Apple-converted-space}8
min[    ]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ Clear[           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🚇]{.s12}[ BART to Montgomery [       
]{.Apple-converted-space}22 min [ 
]{.Apple-converted-space}]{.s1}[🛡️]{.s12}[ Underground[     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
]{.s1}[🚶]{.s12}[ Walk to office [            ]{.Apple-converted-space}5
min[    ]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ RAIN [           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}╰────────────────────────────────────────────────────────────╯
[  ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[💡]{.s12}[ Bring umbrella for the last
5-minute walk [                    ]{.Apple-converted-space}│ │]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                            ]{.Apple-converted-space}│ │]{.s1}

[│[ 
]{.Apple-converted-space}└───────────────────────────────────────────────────────────────────┘
│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Mode 2: CarPlay Active (Companion Mode)**]{.s1}

[When connected to CarPlay, the phone becomes a secondary display.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY COMPANION MODE [                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}The phone shows COMPLEMENTARY information,
not duplicate. [            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Driver focuses on CarPlay. Passenger can
use phone for detail.[        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[🚗]{.s12}[ CARPLAY CONNECTED[           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Navigation
active on car screen │[  ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}TRIP DETAILS
[                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}To: San Francisco[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}ETA: 10:15 AM (32 min) [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}WEATHER ALONG ROUTE[           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}NOW ━━━━━━━━━━━━━━━━━━━ ARRIVE │[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58°[ 
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ 54°[ 
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ 56°[ 
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ 55° │[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[📍]{.s12}[ Rain zone in 12 miles [     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}Duration: \~15 minutes [     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}Intensity: Moderate [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}LIVE RADAR [ 
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}\[FULL RADAR MAP VIEW\][       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Shows precipitation[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}movement, your route,[       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}and predicted intersection [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}\[Play animation button\][     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}DESTINATION
WEATHER[                  ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ San
Francisco [                  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[⛅]{.s12}[ 55°F[  ]{.Apple-converted-space}Partly Cloudy[       
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ 10A[ 
]{.Apple-converted-space}11A[  ]{.Apple-converted-space}12P[ 
]{.Apple-converted-space}1P [  ]{.Apple-converted-space}2P [ 
]{.Apple-converted-space}3P [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│
]{.s1}[⛅]{.s12}[ [  ]{.Apple-converted-space}]{.s1}[⛅]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ [ 
]{.Apple-converted-space}]{.s1}[⛅]{.s12}[[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ 55°[ 
]{.Apple-converted-space}58°[  ]{.Apple-converted-space}62°[ 
]{.Apple-converted-space}64°[  ]{.Apple-converted-space}63°[ 
]{.Apple-converted-space}61°[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ Rain
chance: 20% after 4pm [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}┌─────────────────────────────────┐[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}\[ END NAVIGATION \] [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}└─────────────────────────────────┘[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}COMPANION MODE FEATURES: [               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Full radar view (too detailed for
CarPlay)[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Extended destination forecast[         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Trip statistics and progress[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Settings access (passenger can adjust)[ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"End Navigation\" safely stops trip[   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WHAT\'S NOT SHOWN:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Turn-by-turn (that\'s on CarPlay)[     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Basic ETA (that\'s on CarPlay) [       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Voice controls (use car\'s mic)[       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Mode 3: Background Intelligence**]{.s1}

[The app works even when closed.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}BACKGROUND MODE[                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PROACTIVE NOTIFICATIONS[                 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────────────────╮[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
┌──────────────────────────────────────────────────────────────┐ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🌤️]{.s12}[ LiquidCrypto [     
                        ]{.Apple-converted-space}8:15 AM[       
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Rain starting on your commute route at
9:15. [                ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Leave in the next 20 minutes to stay
dry.[                    ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ \[ Start Navigation \][ 
]{.Apple-converted-space}\[ Remind in 10 min \][ 
]{.Apple-converted-space}\[ Dismiss \][      ]{.Apple-converted-space}│
│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
└──────────────────────────────────────────────────────────────┘ │[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────────────────╯[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────────────────╮[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
┌──────────────────────────────────────────────────────────────┐ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🌤️]{.s12}[ LiquidCrypto [     
                        ]{.Apple-converted-space}5:00 PM[       
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Perfect evening to bike home! Clear
skies and 68°F.[          ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Traffic is heavy on 101 anyway.[     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ \[ Plan Bike Route \][ 
]{.Apple-converted-space}\[ Dismiss \] [                           
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
└──────────────────────────────────────────────────────────────┘ │[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────────────────╯[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╭──────────────────────────────────────────────────────────────────╮[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
┌──────────────────────────────────────────────────────────────┐ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🌤️]{.s12}[ LiquidCrypto [     
                        ]{.Apple-converted-space}9:00 PM Sun[   
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Tomorrow\'s commute: Rain all morning
]{.s1}[☔]{.s12}[ [                      ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Consider working from home or leaving
early. [                ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                        ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ \[ See Full Forecast \][ 
]{.Apple-converted-space}\[ Dismiss \] [                         
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
└──────────────────────────────────────────────────────────────┘ │[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}╰──────────────────────────────────────────────────────────────────╯[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NOTIFICATION TYPES:[                     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. DEPARTURE ALERTS [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Leave now to beat the rain\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Traffic + rain combo---wait 20 min\"
[                                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. OPPORTUNITY ALERTS [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Great day to bike!\" [               
                              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Window of clear weather---go now\" [ 
                                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. PLANNING ALERTS[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Tomorrow looks rough---plan ahead\"[ 
                                ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Weekend trip weather looking good\"[ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. CALENDAR-AWARE [                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Your 10am meeting + rain = leave by
9\"[                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}\"Flight at 3pm---suggest leaving 11am
(weather delays)\"[              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NOTIFICATION INTELLIGENCE: [             
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Learns your patterns (don\'t notify for
trips you don\'t take)[        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Respects quiet hours[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Bundles related alerts[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Urgent weather: always notify [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Suggestions: based on settings[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Widgets**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}WIDGETS[                                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SMALL WIDGET (2×2)[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭───────────────────╮ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🌤️]{.s12}[ Commute[       
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🏢]{.s12}[ Work[ 
]{.Apple-converted-space}28 min [  ]{.Apple-converted-space}│ [         
                                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[☀️]{.s12}[ → ]{.s1}[🌧️]{.s12}[
Rain 12pm │ [                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰───────────────────╯ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}MEDIUM WIDGET (4×2) [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭───────────────────────────────────────╮
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🌤️]{.s12}[ Today\'s Commutes [   
              ]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                     
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🏢]{.s12}[ Work[     
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ → ]{.s1}[🌧️]{.s12}[ [   
]{.Apple-converted-space}28 min [      ]{.Apple-converted-space}│ [     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[             
]{.Apple-converted-space}Rain at 12pm [           
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                     
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🏠]{.s12}[ Home[     
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[ → ]{.s1}[⛅]{.s12}[[     
]{.Apple-converted-space}35 min [      ]{.Apple-converted-space}│ [     
                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[             
]{.Apple-converted-space}Clearing by 6pm[         
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰───────────────────────────────────────╯
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LARGE WIDGET (4×4)[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭───────────────────────────────────────╮
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[🌤️]{.s12}[ Travel Weather [     
              ]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                     
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ NOW [                                 
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[☀️]{.s12}[ 58°F Clear [         
              ]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                     
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ COMMUTES[                             
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ┌─────────────────────────────────┐ [ 
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🏢]{.s12}[ Work[   
]{.Apple-converted-space}28m [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[[ 
]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[[     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Leave by 11:45 to stay dry [   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ └─────────────────────────────────┘ [ 
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ┌─────────────────────────────────┐ [ 
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🏠]{.s12}[ Home[   
]{.Apple-converted-space}35m [ 
]{.Apple-converted-space}]{.s1}[🌧️]{.s12}[→]{.s1}[⛅]{.s12}[[         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Rain clearing by 6pm [         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ └─────────────────────────────────┘ [ 
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                     
]{.Apple-converted-space}│ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[💡]{.s12}[ Consider biking
tomorrow---clear! [  ]{.Apple-converted-space}│ [                       
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰───────────────────────────────────────╯
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LOCK SCREEN WIDGET[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╭─────────────────────────────╮ [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[ Rain
12pm • Leave 11:45│ [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}╰─────────────────────────────╯ [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WIDGET FEATURES: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tap anywhere to open app[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Deep link to specific commute [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Updates every 15 minutes[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Shows most relevant commute based on
time [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Alerts surface in widget before
notification[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Apple Watch**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}APPLE WATCH[                             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}COMPLICATION (Small) [         
]{.Apple-converted-space}COMPLICATION (Large) [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌─────────┐ [                 
]{.Apple-converted-space}┌───────────────────┐ [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[ [ 
]{.Apple-converted-space}│ [                  ]{.Apple-converted-space}│
]{.s1}[☀️]{.s12}[→]{.s1}[🌧️]{.s12}[ Rain 12pm [ 
]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}12pm [ 
]{.Apple-converted-space}│ [                  ]{.Apple-converted-space}│
Leave by 11:45 [  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└─────────┘ [                 
]{.Apple-converted-space}└───────────────────┘ [                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WATCH APP - GLANCE[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌───────────────────┐ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ 58°F [       
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[🏢]{.s12}[ Work [       
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}28 min[     
    ]{.Apple-converted-space}│ [                                       
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[☀️]{.s12}[ → ]{.s1}[🌧️]{.s12}[[         
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}]{.s1}[⚠️]{.s12}[ Rain at 12 [ 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└───────────────────┘ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WATCH APP - DETAIL[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┌───────────────────┐ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ To: Work[         
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ┌───────────────┐ │ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🚗]{.s12}[ 28 min [   
]{.Apple-converted-space}│ │ [                                         
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[☀️]{.s12}[ →
]{.s1}[🌧️]{.s12}[[        ]{.Apple-converted-space}│ │ [               
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ └───────────────┘ │ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ┌───────────────┐ │ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🚴]{.s12}[ 45 min [   
]{.Apple-converted-space}│ │ [                                         
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[☀️]{.s12}[ Clear! [   
]{.Apple-converted-space}│ │ [                                         
      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ └───────────────┘ │ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ \[ Start Nav \][   
]{.Apple-converted-space}│ [                                           
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└───────────────────┘ [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}HAPTIC ALERTS:[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Gentle tap: Weather change on commute [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Prominent tap: Leave now for dry
commute[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Warning tap: Severe weather alert [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[**Siri Integration**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}SIRI SHORTCUTS [                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}BUILT-IN PHRASES:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Hey Siri, what\'s my commute
weather?\"[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}→ \"Your drive to work is 28 minutes.
It\'s clear now, but rain[        ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}starts around noon. I\'d suggest
leaving before 11:45.\" [            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Hey Siri, should I bike today?\"[       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}→ \"Great day to bike! Clear skies until
5pm, 62 degrees. [            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}You\'ll beat the evening rain both
ways.\" [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Hey Siri, when should I leave for
work?\" [                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}→ \"For clear weather the whole way, leave
by 8:30. [                  ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Rain moves in around 9:15. Want me to
set a reminder?\" [            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Hey Siri, what\'s the weather for my
drive to Mom\'s?\" [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}→ \"The drive to your mom\'s is 45
minutes. Partly cloudy[              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}the whole way, temps in the mid-60s.
Looks like a nice drive.\"[    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CUSTOM SHORTCUTS:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Commute check\" → Morning briefing[   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Bike or drive?\" → Quick decision
helper[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Weather route to \[place\]\" → Full
route weather [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Set commute reminder\" → Alert for
optimal departure[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PROACTIVE SIRI SUGGESTIONS: [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}At 8am on workdays: [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌────────────────────────────────────────────────────────────────┐[ 
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ]{.s1}[💡]{.s12}[ Siri Suggestion [     
                                      ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Rain expected during your commute. [   
                        ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ \[ Check Commute Weather \][           
                          ]{.Apple-converted-space}│[   
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└────────────────────────────────────────────────────────────────┘[ 
  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Voice Interface (In-App)**]{.s1}

[Full conversational AI, not just shortcuts.]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}IN-APP VOICE INTERFACE [                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[     
]{.Apple-converted-space}\[Previous context/map\] [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🧑]{.s12}[ \"What about Thursday?\" [   
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Thursday looks great for [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}your commute. Clear all [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}day, highs around 70. [     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}Perfect biking weather[     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}if you\'re up for it.\" [     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🧑]{.s12}[ \"Yeah, I\'ll bike
Thursday.[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [   
                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}Remind me Wednesday night.\" │[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Got it! I\'ll remind you[ 
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}Wednesday at 9pm to prep[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}your bike for Thursday.\"[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╭─────────────────────────────────╮[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}▁ ▃ ▅ ▇ ▅ ▃ ▁ ▃ [         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}]{.s1}[🎙️]{.s12}[ [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│[       
]{.Apple-converted-space}Listening\... [           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[  ]{.Apple-converted-space}│ [         
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[ 
]{.Apple-converted-space}╰─────────────────────────────────╯[ 
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[ Type
instead \][              ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}KEY FEATURES:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Continuous conversation (remembers
context) [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Can reference previous queries[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Sets reminders, plans trips via voice [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Works hands-free with wake word [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Fall back to typing if preferred[       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Design System (iOS)**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}iOS DESIGN TOKENS[                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}COLORS (Following iOS conventions + Liquid
Glass) [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Light Mode[                       
]{.Apple-converted-space}Dark Mode [                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                       
]{.Apple-converted-space}───────── [                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Background: #FFFFFF [             
]{.Apple-converted-space}Background: #000000 [               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Surface:[   
]{.Apple-converted-space}#F2F2F7 [             
]{.Apple-converted-space}Surface:[    ]{.Apple-converted-space}#1C1C1E
[                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Elevated: [ 
]{.Apple-converted-space}#FFFFFF [             
]{.Apple-converted-space}Elevated: [  ]{.Apple-converted-space}#2C2C2E
[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Glass Effect (iOS)[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────── [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.regularMaterial (system) [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.thinMaterial (lighter) [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.ultraThinMaterial (most transparent) [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather Colors (Same as CarPlay for
consistency)[                      ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────
[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Clear: [     
]{.Apple-converted-space}#3B82F6 (Blue) [                               
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Cloudy:[     
]{.Apple-converted-space}#94A3B8 (Slate)[                               
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Rain:[       
]{.Apple-converted-space}#6366F1 (Indigo) [                             
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Heavy: [     
]{.Apple-converted-space}#7C3AED (Violet) [                             
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Snow:[       
]{.Apple-converted-space}#E2E8F0 (Light gray) [                         
          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TYPOGRAPHY [                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}iOS system fonts (SF Pro) with Dynamic
Type support [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.largeTitle[   
]{.Apple-converted-space}34pt [  ]{.Apple-converted-space}Bold[     
]{.Apple-converted-space}Screen titles[                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.title1[       
]{.Apple-converted-space}28pt [  ]{.Apple-converted-space}Bold[     
]{.Apple-converted-space}Section headers[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.title2[       
]{.Apple-converted-space}22pt [  ]{.Apple-converted-space}Bold[     
]{.Apple-converted-space}Card titles[                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.title3[       
]{.Apple-converted-space}20pt [  ]{.Apple-converted-space}Semibold[ 
]{.Apple-converted-space}Subsection headers [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.headline[     
]{.Apple-converted-space}17pt [  ]{.Apple-converted-space}Semibold[ 
]{.Apple-converted-space}Emphasized body[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.body[         
]{.Apple-converted-space}17pt [  ]{.Apple-converted-space}Regular [ 
]{.Apple-converted-space}Main content [                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.callout [     
]{.Apple-converted-space}16pt [  ]{.Apple-converted-space}Regular [ 
]{.Apple-converted-space}Secondary content[                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.subheadline [ 
]{.Apple-converted-space}15pt [  ]{.Apple-converted-space}Regular [ 
]{.Apple-converted-space}Supporting text[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.footnote[     
]{.Apple-converted-space}13pt [  ]{.Apple-converted-space}Regular [ 
]{.Apple-converted-space}Captions, timestamps [               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.caption1[     
]{.Apple-converted-space}12pt [  ]{.Apple-converted-space}Regular [ 
]{.Apple-converted-space}Labels [                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}.caption2[     
]{.Apple-converted-space}11pt [  ]{.Apple-converted-space}Regular [ 
]{.Apple-converted-space}Fine print [                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SPACING[                                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4pt[  ]{.Apple-converted-space}- Tight
(related elements) [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}8pt[  ]{.Apple-converted-space}- Compact[ 
                                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}12pt - Standard [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}16pt - Comfortable (card padding) [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}20pt - Section gap[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}32pt - Major section gap[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CORNERS[                                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Small: 8pt (buttons, badges)[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Medium: 12pt (cards, inputs)[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Large: 16pt (modals, large cards) [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Continuous: Use .continuous corner style[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SHADOWS[                                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Subtle: 0 2px 8px rgba(0,0,0,0.08) [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Medium: 0 4px 16px rgba(0,0,0,0.12)[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Strong: 0 8px 32px rgba(0,0,0,0.16)[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Interaction Patterns**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}iOS INTERACTION PATTERNS [               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}GESTURES [                               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────[                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Pull to refresh: Update weather data[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Swipe left on commute: Quick actions
(delete, edit) [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Long press on card: Context menu[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Pinch on map: Zoom radar/route[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Swipe between departure options [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}HAPTICS[                                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────── [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Selection: Light impact on option
select[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Success: Success feedback on action
complete[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Warning: Warning feedback on alert[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Error: Error feedback on failure[       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TRANSITIONS[                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────── [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Standard push: List → Detail[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Modal: Settings, voice interface[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Matched geometry: Weather icon
transitions[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Hero animation: Map expansion [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LOADING STATES [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Skeleton screens (not spinners) [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Shimmer effect on loading cards [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Progressive loading (show what\'s ready)
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Optimistic updates (assume success) [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ERROR STATES [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────[                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Inline errors (don\'t block UI)[       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Retry buttons on failures [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Cached data with \"last updated\"
timestamp [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Graceful degradation (show what we can)
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Onboarding Flow**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ONBOARDING [                             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 1: WELCOME [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[         
]{.Apple-converted-space}\[Animated weather[           
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [          ]{.Apple-converted-space}+
route illustration\] [      ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}Weather
Intelligence[                ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}for Every
Journey [                  ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}Know what
weather you\'ll drive, [    ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}bike, or
walk through---before[        ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}you leave.[ 
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[ Get
Started \][                ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 2: LOCATION PERMISSION [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[          ]{.Apple-converted-space}\[Map
illustration\] [          ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[📍]{.s12}[ Location Access[             
    ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}We need your
location to: [          ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}• Show
weather along your routes[    ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}• Learn your
commute patterns [      ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}• Send
timely departure alerts[      ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}Your data
stays on-device.[          ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}We never
sell location data.[        ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[
Allow Location \] [            ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[          ]{.Apple-converted-space}Skip
for now [                ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 3: SET UP COMMUTES [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}Where do you
go regularly?[          ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╭─────────────────────────────────╮ ┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│
]{.s1}[🏢]{.s12}[ WORK [                       
]{.Apple-converted-space}│ ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│ Search
address\... [              ]{.Apple-converted-space}│ ┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╰─────────────────────────────────╯ ┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╭─────────────────────────────────╮ ┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│
]{.s1}[🏠]{.s12}[ HOME [                       
]{.Apple-converted-space}│ ┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│ Current
location detected [      ]{.Apple-converted-space}│ ┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╰─────────────────────────────────╯ ┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╭─────────────────────────────────╮ ┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│ + Add
another place [            ]{.Apple-converted-space}│ ┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}╰─────────────────────────────────╯ ┃ [       
                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[💡]{.s12}[ We\'ll learn more over time[ 
    ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[
Continue \] [                  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 4: TRANSPORT PREFERENCES [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}How do you
usually get around?[      ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}(Select all
that apply) [            ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}┌───────┐
┌───────┐ [                ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🚗]{.s12}[ [  ]{.Apple-converted-space}│
│[  ]{.Apple-converted-space}]{.s1}[🚴]{.s12}[ [ 
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│ Drive │ │
Bike[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}✓[    ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}✓[    ]{.Apple-converted-space}│ [             
  ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}└───────┘
└───────┘ [                ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}┌───────┐
┌───────┐ [                ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}]{.s1}[🚶]{.s12}[ [  ]{.Apple-converted-space}│
│[  ]{.Apple-converted-space}]{.s1}[🚇]{.s12}[ [ 
]{.Apple-converted-space}│ [                ]{.Apple-converted-space}┃
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│ Walk[ 
]{.Apple-converted-space}│ │Transit│ [               
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}│ │ [      ]{.Apple-converted-space}│ [       
        ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}└───────┘
└───────┘ [                ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[
Continue \] [                  ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 5: NOTIFICATIONS [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[         
]{.Apple-converted-space}\[Notification preview\] [     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[🔔]{.s12}[ Stay Ahead of Weather[       
    ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}Get alerts
when:[                    ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}✓ Rain is
coming on your route[      ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}✓ It\'s time
to leave[                ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}✓ Great
weather for biking[          ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}We\'re smart
about it---no spam. [      ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[
Enable Notifications \] [      ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [           
]{.Apple-converted-space}Maybe later [             
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 6: CALENDAR (OPTIONAL) [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[📅]{.s12}[ Connect Your Calendar? [     
    ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}We\'ll know
when you have[            ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}meetings and
factor that into [      ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}your
departure suggestions. [        ]{.Apple-converted-space}┃ [           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}Example:[   
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}\"Rain
starts at 9---but your 10am[    ]{.Apple-converted-space}┃ [           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}meeting
means you should leave[      ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}by 9:15 to
arrive on time.\" [        ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}We only read
event times and[        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}locations,
not content. [            ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[
Connect Calendar \] [          ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [           
]{.Apple-converted-space}Skip[                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCREEN 7: ALL SET [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[          ]{.Apple-converted-space}✓[   
                        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}You\'re all
set! [                    ]{.Apple-converted-space}┃ [                 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}We\'ll learn
your patterns over[      ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}the next few
days and get [          ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}smarter
about your commutes.[        ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [ 
]{.Apple-converted-space}]{.s1}[💡]{.s12}[ TIP: Add the widget to your
[    ]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}home screen
for at-a-glance [        ]{.Apple-converted-space}┃ [                   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [  ]{.Apple-converted-space}commute
weather.[                    ]{.Apple-converted-space}┃ [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃[        ]{.Apple-converted-space}\[
Start Using App \][            ]{.Apple-converted-space}┃ [             
              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┃ [                                     
]{.Apple-converted-space}┃ [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Summary: App Modes At a Glance**]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}MODE COMPARISON[                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[                    ]{.Apple-converted-space}STANDALONE[   
]{.Apple-converted-space}CARPLAY[       
]{.Apple-converted-space}BACKGROUND[             
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}──────────────────────────────────────────────────────────────────[ 
  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Full UI[           
]{.Apple-converted-space}✓[           
]{.Apple-converted-space}Companion[      ]{.Apple-converted-space}✗[   
                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Route planning [   
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}Via
CarPlay[    ]{.Apple-converted-space}✗[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Voice interface[   
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}Via car
mic[    ]{.Apple-converted-space}Via Siri [             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Multi-modal[       
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}Car only
[      ]{.Apple-converted-space}✗[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Radar view [       
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}✓
(detail) [    ]{.Apple-converted-space}✗[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Notifications[     
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}✓[     
        ]{.Apple-converted-space}✓[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Widgets[           
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}✓[     
        ]{.Apple-converted-space}✓[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Apple Watch[       
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}✓[     
        ]{.Apple-converted-space}✓[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Calendar aware [   
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}✓[     
        ]{.Apple-converted-space}✓[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Pattern learning [ 
]{.Apple-converted-space}✓[            ]{.Apple-converted-space}✓[     
        ]{.Apple-converted-space}✓[                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRIMARY USE CASE:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}STANDALONE: [ 
]{.Apple-converted-space}Planning trips, checking conditions, full
control [      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY:[     
]{.Apple-converted-space}Driving with weather intelligence [           
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}BACKGROUND: [ 
]{.Apple-converted-space}Proactive alerts without opening app[         
          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[**Next Steps**]{.s1}

[This concept covers the complete iOS companion experience. From here, I
could:]{.s1}

1.  [**Create detailed Figma mockups** for each screen state]{.s1}
2.  [**Design the A2A server architecture** to support these features
    (weather agent, calendar agent, pattern learning agent, etc.)]{.s1}
3.  [**Write the SwiftUI component library** starting with the design
    system]{.s1}
4.  [**Prototype the voice interaction flow** with specific conversation
    trees]{.s1}
5.  [**Design the data model** for trips, patterns, preferences]{.s1}

[Which would be most valuable to dive into next?]{.s1}

[Ste 4 and then and then Step 2]{.s7}

[]{.s1}\

[Voice Interaction Flow: Conversation Design]{.s1}

[Core Principles]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}VOICE DESIGN PHILOSOPHY[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. CONVERSATIONAL, NOT COMMAND-BASED[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}✗ \"Check weather route home\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}✓ \"What\'s the weather like for my
drive home?\" [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. CONTEXT-AWARE [                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Remembers previous queries in
session[                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Knows time of day, location,
calendar[                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• References learned patterns [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. PROACTIVELY HELPFUL[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Offers relevant follow-ups [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Suggests actions, not just
information [                          ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Anticipates next questions [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. CONCISE BUT COMPLETE [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Lead with the answer [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Add context only if valuable [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Shorter when driving, more detail
when stationary[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. GRACEFUL DEGRADATION [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Handle partial understanding [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Ask clarifying questions naturally [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Never say \"I don\'t
understand\"---offer alternatives [             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Conversation Architecture]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}INTENT CLASSIFICATION[                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRIMARY INTENTS[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ INTENT[             
]{.Apple-converted-space}EXAMPLES [                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ route_weather [     
]{.Apple-converted-space}\"What\'s the weather for my drive to work?\"[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Will it rain on my way home?\"[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"How\'s the weather to mom\'s house?\" [     
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ departure_time[     
]{.Apple-converted-space}\"When should I leave?\"[                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"What\'s the best time to go?\" [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Should I leave now or wait?\" [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ transport_decision[ 
]{.Apple-converted-space}\"Should I bike today?\"[                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Is it good weather for walking?\" [         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Drive or bike?\"[                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ current_weather [   
]{.Apple-converted-space}\"What\'s the weather right now?\" [           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Is it raining?\"[                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"How cold is it?\" [                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ forecast[           
]{.Apple-converted-space}\"What\'s the weather tomorrow?\"[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Will it rain this weekend?\"[               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"How\'s Thursday looking?\" [                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ set_reminder[       
]{.Apple-converted-space}\"Remind me to leave at 8\" [                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Alert me when I should go\" [               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Let me know when the rain stops\" [         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ start_navigation[   
]{.Apple-converted-space}\"Start navigation to work\"[                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Take me home\"[                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Navigate to the airport\" [                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ modify_preference [ 
]{.Apple-converted-space}\"I prefer to avoid rain\"[                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"I like biking on Tuesdays\" [               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Don\'t suggest biking when it\'s cold\" [   
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ clarification [     
]{.Apple-converted-space}\"What do you mean?\" [                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Tell me more\"[                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Why?\"[                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ confirmation[       
]{.Apple-converted-space}\"Yes\" / \"No\" / \"Okay\" / \"Sure\"[       
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"Do that\" / \"Cancel\" / \"Never mind\" [   
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENTITY EXTRACTION[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────── [                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ENTITY[             
]{.Apple-converted-space}EXAMPLES [                                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ destination [       
]{.Apple-converted-space}\"work\", \"home\", \"mom\'s\", \"the
airport\", [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"123 Main St\", \"Whole Foods\"[             
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ time[               
]{.Apple-converted-space}\"now\", \"tomorrow\", \"Thursday\", \"8am\",
[      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"this weekend\", \"in an hour\"[             
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ transport_mode[     
]{.Apple-converted-space}\"drive\", \"bike\", \"walk\", \"take BART\"[ 
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ weather_condition [ 
]{.Apple-converted-space}\"rain\", \"clear\", \"sunny\", \"snow\",
\"cold\"[    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ relative_time [     
]{.Apple-converted-space}\"before the rain\", \"after work\",[         
  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}\"when it clears up\" [                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Conversation Trees]{.s1}

[Tree 1: Route Weather Query]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ROUTE WEATHER CONVERSATION [             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENTRY POINTS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"What\'s the weather for my drive to
\[destination\]?\" [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Will it rain on my way to
\[destination\]?\"[                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"How\'s the weather to
\[destination\]?\" [                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"What\'s my commute weather?\"[       
                                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO A: Clear Route [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────── [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
for my drive to work?\" [                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Clear skies the whole
way. 58 degrees now, warming to 64[         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}by the time you arrive. About 28
minutes with current traffic.[    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Great driving conditions.\"[         
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\[If morning + bike weather good\]: [ 
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"Actually, perfect day to bike if
you\'re up for it---[                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}45 minutes, clear both ways.\" [     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO B: Weather Change En Route [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────────── [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
for my drive to work?\" [                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"You\'ll start in clear
weather, but rain begins on I-280 [         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}around 9:15---about halfway through
your drive. [                    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Moderate intensity, should last about
20 minutes. [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}If you leave in the next 15 minutes,
you\'ll beat it entirely. [    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Want me to set a departure reminder?\"
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}FOLLOW-UPS: [                             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Yes, remind me\" [   
                                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Got it. I\'ll alert
you in 10 minutes---that gives you 5 minutes[   
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}buffer to get going.\" [             
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What if I wait?\"[   
                                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"The rain should clear
by 9:45. If you leave around 10, [         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}you\'ll have clear roads but heavier
traffic---about 35 minutes[      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}instead of 28. Still dry though.\" [ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"How bad is the rain?\"
[                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Moderate---you\'ll
want wipers on medium. Visibility drops a bit[   
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}but nothing dangerous. Roads might be
slick for the first [        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}few minutes after it starts.\" [     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO C: Bad Weather Entire Route[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────────[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
for my drive to work?\" [                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Rain the entire way,
unfortunately. Started about an hour ago[   
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}and should continue until early
afternoon.[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Current intensity is light to
moderate---drive time about [          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}35 minutes with the slower traffic. [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}If you can wait until after 1pm,
you\'ll have clear roads.\"[        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\[If calendar shows flexible day\]: [ 
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"I see your calendar is pretty open
this morning---[                  ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}might be a good work-from-home
day?\"[                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO D: Destination Not Specified [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────────────────────── [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s my commute
weather?\" [                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[If time suggests
direction\]:[                                     
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Morning → Assumes \"to work\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Evening → Assumes \"to home\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"For your drive to work: clear now,
but rain starting [            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}around 9:15\...\" [                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[If ambiguous\]:[     
                                             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"Are you heading to work or somewhere
else?\"[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO E: Unknown Destination [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────── [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
for my drive to Jake\'s place?\" [               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I don\'t have an
address saved for Jake\'s place. [                 
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}What\'s the address, or a nearby
landmark?\"[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"It\'s in Oakland, near
Lake Merritt\" [                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Got it---Lake Merritt
area. About 25 minutes from here.[           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Clear weather the whole way, 62
degrees when you arrive.[          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Want me to save this as \'Jake\'s
place\' for next time?\" [          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Tree 2: Departure Time Optimization]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}DEPARTURE TIME CONVERSATION[             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENTRY POINTS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"When should I leave?\"[               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"What\'s the best time to leave for
\[destination\]?\"[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Should I leave now or wait?\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"When should I leave to arrive by
\[time\]?\"[                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO A: Optimize for Weather[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"When should I leave
for work?\"[                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"For the best weather,
leave in the next 20 minutes--- [             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}you\'ll have clear skies the whole
way.[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Rain starts on your route around 9:15.
If you leave after 9,[      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}you\'ll hit about 15 minutes of
moderate rain on I-280.[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Or wait until 10---the rain will have
passed by then, [              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}though traffic will be heavier.\"[   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What time exactly
should I leave?\"[                               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"8:45 is the sweet
spot. You\'ll arrive at 9:30 with clear [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}weather and light traffic. Want me to
set a reminder?\"[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO B: Arrival Constraint[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────────[           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"When should I leave to
get to work by 10?\"[                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"To arrive by 10, you
need to leave by 9:15 at the latest.[       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}But here\'s the thing---rain starts at
9:15 on your route.[          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}I\'d suggest either: [               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Leave now, arrive 9:30, completely
dry[                          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Leave at 9:15, arrive 10:00, drive
through rain [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}The first option gives you a buffer
and better weather.\"[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I can\'t leave now, I
have a call until 9\" [                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Understood. Leave
right at 9 then---you\'ll catch the very[         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}beginning of the rain but miss the
heavier stuff. [                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}You\'ll arrive around 9:50. Should I
remind you at 8:55?\"[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO C: Calendar-Aware[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"When should I leave
for work?\"[                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I see you have a 9:30
meeting. To make that comfortably, [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}leave by 8:45.[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Good news: the weather is clear until
10, so you\'ll have[          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}a nice dry drive. The rain holds off
until after you arrive.\" [    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO D: Future Trip [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────── [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"When should I leave
for the airport tomorrow?\"[                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"What time is your
flight?\"[                                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"2pm\"[               
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"For a 2pm flight,
you\'ll want to be there by noon for[           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}domestic, or 11 for international.
Which is it?\"[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Domestic\" [         
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"To arrive by noon:
leave by 11am. [                               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Tomorrow\'s weather looks clear all
morning, so no weather [        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}concerns. Traffic on 101 to SFO is
usually moderate [              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}at that hour---about 45 minutes.[     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}I\'ll remind you tomorrow at 10:45.
Sound good?\" [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Make it 10:30, I like
extra buffer\" [                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Smart. Reminder set
for 10:30am tomorrow.\"[                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Tree 3: Transport Mode Decision]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}TRANSPORT DECISION CONVERSATION[         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENTRY POINTS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Should I bike today?\"[               
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Is it good weather for
biking/walking?\"[                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Drive or bike?\"[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Can I bike to work?\" [               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO A: Good Conditions [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────── [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Should I bike to work
today?\" [                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Yes! Great day for
it.[                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• 58 degrees now, warming to 65 by
afternoon[                      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Clear skies both directions [       
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Light wind, 5mph---won\'t slow you
down [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}45 minutes each way. You\'ll beat the
traffic too--- [                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}101 is backed up this morning.\" [   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What about coming
home?\"[                                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Still clear at 5pm, 68
degrees. Headwind of about 8mph [         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}heading back, so maybe 50 minutes
return. Still nice though.\" [    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO B: Marginal Conditions [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────── [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Should I bike to work
today?\" [                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Hmm, it\'s borderline.
[                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Morning is fine---52 degrees, clear,
light wind. [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}But rain is expected around 4pm. If
you leave work by 3:30, [      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}you\'ll make it home dry. After that,
you\'re likely to get wet.[    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Can you leave early today?\" [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I have a meeting until
5\" [                                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Then I\'d suggest
driving today. The rain should be steady[       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}from 4 to 7pm. You could bike in and
drive home, but that\'s[      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}a hassle. [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Thursday looks perfect for biking
though---clear all day.\"[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO C: Bad Conditions[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Should I bike today?\"
[                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I wouldn\'t recommend
it today.[                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Rain expected most of the
day---starting around 8am and [           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}continuing until evening. Plus it\'s
48 degrees and[                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}there\'s a 15mph headwind this
morning.[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Drive today. Tomorrow\'s looking much
better if you want [          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}to bike then.\"[                     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO D: Comparative [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────── [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Drive or bike today?\"
[                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Let me compare: [     
                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}]{.s1}[🚗]{.s12}[ Drive: 28 minutes[ 
                                           
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}Clear weather, but traffic is heavy
on 101 [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}]{.s1}[🚴]{.s12}[ Bike: 45 minutes [ 
                                           
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}Perfect conditions---62 degrees, no
wind, clear [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Biking is only 17 minutes longer and
you skip the traffic.[        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}I\'d bike today.\"[                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What about
walking?\"[                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Walking is 1 hour 40
minutes. Weather would be fine, but [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}that\'s a long walk. Maybe save that
for a shorter trip?\"[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Tree 4: Forecast Queries]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}FORECAST CONVERSATION[                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENTRY POINTS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"What\'s the weather tomorrow?\"[     
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Will it rain this weekend?\"[         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"How\'s Thursday looking?\" [         
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"What\'s the forecast for
\[day/time\]?\" [                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO A: Tomorrow\'s Commute[         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────────────────────[           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
tomorrow?\" [                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Tomorrow looks great.
Sunny, highs around 68. [                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}For your commute: [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Morning: Clear, 55 degrees[         
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Evening: Still clear, 65 degrees[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Perfect day to bike if you\'re
thinking about it.\" [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO B: Weekend Planning[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Will it rain this
weekend?\" [                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Saturday looks
clear---perfect for outdoor plans.[                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Sunday has rain moving in around noon.
Morning should [            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}be dry, but expect steady rain from
about 12pm through[            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}the evening.[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}If you have outdoor plans, I\'d aim
for Saturday or[                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Sunday morning.\"[                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I\'m driving to LA on
Saturday\"[                                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Nice---Saturday is the
better day for that drive.[                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Weather along the route:[             
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Bay Area: Clear, 65 [               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Central Valley: Clear, 72 [         
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• Grapevine: Clear, 68[               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}• LA: Sunny, 75 [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Beautiful driving weather the whole
way. About 6 hours[            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}with typical traffic. When are you
planning to leave?\"[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO C: Specific Day[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"How\'s Thursday
looking?\"[                                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Thursday is looking
good. [                                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Partly cloudy, high of 64. No rain
expected.[                      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Wind picks up a bit in the
afternoon---around 12mph. [             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Good commute day both directions.\"[ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What about for
biking?\" [                                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Definitely bikeable.
The wind is from the west, so you\'ll[       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}have a slight tailwind going to work
in the morning.[              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Coming home might be 5-10 minutes
longer with the headwind, [      ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}but nothing too bad.\" [             
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO D: Week Overview [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────────── [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What does my commute
look like this week?\"[                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Here\'s your week: [ 
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Monday (today): Clear → rain
afternoon[                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Tuesday: Rain morning, clearing by
noon [                          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Wednesday: Clear all day ← great bike
day [                        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Thursday: Partly cloudy, clear
commute[                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Friday: Clear all day ← another good
bike day [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Wednesday and Friday are your best
biking days. [                  ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Tuesday morning might be
tricky---leave early or late [             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}to avoid the rain.\" [               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Tree 5: Reminders and Actions]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}REMINDERS CONVERSATION [                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENTRY POINTS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Remind me to leave at \[time\]\"[     
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Set a reminder for \[condition\]\"[   
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Alert me when \[event\]\" [           
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Let me know when I should leave\" [   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO A: Time-Based Reminder [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────── [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Remind me to leave at
8:30\" [                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Got it. I\'ll remind
you at 8:30 to leave. [                       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Heading to work?\" [                 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Yes\"[               
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Perfect. At 8:30,
I\'ll also give you a quick weather update [     
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}for your drive.\"[                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO B: Condition-Based Reminder[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────────[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Let me know when the
rain stops\"[                                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I\'ll alert you when
the rain clears.[                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Based on the radar, that should be
around 2pm,[                    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}but I\'ll ping you when it actually
stops---sometimes[                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}it clears earlier or later than
predicted.\" [                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LATER\...[                               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[Notification\]: \"Rain
has stopped. Roads should be dry[           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}in about 20 minutes. Good time to head
out.\"[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO C: Smart Departure Reminder[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────────[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Let me know when I
should leave for work\" [                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I\'ll monitor the
weather and traffic and alert you [             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}at the optimal time.[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Right now, that looks like 8:45 to
avoid the rain at 9:15.[        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}But if conditions change, I\'ll
adjust.[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Is there a time you absolutely have to
arrive by?\"[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I have a 10am
meeting\"[                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Got it. I\'ll make
sure you have time to arrive by 9:45 [         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}with a comfortable buffer. I\'ll alert
you when it\'s time.\"[        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO D: Future Day Reminder [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────── [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Remind me Wednesday
night to prep my bike for Thursday\" [         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Done. Wednesday at 8pm
I\'ll remind you to prep for biking[       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Thursday. [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}I\'ll also include Thursday\'s
forecast so you can confirm[          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}it\'s still a good day for it.\"[     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Tree 6: Proactive Conversations]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}AI-INITIATED CONVERSATIONS [             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}These are triggered by the AI, not the
user.[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Delivered via notification or when user
opens app.[                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO A: Weather Change Alert[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[Notification\]: \"Rain
starting on your commute route in[           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}25 minutes. Leave now to beat it, or
wait until after 10.\"[        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[User opens app\][                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Hey---rain is moving
in faster than expected. If you were[         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}planning to head to work soon, now\'s
the time.[                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Want me to start navigation?\" [     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Yes, let\'s go\"[     
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Starting navigation to
work. You should arrive dry [             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}in about 30 minutes. Have a good
drive!\"[                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO B: Opportunity Alert [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────────────── [           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[Notification\]:
\"Perfect biking weather today. Clear skies,[       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}62°F, light winds. Better than driving
in this traffic!\"[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[User opens app\][                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Good morning! Noticed
you usually drive Tuesdays, but today[     
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}is actually perfect for biking---clear
all day, 62 degrees,[        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}and traffic on 101 is heavy.[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Biking would be 45 minutes versus 40
for driving today. [          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Interested?\"[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I don\'t have my bike
gear today\"[                                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"No worries. I\'ll
remember you bike on Thursdays---[                 
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Thursday looks good too, so I\'ll
check in then.\"[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO C: Tomorrow\'s Heads Up [       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────── [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[Evening
notification\]: \"Tomorrow\'s commute: rain all morning. [   
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Might be a good WFH day. Your calendar
shows 2 meetings [          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}that could go virtual.\" [           
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[User opens app\][                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Hey---wanted to give
you a heads up about tomorrow.[               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Rain starts around 6am and continues
through noon.[                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Your 10am meeting and 2pm meeting are
both internal---[              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}might be worth going remote.[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}If you do need to go in, leave before
6 or after 1.\"[              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I\'ll work from
home\"[                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Good call. I\'ll skip
the commute alerts tomorrow morning.\"[       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCENARIO D: During Drive Update [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────────────── [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[Via CarPlay or notification while
driving\] [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Heads up---rain is
heavier than expected ahead.[                   
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}About 5 miles out, should last 10
minutes.[                        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Visibility might drop. Take it easy.\"
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[Later\] [                               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"You\'re through the
worst of it. Clear weather the rest [         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}of the way.\"[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Context Management]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CONVERSATION CONTEXT [                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}The AI maintains context across the
conversation. [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}This enables natural follow-up questions.
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}EXAMPLE: Multi-Turn Conversation[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s my commute
weather?\" [                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Clear to work, rain
starting around 4pm for your drive home.\"[   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What about tomorrow?\"
[                                           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\[Context: \"commute weather\"\][     
                                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Tomorrow\'s commute
looks clear both ways.\"[                       
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Should I bike?\" [   
                                             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\[Context: \"tomorrow\",
\"commute\"\][                                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Tomorrow is great for
biking---clear, 65 degrees, light wind.\" [   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Remind me tonight\"[ 
                                             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\[Context: \"bike tomorrow\"\][       
                                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I\'ll remind you
tonight at 8pm to prep for biking tomorrow.\" [   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CONTEXT VARIABLES TRACKED:[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Variable [           
]{.Apple-converted-space}│ Example Value[                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ current_destination[ 
]{.Apple-converted-space}│ \"work\" [                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ current_time_ref [   
]{.Apple-converted-space}│ \"tomorrow\" [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ current_mode [       
]{.Apple-converted-space}│ \"bike\" [                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ discussed_weather[   
]{.Apple-converted-space}│ { clear_am: true, rain_pm: true }[       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ pending_action [     
]{.Apple-converted-space}│ { type: \"reminder\", time: \"8pm\" }[       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ conversation_topic [ 
]{.Apple-converted-space}│ \"commute_planning\" [                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CONTEXT EXPIRATION: [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Session context: Clears when app closes
or after 30 min idle[        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Topic context: Clears when topic clearly
changes[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Reference context: Last 5 turns kept for
pronouns (\"it\", \"there\") [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}AMBIGUITY RESOLUTION: [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What about Thursday?\"
[                                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[If recent context was about biking\]: [ 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Thursday is great for
biking---clear and 68 degrees.\"[             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[If recent context was about a trip\]: [ 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Thursday weather in LA
is sunny, high of 78.\"[                   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[If no clear context\]:[                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Thursday\'s looking
good---clear and 68. For your commute,[         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}or did you have something else in
mind?\"[                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Error Handling & Edge Cases]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ERROR HANDLING [                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRINCIPLE: Never say \"I don\'t
understand.\" Always offer alternatives. │]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}MISHEARD SPEECH [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────── [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \[Unclear audio\][     
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Sorry, I didn\'t catch
that. Were you asking about your commute,[ 
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}or something else?\" [               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}UNKNOWN LOCATION[                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Weather to Grandma\'s
house\" [                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I don\'t have an
address for Grandma\'s. What city is she in,[     
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}or can you give me the address?\"[   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NO WEATHER DATA [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────── [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather in
Antarctica?\"[                               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I don\'t have detailed
weather data for Antarctica. [             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}I\'m best at routes in the US. Is
there somewhere[                  ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}closer to home I can help with?\"[   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}AMBIGUOUS TIME[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
Friday?\" [                                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[If it\'s Thursday\]: [                 
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Tomorrow, Friday?
Looks like\...\"[                                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[If it\'s Saturday\]: [                 
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Do you mean yesterday,
or next Friday?\"[                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OUT OF SCOPE REQUEST[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Play some music\"[   
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I\'m focused on
weather and travel---music isn\'t my thing.[         
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}But I can tell you if it\'s good
weather for a drive with[          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}the windows down, if that helps!\" [ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NETWORK ERROR [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I\'m having trouble
getting the latest weather data.[             
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Based on what I have cached, it looks
clear this morning.[        ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}I\'ll update you when I reconnect.\"[ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CONFLICTING INFORMATION [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────────────────── [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"I need to arrive by 9
but I can\'t leave until 8:45\"[             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"That\'s cutting it
close---the drive is usually 28 minutes. [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}You might make it if traffic is light,
but there\'s not[            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}much buffer.[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}Is there any way to leave by 8:30? Or
could you push[              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}your arrival to 9:15?\"[             
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Voice Persona & Tone]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}VOICE PERSONALITY[                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}NAME: Unnamed (it\'s just \"the app\" or
responds to wake word)[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PERSONALITY TRAITS: [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Helpful, not servile[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Knowledgeable, not condescending[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Friendly, not overly casual [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Proactive, not pushy[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Concise, not terse[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TONE EXAMPLES [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}✓ GOOD [                         
]{.Apple-converted-space}✗ AVOID [                           
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}──────────────────────────────────────────────────────────────────[ 
  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Looks like rain around 4\" [     
]{.Apple-converted-space}\"I\'m afraid it will rain at 4\"[     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Great day to bike\"[             
]{.Apple-converted-space}\"I recommend biking! ]{.s1}[🚴]{.s12}[\" [   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Leave by 8:30 to beat it\" [     
]{.Apple-converted-space}\"You should leave by 8:30\"[         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"The rain should clear by 2\" [   
]{.Apple-converted-space}\"Based on my analysis\...\" [         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"I\'ll remind you at 8\" [         
]{.Apple-converted-space}\"Certainly! I\'ll remind you\"[       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\"Tomorrow\'s looking rough\" [     
]{.Apple-converted-space}\"Tomorrow\'s forecast is suboptimal\" │]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CONTEXT-DEPENDENT TONE: [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DRIVING (CarPlay):[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Shorter responses [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• More direct [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Essential info only [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Rain in 10 minutes. Moderate. Wipers
ready.\"[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}STATIONARY (Phone): [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• More conversational [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Can elaborate [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Offer context and alternatives[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Rain starts in about 10 minutes on
your route---moderate[            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}intensity, you\'ll want your wipers on.
If you wait 30 minutes,[    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}it should pass.\" [                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}URGENT ALERT: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Lead with action[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Clear and direct[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• No hedging[                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Heavy rain ahead in 3 minutes.
Consider pulling over.\"[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SUGGESTION: [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Softer framing[                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Present as option [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Easy to dismiss [                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"By the way, tomorrow\'s perfect for
biking if you\'re interested.\" │]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[CarPlay-Specific Voice Patterns]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CARPLAY VOICE INTERACTIONS [             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}While driving, voice is PRIMARY interface.
Must be extra safe.[        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WAKE PATTERNS [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Hey \[App Name\]\" - Custom wake word
[                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Press mic button on CarPlay screen[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Press mic button on steering wheel (if
mapped)[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DRIVING MODE RESPONSES (Shorter, Direct)[ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────────────────────[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"What\'s the weather
ahead?\"[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Rain in 12 miles.
Moderate. About 15 minutes of it.\" [           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"How much longer?\" [ 
                                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"22 minutes. Clear
weather the rest of the way.\"[                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Is there a rest
stop?\"[                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Rest stop in 3 miles,
right side. Another in 8 miles.\" [         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Pull over options?\"
[                                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Gas station in 1 mile.
Rest area in 4 miles with coverage.\"[     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PROACTIVE DRIVING ALERTS[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────────────[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[Upcoming weather change\] [             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Heads up---rain
starting in about 5 miles. Should last [           
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}10 minutes.\"[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[Severe conditions\] [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Heavy rain ahead.
Visibility dropping. Consider the rest [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}area in 2 miles.\" [                 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[Conditions improving\][                 
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"You\'re through the
rain. Clear from here.\" [                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\[Route update\][                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"I found a route that
avoids the rain. Adds 5 minutes but [       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}stays dry. Want me to switch?\"[     
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INTERRUPTION HANDLING [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────── [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Rain is expected to
start around---\"[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Never mind\" [       
                                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \[Stops immediately\][ 
                                             
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"There\'s a rest stop
in 3 miles---\"[                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"The covered one\"[   
                                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"The covered rest area
is in 6 miles. Want me to route there?\"[   
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CONFIRMATION PATTERNS (Driving - Minimize
Interaction)[                ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}──────────────────────────────────────────────────────[ 
              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Want me to route to
the rest area?\" [                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"Yes\" / \"Yeah\" /
\"Do it\" / \"Okay\"[                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Routing. 6 miles
ahead.\"[                                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Should I switch to the
dry route?\"[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[👤]{.s12}[ \"No\" / \"Keep going\"
/ \"Stay on this\" [                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}]{.s1}[🤖]{.s12}[ \"Okay, staying on
current route.\"[                                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Now let me move on to Step 2: A2A Server Architecture to support all
these features.]{.s1}

[]{.s1}\

[A2A Server Architecture]{.s1}

[Overview]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}SYSTEM ARCHITECTURE[                     
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}┌─────────────┐ [   
]{.Apple-converted-space}┌─────────────┐ [   
]{.Apple-converted-space}┌─────────────┐[             
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}iOS App [ 
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}CarPlay [  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}│ Apple Watch │[             
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│
[    ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}App [   
]{.Apple-converted-space}│ [    ]{.Apple-converted-space}│[   
]{.Apple-converted-space}App[      ]{.Apple-converted-space}│[         
    ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}└──────┬──────┘ [   
]{.Apple-converted-space}└──────┬──────┘ [   
]{.Apple-converted-space}└──────┬──────┘[             
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│ [                 
]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[         
]{.Apple-converted-space}└───────────────────┼───────────────────┘[     
                ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[         
]{.Apple-converted-space}┌───────────────────────────────────────┐[     
                ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [                               
      ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}API GATEWAY [               
]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[       
]{.Apple-converted-space}(Authentication, [             
]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}Rate Limiting)[               
]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [                               
      ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[         
]{.Apple-converted-space}└───────────────────┬───────────────────┘[     
                ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[         
]{.Apple-converted-space}┌───────────────────────────────────────┐[     
                ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [                               
      ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}ORCHESTRATOR HUB[             
]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[     
]{.Apple-converted-space}(Main A2A Coordinator) [         
]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [                               
      ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
Routes requests to agents[          ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
Maintains conversation context [    ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
Combines agent responses [          ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│[  ]{.Apple-converted-space}•
Handles user preferences [          ]{.Apple-converted-space}│[         
            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}│ [                               
      ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}│]{.s1}

[│[         
]{.Apple-converted-space}└───────────────────┬───────────────────┘[     
                ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[       
]{.Apple-converted-space}┌─────────────────────┼─────────────────────┐[ 
                  ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [          ]{.Apple-converted-space}│[       
            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}▼ [         
]{.Apple-converted-space}▼ [        ]{.Apple-converted-space}▼ [       
]{.Apple-converted-space}▼ [          ]{.Apple-converted-space}▼[       
            ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}┌─────────┐ ┌─────────┐ ┌─────────┐
┌─────────┐ ┌─────────┐[          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ │
[        ]{.Apple-converted-space}│ │ [       
]{.Apple-converted-space}│ │ [        ]{.Apple-converted-space}│ │ [   
    ]{.Apple-converted-space}│[         
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ WEATHER │ │ TRAFFIC │ │CALENDAR │ │[ 
]{.Apple-converted-space}ROUTE[  ]{.Apple-converted-space}│ │[ 
]{.Apple-converted-space}VOICE[  ]{.Apple-converted-space}│[         
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}AGENT[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}AGENT[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}AGENT[ 
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}INTEL[ 
]{.Apple-converted-space}│ │ GATEWAY │[         
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ │
[        ]{.Apple-converted-space}│ │ [       
]{.Apple-converted-space}│ │[  ]{.Apple-converted-space}AGENT[ 
]{.Apple-converted-space}│ │ [        ]{.Apple-converted-space}│[       
  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}└────┬────┘ └────┬────┘ └────┬────┘
└────┬────┘ └────┬────┘[          ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}│ [         
]{.Apple-converted-space}│ [          ]{.Apple-converted-space}│ [     
    ]{.Apple-converted-space}│ [          ]{.Apple-converted-space}│[   
            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}▼ [         
]{.Apple-converted-space}▼ [          ]{.Apple-converted-space}▼ [     
    ]{.Apple-converted-space}▼ [          ]{.Apple-converted-space}▼[   
            ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}┌─────────┐ ┌─────────┐ ┌─────────┐
┌─────────┐ ┌─────────┐[          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ NWS API │ │ Google[ 
]{.Apple-converted-space}│ │ Google[  ]{.Apple-converted-space}│ │
Routing │ │ OpenAI[  ]{.Apple-converted-space}│[         
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│OpenMeteo│ │ Maps[   
]{.Apple-converted-space}│ │Calendar │ │ Engine[ 
]{.Apple-converted-space}│ │Realtime │[         
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ Radar [  ]{.Apple-converted-space}│ │
Apple [  ]{.Apple-converted-space}│ │ Apple [ 
]{.Apple-converted-space}│ │ (Local) │ │ Gemini[ 
]{.Apple-converted-space}│[          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│ APIs[    ]{.Apple-converted-space}│ │
Maps[    ]{.Apple-converted-space}│ │ Cal [   
]{.Apple-converted-space}│ │ [        ]{.Apple-converted-space}│ │
Whisper │[          ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}└─────────┘ └─────────┘ └─────────┘
└─────────┘ └─────────┘[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[                       
]{.Apple-converted-space}DATA LAYER [                             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────┐[ 
]{.Apple-converted-space}┌──────────────┐[ 
]{.Apple-converted-space}┌──────────────┐[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}PostgreSQL[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}Redis [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}S3/R2 [    ]{.Apple-converted-space}│[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[         
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[             
]{.Apple-converted-space}│[          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • Users[ 
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • Sessions
[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • Radar[     
]{.Apple-converted-space}│[          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ •
Locations[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ •
Cache[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}tiles[      ]{.Apple-converted-space}│[       
  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • Patterns
[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • Real-time[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • User data[ 
]{.Apple-converted-space}│[          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ • Trips[ 
    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}pub/sub[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}backups[   
]{.Apple-converted-space}│[          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────┘[ 
]{.Apple-converted-space}└──────────────┘[ 
]{.Apple-converted-space}└──────────────┘[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│ [  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│ [ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Agent Specifications]{.s1}

[1. Orchestrator Hub (Main A2A Server)]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ORCHESTRATOR HUB [                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: Central coordinator that routes
requests, maintains [          ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}context, and combines responses
from specialized agents.[      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}RESPONSIBILITIES:[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. REQUEST ROUTING[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Parse incoming requests (REST,
WebSocket, A2A protocol)[          ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Determine which agents need to be
involved [                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Coordinate parallel vs sequential
agent calls[                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Aggregate responses into unified
reply [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. CONTEXT MANAGEMENT [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Maintain conversation state per user
session [                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Track current topic, destination,
time references[                ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Persist context across app restarts
(within session) [            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Handle context expiration[           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. USER STATE [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Load user preferences (locations,
transport modes) [              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Track learned patterns [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Manage notification preferences[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Handle calendar permissions[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. RESPONSE SYNTHESIS [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Combine data from multiple agents[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Generate natural language responses[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Adapt verbosity based on context
(driving vs stationary) [        ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Handle error cases gracefully[       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}A2A CARD: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"name\":
\"liquidcrypto-orchestrator\",[                               
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"description\": \"Central hub for
travel weather intelligence\", [      ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"version\": \"1.0.0\", [               
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"capabilities\": { [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"streaming\": true,[                 
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"pushNotifications\": true,[         
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"stateManagement\": true [           
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}},[                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"skills\": \[ [                       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"route-weather\",[         
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Route Weather Query\",[ 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Get weather
conditions along a travel route\" [  ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"departure-optimize\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Departure Time
Optimizer\", [                           
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Find optimal
departure time based on weather\"[  ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"transport-decision\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Transport Mode
Decision\",[                             
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Recommend drive
vs bike vs walk\"[                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"reminder-set\", [         
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Smart Reminders\",[     
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Set time or
condition-based reminders\"[          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\],[                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"authentication\": { [                 
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"type\": \"bearer\", [               
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"required\": true[                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}KEY ENDPOINTS:[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}POST /a2a/tasks [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Create new task (voice query, route
request, etc.)[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Returns task ID and initial streaming
response[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}GET /a2a/tasks/{id} [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Get task status and result[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}POST /a2a/tasks/{id}/messages [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Continue conversation with follow-up[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WebSocket /a2a/stream [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Real-time bidirectional communication [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• For voice interactions and live updates
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}EXAMPLE FLOW: \"What\'s my commute
weather?\"[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. Request arrives at Orchestrator[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. Parse intent: route_weather[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. Load user context: home location, work
location[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. Determine time context: morning → going
to work[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. Call agents in parallel: [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Weather Agent: Get forecast for
route[                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Traffic Agent: Get current
conditions[                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Calendar Agent: Check for time
constraints [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}6. Route Intel Agent: Combine into route
analysis [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}7. Synthesize response with LLM [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}8. Stream response to client[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[2. Weather Agent]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}WEATHER AGENT[                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: Aggregate weather data from
multiple sources,[                ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}provide forecasts at specific
points and times.[              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DATA SOURCES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ SOURCE[         
]{.Apple-converted-space}│ DATA TYPE [         
]{.Apple-converted-space}│ UPDATE FREQ │ COST [   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ National Weather│ Point forecasts,[   
]{.Apple-converted-space}│ Hourly[      ]{.Apple-converted-space}│ Free
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Service (NWS) [ 
]{.Apple-converted-space}│ alerts, radar [     
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Open-Meteo[     
]{.Apple-converted-space}│ Global forecasts, [ 
]{.Apple-converted-space}│ Hourly[      ]{.Apple-converted-space}│ Free
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ historical[         
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Tomorrow.io [   
]{.Apple-converted-space}│ Minute-by-minute[   
]{.Apple-converted-space}│ Real-time [  ]{.Apple-converted-space}│ Paid
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ nowcasting[         
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ NOAA MRMS [     
]{.Apple-converted-space}│ Radar composites[   
]{.Apple-converted-space}│ 2 min [      ]{.Apple-converted-space}│ Free
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CAPABILITIES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. POINT FORECAST [                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { lat, lng, time }[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { temp, condition, precip_prob,
wind, humidity, uv } [      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. ROUTE FORECAST [                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { waypoints: \[{lat, lng,
eta}\...\] } [                        ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { segments: \[{start, end,
weather_at_arrival}\...\] }[        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. NOWCAST (Next 2 Hours) [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { lat, lng }[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { timeline: \[{time,
precip_intensity, precip_type}\...\] } [ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. RADAR TILES[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { bounds, zoom, time }[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { tile_url, animation_frames }
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. SEVERE ALERTS[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { lat, lng }[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { alerts: \[{type, severity,
headline, expires}\...\] } [      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}A2A CARD: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"name\": \"liquidcrypto-weather\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"description\": \"Weather data
aggregation and forecasting\",[         
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"version\": \"1.0.0\", [               
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"skills\": \[ [                       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"point-forecast\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Point Forecast\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"inputSchema\": {[                 
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"type\": \"object\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"properties\": { [               
                              ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}\"lat\": { \"type\": \"number\"
},[                                ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}\"lng\": { \"type\": \"number\"
},[                                ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}\"time\": { \"type\":
\"string\", \"format\": \"date-time\" } [       
]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}} [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}} [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"route-forecast\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Route Forecast\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"inputSchema\": {[                 
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"type\": \"object\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"properties\": { [               
                              ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}\"waypoints\": {[               
                              ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}\"type\": \"array\",[         
                                ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}\"items\": {[                 
                              ]{.Apple-converted-space}│]{.s1}

[│[                ]{.Apple-converted-space}\"type\": \"object\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[                ]{.Apple-converted-space}\"properties\": { [         
                              ]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}\"lat\": { \"type\":
\"number\" },[                          ]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}\"lng\": { \"type\":
\"number\" },[                          ]{.Apple-converted-space}│]{.s1}

[│[                  ]{.Apple-converted-space}\"eta\": { \"type\":
\"string\" } [                          ]{.Apple-converted-space}│]{.s1}

[│[                ]{.Apple-converted-space}} [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[              ]{.Apple-converted-space}} [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}} [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}} [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}} [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"nowcast\",[               
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"2-Hour Nowcast\"[       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"radar-tiles\",[           
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Radar Tile Service\"[   
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"id\": \"severe-alerts\",[         
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"Severe Weather Alerts\"
[                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\] [                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CACHING STRATEGY: [                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Point forecasts: 15 min TTL [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Hourly forecasts: 1 hour TTL[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Radar tiles: 2 min TTL[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Nowcasts: 5 min TTL [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Alerts: Real-time (pub/sub from NWS)[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}FALLBACK CHAIN: [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. Tomorrow.io (primary for nowcast)[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. NWS (primary for forecasts)[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. Open-Meteo (backup)[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. Cached data (last resort, with
staleness warning)[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[3. Traffic Agent]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}TRAFFIC AGENT[                           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: Provide real-time and predicted
traffic conditions,[          ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}travel times, and incident data.
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DATA SOURCES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ SOURCE[         
]{.Apple-converted-space}│ DATA TYPE [         
]{.Apple-converted-space}│ UPDATE FREQ │ COST [   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Google Maps [   
]{.Apple-converted-space}│ Real-time traffic,[ 
]{.Apple-converted-space}│ Real-time [  ]{.Apple-converted-space}│ Paid
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Routes API[     
]{.Apple-converted-space}│ ETAs, incidents [   
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Apple Maps[     
]{.Apple-converted-space}│ Traffic conditions[ 
]{.Apple-converted-space}│ Real-time [  ]{.Apple-converted-space}│
Free\*[    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ (MapKit)[       
]{.Apple-converted-space}│ (limited API) [     
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ HERE Traffic[   
]{.Apple-converted-space}│ Flow, incidents [   
]{.Apple-converted-space}│ Real-time [  ]{.Apple-converted-space}│ Paid
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [               
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Historical[     
]{.Apple-converted-space}│ Typical traffic [   
]{.Apple-converted-space}│ Static[      ]{.Apple-converted-space}│
Internal │ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Patterns[       
]{.Apple-converted-space}│ by day/hour [       
]{.Apple-converted-space}│ [            ]{.Apple-converted-space}│[     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CAPABILITIES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. ROUTE TIME [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { origin, destination,
departure_time } [                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { duration,
duration_in_traffic, distance }[               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. TRAFFIC CONDITIONS [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { route_polyline }[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { segments: \[{start, end,
congestion_level}\...\] }[          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. INCIDENTS[                             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { bounds OR route_polyline }[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { incidents: \[{type, location,
severity, description}\...\] }│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. PREDICTED TRAFFIC[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { route, time_range } [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { predictions: \[{departure,
eta, confidence}\...\] } [        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. ALTERNATIVE ROUTES [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { origin, destination,
avoid_conditions } [                  ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { routes: \[{polyline,
duration, weather_comparison}\...\] }[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}A2A CARD: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"name\": \"liquidcrypto-traffic\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"description\": \"Traffic data and
routing intelligence\", [            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"version\": \"1.0.0\", [               
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"skills\": \[ [                       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ \"id\": \"route-time\", \"name\":
\"Route Travel Time\" },[              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ \"id\": \"traffic-conditions\",
\"name\": \"Traffic Conditions\" }, [   
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ \"id\": \"incidents\", \"name\":
\"Traffic Incidents\" }, [              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ \"id\": \"predict-traffic\",
\"name\": \"Traffic Prediction\" },[       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ \"id\": \"alt-routes\", \"name\":
\"Alternative Routes\" }[              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\] [                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}HISTORICAL PATTERN LEARNING:[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}The agent builds patterns over time:[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Monday 8am on 101 South: typically 35
min\" [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Friday 5pm on 280 North: typically 45
min\" [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Rain days add 15-20% to typical travel
times\"[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}This improves predictions and helps
suggest departure times [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}even when real-time API is slow to
respond. [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[4. Calendar Agent]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}CALENDAR AGENT [                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: Integrate with user calendars to
understand time [            ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}constraints and provide
context-aware suggestions. [          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INTEGRATIONS: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ PROVIDER[       
]{.Apple-converted-space}│ INTEGRATION METHOD[ 
]{.Apple-converted-space}│ DATA ACCESS[           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Apple Calendar[ 
]{.Apple-converted-space}│ EventKit (on-device)│ Full (with permission)
│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Google Calendar │ OAuth + API [       
]{.Apple-converted-space}│ Read-only[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Microsoft 365 [ 
]{.Apple-converted-space}│ OAuth + Graph API [ 
]{.Apple-converted-space}│ Read-only[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CAPABILITIES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. NEXT EVENT [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { time_range }[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { event: { title, start, end,
location, is_flexible } }[    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. DAY SCHEDULE [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { date }[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { events: \[\...\],
free_windows: \[\...\], constraints: \[\...\] } │]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. MEETING LOCATION [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { event_id }[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { location, is_virtual,
travel_required, address } [        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. FLEXIBILITY ANALYSIS [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Input: { date }[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output: { can_wfh: true/false,
first_required_presence, \... }[      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRIVACY-FIRST DESIGN: [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Data extracted (what we use): [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Event start/end times [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Event location (if set) [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Event type hints (meeting, travel,
etc.)[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Data NOT extracted: [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Event titles (unless needed for location
detection) [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Attendees [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Event descriptions[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Attachments [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}All processing happens on-device when
possible. [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Only time/location data sent to server for
route calculation. [        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INTELLIGENCE: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Detect \"travel time needed\" between
back-to-back meetings [          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Recognize virtual meetings (Zoom/Meet
links) = no travel[            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Identify \"all-hands\" or \"optional\"
meetings [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Learn which meetings user actually
attends in-person[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[5. Route Intelligence Agent]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ROUTE INTELLIGENCE AGENT [               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: The \"brain\" that combines
weather, traffic, and time [        ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}data to produce actionable travel
recommendations. [          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}This agent CONSUMES data from other agents
and PRODUCES:[              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Optimal departure times [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Route weather timelines [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Transport mode recommendations[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Proactive alerts[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CAPABILITIES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. ROUTE WEATHER TIMELINE [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Inputs:[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Route polyline (from Traffic
Agent)[                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Departure time [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Weather forecasts along route (from
Weather Agent) [            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Algorithm: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}1. Segment route into \~1 mile chunks
[                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}2. Calculate ETA at each segment
based on traffic[                ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}3. Query weather for each segment at
its ETA [                    ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}4. Identify weather transition
points[                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}5. Return timeline with weather
states [                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output:[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}{[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"timeline\": \[[                 
                                ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}{ \"time\": \"9:00\",
\"location\": \"start\", \"weather\": \"clear\" }, │]{.s1}

[│ [          ]{.Apple-converted-space}{ \"time\": \"9:15\",
\"location\": \"I-280\", \"weather\": \"rain\" },[ 
]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}{ \"time\": \"9:35\",
\"location\": \"Daly City\", \"weather\": \"clearing\" },│]{.s1}

[│ [          ]{.Apple-converted-space}{ \"time\": \"9:45\",
\"location\": \"destination\", \"weather\": \"cloudy\" } │]{.s1}

[│ [        ]{.Apple-converted-space}\], [                             
                              ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"transitions\": \[ [             
                                ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}{ \"time\": \"9:15\", \"from\":
\"clear\", \"to\": \"rain\", \"location\": {\...} }│]{.s1}

[│ [        ]{.Apple-converted-space}\], [                             
                              ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"summary\": \"Rain on I-280 from
9:15-9:35\"[                      ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}}[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. DEPARTURE OPTIMIZER[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Inputs:[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Origin, destination[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Arrival constraint (optional)[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- User preferences (avoid rain,
etc.)[                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Weather forecasts (next 12 hours)[ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Traffic predictions[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Algorithm: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}1. Generate candidate departure times
(every 15 min) [            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}2. For each candidate: [             
                            ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}a. Calculate route weather
timeline [                          ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}b. Score based on:[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}- Weather quality (clear=10,
light rain=6, heavy=2)[        ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}- Traffic conditions (light=10,
heavy=4) [                  ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}- Total travel time[           
                            ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}- Buffer before arrival
constraint [                        ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}3. Rank and return top 3 options [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output:[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}{[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"options\": \[ [                 
                                ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}{[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"departure\": \"8:45\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"arrival\": \"9:30\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"duration\": 45,[             
                              ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"weather_score\": 10, [       
                              ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"traffic_score\": 8,[         
                              ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"summary\": \"Clear entire
route\", [                          ]{.Apple-converted-space}│]{.s1}

[│ [            ]{.Apple-converted-space}\"recommended\": true[         
                              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}}, [                             
                            ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}\...[                           
                              ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\][                               
                              ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}}[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. TRANSPORT MODE COMPARISON[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Inputs:[                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Origin, destination[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Time constraints [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- User transport preferences [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- Weather conditions [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Output per mode: [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}{[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"mode\": \"bike\",[               
                                ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"duration\": 45,[                 
                              ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"weather_suitability\":
\"excellent\",[                           
]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"conditions\": {[                 
                              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}\"temp\": 62,[                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}\"wind\": \"8mph headwind
return\",[                              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}\"precip\": \"none\",[           
                                ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}\"uv\": 6[                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}}, [                               
                            ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"gear_suggestions\": \[\"light
jacket\", \"sunscreen\"\], [            ]{.Apple-converted-space}│]{.s1}

[│ [        ]{.Apple-converted-space}\"verdict\": \"recommended\" [     
                                ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}}[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. PROACTIVE ALERT GENERATION [           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Continuous background process that:[   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}1. Monitors weather changes for user\'s
common routes [              ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}2. Checks calendar for upcoming travel
needs [                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}3. Generates alerts when:[             
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}- Weather changes affect upcoming
commute [                      ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}- Optimal departure window is
approaching [                      ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}- Better transport mode becomes
available [                      ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}- Severe weather incoming [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Alert types: [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- DEPARTURE_WINDOW: \"Leave in next
20 min to beat rain\"[          ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- WEATHER_CHANGE: \"Rain starting
earlier than expected\"[          ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- OPPORTUNITY: \"Great day to
bike!\"[                              ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- SEVERE: \"Heavy rain warning for
your route\"[                    ]{.Apple-converted-space}│]{.s1}

[│ [      ]{.Apple-converted-space}- PLANNING: \"Tomorrow\'s commute
looks rough\" [                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[6. Voice Gateway Agent]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}VOICE GATEWAY AGENT[                     
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: Handle real-time speech-to-text,
text-to-speech, [            ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}and conversational AI for voice
interactions.[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PROVIDER OPTIONS: [                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ PROVIDER[         
]{.Apple-converted-space}│ LATENCY │ QUALITY │ COST[   
]{.Apple-converted-space}│ BEST FOR [    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ OpenAI Realtime [ 
]{.Apple-converted-space}│ \~300ms[  ]{.Apple-converted-space}│
]{.s1}[★★★★★]{.s15}[[  ]{.Apple-converted-space}│ \$\$\$\$[   
]{.Apple-converted-space}│ Natural[      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ API [             
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│
conversation │ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Google Gemini [   
]{.Apple-converted-space}│ \~400ms[  ]{.Apple-converted-space}│
]{.s1}[★★★★★]{.s15}[[  ]{.Apple-converted-space}│ \$\$\$ [   
]{.Apple-converted-space}│ Multi-modal[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ 2.0 Live[         
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│[         
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Deepgram Nova + [ 
]{.Apple-converted-space}│ \~500ms[  ]{.Apple-converted-space}│
]{.s1}[★★★★☆]{.s15}[[  ]{.Apple-converted-space}│ \$\$[     
]{.Apple-converted-space}│ Cost/quality │ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ ElevenLabs[       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ balance[ 
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Whisper (local) + │ \~800ms[ 
]{.Apple-converted-space}│ ]{.s1}[★★★☆☆]{.s15}[[ 
]{.Apple-converted-space}│ \$ [      ]{.Apple-converted-space}│ Privacy,
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Local TTS [       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ offline[ 
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}├─────────────────────────────────────────────────────────────────┤
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Apple Speech[     
]{.Apple-converted-space}│ \~200ms[  ]{.Apple-converted-space}│
]{.s1}[★★★☆☆]{.s15}[[  ]{.Apple-converted-space}│ Free[   
]{.Apple-converted-space}│ On-device, [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ (on-device) [     
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}│ [        ]{.Apple-converted-space}│ fallback
[    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ARCHITECTURE: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}iOS App[     
                ]{.Apple-converted-space}Voice Gateway [               
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}──────── [   
                ]{.Apple-converted-space}───────────── [               
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┌─────────┐[ 
                ]{.Apple-converted-space}┌─────────────────┐ [         
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Mic [  ]{.Apple-converted-space}│ ──── Audio
────▶ │[  ]{.Apple-converted-space}STT Provider [ 
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}└─────────┘[ 
  ]{.Apple-converted-space}(WebSocket) [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Realtime API) │ [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}└────────┬────────┘ [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
]{.Apple-converted-space}│[                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
]{.Apple-converted-space}▼ Transcript [           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}┌─────────────────┐ [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Orchestrator[ 
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}(NLU + Agent[ 
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}│[    ]{.Apple-converted-space}Routing) [   
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}└────────┬────────┘ [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
]{.Apple-converted-space}│[                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
]{.Apple-converted-space}▼ Response [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}┌─────────┐[ 
                ]{.Apple-converted-space}┌─────────────────┐ [         
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Speaker │
◀── Audio ────── │[  ]{.Apple-converted-space}TTS Provider [ 
]{.Apple-converted-space}│ [              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}└─────────┘[ 
  ]{.Apple-converted-space}(Streaming) [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Realtime API) │ [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                             
]{.Apple-converted-space}└─────────────────┘ [             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CAPABILITIES: [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. STREAMING STT[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Real-time transcription as user
speaks [                          ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• End-of-speech detection[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Interim results for UI feedback[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Noise cancellation / car environment
optimization[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. STREAMING TTS[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Start speaking before full response
generated[                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Natural prosody and intonation [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Interruptible (user can cut in)[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Voice customization (speed, pitch) [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. CONVERSATION MANAGEMENT[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Turn-taking logic[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Context window management[           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Multi-turn conversation state[       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Graceful interruption handling [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. FALLBACK HANDLING[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Network degradation → switch to
on-device[                        ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• High latency → skip TTS, show text [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Provider failure → automatic
failover[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}RECOMMENDED ARCHITECTURE: [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRIMARY: OpenAI Realtime API[             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Single WebSocket connection for STT +
LLM + TTS [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Lowest latency, most natural[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Function calling for agent routing[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}FALLBACK 1: Deepgram + Custom LLM +
ElevenLabs[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• If OpenAI is down or slow [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• More control over each component[       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}FALLBACK 2: Apple Speech (on-device)[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• If network is unavailable [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Limited to cached responses / simple
queries[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OPENAI REALTIME INTEGRATION:[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}The Realtime API provides:[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• WebSocket connection with audio
streaming [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Built-in voice activity detection [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Function calling (tools) for agent
integration[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Natural conversation with interruption
support[                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Example tool definitions: [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"tools\": \[[                         
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"type\": \"function\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"get_route_weather\",[   
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Get weather along
a travel route\", [            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"parameters\": { [                 
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"type\": \"object\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"properties\": { [               
                              ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}\"destination\": { \"type\":
\"string\" },[                        ]{.Apple-converted-space}│]{.s1}

[│[            ]{.Apple-converted-space}\"departure_time\": { \"type\":
\"string\" }[                      ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}} [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}} [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"type\": \"function\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\":
\"get_departure_recommendation\", [                       
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Get optimal
departure time\",[                    ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"parameters\": {\...} [           
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"type\": \"function\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"name\": \"set_reminder\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"description\": \"Set a departure
reminder\",[                      ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"parameters\": {\...} [           
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\] [                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}When user says \"What\'s my commute
weather?\":[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. Realtime API transcribes and
understands intent[                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. Calls get_route_weather function [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. Voice Gateway executes against
Orchestrator[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. Returns data to Realtime API [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}5. Realtime API synthesizes natural
response[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}6. Audio streams back to user [           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[7. Pattern Learning Agent]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}PATTERN LEARNING AGENT [                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PURPOSE: Learn user travel patterns over
time to improve[              ]{.Apple-converted-space}│]{.s1}

[│ [          ]{.Apple-converted-space}predictions and provide
personalized suggestions.[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}DATA COLLECTED (with user consent): [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Trip history: origin, destination, mode,
time, duration [            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather conditions during trips [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Departure time choices (early, on-time,
late) [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Transport mode choices per condition[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Alert interactions (acted on, dismissed,
snoozed) [                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PATTERNS DETECTED:[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. COMMUTE SCHEDULE [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Typical departure times per day of
week[                          ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Work-from-home days[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Flexible vs. rigid meeting days[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. TRANSPORT PREFERENCES[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Weather conditions that trigger mode
switch[                      ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Temperature comfort range for biking
[                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Rain tolerance [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Preferred biking days[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. ROUTE PREFERENCES[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Preferred routes per destination [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Alternate routes used during
weather/traffic [                    ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Avoided roads/areas[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}4. ALERT PREFERENCES[                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Types of alerts user acts on [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Preferred notification times [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}• Dismissed alert patterns [           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRIVACY DESIGN: [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Patterns aggregated, not raw trips[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• User can view all learned patterns[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Forget\" button clears specific
patterns[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• \"Reset all\" clears everything [       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Export data in standard format[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Patterns stay on-device when possible [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ [  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}EXAMPLE LEARNED PREFERENCES:[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"user_id\": \"\...\", [               
                                  ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"patterns\": { [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"commute\": {[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"work_days\": \[\"mon\", \"tue\",
\"wed\", \"thu\", \"fri\"\], [             
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"typical_departure_am\": \"8:15\",
[                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"typical_departure_pm\":
\"17:45\",[                               
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"wfh_days\": \[\"wed\"\],[         
                                  ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"flexible_arrival\": false [       
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"transport\": {[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"default_mode\": \"car\",[         
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"bike_days\": \[\"tue\",
\"thu\"\],[                                   
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"bike_temp_min\": 55,[             
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"bike_temp_max\": 85,[             
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"rain_tolerance\": \"none\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"wind_tolerance\": 15[             
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"alerts\": { [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"morning_check_time\": \"7:30\", [ 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"evening_check_time\": \"16:00\",[ 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"acted_on_departure_alerts\":
0.85,[                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"dismissed_bike_suggestions\":
0.30[                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Data Flow Examples (continued)]{.s3}

[Example 1: \"What\'s my commute weather?\"]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}FLOW: COMMUTE WEATHER QUERY[             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}USER: \"What\'s my commute weather?\"[   
                                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 1: Request arrives at
Orchestrator[                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ { [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"type\":
\"voice_query\",[                                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}\"transcript\": \"What\'s my commute
weather?\", [                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"user_id\":
\"user_123\",[                                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"context\":
{ \"time\": \"8:15 AM\", \"day\": \"Tuesday\" }[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 2: Orchestrator parses intent +
loads context [              ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Intent: route_weather [                 
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Destination: (not specified) → infer
from time [                  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Time: 8:15 AM Tuesday → likely going to
work [                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Load user data: [                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}home: { lat:
37.7749, lng: -122.4194 } [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}work: { lat:
37.3861, lng: -122.0839 } [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 3: Parallel agent calls[           
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐[ 
]{.Apple-converted-space}┌─────────────────┐ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Traffic
Agent [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ Weather
Agent [  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
Calendar Agent[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ GET
route_time[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ GET
route\_[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
GET next_event[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ origin:
home[    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}forecast[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ time_range: [    ]{.Apple-converted-space}│
[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ dest:
work[      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│
waypoints: \[..\] │[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}next 3 hours[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ depart: now
[    ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [         
      ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}└────────┬────────┘[ 
]{.Apple-converted-space}└────────┬────────┘ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [          ]{.Apple-converted-space}│[ 
                  ]{.Apple-converted-space}│[                   
]{.Apple-converted-space}│[            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [          ]{.Apple-converted-space}▼[ 
                  ]{.Apple-converted-space}▼[                   
]{.Apple-converted-space}▼[            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}duration: 28
min [    ]{.Apple-converted-space}forecasts: \[\...\][     
]{.Apple-converted-space}event: 10am mtg [   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}traffic:
moderate[    ]{.Apple-converted-space}rain at 9:15[         
]{.Apple-converted-space}location: office[   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 4: Route Intel Agent combines
data[                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Input: traffic + weather + calendar [   
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Analysis: [                             
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- 28 min
drive, depart 8:15 → arrive 8:43[                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Rain
starts 9:15 on I-280 [                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- User will
be past rain zone by 8:50[                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- 10am
meeting gives flexibility[                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Output: [                               
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ { [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}\"timeline\": \[ [                             
                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{
\"time\": \"8:15\", \"weather\": \"clear\", \"temp\": 58 },[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{
\"time\": \"8:43\", \"weather\": \"clear\", \"temp\": 60 } [         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\],[       
                                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"alert\":
null,[                                                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"summary\":
\"Clear entire route if leaving now\" [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 5: Orchestrator synthesizes
response[                        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ LLM prompt: [                           
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"Generate
concise voice response for commute weather. [         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}Data:
{route_intel_output} [                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}Context:
morning, going to work, user prefers brevity\" [       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Response: [                             
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"Clear
skies the whole way. 58 degrees now, 28 minutes[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}to work. If
you leave in the next hour, you\'ll beat the[       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[    ]{.Apple-converted-space}rain that
starts around 9:15.\" [                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 6: Response streamed to client[   
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ { [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"type\":
\"voice_response\", [                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"text\":
\"Clear skies the whole way\...\", [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}\"audio_url\": \"wss://voice\.../stream\", [   
                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"data\": {
[                                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}\"route_weather\": {\...}, [                   
                  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}\"suggested_actions\": \[\"start_navigation\",
\"set_reminder\"\] [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}} [         
                                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TOTAL LATENCY: \~800ms (parallel calls +
LLM synthesis)[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Example 2: Proactive Alert Generation]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}FLOW: PROACTIVE RAIN ALERT [             
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TRIGGER: Weather Agent detects incoming
rain on monitored route [      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 1: Weather Agent continuous
monitoring[                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Every 5 minutes:[                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Fetch
nowcast for user\'s common routes [                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Compare to
previous forecast[                                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Detect
significant changes[                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Detection:[                             
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ { [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"type\":
\"weather_change\", [                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"route\":
\"home_to_work\",[                                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"change\":
\"rain_incoming\",[                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"eta\":
\"25 minutes\",[                                           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}\"affected_segment\": \"I-280 between Daly City
and San Mateo\"[    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 2: Route Intel Agent evaluates
impact [                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Questions answered: [                   
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Is user
likely to travel this route soon?[                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- What\'s
the optimal departure window? [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- How severe
is the weather? [                                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Analysis: [                             
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Time: 8:45
AM, user typically leaves 8:15-8:30 [             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Rain ETA:
9:10 AM [                                           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Window:
Leave in next 15 min to beat rain[                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Severity:
Moderate (not severe enough to delay)[             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Decision: SEND ALERT[                   
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 3: Pattern Agent checks user
preferences[                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User patterns:[                         
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Rain
tolerance: LOW [                                         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Acted on
85% of departure alerts [                           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Prefers
morning alerts before 9am[                           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Notification settings:[                 
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Push
notifications: ENABLED [                                 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Sound:
ENABLED[                                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}- Quiet
hours: OFF (it\'s 8:45 AM)[                             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ Decision: PROCEED WITH NOTIFICATION [   
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 4: Orchestrator generates
notification[                      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ { [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"type\":
\"push_notification\",[                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"title\":
\"Rain starting on your route\", [                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"body\":
\"Leave in the next 15 min to stay dry, [               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[            ]{.Apple-converted-space}or
wait until after 10am.\",[                           
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"actions\":
\[[                                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{ \"id\":
\"navigate\", \"label\": \"Start Navigation\" }, [         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{ \"id\":
\"remind_10\", \"label\": \"Remind in 10 min\" },[         
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{ \"id\":
\"dismiss\", \"label\": \"Dismiss\" }[                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\],[       
                                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}\"data\": {
[                                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}\"alert_type\": \"departure_window\", [       
                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}\"destination\": \"work\",[                   
                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [   
]{.Apple-converted-space}\"window_closes\": \"9:00 AM\"[               
                    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}} [         
                                                   
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ } [                                     
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 5: Notification delivered via
APNs[                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ User sees on lock screen: [             
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
┌────────────────────────────────────────────────────────────┐ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ ]{.s1}[🌤️]{.s12}[ LiquidCrypto [     
                        ]{.Apple-converted-space}8:45 AM[     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Rain starting on your route[         
                      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ Leave in the next 15 min to stay
dry,[                      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ or wait until after 10am.[           
                      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │[                                     
                      ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ │ \[ Start Navigation \] \[ Remind in 10
min \][                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│
└────────────────────────────────────────────────────────────┘ [ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌──────────────────────────────────────────────────────────────────┐[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ STEP 6: Track user response for learning
[                        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ If user taps \"Start Navigation\": [   
                            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}→ Record:
acted_on_departure_alert = true[                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}→ Start
navigation flow[                                       
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ If user taps \"Remind in 10 min\": [   
                            ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}→ Schedule
follow-up notification [                             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}→ Record:
snoozed_alert = true [                               
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                                       
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ If user dismisses or ignores:[         
                          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}→ Record:
dismissed_alert = true [                             
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}→ Don\'t
resend same alert[                                     
]{.Apple-converted-space}│[  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└──────────────────────────────────────────────────────────────────┘[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[API Contracts]{.s3}

[Orchestrator REST API]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}ORCHESTRATOR API [                       
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}BASE URL: https://api.liquidcrypto.app/v1
[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}AUTHENTICATION [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Header: Authorization: Bearer
\<jwt_token\> [                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}═══════════════════════════════════════════════════════════════════
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}ENDPOINTS[                               
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}POST /route/weather [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Get weather along a route.[               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Request:[                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"origin\": { [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"type\": \"saved_location\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"id\": \"home\"[                     
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}},[                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"destination\": {[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"type\": \"saved_location\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"id\": \"work\"[                     
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}},[                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"departure_time\":
\"2026-01-20T08:30:00-08:00\",[                     
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"transport_mode\": \"car\" [           
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Response: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"route\": {[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"distance_miles\": 32, [             
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"duration_minutes\": 45, [           
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"polyline\":
\"encoded_polyline_string\" [                           
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}},[                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"weather_timeline\": \[ [             
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"time\":
\"2026-01-20T08:30:00-08:00\",[                           
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"location\": { \"lat\": 37.77,
\"lng\": -122.41 }, [                  ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"condition\": \"clear\", [         
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"temp_f\": 58, [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"precip_probability\": 0 [         
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"time\":
\"2026-01-20T08:55:00-08:00\",[                           
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"location\": { \"lat\": 37.55,
\"lng\": -122.27 }, [                  ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"condition\": \"rain\",[           
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"temp_f\": 54, [                   
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"precip_probability\": 85, [       
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"precip_intensity\": \"moderate\"[ 
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\],[                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"transitions\": \[[                   
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"time\":
\"2026-01-20T08:50:00-08:00\",[                           
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"from\": \"clear\",[               
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"to\": \"rain\", [                 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"location_description\": \"I-280
near Daly City\"[                  ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\],[                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"summary\": \"Rain starting mid-route
around 8:50 AM\" [                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}POST /route/optimize-departure[           
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Get optimal departure time
recommendations. [                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Request:[                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"origin\": { \"type\":
\"saved_location\", \"id\": \"home\" }, [             
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"destination\": { \"type\":
\"saved_location\", \"id\": \"work\" },[         
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"arrive_by\":
\"2026-01-20T10:00:00-08:00\", [                         
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"preferences\": {[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"avoid_rain\": true, [               
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"minimize_time\": false[             
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Response: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"options\": \[[                       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"departure_time\":
\"2026-01-20T08:15:00-08:00\",[                 
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"arrival_time\":
\"2026-01-20T09:00:00-08:00\",[                   
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"duration_minutes\": 45, [         
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"weather_score\": 10,[             
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"weather_summary\": \"Clear entire
route\",[                        ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"recommended\": true [             
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"departure_time\":
\"2026-01-20T09:15:00-08:00\",[                 
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"arrival_time\":
\"2026-01-20T10:00:00-08:00\",[                   
]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"duration_minutes\": 45, [         
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"weather_score\": 4, [             
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"weather_summary\": \"Rain on I-280
for 15 minutes\",[              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"recommended\": false[             
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\] [                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}POST /transport/compare [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Compare transport modes for a trip. [     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Request:[                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"origin\": { \"type\":
\"saved_location\", \"id\": \"home\" }, [             
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"destination\": { \"type\":
\"saved_location\", \"id\": \"work\" },[         
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"departure_time\":
\"2026-01-20T08:30:00-08:00\",[                     
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"modes\": \[\"car\", \"bike\",
\"transit\"\] [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Response: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"comparisons\": \[[                   
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"mode\": \"car\",[                 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"duration_minutes\": 45, [         
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"weather_suitability\": \"good\",[ 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"conditions\": { \"rain_exposure\":
\"15 min mid-route\" } [          ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}},[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{ [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"mode\": \"bike\", [               
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"duration_minutes\": 55, [         
                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"weather_suitability\": \"poor\",[ 
                                ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"conditions\": { [                 
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"temp_f\": 58, [                 
                              ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"rain_exposure\": \"entire return
trip\",[                        ]{.Apple-converted-space}│]{.s1}

[│[          ]{.Apple-converted-space}\"wind\": \"8 mph headwind
return\" [                              ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}},[                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[        ]{.Apple-converted-space}\"recommendation\": \"Not
recommended due to afternoon rain\" [     
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}} [                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\],[                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"suggestion\": { [                     
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"mode\": \"car\",[                   
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"reason\": \"Afternoon rain makes
biking risky for return trip\" [    ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}POST /reminders [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Set a departure or condition-based
reminder.[                          ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Request (time-based): [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"departure\",[               
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"trigger\": {[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"type\": \"time\", [                 
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"time\":
\"2026-01-20T08:30:00-08:00\" [                             
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}},[                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"destination\": { \"type\":
\"saved_location\", \"id\": \"work\" } [         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Request (condition-based):[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"condition\",[               
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"trigger\": {[                         
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"type\": \"weather_change\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"condition\": \"rain_stops\",[       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"location\": { \"type\":
\"saved_location\", \"id\": \"current\" } [       
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Response: [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"reminder_id\": \"rem_abc123\",[       
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"status\": \"scheduled\",[             
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"estimated_trigger\":
\"2026-01-20T14:00:00-08:00\", [                 
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"message\": \"I\'ll alert you when the
rain stops\" [                    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WebSocket /voice[                         
                            ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Real-time voice interaction.[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Connection:
wss://api.liquidcrypto.app/v1/voice [                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Client → Server:[                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"audio_chunk\",[             
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"data\": \"base64_encoded_audio\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"format\": \"pcm_16khz\" [             
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Server → Client:[                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"transcript_partial\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"What\'s the weath\...\" [   
                                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"transcript_final\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"What\'s the weather for my
drive?\"[                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"response_audio\", [         
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"data\": \"base64_encoded_audio\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"Clear skies the whole
way\...\"[                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Infrastructure]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}DEPLOYMENT ARCHITECTURE[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [                       
]{.Apple-converted-space}CLOUDFLARE[                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• CDN for
static assets[                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• DDoS
protection[                                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Edge
caching for weather tiles [                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}• WebSocket
proxy[                                             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}RAILWAY / FLY.IO [                         
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────┐[ 
]{.Apple-converted-space}┌──────────────────┐ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Orchestrator [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Voice Gateway[ 
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}(Elysia/Bun) [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}(WebSocket)[   
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[         
        ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}2-4 instances[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}2-4 instances[ 
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}Auto-scaling [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}Sticky sessions│
[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────┘[ 
]{.Apple-converted-space}└──────────────────┘ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────┐[ 
]{.Apple-converted-space}┌──────────────────┐ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Weather Agent [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Traffic Agent [ 
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[         
        ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Background jobs │[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}On-demand calls │
[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}+ API handlers[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[                  ]{.Apple-converted-space}│
[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────┘[ 
]{.Apple-converted-space}└──────────────────┘ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────┐[ 
]{.Apple-converted-space}┌──────────────────┐ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Route Intel [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}Pattern Agent [ 
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Agent [          ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[                  ]{.Apple-converted-space}│
[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Background[      ]{.Apple-converted-space}│ [ 
                  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Compute-heavy [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}learning jobs [ 
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────┘[ 
]{.Apple-converted-space}└──────────────────┘ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}│[           
                              ]{.Apple-converted-space}│]{.s1}

[│[                              ]{.Apple-converted-space}▼[           
                              ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                     
]{.Apple-converted-space}DATA LAYER[                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────┐[ 
]{.Apple-converted-space}┌──────────────────┐ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[   
]{.Apple-converted-space}Supabase[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}Upstash [     
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}(PostgreSQL) [  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[    ]{.Apple-converted-space}(Redis) [     
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
      ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[         
        ]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• Users [        ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Sessions[     
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• Locations [    ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Weather cache │
[                    ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• Trip history[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Rate limits [ 
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• Patterns[      ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}│[  ]{.Apple-converted-space}• Pub/sub [     
]{.Apple-converted-space}│ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────┘[ 
]{.Apple-converted-space}└──────────────────┘ [                   
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}┌──────────────────┐ [                         
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Cloudflare R2 [  ]{.Apple-converted-space}│ [ 
                                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}(Object Store)[  ]{.Apple-converted-space}│ [ 
                                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[           
      ]{.Apple-converted-space}│ [                                     
    ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• Radar tiles [  ]{.Apple-converted-space}│ [ 
                                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• Audio cache [  ]{.Apple-converted-space}│ [ 
                                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}• User exports[  ]{.Apple-converted-space}│ [ 
                                        ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}└──────────────────┘ [                         
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}EXTERNAL SERVICES:[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• OpenAI Realtime API (voice) [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Tomorrow.io / NWS (weather) [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Google Maps Platform (routing/traffic)[ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• APNs (push notifications) [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Cost Estimates]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}MONTHLY COST PROJECTION (per 10,000 MAU)
[                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}INFRASTRUCTURE [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Railway/Fly.io hosting[         
]{.Apple-converted-space}\$50-100/month [                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Supabase (PostgreSQL) [         
]{.Apple-converted-space}\$25/month (Pro) [                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Upstash (Redis) [               
]{.Apple-converted-space}\$10/month [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Cloudflare (CDN + R2) [         
]{.Apple-converted-space}\$20/month [                           
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Subtotal: [                     
]{.Apple-converted-space}\~\$105-155/month [                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}API SERVICES [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────[                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OpenAI Realtime API [           
]{.Apple-converted-space}\$200-500/month[                       
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}(assuming 5 min voice/user/day) [       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Weather APIs [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}Tomorrow.io [                 
]{.Apple-converted-space}\$0-50/month (free tier + overage) [   
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}NWS/Open-Meteo[               
]{.Apple-converted-space}Free[                                 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Google Maps Platform[           
]{.Apple-converted-space}\$200-400/month[                       
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}(Routes API, \~50k requests) [         
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Subtotal: [                     
]{.Apple-converted-space}\~\$400-950/month [                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TOTAL:[                         
]{.Apple-converted-space}\~\$500-1100/month per 10k MAU[         
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Per-user cost:[                 
]{.Apple-converted-space}\$0.05-0.11/month[                     
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SCALING NOTES: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Voice is the biggest cost driver[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Caching weather aggressively reduces API
calls[                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Traffic API costs scale linearly with
active users[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Consider hybrid voice (on-device STT for
simple queries)[            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Summary]{.s3}

[This architecture provides:]{.s3}

1.  [Modular A2A agents that can be developed and scaled
    independently]{.s3}
2.  [Real-time voice with low latency via OpenAI Realtime or
    similar]{.s3}
3.  [Intelligent routing that combines weather, traffic, and
    calendar]{.s3}
4.  [Proactive alerts that learn user patterns over time]{.s3}
5.  [Privacy-conscious design with on-device processing where
    possible]{.s3}
6.  [Cost-effective scaling with aggressive caching]{.s3}

[The key innovation is the Route Intelligence Agent that creates the
weather×time×location intersection---something no existing app does
well.]{.s3}

[]{.s1}\

[What would you like me to dive deeper into next? Options:]{.s3}

1.  [Database schema for users, locations, patterns, trips]{.s3}
2.  [A2A protocol details for inter-agent communication]{.s3}
3.  [iOS app technical architecture (SwiftUI, CarPlay SDK
    integration)]{.s3}
4.  [Voice integration specifics (OpenAI Realtime setup, function
    calling)]{.s3}

[let\'s do 1,2 and then 3]{.s7}

[]{.s1}\

[Database Schema]{.s3}

[Overview]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}DATABASE ARCHITECTURE[                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PRIMARY: PostgreSQL (Supabase)[           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Relational data: users, locations,
trips, patterns[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Full-text search for location queries [ 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• PostGIS for geospatial queries[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Row-level security for multi-tenant
isolation [                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CACHE: Redis (Upstash)[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Session state [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Weather cache (high-frequency reads)[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Rate limiting [                         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Pub/sub for real-time updates [         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}OBJECT STORE: Cloudflare R2 [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Radar tile images [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Audio response cache[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• User data exports [                     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[PostgreSQL Schema]{.s3}

[Core Tables]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- USERS & AUTHENTICATION*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ users (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Authentication (Supabase Auth
integration)*]{.s1}

[[    ]{.Apple-converted-space}auth_id [       
]{.Apple-converted-space}UUID ]{.s1}[UNIQUE]{.s8}[
]{.s1}[REFERENCES]{.s8}[ auth.users(id),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Profile*]{.s1}

[[    ]{.Apple-converted-space}display_name[   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[100]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}email [         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[255]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}avatar_url[     
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}timezone[       
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'America/Los_Angeles\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Subscription*]{.s1}

[[    ]{.Apple-converted-space}subscription_tier [ 
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'free\']{.s10}[, ]{.s1}[*\-- free,
premium, pro*]{.s13}

[[    ]{.Apple-converted-space}subscription_expires_at
TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Settings*]{.s1}

[[    ]{.Apple-converted-space}units [         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[10]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'imperial\']{.s10}[, ]{.s1}[*\-- imperial,
metric*]{.s13}

[[    ]{.Apple-converted-space}voice_enabled [ 
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Metadata*]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}last_active_at[ 
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Soft delete*]{.s1}

[[    ]{.Apple-converted-space}deleted_at[     
]{.Apple-converted-space}TIMESTAMPTZ]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_users_auth_id ]{.s1}[ON]{.s8}[
users(auth_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_users_email ]{.s1}[ON]{.s8}[
users(email);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- DEVICES & SESSIONS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ devices (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Device info*]{.s1}

[[    ]{.Apple-converted-space}device_type [   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[, ]{.s1}[*\-- iphone, watch,
carplay*]{.s13}

[[    ]{.Apple-converted-space}device_name [   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[100]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}device_token[   
]{.Apple-converted-space}]{.s6}[TEXT]{.s8}[, ]{.s6}[*\-- APNs token for
push notifications*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Capabilities*]{.s1}

[[    ]{.Apple-converted-space}supports_carplay[   
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}supports_voice[     
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}supports_location [ 
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Status*]{.s1}

[[    ]{.Apple-converted-space}last_seen_at[   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}app_version [   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}os_version[     
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_devices_user_id ]{.s1}[ON]{.s8}[
devices(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_devices_token ]{.s1}[ON]{.s8}[
devices(device_token);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- LOCATIONS (Saved Places)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ EXTENSION ]{.s1}[IF]{.s8}[ ]{.s1}[NOT]{.s9}[
]{.s1}[EXISTS]{.s8}[ postgis;]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ locations (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Location data*]{.s1}

[[    ]{.Apple-converted-space}name[           
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[100]{.s11}[)
]{.s6}[NOT]{.s9}[ ]{.s6}[NULL]{.s11}[, ]{.s6}[*\-- \"Home\", \"Work\",
\"Mom\'s House\"*]{.s1}

[[    ]{.Apple-converted-space}label [         
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[50]{.s11}[),
]{.s6}[*\-- home, work, gym, custom*]{.s1}

[[    ]{.Apple-converted-space}address [       
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Coordinates (PostGIS
point)*]{.s1}

[[    ]{.Apple-converted-space}coordinates [   
]{.Apple-converted-space}GEOGRAPHY(]{.s1}[POINT]{.s8}[,
]{.s1}[4326]{.s11}[) ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Extracted for easier
queries*]{.s1}

[[    ]{.Apple-converted-space}latitude[       
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[10]{.s11}[,
]{.s1}[8]{.s11}[) ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}longitude [     
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[11]{.s11}[,
]{.s1}[8]{.s11}[) ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Metadata*]{.s1}

[[    ]{.Apple-converted-space}place_id[       
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[255]{.s11}[),
]{.s1}[*\-- Google/Apple place ID*]{.s13}

[[    ]{.Apple-converted-space}icon[           
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[),
]{.s1}[*\-- emoji or icon name*]{.s13}

[[    ]{.Apple-converted-space}color [         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[7]{.s11}[),
]{.s1}[*\-- hex color*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Usage tracking*]{.s1}

[[    ]{.Apple-converted-space}visit_count [   
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[0]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}last_visited_at TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Ordering*]{.s1}

[[    ]{.Apple-converted-space}sort_order[     
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[0]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}is_favorite [   
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_locations_user_id
]{.s1}[ON]{.s8}[ locations(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_locations_coordinates
]{.s1}[ON]{.s8}[ locations ]{.s1}[USING]{.s8}[ GIST(coordinates);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_locations_label ]{.s1}[ON]{.s8}[
locations(user_id, label);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- ROUTES (Saved/Common Routes)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ routes (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Route definition*]{.s1}

[[    ]{.Apple-converted-space}name[           
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[100]{.s11}[),
]{.s6}[*\-- \"Commute to Work\", auto-generated if null*]{.s1}

[[    ]{.Apple-converted-space}origin_id [     
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ locations(id),]{.s1}

[[    ]{.Apple-converted-space}destination_id[ 
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ locations(id),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Route geometry (for weather
overlay)*]{.s1}

[[    ]{.Apple-converted-space}polyline[       
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[, ]{.s1}[*\-- Encoded
polyline*]{.s13}

[[    ]{.Apple-converted-space}distance_meters
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Typical durations by
mode*]{.s1}

[[    ]{.Apple-converted-space}typical_duration_car_minutes[   
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}typical_duration_bike_minutes [ 
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}typical_duration_walk_minutes [ 
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}typical_duration_transit_minutes
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Usage stats*]{.s1}

[[    ]{.Apple-converted-space}trip_count[     
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[0]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}last_used_at[   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Preferences for this
route*]{.s1}

[[    ]{.Apple-converted-space}preferred_mode[ 
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[),
]{.s6}[*\-- car, bike, walk, transit*]{.s1}

[[    ]{.Apple-converted-space}avoid_highways[ 
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}avoid_tolls [   
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_routes_user_id ]{.s1}[ON]{.s8}[
routes(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_routes_origin ]{.s1}[ON]{.s8}[
routes(origin_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_routes_destination
]{.s1}[ON]{.s8}[ routes(destination_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[UNIQUE]{.s8}[ ]{.s1}[INDEX]{.s8}[
idx_routes_unique_pair ]{.s1}[ON]{.s8}[ routes(user_id, origin_id,
destination_id);]{.s1}

[]{.s1}\

[Trip History]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- TRIPS (Historical Record)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ trips (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}route_id[       
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[ routes(id)
]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[ ]{.s1}[SET]{.s8}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Trip details*]{.s1}

[[    ]{.Apple-converted-space}origin_location_id[     
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[
locations(id),]{.s1}

[[    ]{.Apple-converted-space}destination_location_id UUID
]{.s1}[REFERENCES]{.s8}[ locations(id),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- If locations weren\'t
saved*]{.s1}

[[    ]{.Apple-converted-space}origin_coordinates[     
]{.Apple-converted-space}GEOGRAPHY(]{.s1}[POINT]{.s8}[,
]{.s1}[4326]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}destination_coordinates
GEOGRAPHY(]{.s1}[POINT]{.s8}[, ]{.s1}[4326]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}origin_address[         
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}destination_address [   
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Transport*]{.s1}

[[    ]{.Apple-converted-space}transport_mode[ 
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[)
]{.s6}[NOT]{.s9}[ ]{.s6}[NULL]{.s11}[, ]{.s6}[*\-- car, bike, walk,
transit*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Timing*]{.s1}

[[    ]{.Apple-converted-space}planned_departure_at[   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}actual_departure_at [   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}planned_arrival_at[     
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}actual_arrival_at [     
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Duration*]{.s1}

[[    ]{.Apple-converted-space}planned_duration_minutes
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}actual_duration_minutes[ 
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Distance*]{.s1}

[[    ]{.Apple-converted-space}distance_meters
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Status*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[status]{.s8}[[         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[
]{.s1}[\'planned\']{.s10}[,[ ]{.Apple-converted-space}]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\-- planned,
in_progress, completed, cancelled*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Source*]{.s1}

[[    ]{.Apple-converted-space}initiated_by[   
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[),
]{.s6}[*\-- user, proactive_alert, reminder*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trips_user_id ]{.s1}[ON]{.s8}[
trips(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trips_route_id ]{.s1}[ON]{.s8}[
trips(route_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trips_departure ]{.s1}[ON]{.s8}[
trips(user_id, actual_departure_at ]{.s1}[DESC]{.s8}[);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trips_status ]{.s1}[ON]{.s8}[
trips(user_id, ]{.s1}[status]{.s8}[);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- TRIP WEATHER (Weather conditions during trip)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ trip_weather (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}trip_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ trips(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Segment info*]{.s1}

[[    ]{.Apple-converted-space}segment_index [ 
]{.Apple-converted-space}]{.s6}[INTEGER]{.s8}[ ]{.s6}[NOT]{.s9}[
]{.s6}[NULL]{.s11}[, ]{.s6}[*\-- 0, 1, 2\... along route*]{.s1}

[[    ]{.Apple-converted-space}segment_start_coordinates
GEOGRAPHY(]{.s1}[POINT]{.s8}[, ]{.s1}[4326]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Weather at this
segment*]{.s1}

[[    ]{.Apple-converted-space}recorded_at [   
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}condition [     
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[50]{.s11}[),
]{.s6}[*\-- clear, cloudy, rain, snow, etc.*]{.s1}

[[    ]{.Apple-converted-space}temp_fahrenheit
]{.s1}[DECIMAL]{.s8}[(]{.s1}[5]{.s11}[, ]{.s1}[2]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}feels_like_fahrenheit
]{.s1}[DECIMAL]{.s8}[(]{.s1}[5]{.s11}[, ]{.s1}[2]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}humidity_percent
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}wind_speed_mph[ 
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[5]{.s11}[,
]{.s1}[2]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}wind_direction[ 
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[10]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}precip_probability
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}precip_intensity
]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[), ]{.s6}[*\-- none, light,
moderate, heavy*]{.s1}

[[    ]{.Apple-converted-space}visibility_miles
]{.s1}[DECIMAL]{.s8}[(]{.s1}[5]{.s11}[, ]{.s1}[2]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Was this forecast or
actual?*]{.s1}

[[    ]{.Apple-converted-space}data_type [     
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'forecast\']{.s10}[, ]{.s1}[*\-- forecast,
actual*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trip_weather_trip_id
]{.s1}[ON]{.s8}[ trip_weather(trip_id);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- TRIP EVENTS (Significant events during trip)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ trip_events (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}trip_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ trips(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}event_type[     
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\--
weather_change, traffic_slowdown, route_change,*]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\-- user_stop,
alert_shown, alert_acted_on*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}occurred_at [   
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}coordinates [   
]{.Apple-converted-space}GEOGRAPHY(]{.s1}[POINT]{.s8}[,
]{.s1}[4326]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Event details (JSON for
flexibility)*]{.s1}

[[    ]{.Apple-converted-space}details [       
]{.Apple-converted-space}JSONB,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trip_events_trip_id
]{.s1}[ON]{.s8}[ trip_events(trip_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_trip_events_type ]{.s1}[ON]{.s8}[
trip_events(event_type);]{.s1}

[]{.s1}\

[User Preferences & Patterns]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- USER PREFERENCES*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ user_preferences (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[UNIQUE]{.s8}[ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[ ]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[
]{.s1}[DELETE]{.s8}[ ]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Transport preferences*]{.s1}

[[    ]{.Apple-converted-space}default_transport_mode[ 
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'car\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}enabled_transport_modes
]{.s1}[VARCHAR]{.s8}[(]{.s1}[100]{.s11}[) ]{.s1}[DEFAULT]{.s8}[
]{.s1}[\'car,bike,walk,transit\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Weather preferences*]{.s1}

[[    ]{.Apple-converted-space}rain_tolerance[         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'low\']{.s10}[, ]{.s1}[*\-- none, low,
medium, high*]{.s13}

[[    ]{.Apple-converted-space}temp_min_comfortable_f[ 
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[55]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}temp_max_comfortable_f[ 
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[85]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}wind_max_comfortable_mph
]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[ ]{.s1}[15]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Bike-specific*]{.s1}

[[    ]{.Apple-converted-space}bike_rain_ok[           
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}bike_night_ok [         
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}bike_hills_ok [         
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Notification
preferences*]{.s1}

[[    ]{.Apple-converted-space}notifications_enabled [ 
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}notify_departure_window
]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[ ]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}notify_weather_change [ 
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}notify_opportunities[   
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[, ]{.s1}[*\-- \"great day to bike!\"*]{.s13}

[[    ]{.Apple-converted-space}notify_tomorrow_preview
]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[ ]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Quiet hours*]{.s1}

[[    ]{.Apple-converted-space}quiet_hours_enabled [   
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}quiet_hours_start [     
]{.Apple-converted-space}]{.s1}[TIME]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[\'22:00\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}quiet_hours_end [       
]{.Apple-converted-space}]{.s1}[TIME]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[\'07:00\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Voice preferences*]{.s1}

[[    ]{.Apple-converted-space}voice_speed [           
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[3]{.s11}[,
]{.s1}[2]{.s11}[) ]{.s1}[DEFAULT]{.s8}[ ]{.s1}[1.0]{.s11}[, ]{.s1}[*\--
0.5 to 2.0*]{.s13}

[[    ]{.Apple-converted-space}voice_style [           
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'concise\']{.s10}[, ]{.s1}[*\-- concise,
detailed*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Privacy*]{.s1}

[[    ]{.Apple-converted-space}share_anonymous_data[   
]{.Apple-converted-space}]{.s6}[BOOLEAN]{.s8}[ ]{.s6}[DEFAULT]{.s8}[
]{.s6}[true]{.s11}[, ]{.s6}[*\-- for traffic/pattern improvements*]{.s1}

[[    ]{.Apple-converted-space}store_trip_history[     
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[true]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- LEARNED PATTERNS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ user_patterns (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}pattern_type[   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\--
commute_schedule,
transport_preference,[ ]{.Apple-converted-space}*]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\--
route_preference, alert_response*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Pattern data (flexible JSON
structure)*]{.s1}

[[    ]{.Apple-converted-space}pattern_data[   
]{.Apple-converted-space}JSONB ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Confidence and recency*]{.s1}

[[    ]{.Apple-converted-space}confidence[     
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[3]{.s11}[,
]{.s1}[2]{.s11}[) ]{.s1}[DEFAULT]{.s8}[ ]{.s1}[0.5]{.s11}[, ]{.s1}[*\--
0.0 to 1.0*]{.s13}

[[    ]{.Apple-converted-space}sample_size [   
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[0]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}last_updated_at TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Pattern validity*]{.s1}

[[    ]{.Apple-converted-space}valid_from[     
]{.Apple-converted-space}]{.s6}[DATE]{.s8}[, ]{.s6}[*\-- for seasonal
patterns*]{.s1}

[[    ]{.Apple-converted-space}valid_until [   
]{.Apple-converted-space}]{.s1}[DATE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}day_of_week [   
]{.Apple-converted-space}]{.s6}[INTEGER]{.s8}[\[\], ]{.s6}[*\--
0=Sunday, 1=Monday, etc.*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_user_patterns_user_id
]{.s1}[ON]{.s8}[ user_patterns(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_user_patterns_type
]{.s1}[ON]{.s8}[ user_patterns(user_id, pattern_type);]{.s1}

[]{.s1}\

[*\-- Example pattern_data structures:*]{.s1}

[*\--*]{.s1}

[*\-- commute_schedule:*]{.s1}

[*\-- {*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"work_days\": \[1, 2, 3, 4,
5\],*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"typical_departure_to_work\":
\"08:15\",*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"typical_departure_to_home\":
\"17:45\",*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"wfh_days\": \[3\],*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"departure_variance_minutes\":
15*]{.s1}

[*\-- }*]{.s1}

[*\--*]{.s1}

[*\-- transport_preference:*]{.s1}

[*\-- {*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"route_id\": \"uuid\",*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"mode_distribution\": {\"car\": 0.7,
\"bike\": 0.25, \"transit\": 0.05},*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"bike_conditions\": {*]{.s1}

[*\-- [    ]{.Apple-converted-space}\"temp_min\": 55,*]{.s1}

[*\-- [    ]{.Apple-converted-space}\"temp_max\": 80,*]{.s1}

[*\-- [    ]{.Apple-converted-space}\"max_precip_prob\": 10,*]{.s1}

[*\-- [    ]{.Apple-converted-space}\"max_wind_mph\": 12*]{.s1}

[*\-- [  ]{.Apple-converted-space}}*]{.s1}

[*\-- }*]{.s1}

[*\--*]{.s1}

[*\-- alert_response:*]{.s1}

[*\-- {*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"departure_alerts_acted_on\":
0.85,*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"departure_alerts_dismissed\":
0.10,*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"departure_alerts_snoozed\":
0.05,*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"bike_suggestions_accepted\":
0.30,*]{.s1}

[*\-- [  ]{.Apple-converted-space}\"preferred_alert_lead_time_minutes\":
20*]{.s1}

[*\-- }*]{.s1}

[]{.s1}\

[Reminders & Alerts]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- REMINDERS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ reminders (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Reminder type*]{.s1}

[[    ]{.Apple-converted-space}reminder_type [ 
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\-- departure,
condition_based, recurring*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Trigger configuration*]{.s1}

[[    ]{.Apple-converted-space}trigger_config[ 
]{.Apple-converted-space}JSONB ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Examples:*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- {\"type\": \"time\",
\"time\": \"2026-01-20T08:30:00-08:00\"}*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- {\"type\": \"condition\",
\"condition\": \"rain_stops\", \"location_id\": \"uuid\"}*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- {\"type\": \"recurring\",
\"days\": \[1,2,3,4,5\], \"time\": \"08:00\"}*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Associated
trip/destination*]{.s1}

[[    ]{.Apple-converted-space}destination_id[ 
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[
locations(id),]{.s1}

[[    ]{.Apple-converted-space}route_id[       
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[ routes(id),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Reminder content*]{.s1}

[[    ]{.Apple-converted-space}title [         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[255]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}message [       
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Status*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[status]{.s1}[[         
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s1}[(]{.s6}[20]{.s11}[)
]{.s6}[DEFAULT]{.s1}[ ]{.s6}[\'active\']{.s10}[,]{.s6}

[[                    ]{.Apple-converted-space}]{.s6}[*\-- active,
triggered, completed, cancelled, expired*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Timing*]{.s1}

[[    ]{.Apple-converted-space}scheduled_for [ 
]{.Apple-converted-space}TIMESTAMPTZ, ]{.s1}[*\-- when we expect to
trigger*]{.s13}

[[    ]{.Apple-converted-space}triggered_at[   
]{.Apple-converted-space}TIMESTAMPTZ, ]{.s1}[*\-- when actually
triggered*]{.s13}

[[    ]{.Apple-converted-space}expires_at[     
]{.Apple-converted-space}TIMESTAMPTZ, ]{.s6}[*\-- auto-cancel if not
triggered by this time*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Response tracking*]{.s1}

[[    ]{.Apple-converted-space}user_response [ 
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[),
]{.s6}[*\-- acted, dismissed, snoozed*]{.s1}

[[    ]{.Apple-converted-space}response_at [   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_reminders_user_id
]{.s1}[ON]{.s8}[ reminders(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_reminders_status ]{.s1}[ON]{.s8}[
reminders(]{.s1}[status]{.s8}[, scheduled_for);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_reminders_scheduled
]{.s1}[ON]{.s8}[
reminders(scheduled_for)[ ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[WHERE]{.s1}[ ]{.s6}[status]{.s1}[
]{.s6}[=]{.s9}[ ]{.s6}[\'active\']{.s10}[;]{.s6}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- ALERTS (System-generated proactive notifications)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ alerts (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Alert type*]{.s1}

[[    ]{.Apple-converted-space}alert_type[     
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\--
departure_window, weather_change, opportunity,*]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\--
severe_weather, tomorrow_preview*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Priority*]{.s1}

[[    ]{.Apple-converted-space}priority[       
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[)
]{.s6}[DEFAULT]{.s8}[ ]{.s6}[\'normal\']{.s10}[, ]{.s6}[*\-- low,
normal, high, urgent*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Content*]{.s1}

[[    ]{.Apple-converted-space}title [         
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[255]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}body[           
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Rich data for app
display*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[data]{.s8}[[           
]{.Apple-converted-space}JSONB,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Example:*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[*\-- {*]{.s13}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"route_id\": \"uuid\",*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"weather_summary\": \"Rain starting at
9:15\",*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"recommended_action\": \"leave_now\",*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"window_closes_at\":
\"2026-01-20T09:00:00-08:00\"*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[*\-- }*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Delivery*]{.s1}

[[    ]{.Apple-converted-space}delivery_status
]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[) ]{.s1}[DEFAULT]{.s8}[
]{.s1}[\'pending\']{.s10}[,]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*\-- pending,
sent, delivered, failed*]{.s1}

[[    ]{.Apple-converted-space}sent_at [       
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}delivered_at[   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- User interaction*]{.s1}

[[    ]{.Apple-converted-space}read_at [       
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}user_response [ 
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[),
]{.s6}[*\-- acted, dismissed, snoozed*]{.s1}

[[    ]{.Apple-converted-space}response_at [   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Prevent duplicates*]{.s1}

[[    ]{.Apple-converted-space}dedup_key [     
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[255]{.s11}[),
]{.s6}[*\-- unique key to prevent repeat alerts*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Expiration*]{.s1}

[[    ]{.Apple-converted-space}expires_at[     
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_alerts_user_id ]{.s1}[ON]{.s8}[
alerts(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_alerts_pending ]{.s1}[ON]{.s8}[
alerts(delivery_status, created_at)[ ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[WHERE]{.s8}[ delivery_status
]{.s1}[=]{.s9}[ ]{.s1}[\'pending\']{.s10}[;]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_alerts_dedup ]{.s1}[ON]{.s8}[
alerts(user_id, dedup_key);]{.s1}

[]{.s1}\

[Calendar Integration]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- CALENDAR CONNECTIONS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ calendar_connections (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Provider*]{.s1}

[[    ]{.Apple-converted-space}provider[       
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[)
]{.s6}[NOT]{.s9}[ ]{.s6}[NULL]{.s11}[, ]{.s6}[*\-- apple, google,
microsoft*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- OAuth tokens
(encrypted)*]{.s1}

[[    ]{.Apple-converted-space}access_token[   
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}refresh_token [ 
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}token_expires_at TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Scope*]{.s1}

[[    ]{.Apple-converted-space}calendars_synced
]{.s6}[VARCHAR]{.s8}[(]{.s6}[255]{.s11}[)\[\], ]{.s6}[*\-- list of
calendar IDs to sync*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Sync status*]{.s1}

[[    ]{.Apple-converted-space}last_synced_at[ 
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}sync_status [   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'active\']{.s10}[, ]{.s1}[*\-- active,
error, disabled*]{.s13}

[[    ]{.Apple-converted-space}sync_error[     
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_calendar_connections_user
]{.s1}[ON]{.s8}[ calendar_connections(user_id);]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- CALENDAR EVENTS (Cached for quick access)*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ calendar_events (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}connection_id [ 
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ calendar_connections(id) ]{.s1}[ON]{.s8}[
]{.s1}[DELETE]{.s8}[ ]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- External reference*]{.s1}

[[    ]{.Apple-converted-space}external_id [   
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[255]{.s11}[)
]{.s6}[NOT]{.s9}[ ]{.s6}[NULL]{.s11}[, ]{.s6}[*\-- ID from calendar
provider*]{.s1}

[[    ]{.Apple-converted-space}calendar_id [   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[255]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Event basics (we only store
what we need)*]{.s1}

[[    ]{.Apple-converted-space}title [         
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[255]{.s11}[),
]{.s6}[*\-- may be null for privacy*]{.s1}

[[    ]{.Apple-converted-space}starts_at [     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}ends_at [       
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}is_all_day[     
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Location (extracted for
travel planning)*]{.s1}

[[    ]{.Apple-converted-space}location_text [ 
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}location_coordinates
GEOGRAPHY(]{.s1}[POINT]{.s8}[, ]{.s1}[4326]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}is_virtual[     
]{.Apple-converted-space}]{.s6}[BOOLEAN]{.s8}[, ]{.s6}[*\-- detected
from Zoom/Meet links*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Travel relevance*]{.s1}

[[    ]{.Apple-converted-space}requires_travel ]{.s6}[BOOLEAN]{.s8}[,
]{.s6}[*\-- true if has physical location*]{.s1}

[[    ]{.Apple-converted-space}travel_time_minutes
]{.s6}[INTEGER]{.s8}[, ]{.s6}[*\-- estimated from user\'s
location*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Recurrence*]{.s1}

[[    ]{.Apple-converted-space}is_recurring[   
]{.Apple-converted-space}]{.s1}[BOOLEAN]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[false]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}recurrence_rule ]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Sync metadata*]{.s1}

[[    ]{.Apple-converted-space}synced_at [     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_calendar_events_user
]{.s1}[ON]{.s8}[ calendar_events(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_calendar_events_time
]{.s1}[ON]{.s8}[ calendar_events(user_id, starts_at);]{.s1}

[CREATE]{.s8}[ ]{.s1}[UNIQUE]{.s8}[ ]{.s1}[INDEX]{.s8}[
idx_calendar_events_external ]{.s1}[ON]{.s8}[
calendar_events(connection_id, external_id);]{.s1}

[]{.s1}\

[Conversation & Voice]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- CONVERSATION SESSIONS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ conversation_sessions (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id) ]{.s1}[ON]{.s8}[ ]{.s1}[DELETE]{.s8}[
]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}device_id [     
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[
devices(id),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Session info*]{.s1}

[[    ]{.Apple-converted-space}started_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}ended_at[       
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Context (what we\'re talking
about)*]{.s1}

[[    ]{.Apple-converted-space}context [       
]{.Apple-converted-space}JSONB ]{.s1}[DEFAULT]{.s8}[
]{.s1}[\'{}\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Example:*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[*\-- {*]{.s13}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"current_destination\": \"work\",*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"current_time_ref\": \"tomorrow\",*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"current_mode\": \"bike\",*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- [ 
]{.Apple-converted-space}\"discussed_routes\": \[\"uuid1\",
\"uuid2\"\]*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[*\-- }*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Session type*]{.s1}

[[    ]{.Apple-converted-space}session_type[   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'voice\']{.s10}[, ]{.s1}[*\-- voice, text,
mixed*]{.s13}

[[    ]{.Apple-converted-space}interface [     
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[20]{.s11}[),
]{.s6}[*\-- ios_app, carplay, watch, widget*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Metrics*]{.s1}

[[    ]{.Apple-converted-space}turn_count[     
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[0]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}total_duration_seconds
]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[    ]{.Apple-converted-space}updated_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_conversation_sessions_user
]{.s1}[ON]{.s8}[ conversation_sessions(user_id);]{.s1}

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_conversation_sessions_active
]{.s1}[ON]{.s8}[ conversation_sessions(user_id,
ended_at)[ ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[WHERE]{.s8}[ ended_at
]{.s1}[IS]{.s9}[ ]{.s1}[NULL]{.s11}[;]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- CONVERSATION TURNS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ conversation_turns (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}session_id[     
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ conversation_sessions(id) ]{.s1}[ON]{.s8}[
]{.s1}[DELETE]{.s8}[ ]{.s1}[CASCADE]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Turn info*]{.s1}

[[    ]{.Apple-converted-space}turn_index[     
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[ ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}role[           
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[, ]{.s1}[*\-- user, assistant,
system*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Content*]{.s1}

[[    ]{.Apple-converted-space}content_text[   
]{.Apple-converted-space}]{.s6}[TEXT]{.s8}[, ]{.s6}[*\-- transcript or
response text*]{.s1}

[[    ]{.Apple-converted-space}content_audio_url ]{.s1}[TEXT]{.s8}[,
]{.s1}[*\-- S3/R2 URL if stored*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- For user turns*]{.s1}

[[    ]{.Apple-converted-space}intent_detected
]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}entities_extracted JSONB,]{.s1}

[[    ]{.Apple-converted-space}confidence[     
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[3]{.s11}[,
]{.s1}[2]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- For assistant turns*]{.s1}

[[    ]{.Apple-converted-space}agents_called [ 
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[255]{.s11}[)\[\],
]{.s6}[*\-- which agents were invoked*]{.s1}

[[    ]{.Apple-converted-space}response_data [ 
]{.Apple-converted-space}JSONB, ]{.s1}[*\-- structured data
returned*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- Timing*]{.s1}

[[    ]{.Apple-converted-space}started_at[     
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}ended_at[       
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}latency_ms[     
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}created_at[     
]{.Apple-converted-space}TIMESTAMPTZ ]{.s1}[DEFAULT]{.s8}[
]{.s1}[NOW]{.s9}[()]{.s1}

[);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[INDEX]{.s8}[ idx_conversation_turns_session
]{.s1}[ON]{.s8}[ conversation_turns(session_id);]{.s1}

[]{.s1}\

[]{.s1}\

[Redis Schema]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}REDIS KEY PATTERNS [                     
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SESSION STATE[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: session:{user_id}:{device_id}[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: Hash[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 30 minutes (refreshed on activity) [ 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Fields: [                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}conversation_id: \"uuid\" [             
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}context: \"{\...json\...}\" [           
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}last_activity: \"timestamp\"[           
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}interface: \"carplay\"[                 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}WEATHER CACHE[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: weather:point:{lat}:{lng}:{hour} [   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: String (JSON) [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 15 minutes [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Value:[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"temp_f\": 58, [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"condition\": \"clear\", [             
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"precip_prob\": 10,[                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"wind_mph\": 8,[                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"fetched_at\":
\"2026-01-20T08:00:00Z\"[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: weather:nowcast:{lat}:{lng}[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: String (JSON) [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 5 minutes[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Value:[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"timeline\": \[ [                     
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{\"minutes\": 0, \"precip_intensity\":
0},[                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{\"minutes\": 15,
\"precip_intensity\": 0.5}, [                       
]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}{\"minutes\": 30,
\"precip_intensity\": 2.1}[                         
]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\],[                                   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"fetched_at\":
\"2026-01-20T08:45:00Z\"[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key:
weather:route:{route_hash}:{departure_hour}[                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: String (JSON) [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 10 minutes [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TRAFFIC CACHE[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: traffic:route:{route_hash} [         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: String (JSON) [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 5 minutes[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Value:[                                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"duration_minutes\": 28, [             
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"duration_in_traffic_minutes\": 35,[   
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"congestion_level\": \"moderate\", [   
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"incidents\": \[\...\], [             
                                  ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"fetched_at\": \"\...\" [             
                                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}RATE LIMITING[                           
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: ratelimit:{user_id}:{endpoint} [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: String (counter)[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 60 seconds (sliding window)[         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: ratelimit:api:{provider} [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: String (counter)[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: varies by provider [                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}USER LOCATION (Real-time) [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────────── [               
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Key: location:{user_id} [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Type: Geo [                               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TTL: 10 minutes [                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Used for: proactive alerts based on
current position[                  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PUB/SUB CHANNELS [                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}────────────────[                         
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Channel: alerts:{user_id} [               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Purpose: Real-time alert delivery to
connected clients[                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Channel: weather:updates:{region} [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Purpose: Broadcast weather changes to
monitoring workers[              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Channel: voice:{session_id} [             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Purpose: Voice streaming coordination [   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[Database Migrations]{.s3}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- MIGRATION: 001_initial_schema*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*\-- Enable required extensions*]{.s1}

[CREATE]{.s8}[ EXTENSION ]{.s1}[IF]{.s8}[ ]{.s1}[NOT]{.s9}[
]{.s1}[EXISTS]{.s8}[ ]{.s1}[\"uuid-ossp\"]{.s10}[;]{.s1}

[CREATE]{.s8}[ EXTENSION ]{.s1}[IF]{.s8}[ ]{.s1}[NOT]{.s9}[
]{.s1}[EXISTS]{.s8}[ ]{.s1}[\"postgis\"]{.s10}[;]{.s1}

[CREATE]{.s8}[ EXTENSION ]{.s6}[IF]{.s8}[ ]{.s6}[NOT]{.s9}[
]{.s6}[EXISTS]{.s8}[ ]{.s6}[\"pg_trgm\"]{.s10}[; ]{.s6}[*\-- for fuzzy
text search*]{.s1}

[]{.s1}\

[*\-- Create all tables (as defined above)*]{.s1}

[*\-- \...*]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- ROW LEVEL SECURITY*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*\-- Enable RLS on all user-data tables*]{.s1}

[ALTER]{.s1}[ ]{.s6}[TABLE]{.s1}[ users ]{.s6}[ENABLE]{.s1}[
]{.s6}[ROW]{.s1}[ ]{.s6}[LEVEL]{.s1}[ SECURITY;]{.s6}

[ALTER]{.s1}[ ]{.s6}[TABLE]{.s1}[ devices ]{.s6}[ENABLE]{.s1}[
]{.s6}[ROW]{.s1}[ ]{.s6}[LEVEL]{.s1}[ SECURITY;]{.s6}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ locations ]{.s1}[ENABLE]{.s8}[
]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[ SECURITY;]{.s1}

[ALTER]{.s1}[ ]{.s6}[TABLE]{.s1}[ routes ]{.s6}[ENABLE]{.s1}[
]{.s6}[ROW]{.s1}[ ]{.s6}[LEVEL]{.s1}[ SECURITY;]{.s6}

[ALTER]{.s1}[ ]{.s6}[TABLE]{.s1}[ trips ]{.s6}[ENABLE]{.s1}[
]{.s6}[ROW]{.s1}[ ]{.s6}[LEVEL]{.s1}[ SECURITY;]{.s6}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ user_preferences ]{.s1}[ENABLE]{.s8}[
]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[ SECURITY;]{.s1}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ user_patterns ]{.s1}[ENABLE]{.s8}[
]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[ SECURITY;]{.s1}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ reminders ]{.s1}[ENABLE]{.s8}[
]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[ SECURITY;]{.s1}

[ALTER]{.s1}[ ]{.s6}[TABLE]{.s1}[ alerts ]{.s6}[ENABLE]{.s1}[
]{.s6}[ROW]{.s1}[ ]{.s6}[LEVEL]{.s1}[ SECURITY;]{.s6}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ calendar_connections
]{.s1}[ENABLE]{.s8}[ ]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[
SECURITY;]{.s1}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ calendar_events ]{.s1}[ENABLE]{.s8}[
]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[ SECURITY;]{.s1}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ conversation_sessions
]{.s1}[ENABLE]{.s8}[ ]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[
SECURITY;]{.s1}

[ALTER]{.s8}[ ]{.s1}[TABLE]{.s8}[ conversation_turns
]{.s1}[ENABLE]{.s8}[ ]{.s1}[ROW]{.s8}[ ]{.s1}[LEVEL]{.s8}[
SECURITY;]{.s1}

[]{.s1}\

[*\-- Policy: Users can only access their own data*]{.s1}

[CREATE]{.s8}[ POLICY users_own_data ]{.s1}[ON]{.s8}[ users]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[FOR]{.s8}[ ]{.s1}[ALL]{.s8}[
]{.s1}[USING]{.s8}[ (auth.uid() ]{.s1}[=]{.s9}[ auth_id);]{.s1}

[]{.s1}\

[CREATE]{.s8}[ POLICY devices_own_data ]{.s1}[ON]{.s8}[ devices]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[FOR]{.s8}[ ]{.s1}[ALL]{.s8}[
]{.s1}[USING]{.s8}[ (user_id ]{.s1}[=]{.s9}[ (]{.s1}[SELECT]{.s8}[ id
]{.s1}[FROM]{.s8}[ users ]{.s1}[WHERE]{.s8}[ auth_id ]{.s1}[=]{.s9}[
auth.uid()));]{.s1}

[]{.s1}\

[CREATE]{.s8}[ POLICY locations_own_data ]{.s1}[ON]{.s8}[
locations]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[FOR]{.s8}[ ]{.s1}[ALL]{.s8}[
]{.s1}[USING]{.s8}[ (user_id ]{.s1}[=]{.s9}[ (]{.s1}[SELECT]{.s8}[ id
]{.s1}[FROM]{.s8}[ users ]{.s1}[WHERE]{.s8}[ auth_id ]{.s1}[=]{.s9}[
auth.uid()));]{.s1}

[]{.s1}\

[*\-- \... similar policies for all tables*]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- FUNCTIONS & TRIGGERS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*\-- Auto-update updated_at timestamp*]{.s1}

[CREATE]{.s8}[ ]{.s1}[OR]{.s9}[ ]{.s1}[REPLACE]{.s8}[
]{.s1}[FUNCTION]{.s8}[ update_updated_at()]{.s1}

[RETURNS]{.s1}[ ]{.s6}[TRIGGER]{.s1}[ ]{.s6}[AS]{.s1}[ \$\$]{.s6}

[BEGIN]{.s1}

[[    ]{.Apple-converted-space}NEW.updated_at ]{.s1}[=]{.s9}[
]{.s1}[NOW]{.s9}[();]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[RETURN]{.s8}[ NEW;]{.s1}

[END]{.s1}[;]{.s6}

[\$\$ ]{.s1}[LANGUAGE]{.s8}[ plpgsql;]{.s1}

[]{.s1}\

[*\-- Apply to all tables with updated_at*]{.s1}

[CREATE]{.s8}[ ]{.s1}[TRIGGER]{.s8}[ update_users_updated_at]{.s1}

[[    ]{.Apple-converted-space}BEFORE ]{.s1}[UPDATE]{.s8}[
]{.s1}[ON]{.s8}[ users]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[FOR EACH ROW]{.s8}[
]{.s1}[EXECUTE]{.s8}[ ]{.s1}[FUNCTION]{.s8}[ update_updated_at();]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TRIGGER]{.s8}[ update_locations_updated_at]{.s1}

[[    ]{.Apple-converted-space}BEFORE ]{.s1}[UPDATE]{.s8}[
]{.s1}[ON]{.s8}[ locations]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[FOR EACH ROW]{.s8}[
]{.s1}[EXECUTE]{.s8}[ ]{.s1}[FUNCTION]{.s8}[ update_updated_at();]{.s1}

[]{.s1}\

[*\-- \... apply to all relevant tables*]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- AUTO-CREATE USER PREFERENCES*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[OR]{.s9}[ ]{.s1}[REPLACE]{.s8}[
]{.s1}[FUNCTION]{.s8}[ create_user_preferences()]{.s1}

[RETURNS]{.s1}[ ]{.s6}[TRIGGER]{.s1}[ ]{.s6}[AS]{.s1}[ \$\$]{.s6}

[BEGIN]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[INSERT]{.s8}[ ]{.s1}[INTO]{.s8}[
user_preferences (user_id)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[VALUES]{.s8}[ (NEW.id)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[ON]{.s8}[ CONFLICT (user_id)
]{.s1}[DO]{.s8}[ NOTHING;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[RETURN]{.s8}[ NEW;]{.s1}

[END]{.s1}[;]{.s6}

[\$\$ ]{.s1}[LANGUAGE]{.s8}[ plpgsql;]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TRIGGER]{.s8}[
create_preferences_for_new_user]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[AFTER]{.s1}[ ]{.s6}[INSERT]{.s1}[
]{.s6}[ON]{.s1}[ users]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[FOR EACH ROW]{.s8}[
]{.s1}[EXECUTE]{.s8}[ ]{.s1}[FUNCTION]{.s8}[
create_user_preferences();]{.s1}

[]{.s1}\

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*\-- AUTO-CREATE/UPDATE ROUTES FROM TRIPS*]{.s1}

[*\--*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[OR]{.s9}[ ]{.s1}[REPLACE]{.s8}[
]{.s1}[FUNCTION]{.s8}[ update_route_stats()]{.s1}

[RETURNS]{.s1}[ ]{.s6}[TRIGGER]{.s1}[ ]{.s6}[AS]{.s1}[ \$\$]{.s6}

[BEGIN]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*\-- If trip has associated route,
update stats*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[IF]{.s8}[ NEW.route_id
]{.s1}[IS]{.s9}[ ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[ ]{.s1}[AND]{.s9}[
NEW.]{.s1}[status]{.s8}[ ]{.s1}[=]{.s9}[ ]{.s1}[\'completed\']{.s10}[
]{.s1}[THEN]{.s8}

[[        ]{.Apple-converted-space}]{.s1}[UPDATE]{.s8}[ routes]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[SET]{.s8}[[ ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}trip_count ]{.s1}[=]{.s9}[
trip_count ]{.s1}[+]{.s9}[ ]{.s1}[1]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}last_used_at ]{.s1}[=]{.s9}[
]{.s1}[NOW]{.s9}[(),]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*\-- Update typical
duration (rolling average)*]{.s1}

[[            ]{.Apple-converted-space}typical_duration_car_minutes
]{.s1}[=]{.s9}[ ]{.s1}[CASE]{.s8}[[ ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[WHEN]{.s8}[
NEW.transport_mode ]{.s1}[=]{.s9}[ ]{.s1}[\'car\']{.s10}[
]{.s1}[THEN]{.s8}

[[                   
]{.Apple-converted-space}]{.s1}[COALESCE]{.s8}[(]{.s1}

[[                       
]{.Apple-converted-space}(typical_duration_car_minutes ]{.s1}[\*]{.s9}[
(trip_count ]{.s1}[-]{.s9}[ ]{.s1}[1]{.s11}[) ]{.s1}[+]{.s9}[
NEW.actual_duration_minutes) ]{.s1}[/]{.s9}[ trip_count,]{.s1}

[[                       
]{.Apple-converted-space}NEW.actual_duration_minutes]{.s1}

[[                    ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[ELSE]{.s8}[
typical_duration_car_minutes]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[END]{.s8}

[[            ]{.Apple-converted-space}]{.s6}[*\-- \... similar for
other modes*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[WHERE]{.s8}[ id
]{.s1}[=]{.s9}[ NEW.route_id;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[END]{.s8}[ ]{.s1}[IF]{.s8}[;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[RETURN]{.s8}[ NEW;]{.s1}

[END]{.s1}[;]{.s6}

[\$\$ ]{.s1}[LANGUAGE]{.s8}[ plpgsql;]{.s1}

[]{.s1}\

[CREATE]{.s8}[ ]{.s1}[TRIGGER]{.s8}[ update_route_on_trip_complete]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[AFTER]{.s1}[ ]{.s6}[UPDATE]{.s1}[
]{.s6}[ON]{.s1}[ trips]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[FOR EACH ROW]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[WHEN]{.s8}[
(NEW.]{.s6}[status]{.s8}[ ]{.s6}[=]{.s9}[ ]{.s6}[\'completed\']{.s1}[
]{.s6}[AND]{.s9}[ OLD.]{.s6}[status]{.s8}[ ]{.s6}[!=]{.s9}[
]{.s6}[\'completed\']{.s1}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[EXECUTE]{.s8}[
]{.s1}[FUNCTION]{.s8}[ update_route_stats();]{.s1}

[]{.s1}\

[]{.s1}\

[A2A Protocol Details]{.s3}

[Protocol Overview]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}A2A (Agent-to-Agent) PROTOCOL[           
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Based on Google\'s A2A specification with
extensions for our use case. │]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}KEY CONCEPTS:[                           
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• AGENT: A service that can perform tasks
and communicate [            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• TASK: A unit of work requested from an
agent[                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• SKILL: A capability an agent advertises
[                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• ARTIFACT: Data produced by a task [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• MESSAGE: Communication between agents or
agent-user [                ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TRANSPORT: [                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• HTTP/REST for request-response[         
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• WebSocket for streaming/real-time [     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Server-Sent Events for push
notifications [                         
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SERIALIZATION: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• JSON for all payloads [                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}• Binary frames for audio streaming
(WebSocket) [                      ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Agent Card Schema]{.s3}

[{]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"\$schema\"]{.s5}[:]{.s9}[
]{.s6}[\"https://json-schema.org/draft/2020-12/schema\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"title\"]{.s5}[:]{.s9}[
]{.s6}[\"AgentCard\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Metadata describing an A2A agent\'s
capabilities\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"type\"]{.s5}[:]{.s9}[
]{.s6}[\"object\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"required\"]{.s5}[:]{.s9}[
\[]{.s6}[\"name\"]{.s1}[, ]{.s6}[\"version\"]{.s1}[,
]{.s6}[\"url\"]{.s1}[, ]{.s6}[\"skills\"]{.s1}[\],]{.s6}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[\"name\"]{.s5}[:]{.s9}[ {]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Unique identifier for the agent\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"pattern\"]{.s5}[:]{.s9}[
]{.s6}[\"\^\[a-z\]\[a-z0-9-\]\*\$\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"examples\"]{.s5}[:]{.s9}[
\[]{.s6}[\"liquidcrypto-weather\"]{.s1}[,
]{.s6}[\"liquidcrypto-orchestrator\"]{.s1}[\]]{.s6}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"displayName\"]{.s1}[:]{.s9}[
{]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Human-readable name\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"examples\"]{.s5}[:]{.s9}[
\[]{.s6}[\"Weather Intelligence Agent\"]{.s1}[\]]{.s6}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"description\"]{.s1}[:]{.s9}[
{]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"What this agent does\"]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"version\"]{.s1}[:]{.s9}[ {]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"pattern\"]{.s5}[:]{.s9}[
]{.s6}[\"\^\\\\d+\\\\.\\\\d+\\\\.\\\\d+\$\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"examples\"]{.s1}[:]{.s9}[
\[]{.s6}[\"1.0.0\"]{.s10}[\]]{.s6}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\"url\"]{.s5}[:]{.s9}[ {]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[\"format\"]{.s5}[:]{.s9}[
]{.s1}[\"uri\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Base URL for the agent\'s API\"]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"capabilities\"]{.s1}[:]{.s9}[
{]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\"streaming\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"boolean\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Supports streaming responses\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[\"pushNotifications\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"boolean\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Can send proactive notifications\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[\"stateManagement\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"boolean\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Maintains conversation state\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"multiModal\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"boolean\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Supports audio/visual input/output\"]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"skills\"]{.s1}[:]{.s9}[ {]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"items\"]{.s5}[:]{.s9}[ {
]{.s6}[\"\$ref\"]{.s5}[:]{.s9}[ ]{.s6}[\"#/\$defs/Skill\"]{.s1}[ }]{.s6}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"authentication\"]{.s1}[:]{.s9}[
{]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
{]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[          ]{.Apple-converted-space}]{.s6}[\"enum\"]{.s5}[:]{.s9}[
\[]{.s6}[\"none\"]{.s1}[, ]{.s6}[\"bearer\"]{.s1}[,
]{.s6}[\"api_key\"]{.s1}[, ]{.s6}[\"oauth2\"]{.s1}[\]]{.s6}

[[        ]{.Apple-converted-space}},]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"required\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"boolean\"]{.s10}[ }]{.s6}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\"rateLimits\"]{.s1}[:]{.s9}[
{]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[\"requestsPerMinute\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[ },]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[\"requestsPerDay\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[ }]{.s6}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}},]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"\$defs\"]{.s1}[:]{.s9}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"Skill\"]{.s1}[:]{.s9}[ {]{.s6}

[[      ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"id\"]{.s10}[, ]{.s1}[\"name\"]{.s10}[\],]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"id\"]{.s5}[:]{.s9}[ {]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Unique skill identifier\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"name\"]{.s5}[:]{.s9}[
{]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Human-readable skill name\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"description\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}

[[        ]{.Apple-converted-space}},]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"JSON Schema for skill input\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[ {]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"JSON Schema for skill output\"]{.s1}

[[        ]{.Apple-converted-space}},]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"examples\"]{.s5}[:]{.s9}[
{]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"input\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[ },]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"output\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[ }]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Agent Cards for LiquidCrypto]{.s3}

[Orchestrator Agent Card]{.s3}

[{]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"liquidcrypto-orchestrator\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"displayName\"]{.s5}[:]{.s9}[
]{.s6}[\"LiquidCrypto Orchestrator\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Central hub for travel weather intelligence. Routes requests to
specialized agents and synthesizes responses.\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"version\"]{.s1}[:]{.s9}[
]{.s6}[\"1.0.0\"]{.s10}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"url\"]{.s5}[:]{.s9}[
]{.s6}[\"https://api.liquidcrypto.app/a2a\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"capabilities\"]{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"streaming\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[   
]{.Apple-converted-space}]{.s6}[\"pushNotifications\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"stateManagement\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"multiModal\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}

[[  ]{.Apple-converted-space}},]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"skills\"]{.s1}[:]{.s9}[ \[]{.s6}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"route-weather\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Route Weather Query\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Get weather conditions along a travel route at the time you\'ll
be there\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"required\"]{.s5}[:]{.s9}[
\[]{.s6}[\"destination\"]{.s1}[\],]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"origin\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"oneOf\"]{.s5}[:]{.s9}[
\[]{.s1}

[[              ]{.Apple-converted-space}{
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[,
]{.s1}[\"properties\"]{.s5}[:]{.s9}[ { ]{.s1}[\"type\"]{.s5}[:]{.s9}[ {
]{.s1}[\"const\"]{.s5}[:]{.s9}[ ]{.s1}[\"current_location\"]{.s10}[ } }
},]{.s1}

[[              ]{.Apple-converted-space}{
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[,
]{.s1}[\"properties\"]{.s5}[:]{.s9}[ { ]{.s1}[\"type\"]{.s5}[:]{.s9}[ {
]{.s1}[\"const\"]{.s5}[:]{.s9}[ ]{.s1}[\"saved_location\"]{.s10}[ },
]{.s1}[\"id\"]{.s5}[:]{.s9}[ { ]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[ } } },]{.s1}

[[              ]{.Apple-converted-space}{
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[,
]{.s6}[\"properties\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[ {
]{.s6}[\"const\"]{.s1}[:]{.s9}[ ]{.s6}[\"coordinates\"]{.s10}[ },
]{.s6}[\"lat\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[
]{.s6}[\"number\"]{.s10}[ }, ]{.s6}[\"lng\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[ } } },]{.s6}

[[              ]{.Apple-converted-space}{
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[,
]{.s6}[\"properties\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[ {
]{.s6}[\"const\"]{.s1}[:]{.s9}[ ]{.s6}[\"address\"]{.s10}[ },
]{.s6}[\"address\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[
]{.s6}[\"string\"]{.s10}[ } } }]{.s6}

[[            ]{.Apple-converted-space}\]]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"destination\"]{.s1}[:]{.s9}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"oneOf\"]{.s5}[:]{.s9}[
\[]{.s1}

[[              ]{.Apple-converted-space}{
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[,
]{.s1}[\"properties\"]{.s5}[:]{.s9}[ { ]{.s1}[\"type\"]{.s5}[:]{.s9}[ {
]{.s1}[\"const\"]{.s5}[:]{.s9}[ ]{.s1}[\"saved_location\"]{.s10}[ },
]{.s1}[\"id\"]{.s5}[:]{.s9}[ { ]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[ } } },]{.s1}

[[              ]{.Apple-converted-space}{
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[,
]{.s6}[\"properties\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[ {
]{.s6}[\"const\"]{.s1}[:]{.s9}[ ]{.s6}[\"coordinates\"]{.s10}[ },
]{.s6}[\"lat\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[
]{.s6}[\"number\"]{.s10}[ }, ]{.s6}[\"lng\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[ } } },]{.s6}

[[              ]{.Apple-converted-space}{
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[,
]{.s6}[\"properties\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[ {
]{.s6}[\"const\"]{.s1}[:]{.s9}[ ]{.s6}[\"address\"]{.s10}[ },
]{.s6}[\"address\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[
]{.s6}[\"string\"]{.s10}[ } } }]{.s6}

[[            ]{.Apple-converted-space}\]]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"departureTime\"]{.s1}[:]{.s9}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"format\"]{.s5}[:]{.s9}[
]{.s1}[\"date-time\"]{.s10}[,]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"ISO 8601 datetime, defaults to now\"]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"transportMode\"]{.s1}[:]{.s9}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"string\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"enum\"]{.s5}[:]{.s9}[
\[]{.s6}[\"car\"]{.s1}[, ]{.s6}[\"bike\"]{.s1}[, ]{.s6}[\"walk\"]{.s1}[,
]{.s6}[\"transit\"]{.s1}[\],]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"default\"]{.s5}[:]{.s9}[
]{.s1}[\"car\"]{.s10}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"route\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"distanceMiles\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[             
]{.Apple-converted-space}]{.s6}[\"durationMinutes\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[ },]{.s6}

[[             
]{.Apple-converted-space}]{.s1}[\"polyline\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ }]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"weatherTimeline\"]{.s1}[:]{.s9}[
{]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"time\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[,
]{.s1}[\"format\"]{.s5}[:]{.s9}[ ]{.s1}[\"date-time\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"location\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"condition\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"tempF\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[\"precipProbability\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[ }]{.s6}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"transitions\"]{.s1}[:]{.s9}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"time\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"from\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\"to\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[\"locationDescription\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"string\"]{.s10}[ }]{.s6}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"summary\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ }]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"examples\"]{.s1}[:]{.s9}[
\[]{.s6}

[[        ]{.Apple-converted-space}{]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"input\"]{.s5}[:]{.s9}[
{]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[\"destination\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"saved_location\"]{.s10}[,
]{.s6}[\"id\"]{.s1}[:]{.s9}[ ]{.s6}[\"work\"]{.s10}[ }]{.s6}

[[          ]{.Apple-converted-space}},]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"output\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"route\"]{.s1}[:]{.s9}[ {
]{.s6}[\"distanceMiles\"]{.s1}[:]{.s9}[ ]{.s6}[32]{.s11}[,
]{.s6}[\"durationMinutes\"]{.s1}[:]{.s9}[ ]{.s6}[45]{.s11}[ },]{.s6}

[[           
]{.Apple-converted-space}]{.s6}[\"weatherTimeline\"]{.s1}[:]{.s9}[
\[]{.s6}

[[              ]{.Apple-converted-space}{
]{.s6}[\"time\"]{.s5}[:]{.s9}[
]{.s6}[\"2026-01-20T08:30:00-08:00\"]{.s1}[,
]{.s6}[\"condition\"]{.s5}[:]{.s9}[ ]{.s6}[\"clear\"]{.s1}[,
]{.s6}[\"tempF\"]{.s5}[:]{.s9}[ ]{.s6}[58]{.s11}[ },]{.s6}

[[              ]{.Apple-converted-space}{
]{.s6}[\"time\"]{.s5}[:]{.s9}[
]{.s6}[\"2026-01-20T08:55:00-08:00\"]{.s1}[,
]{.s6}[\"condition\"]{.s5}[:]{.s9}[ ]{.s6}[\"rain\"]{.s1}[,
]{.s6}[\"tempF\"]{.s5}[:]{.s9}[ ]{.s6}[54]{.s11}[ }]{.s6}

[[            ]{.Apple-converted-space}\],]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"summary\"]{.s5}[:]{.s9}[
]{.s6}[\"Rain starting mid-route around 8:55 AM\"]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}\]]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"optimize-departure\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Departure Time Optimizer\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Find the best time to leave based on weather and
traffic\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"required\"]{.s5}[:]{.s9}[
\[]{.s6}[\"destination\"]{.s1}[\],]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"origin\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[ },]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"destination\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[ },]{.s6}

[[          ]{.Apple-converted-space}]{.s6}[\"arriveBy\"]{.s1}[:]{.s9}[
{ ]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"string\"]{.s10}[,
]{.s6}[\"format\"]{.s1}[:]{.s9}[ ]{.s6}[\"date-time\"]{.s10}[ },]{.s6}

[[         
]{.Apple-converted-space}]{.s6}[\"preferences\"]{.s1}[:]{.s9}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"avoidRain\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"boolean\"]{.s10}[ },]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"minimizeTime\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"boolean\"]{.s10}[ }]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"options\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"departureTime\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"arrivalTime\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"durationMinutes\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"integer\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[\"weatherScore\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[,
]{.s6}[\"minimum\"]{.s1}[:]{.s9}[ ]{.s6}[0]{.s11}[,
]{.s6}[\"maximum\"]{.s1}[:]{.s9}[ ]{.s6}[10]{.s11}[ },]{.s6}

[[               
]{.Apple-converted-space}]{.s1}[\"weatherSummary\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"recommended\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"boolean\"]{.s10}[ }]{.s1}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"compare-transport\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Transport Mode Comparison\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Compare driving, biking, walking, and transit
options\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"required\"]{.s5}[:]{.s9}[
\[]{.s6}[\"destination\"]{.s1}[, ]{.s6}[\"modes\"]{.s1}[\],]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"origin\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[ },]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"destination\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[ },]{.s6}

[[         
]{.Apple-converted-space}]{.s6}[\"departureTime\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"string\"]{.s10}[ },]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"modes\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"items\"]{.s5}[:]{.s9}[ {
]{.s6}[\"type\"]{.s5}[:]{.s9}[ ]{.s6}[\"string\"]{.s1}[,
]{.s6}[\"enum\"]{.s5}[:]{.s9}[ \[]{.s6}[\"car\"]{.s1}[,
]{.s6}[\"bike\"]{.s1}[, ]{.s6}[\"walk\"]{.s1}[,
]{.s6}[\"transit\"]{.s1}[\] }]{.s6}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"set-reminder\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Smart Reminder\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Set time-based or condition-based reminders\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"required\"]{.s5}[:]{.s9}[
\[]{.s6}[\"type\"]{.s1}[, ]{.s6}[\"trigger\"]{.s1}[\],]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s6}[\"type\"]{.s5}[:]{.s9}[ {
]{.s6}[\"type\"]{.s5}[:]{.s9}[ ]{.s6}[\"string\"]{.s1}[,
]{.s6}[\"enum\"]{.s5}[:]{.s9}[ \[]{.s6}[\"departure\"]{.s1}[,
]{.s6}[\"condition\"]{.s1}[\] },]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"trigger\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"oneOf\"]{.s5}[:]{.s9}[
\[]{.s1}

[[              ]{.Apple-converted-space}{
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[,
]{.s6}[\"properties\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[ {
]{.s6}[\"const\"]{.s1}[:]{.s9}[ ]{.s6}[\"time\"]{.s10}[ },
]{.s6}[\"time\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[
]{.s6}[\"string\"]{.s10}[ } } },]{.s6}

[[              ]{.Apple-converted-space}{
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[,
]{.s6}[\"properties\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[ {
]{.s6}[\"const\"]{.s1}[:]{.s9}[ ]{.s6}[\"condition\"]{.s10}[ },
]{.s6}[\"condition\"]{.s1}[:]{.s9}[ { ]{.s6}[\"type\"]{.s1}[:]{.s9}[
]{.s6}[\"string\"]{.s10}[ } } }]{.s6}

[[            ]{.Apple-converted-space}\]]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"destination\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"object\"]{.s10}[ }]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"voice-query\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Voice Query Handler\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Process natural language voice queries\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"query\"]{.s10}[\],]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"query\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"context\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"object\"]{.s10}[ }]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}\],]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"authentication\"]{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"type\"]{.s5}[:]{.s9}[
]{.s6}[\"bearer\"]{.s1}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"required\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}

[[  ]{.Apple-converted-space}},]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"rateLimits\"]{.s1}[:]{.s9}[
{]{.s6}

[[   
]{.Apple-converted-space}]{.s6}[\"requestsPerMinute\"]{.s1}[:]{.s9}[
]{.s6}[60]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"requestsPerDay\"]{.s1}[:]{.s9}[
]{.s6}[10000]{.s11}

[[  ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Weather Agent Card]{.s3}

[{]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"liquidcrypto-weather\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"displayName\"]{.s5}[:]{.s9}[
]{.s6}[\"Weather Intelligence Agent\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Aggregates weather data from multiple sources for point
forecasts, route forecasts, and nowcasting\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"version\"]{.s1}[:]{.s9}[
]{.s6}[\"1.0.0\"]{.s10}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"url\"]{.s5}[:]{.s9}[
]{.s6}[\"https://weather.liquidcrypto.app/a2a\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"capabilities\"]{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"streaming\"]{.s1}[:]{.s9}[
]{.s6}[false]{.s11}[,]{.s6}

[[   
]{.Apple-converted-space}]{.s6}[\"pushNotifications\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"stateManagement\"]{.s1}[:]{.s9}[
]{.s6}[false]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"multiModal\"]{.s1}[:]{.s9}[
]{.s6}[false]{.s11}

[[  ]{.Apple-converted-space}},]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"skills\"]{.s1}[:]{.s9}[ \[]{.s6}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"point-forecast\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Point Forecast\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Get weather forecast for a specific location and
time\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"lat\"]{.s10}[, ]{.s1}[\"lng\"]{.s10}[\],]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s6}[\"lat\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[,
]{.s6}[\"minimum\"]{.s1}[:]{.s9}[ ]{.s6}[-90]{.s11}[,
]{.s6}[\"maximum\"]{.s1}[:]{.s9}[ ]{.s6}[90]{.s11}[ },]{.s6}

[[          ]{.Apple-converted-space}]{.s6}[\"lng\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[,
]{.s6}[\"minimum\"]{.s1}[:]{.s9}[ ]{.s6}[-180]{.s11}[,
]{.s6}[\"maximum\"]{.s1}[:]{.s9}[ ]{.s6}[180]{.s11}[ },]{.s6}

[[          ]{.Apple-converted-space}]{.s6}[\"time\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"string\"]{.s10}[,
]{.s6}[\"format\"]{.s1}[:]{.s9}[ ]{.s6}[\"date-time\"]{.s10}[ }]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"condition\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"tempF\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"feelsLikeF\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[ },]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"humidity\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"integer\"]{.s10}[ },]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"windSpeedMph\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[ },]{.s6}

[[         
]{.Apple-converted-space}]{.s6}[\"windDirection\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"string\"]{.s10}[ },]{.s6}

[[         
]{.Apple-converted-space}]{.s6}[\"precipProbability\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[ },]{.s6}

[[         
]{.Apple-converted-space}]{.s6}[\"precipType\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"string\"]{.s10}[ },]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"uvIndex\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"integer\"]{.s10}[ },]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"visibility\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[ }]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"route-forecast\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Route Forecast\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Get weather forecasts along a route at estimated arrival
times\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"waypoints\"]{.s10}[\],]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"waypoints\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"lat\"]{.s10}[, ]{.s1}[\"lng\"]{.s10}[,
]{.s1}[\"eta\"]{.s10}[\],]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\"lat\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\"lng\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\"eta\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[,
]{.s1}[\"format\"]{.s5}[:]{.s9}[ ]{.s1}[\"date-time\"]{.s10}[ }]{.s1}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"segments\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"startIndex\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"integer\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"endIndex\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"integer\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[\"weather\"]{.s5}[:]{.s9}[ {
]{.s6}[\"\$ref\"]{.s5}[:]{.s9}[
]{.s6}[\"#/\$defs/WeatherCondition\"]{.s1}[ }]{.s6}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"nowcast\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"2-Hour Nowcast\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Minute-by-minute precipitation forecast for next 2
hours\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"lat\"]{.s10}[, ]{.s1}[\"lng\"]{.s10}[\],]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"lat\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"lng\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ }]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"timeline\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"minutesFromNow\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"integer\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"precipIntensity\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[\"precipProbability\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"integer\"]{.s10}[ },]{.s6}

[[               
]{.Apple-converted-space}]{.s1}[\"precipType\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ }]{.s1}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}},]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"summary\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ }]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}},]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"severe-alerts\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Severe Weather Alerts\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"description\"]{.s5}[:]{.s9}[
]{.s6}[\"Get active weather alerts for a location\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\"required\"]{.s5}[:]{.s9}[
\[]{.s1}[\"lat\"]{.s10}[, ]{.s1}[\"lng\"]{.s10}[\],]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"lat\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[\"lng\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"number\"]{.s10}[ },]{.s1}

[[         
]{.Apple-converted-space}]{.s6}[\"radius_miles\"]{.s1}[:]{.s9}[ {
]{.s6}[\"type\"]{.s1}[:]{.s9}[ ]{.s6}[\"number\"]{.s10}[,
]{.s6}[\"default\"]{.s1}[:]{.s9}[ ]{.s6}[25]{.s11}[ }]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s1}[:]{.s9}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\"properties\"]{.s1}[:]{.s9}[
{]{.s6}

[[          ]{.Apple-converted-space}]{.s1}[\"alerts\"]{.s5}[:]{.s9}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"array\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"items\"]{.s5}[:]{.s9}[
{]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[
]{.s1}[\"object\"]{.s10}[,]{.s1}

[[             
]{.Apple-converted-space}]{.s1}[\"properties\"]{.s5}[:]{.s9}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\"id\"]{.s5}[:]{.s9}[
{ ]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"type\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[\"severity\"]{.s5}[:]{.s9}[ {
]{.s6}[\"type\"]{.s5}[:]{.s9}[ ]{.s6}[\"string\"]{.s1}[,
]{.s6}[\"enum\"]{.s5}[:]{.s9}[ \[]{.s6}[\"minor\"]{.s1}[,
]{.s6}[\"moderate\"]{.s1}[, ]{.s6}[\"severe\"]{.s1}[,
]{.s6}[\"extreme\"]{.s1}[\] },]{.s6}

[[               
]{.Apple-converted-space}]{.s1}[\"headline\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"description\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"instruction\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"startsAt\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ },]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[\"expiresAt\"]{.s5}[:]{.s9}[ {
]{.s1}[\"type\"]{.s5}[:]{.s9}[ ]{.s1}[\"string\"]{.s10}[ }]{.s1}

[[              ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}\],]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"authentication\"]{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"type\"]{.s5}[:]{.s9}[
]{.s6}[\"api_key\"]{.s1}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"required\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}

[[  ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Task Protocol]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}TASK LIFECYCLE [                         
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}1. CREATE TASK[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}POST /a2a/tasks[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}→ Returns task_id, initial status[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}2. TASK PROCESSING[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Agent processes the task [             
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}May call other agents[                 
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Status updates via SSE or polling[     
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}3. TASK COMPLETION[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Task reaches terminal state[           
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Artifacts available[                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [    ]{.Apple-converted-space}Client notified[                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}TASK STATES:[                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────── [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}pending[    ]{.Apple-converted-space}→
Task created, not started[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}running[    ]{.Apple-converted-space}→
Agent is processing[                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}streaming[  ]{.Apple-converted-space}→
Results being streamed [                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}completed[  ]{.Apple-converted-space}→
Success, results available [                             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}failed [    ]{.Apple-converted-space}→
Error occurred [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}cancelled[  ]{.Apple-converted-space}→
User or timeout cancelled[                               
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Task Request/Response]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// TASK CREATION*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*// POST /a2a/tasks*]{.s1}

[interface]{.s8}[ ]{.s6}[CreateTaskRequest]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[*// Which skill to invoke*]{.s1}

[[  ]{.Apple-converted-space}skillId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Skill-specific input*]{.s1}

[[  ]{.Apple-converted-space}input]{.s1}[:]{.s9}[
Record]{.s1}[\<]{.s9}[string]{.s10}[,
]{.s1}[unknown]{.s10}[\>]{.s9}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Optional: conversation
context*]{.s1}

[[  ]{.Apple-converted-space}sessionId]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Optional: request streaming
response*]{.s1}

[[  ]{.Apple-converted-space}stream]{.s1}[?:]{.s9}[
]{.s1}[boolean]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Optional: metadata*]{.s1}

[[  ]{.Apple-converted-space}metadata]{.s1}[?:]{.s9}[ {]{.s1}

[[    ]{.Apple-converted-space}clientId]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}requestId]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[interface]{.s8}[?:]{.s9}[
]{.s6}[\'ios_app\']{.s1}[ ]{.s6}[\|]{.s9}[ ]{.s6}[\'carplay\']{.s1}[
]{.s6}[\|]{.s9}[ ]{.s6}[\'watch\']{.s1}[ ]{.s6}[\|]{.s9}[
]{.s6}[\'widget\']{.s1}[;]{.s6}

[[  ]{.Apple-converted-space}};]{.s1}

[}]{.s1}

[]{.s1}\

[*// Response*]{.s1}

[interface]{.s8}[ ]{.s6}[CreateTaskResponse]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}taskId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}status]{.s1}[:]{.s9}[ TaskStatus;]{.s1}

[[  ]{.Apple-converted-space}createdAt]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// If stream=false and task
completes quickly*]{.s1}

[[  ]{.Apple-converted-space}result]{.s1}[?:]{.s9}[ TaskResult;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// If stream=true*]{.s1}

[[  ]{.Apple-converted-space}streamUrl]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// TASK STATUS*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*// GET /a2a/tasks/{taskId}*]{.s1}

[interface]{.s8}[ ]{.s6}[TaskStatusResponse]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}taskId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}status]{.s1}[:]{.s9}[ TaskStatus;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Progress info*]{.s1}

[[  ]{.Apple-converted-space}progress]{.s1}[?:]{.s9}[ {]{.s1}

[[    ]{.Apple-converted-space}current]{.s1}[:]{.s9}[
]{.s1}[number]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}total]{.s1}[:]{.s9}[
]{.s1}[number]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}message]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}};]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Timing*]{.s1}

[[  ]{.Apple-converted-space}createdAt]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}startedAt]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}completedAt]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Result (if completed)*]{.s1}

[[  ]{.Apple-converted-space}result]{.s1}[?:]{.s9}[ TaskResult;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Error (if failed)*]{.s1}

[[  ]{.Apple-converted-space}error]{.s1}[?:]{.s9}[ {]{.s1}

[[    ]{.Apple-converted-space}code]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}message]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}details]{.s1}[?:]{.s9}[
Record]{.s1}[\<]{.s9}[string]{.s10}[,
]{.s1}[unknown]{.s10}[\>]{.s9}[;]{.s1}

[[  ]{.Apple-converted-space}};]{.s1}

[}]{.s1}

[]{.s1}\

[type]{.s8}[ ]{.s6}[TaskStatus]{.s1}[
]{.s6}[=]{.s9}[[ ]{.Apple-converted-space}]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\|]{.s9}[
]{.s6}[\'pending\']{.s1}[[ ]{.Apple-converted-space}]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\|]{.s9}[
]{.s6}[\'running\']{.s1}[[ ]{.Apple-converted-space}]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\|]{.s9}[
]{.s6}[\'streaming\']{.s1}[[ ]{.Apple-converted-space}]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\|]{.s9}[
]{.s6}[\'completed\']{.s1}[[ ]{.Apple-converted-space}]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\|]{.s9}[
]{.s6}[\'failed\']{.s1}[[ ]{.Apple-converted-space}]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\|]{.s9}[
]{.s6}[\'cancelled\']{.s1}[;]{.s6}

[]{.s1}\

[interface]{.s8}[ ]{.s6}[TaskResult]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[*// Skill-specific output*]{.s1}

[[  ]{.Apple-converted-space}output]{.s1}[:]{.s9}[
Record]{.s1}[\<]{.s9}[string]{.s10}[,
]{.s1}[unknown]{.s10}[\>]{.s9}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Generated artifacts (files,
audio, etc.)*]{.s1}

[[  ]{.Apple-converted-space}artifacts]{.s1}[?:]{.s9}[
Artifact\[\];]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Suggested follow-up
actions*]{.s1}

[[  ]{.Apple-converted-space}suggestedActions]{.s1}[?:]{.s9}[
SuggestedAction\[\];]{.s1}

[}]{.s1}

[]{.s1}\

[interface]{.s1}[ ]{.s6}[Artifact]{.s11}[ {]{.s6}

[[  ]{.Apple-converted-space}id]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}type]{.s6}[:]{.s9}[ ]{.s6}[\'text\']{.s1}[
]{.s6}[\|]{.s9}[ ]{.s6}[\'json\']{.s1}[ ]{.s6}[\|]{.s9}[
]{.s6}[\'audio\']{.s1}[ ]{.s6}[\|]{.s9}[ ]{.s6}[\'image\']{.s1}[;]{.s6}

[[  ]{.Apple-converted-space}name]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}url]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}content]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}mimeType]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[}]{.s1}

[]{.s1}\

[interface]{.s8}[ ]{.s6}[SuggestedAction]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}id]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}label]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}skillId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}input]{.s1}[:]{.s9}[
Record]{.s1}[\<]{.s9}[string]{.s10}[,
]{.s1}[unknown]{.s10}[\>]{.s9}[;]{.s1}

[}]{.s1}

[]{.s1}\

[Streaming Protocol]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// SERVER-SENT EVENTS STREAMING*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*// Connect: GET /a2a/tasks/{taskId}/stream*]{.s1}

[*// Headers: Accept: text/event-stream*]{.s1}

[]{.s1}\

[*// Event types:*]{.s1}

[type]{.s8}[ ]{.s6}[StreamEvent]{.s1}[ ]{.s6}[=]{.s9}

[[  ]{.Apple-converted-space}]{.s1}[\|]{.s9}[ { event]{.s1}[:]{.s9}[
]{.s1}[\'status\']{.s10}[; data]{.s1}[:]{.s9}[ { status]{.s1}[:]{.s9}[
TaskStatus; message]{.s1}[?:]{.s9}[ ]{.s1}[string]{.s10}[ } }]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[\|]{.s9}[ { event]{.s1}[:]{.s9}[
]{.s1}[\'progress\']{.s10}[; data]{.s1}[:]{.s9}[ {
current]{.s1}[:]{.s9}[ ]{.s1}[number]{.s10}[; total]{.s1}[:]{.s9}[
]{.s1}[number]{.s10}[; message]{.s1}[?:]{.s9}[ ]{.s1}[string]{.s10}[ }
}]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[\|]{.s9}[ { event]{.s1}[:]{.s9}[
]{.s1}[\'partial\']{.s10}[; data]{.s1}[:]{.s9}[ { type]{.s1}[:]{.s9}[
]{.s1}[\'text\']{.s10}[ ]{.s1}[\|]{.s9}[ ]{.s1}[\'json\']{.s10}[;
content]{.s1}[:]{.s9}[ ]{.s1}[string]{.s10}[ } }]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[\|]{.s9}[ { event]{.s1}[:]{.s9}[
]{.s1}[\'artifact\']{.s10}[; data]{.s1}[:]{.s9}[ Artifact }]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[\|]{.s9}[ { event]{.s1}[:]{.s9}[
]{.s1}[\'complete\']{.s10}[; data]{.s1}[:]{.s9}[ TaskResult }]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[\|]{.s9}[ { event]{.s1}[:]{.s9}[
]{.s1}[\'error\']{.s10}[; data]{.s1}[:]{.s9}[ { code]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[; message]{.s1}[:]{.s9}[ ]{.s1}[string]{.s10}[ }
};]{.s1}

[]{.s1}\

[*// Example stream:*]{.s1}

[*// event: status*]{.s1}

[*// data: {\"status\": \"running\", \"message\": \"Fetching weather
data\...\"}*]{.s1}

[*//*]{.s1}

[*// event: progress*]{.s1}

[*// data: {\"current\": 1, \"total\": 3, \"message\": \"Weather data
received\"}*]{.s1}

[*//*]{.s1}

[*// event: partial*]{.s1}

[*// data: {\"type\": \"text\", \"content\": \"Clear skies for
\"}*]{.s1}

[*//*]{.s1}

[*// event: partial*]{.s1}

[*// data: {\"type\": \"text\", \"content\": \"the first half of your
route\...\"}*]{.s1}

[*//*]{.s1}

[*// event: complete*]{.s1}

[*// data: {\"output\": {\...}, \"suggestedActions\": \[\...\]}*]{.s1}

[]{.s1}\

[Inter-Agent Communication]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}AGENT-TO-AGENT CALLS [                   
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}When Orchestrator needs to call Weather
Agent:[                        ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}┌─────────────────────────────────────────────────────────────────┐
[  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}Orchestrator[                       
]{.Apple-converted-space}Weather Agent[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[ 
]{.Apple-converted-space}────────────[                       
]{.Apple-converted-space}─────────────[             
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}1. Resolve
agent endpoint[                                     
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}→ Read
from agent registry or config[                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}2. Create
internal task[                                       
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}POST
/a2a/tasks [                                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{ [       
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}\"skillId\": \"route-forecast\",[             
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}\"input\": {[                                 
              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}\"waypoints\": \[\...\][                       
              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}},[     
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}\"metadata\": { [                             
              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}\"parentTaskId\": \"original-task-id\", [     
              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}\"callingAgent\": \"liquidcrypto-orchestrator\"
[            ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}}[     
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}} [       
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}3. Receive
response[                                           
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}{ [       
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}\"taskId\": \"weather-task-id\",[             
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}\"status\": \"completed\",[                   
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}\"result\": { [                               
              ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [       
]{.Apple-converted-space}\"output\": { \"segments\": \[\...\] } [       
                ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}}[     
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [    ]{.Apple-converted-space}} [       
                                                 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[  ]{.Apple-converted-space}4.
Incorporate into parent task[                               
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                          ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}└─────────────────────────────────────────────────────────────────┘
[  ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}PARALLEL AGENT CALLS: [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}───────────────────── [                   
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Orchestrator can call multiple agents in
parallel:[                    ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}const \[weather, traffic, calendar\] =
await Promise.all(\[[              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}weatherAgent.invoke(\'route-forecast\',
{ waypoints }), [              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}trafficAgent.invoke(\'route-time\', {
origin, destination }), [        ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}calendarAgent.invoke(\'next-event\', {
timeRange }) [                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}\]); [                                   
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Then combine results in Route Intel
Agent.[                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Agent Registry]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// AGENT REGISTRY*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[interface]{.s8}[ ]{.s6}[AgentRegistry]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[*// Register an agent*]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[register]{.s9}[(card]{.s1}[:]{.s9}[
AgentCard)]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[void]{.s8}[\>]{.s9}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Discover agents*]{.s1}

[[ 
]{.Apple-converted-space}]{.s1}[discover]{.s9}[(query]{.s1}[?:]{.s9}[
{]{.s1}

[[    ]{.Apple-converted-space}skill]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}capability]{.s1}[?:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}})]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[AgentCard\[\]]{.s1}[\>]{.s9}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Get specific agent*]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[get]{.s9}[(name]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[)]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[AgentCard ]{.s1}[\|]{.s9}[
]{.s1}[null]{.s8}[\>]{.s9}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// Health check*]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[health]{.s9}[(name]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[)]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[{]{.s1}

[[    ]{.Apple-converted-space}status]{.s6}[:]{.s9}[
]{.s6}[\'healthy\']{.s1}[ ]{.s6}[\|]{.s9}[ ]{.s6}[\'degraded\']{.s1}[
]{.s6}[\|]{.s9}[ ]{.s6}[\'unhealthy\']{.s1}[;]{.s6}

[[    ]{.Apple-converted-space}latencyMs]{.s1}[:]{.s9}[
]{.s1}[number]{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}lastCheck]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}}]{.s1}[\>]{.s9}[;]{.s1}

[}]{.s1}

[]{.s1}\

[*// In-memory registry for our agents (could be Redis/Consul in
production)*]{.s1}

[const]{.s8}[ agentRegistry]{.s1}[:]{.s9}[
Record]{.s1}[\<]{.s9}[string]{.s10}[, AgentCard]{.s1}[\>]{.s9}[
]{.s1}[=]{.s9}[ {]{.s1}

[[ 
]{.Apple-converted-space}]{.s6}[\'liquidcrypto-orchestrator\']{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}name]{.s6}[:]{.s9}[
]{.s6}[\'liquidcrypto-orchestrator\']{.s1}[,]{.s6}

[[    ]{.Apple-converted-space}url]{.s1}[:]{.s9}[
process.env.]{.s1}[ORCHESTRATOR_URL]{.s11}[ ]{.s1}[\|\|]{.s9}[
]{.s1}[\'http://localhost:3000\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// \... full card*]{.s1}

[[  ]{.Apple-converted-space}},]{.s1}

[[ 
]{.Apple-converted-space}]{.s6}[\'liquidcrypto-weather\']{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}name]{.s6}[:]{.s9}[
]{.s6}[\'liquidcrypto-weather\']{.s1}[,]{.s6}

[[    ]{.Apple-converted-space}url]{.s1}[:]{.s9}[
process.env.]{.s1}[WEATHER_AGENT_URL]{.s11}[ ]{.s1}[\|\|]{.s9}[
]{.s1}[\'http://localhost:3001\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// \... full card*]{.s1}

[[  ]{.Apple-converted-space}},]{.s1}

[[ 
]{.Apple-converted-space}]{.s6}[\'liquidcrypto-traffic\']{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}name]{.s6}[:]{.s9}[
]{.s6}[\'liquidcrypto-traffic\']{.s1}[,]{.s6}

[[    ]{.Apple-converted-space}url]{.s1}[:]{.s9}[
process.env.]{.s1}[TRAFFIC_AGENT_URL]{.s11}[ ]{.s1}[\|\|]{.s9}[
]{.s1}[\'http://localhost:3002\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// \... full card*]{.s1}

[[  ]{.Apple-converted-space}},]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[*// \...*]{.s1}

[};]{.s1}

[]{.s1}\

[Agent Client]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// AGENT CLIENT (for inter-agent calls)*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[class]{.s8}[ ]{.s6}[AgentClient]{.s1}[ {]{.s6}

[[  ]{.Apple-converted-space}]{.s1}[private]{.s8}[
baseUrl]{.s1}[:]{.s9}[ ]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[private]{.s8}[ apiKey]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[;]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[ 
]{.Apple-converted-space}]{.s1}[constructor]{.s9}[(agentCard]{.s1}[:]{.s9}[
AgentCard, apiKey]{.s1}[:]{.s9}[ ]{.s1}[string]{.s10}[) {]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[this]{.s8}[.baseUrl
]{.s1}[=]{.s9}[ agentCard.url;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[this]{.s8}[.apiKey ]{.s1}[=]{.s9}[
apiKey;]{.s1}

[[  ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[async]{.s8}[
]{.s6}[invoke\<]{.s9}[TInput]{.s1}[,]{.s6}[
TOutput]{.s1}[\>]{.s9}[(]{.s6}

[[    ]{.Apple-converted-space}skillId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}input]{.s1}[:]{.s9}[ TInput,]{.s1}

[[    ]{.Apple-converted-space}options]{.s1}[?:]{.s9}[ {]{.s1}

[[      ]{.Apple-converted-space}timeout]{.s1}[?:]{.s9}[
]{.s1}[number]{.s10}[;]{.s1}

[[      ]{.Apple-converted-space}stream]{.s1}[?:]{.s9}[
]{.s1}[boolean]{.s10}[;]{.s1}

[[      ]{.Apple-converted-space}metadata]{.s1}[?:]{.s9}[
Record]{.s1}[\<]{.s9}[string]{.s10}[,
]{.s1}[unknown]{.s10}[\>]{.s9}[;]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space})]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[TOutput]{.s1}[\>]{.s9}[ {]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ response
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetch]{.s9}[(]{.s1}[\`]{.s10}[\${]{.s1}[this]{.s8}[.baseUrl}]{.s1}[/a2a/tasks\`]{.s10}[,
{]{.s1}

[[      ]{.Apple-converted-space}method]{.s1}[:]{.s9}[
]{.s1}[\'POST\']{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}headers]{.s1}[:]{.s9}[ {]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[\'Content-Type\']{.s5}[:]{.s9}[
]{.s6}[\'application/json\']{.s1}[,]{.s6}

[[       
]{.Apple-converted-space}]{.s1}[\'Authorization\']{.s5}[:]{.s9}[
]{.s1}[\`Bearer
]{.s10}[\${]{.s1}[this]{.s8}[.apiKey}]{.s1}[\`]{.s10}[,]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[\'X-Request-ID\']{.s5}[:]{.s9}[
crypto.]{.s1}[randomUUID]{.s9}[(),]{.s1}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}body]{.s1}[:]{.s9}[
]{.s1}[JSON]{.s11}[.]{.s1}[stringify]{.s9}[({]{.s1}

[[        ]{.Apple-converted-space}skillId,]{.s1}

[[        ]{.Apple-converted-space}input,]{.s1}

[[        ]{.Apple-converted-space}stream]{.s1}[:]{.s9}[
options]{.s1}[?.]{.s9}[stream ]{.s1}[??]{.s9}[
]{.s1}[false]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}metadata]{.s1}[:]{.s9}[
options]{.s1}[?.]{.s9}[metadata,]{.s1}

[[      ]{.Apple-converted-space}}),]{.s1}

[[      ]{.Apple-converted-space}signal]{.s1}[:]{.s9}[
AbortSignal.]{.s1}[timeout]{.s9}[(options]{.s1}[?.]{.s9}[timeout
]{.s1}[??]{.s9}[ ]{.s1}[30000]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}});]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[if]{.s8}[
(]{.s1}[!]{.s9}[response.ok) {]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[const]{.s8}[ error
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[ response.]{.s1}[json]{.s9}[();]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[throw]{.s8}[ ]{.s1}[new]{.s8}[
]{.s1}[AgentError]{.s11}[(error.code, error.message);]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ result
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[ response.]{.s1}[json]{.s9}[();]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// If task completed
synchronously*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[if]{.s8}[ (result.status
]{.s1}[===]{.s9}[ ]{.s1}[\'completed\']{.s10}[) {]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[return]{.s8}[
result.result.output ]{.s1}[as]{.s8}[ TOutput;]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Otherwise poll for
completion*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[this]{.s8}[.]{.s1}[waitForCompletion\<]{.s9}[TOutput]{.s11}[\>]{.s9}[(result.taskId,
options]{.s1}[?.]{.s9}[timeout);]{.s1}

[[  ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[async]{.s8}[
]{.s6}[waitForCompletion\<]{.s1}[TOutput]{.s11}[\>]{.s1}[(]{.s6}

[[    ]{.Apple-converted-space}taskId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}timeout]{.s1}[?:]{.s9}[
]{.s1}[number]{.s10}

[[  ]{.Apple-converted-space})]{.s1}[:]{.s9}[
]{.s1}[Promise]{.s11}[\<]{.s9}[TOutput]{.s1}[\>]{.s9}[ {]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ startTime
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[.]{.s1}[now]{.s9}[();]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ maxWait
]{.s1}[=]{.s9}[ timeout ]{.s1}[??]{.s9}[ ]{.s1}[30000]{.s11}[;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[while]{.s8}[
(]{.s1}[Date]{.s11}[.]{.s1}[now]{.s9}[() ]{.s1}[-]{.s9}[ startTime
]{.s1}[\<]{.s9}[ maxWait) {]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[const]{.s8}[ response
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetch]{.s9}[(]{.s1}[\`]{.s10}[\${]{.s1}[this]{.s8}[.baseUrl}]{.s1}[/a2a/tasks/]{.s10}[\${taskId}]{.s1}[\`]{.s10}[);]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[const]{.s8}[ status
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[ response.]{.s1}[json]{.s9}[();]{.s1}

[[      ]{.Apple-converted-space}]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[if]{.s8}[ (status.status
]{.s1}[===]{.s9}[ ]{.s1}[\'completed\']{.s10}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
status.result.output ]{.s1}[as]{.s8}[ TOutput;]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[if]{.s8}[ (status.status
]{.s1}[===]{.s9}[ ]{.s1}[\'failed\']{.s10}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[throw]{.s8}[ ]{.s1}[new]{.s8}[
]{.s1}[AgentError]{.s11}[(status.error.code,
status.error.message);]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[*// Wait before polling
again*]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[await]{.s8}[ ]{.s1}[new]{.s8}[
]{.s1}[Promise]{.s11}[(resolve ]{.s1}[=\>]{.s9}[
]{.s1}[setTimeout]{.s9}[(resolve, ]{.s1}[500]{.s11}[));]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[throw]{.s8}[ ]{.s6}[new]{.s8}[
]{.s6}[AgentError]{.s11}[(]{.s6}[\'TIMEOUT\']{.s1}[, ]{.s6}[\'Task did
not complete in time\']{.s1}[);]{.s6}

[[  ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}async
]{.s6}[\*invokeStreaming\<]{.s1}[TInput]{.s11}[\>]{.s1}[(]{.s6}

[[    ]{.Apple-converted-space}skillId]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}input]{.s1}[:]{.s9}[ TInput]{.s1}

[[  ]{.Apple-converted-space})]{.s1}[:]{.s9}[
AsyncGenerator]{.s1}[\<]{.s9}[StreamEvent]{.s1}[\>]{.s9}[ {]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ response
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetch]{.s9}[(]{.s1}[\`]{.s10}[\${]{.s1}[this]{.s8}[.baseUrl}]{.s1}[/a2a/tasks\`]{.s10}[,
{]{.s1}

[[      ]{.Apple-converted-space}method]{.s1}[:]{.s9}[
]{.s1}[\'POST\']{.s10}[,]{.s1}

[[      ]{.Apple-converted-space}headers]{.s1}[:]{.s9}[ {]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[\'Content-Type\']{.s5}[:]{.s9}[
]{.s6}[\'application/json\']{.s1}[,]{.s6}

[[       
]{.Apple-converted-space}]{.s1}[\'Authorization\']{.s5}[:]{.s9}[
]{.s1}[\`Bearer
]{.s10}[\${]{.s1}[this]{.s8}[.apiKey}]{.s1}[\`]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[\'Accept\']{.s5}[:]{.s9}[
]{.s6}[\'text/event-stream\']{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}},]{.s1}

[[      ]{.Apple-converted-space}body]{.s1}[:]{.s9}[
]{.s1}[JSON]{.s11}[.]{.s1}[stringify]{.s9}[({ skillId, input,
stream]{.s1}[:]{.s9}[ ]{.s1}[true]{.s11}[ }),]{.s1}

[[    ]{.Apple-converted-space}});]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ reader
]{.s1}[=]{.s9}[
response.body]{.s1}[!]{.s9}[.]{.s1}[getReader]{.s9}[();]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ decoder
]{.s1}[=]{.s9}[ ]{.s1}[new]{.s8}[ ]{.s1}[TextDecoder]{.s11}[();]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ buffer ]{.s1}[=]{.s9}[
]{.s1}[\'\']{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[while]{.s8}[ (]{.s1}[true]{.s11}[)
{]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[const]{.s8}[ { done, value }
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[ reader.]{.s1}[read]{.s9}[();]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[if]{.s8}[ (done)
]{.s1}[break]{.s8}[;]{.s1}

[[      ]{.Apple-converted-space}]{.s1}

[[      ]{.Apple-converted-space}buffer ]{.s1}[+=]{.s9}[
decoder.]{.s1}[decode]{.s9}[(value, { stream]{.s1}[:]{.s9}[
]{.s1}[true]{.s11}[ });]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[const]{.s8}[ lines
]{.s1}[=]{.s9}[
buffer.]{.s1}[split]{.s9}[(]{.s1}[\'\\n\\n\']{.s10}[);]{.s1}

[[      ]{.Apple-converted-space}buffer ]{.s1}[=]{.s9}[
lines.]{.s1}[pop]{.s9}[() ]{.s1}[\|\|]{.s9}[ ]{.s1}[\'\']{.s10}[;]{.s1}

[[      ]{.Apple-converted-space}]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[for]{.s8}[ (]{.s1}[const]{.s8}[
line ]{.s1}[of]{.s8}[ lines) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
(line.]{.s1}[startsWith]{.s9}[(]{.s1}[\'event:\']{.s10}[)) {]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[const]{.s8}[ event
]{.s1}[=]{.s9}[ ]{.s1}[this]{.s8}[.]{.s1}[parseSSE]{.s9}[(line);]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[yield]{.s8}[ event;]{.s1}

[[          ]{.Apple-converted-space}]{.s1}

[[          ]{.Apple-converted-space}]{.s1}[if]{.s8}[ (event.event
]{.s1}[===]{.s9}[ ]{.s1}[\'complete\']{.s10}[ ]{.s1}[\|\|]{.s9}[
event.event ]{.s1}[===]{.s9}[ ]{.s1}[\'error\']{.s10}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[;]{.s1}

[[          ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}]{.s1}

[[  ]{.Apple-converted-space}]{.s1}[private]{.s8}[
]{.s1}[parseSSE]{.s9}[(raw]{.s1}[:]{.s9}[
]{.s1}[string]{.s10}[)]{.s1}[:]{.s9}[ StreamEvent {]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[const]{.s8}[ lines ]{.s1}[=]{.s9}[
raw.]{.s1}[split]{.s9}[(]{.s1}[\'\\n\']{.s10}[);]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ event ]{.s1}[=]{.s9}[
]{.s1}[\'\']{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data ]{.s1}[=]{.s9}[
]{.s1}[\'\']{.s10}[;]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[for]{.s8}[ (]{.s1}[const]{.s8}[
line ]{.s1}[of]{.s8}[ lines) {]{.s1}

[[      ]{.Apple-converted-space}]{.s1}[if]{.s8}[
(line.]{.s1}[startsWith]{.s9}[(]{.s1}[\'event:\']{.s10}[)) {]{.s1}

[[        ]{.Apple-converted-space}event ]{.s1}[=]{.s9}[
line.]{.s1}[slice]{.s9}[(]{.s1}[6]{.s11}[).]{.s1}[trim]{.s9}[();]{.s1}

[[      ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ ]{.s1}[if]{.s8}[
(line.]{.s1}[startsWith]{.s9}[(]{.s1}[\'data:\']{.s10}[)) {]{.s1}

[[        ]{.Apple-converted-space}data ]{.s1}[=]{.s9}[
line.]{.s1}[slice]{.s9}[(]{.s1}[5]{.s11}[).]{.s1}[trim]{.s9}[();]{.s1}

[[      ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[return]{.s8}[ { event,
data]{.s1}[:]{.s9}[ ]{.s1}[JSON]{.s11}[.]{.s1}[parse]{.s9}[(data) }
]{.s1}[as]{.s8}[ StreamEvent;]{.s1}

[[  ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Voice Protocol (WebSocket)]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}VOICE WEBSOCKET PROTOCOL [               
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CONNECTION:[                             
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}─────────── [                             
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}wss://api.liquidcrypto.app/a2a/voice[     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}Headers: [                               
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}Authorization: Bearer \<token\> [       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}X-Device-ID: \<device_id\>[             
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}X-Session-ID: \<optional, to resume\> [ 
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}MESSAGE TYPES: [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}──────────────[                           
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}CLIENT → SERVER: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Start voice session[                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"session.start\",[           
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"config\": { [                         
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"inputFormat\": \"pcm_16khz_mono\",[ 
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"outputFormat\": \"pcm_24khz_mono\",
[                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"vadEnabled\": true, [               
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"interruptEnabled\": true[           
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Send audio chunk [                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"audio.input\",[             
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"data\": \"\<base64_encoded_pcm\>\"[   
                                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// User pressed button (manual end of
speech) [                        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"audio.commit\"[             
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// User interrupted (stop current
response) [                          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"response.interrupt\"[       
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Send text (fallback to typing) [       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"text.input\", [             
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"What\'s my commute
weather?\"[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// End session[                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"session.end\" [             
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[ 
]{.Apple-converted-space}─────────────────────────────────────────────────────────────────────[ 
]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}SERVER → CLIENT: [                       
                              ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Session started[                       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"session.started\",[         
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"sessionId\": \"uuid\" [               
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Speech detected (VAD)[                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"speech.started\"[           
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Partial transcript (as user speaks)[   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"transcript.partial\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"What\'s the weath\...\" [   
                                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Final transcript (speech ended)[       
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"transcript.final\", [       
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"What\'s the weather for my
drive to work?\"[                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Processing started [                   
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"processing.started\"[       
                                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Response audio (streaming) [           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"audio.output\", [           
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"data\": \"\<base64_encoded_pcm\>\"[   
                                  ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Response text (for display, sent with
audio) [                      ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"text.output\",[             
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"text\": \"Clear skies the whole
way\...\", [                            ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"isFinal\": false[                     
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Response complete[                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"response.complete\",[       
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"data\": { [                           
                              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"text\": \"Clear skies the whole way.
58 degrees\...\", [              ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"structuredData\": { \... },[       
                                ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}\"suggestedActions\": \[ \... \] [   
                                  ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}} [                                     
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}// Error[                                 
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}{[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"type\": \"error\",[                   
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"code\": \"RECOGNITION_FAILED\", [     
                                ]{.Apple-converted-space}│]{.s1}

[│[    ]{.Apple-converted-space}\"message\": \"Could not understand
audio\" [                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}} [                                       
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[]{.s1}\

[iOS App Technical Architecture]{.s3}

[Project Structure]{.s3}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}XCODE PROJECT STRUCTURE[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LiquidCrypto/ [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCrypto.xcodeproj[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCrypto/ [                   
]{.Apple-converted-space}\# Main iOS App[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── App/[   
                                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── LiquidCryptoApp.swift [   
]{.Apple-converted-space}\# App entry point [             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── AppDelegate.swift [       
]{.Apple-converted-space}\# UIKit lifecycle [             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── SceneDelegate.swift [     
]{.Apple-converted-space}\# Scene management[             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Features/ [                    ]{.Apple-converted-space}\# Feature
modules [              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Today/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
TodayView.swift [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
TodayViewModel.swift[                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Components/
[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── PlanTrip/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
PlanTripView.swift[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
RouteResultsView.swift[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
DepartureOptimizerView.swift[                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── WeekAhead/[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Insights/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Settings/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Voice/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── VoiceView.swift [                         
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── VoiceViewModel.swift[                     
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── WaveformView.swift[                       
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Core/ [ 
                      ]{.Apple-converted-space}\# Core functionality[   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Services/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
A2AClient.swift [      ]{.Apple-converted-space}\# API client[         
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
VoiceService.swift[    ]{.Apple-converted-space}\# Voice handling[     
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
LocationService.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CalendarService.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
NotificationService.swift [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Models/ [                                 
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── User.swift[ 
                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Location.swift[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Route.swift
[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Weather.swift
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Trip.swift[ 
                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── State/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
AppState.swift[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
UserState.swift [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
NavigationState.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Utilities/[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── Extensions/ [                             
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── Helpers/[                                 
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── Constants.swift [                         
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
DesignSystem/ [                ]{.Apple-converted-space}\# Liquid Glass
UI [              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Theme/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Colors.swift[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Typography.swift[                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Spacing.swift
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Components/ [                             
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
GlassCard.swift [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
GlassButton.swift [                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
WeatherIcon.swift [                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
WeatherTimeline.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
RouteWeatherOverlay.swift [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
TransportModePicker.swift [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Modifiers/[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── GlassModifier.swift [                     
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── WeatherTintModifier.swift [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Resources/[                                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}├──
Assets.xcassets [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}├──
Localizable.strings [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}└──
Info.plist[                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCryptoCarPlay/[             
]{.Apple-converted-space}\# CarPlay App [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CarPlaySceneDelegate.swift[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Templates/[                                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── HomeTemplate.swift[                       
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── RoutePreviewTemplate.swift[               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── NavigationTemplate.swift[                 
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── AlertTemplate.swift [                     
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Info.plist[                    ]{.Apple-converted-space}\# CarPlay
entitlements[          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCryptoWatch/[               
]{.Apple-converted-space}\# Watch App [                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
LiquidCryptoWatchApp.swift[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Views/[ 
                                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── CommuteGlanceView.swift [                 
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── DetailView.swift[                         
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Complications/[                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCryptoWidgets/[             
]{.Apple-converted-space}\# iOS Widgets [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CommuteWidget.swift [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
WeatherWidget.swift [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
WidgetBundle.swift[                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Shared/ [                         
]{.Apple-converted-space}\# Shared code across targets[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
A2AProtocol/[                  ]{.Apple-converted-space}\# A2A types &
client[            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── AgentCard.swift [                         
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Task.swift[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── StreamEvent.swift [                       
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── A2AClient.swift [                         
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Models/
[                      ]{.Apple-converted-space}\# Shared data models[ 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}└──
(symlinked from main app) [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── Tests/[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}├── LiquidCryptoTests/[               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}└── LiquidCryptoUITests/[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Core Data Models]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/Location.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[CoreLocation]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[Location]{.s1}[: ]{.s6}[Identifiable]{.s1}[,
]{.s6}[Codable]{.s1}[, ]{.s6}[Equatable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id: ]{.s1}[UUID]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ name:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ label:
]{.s6}[LocationLabel]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ address:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ coordinate:
]{.s6}[CLLocationCoordinate2D]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ icon:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ color:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ isFavorite:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ visitCount:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ lastVisitedAt:
]{.s1}[Date]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[LocationLabel]{.s1}[: ]{.s6}[String]{.s1}[,
]{.s6}[Codable]{.s1}[, ]{.s6}[CaseIterable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ home]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ work]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ gym]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ school]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ custom]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ defaultIcon:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .home:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🏠]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .work:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🏢]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .gym:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🏋️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .school:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🎓]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .custom:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[📍]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[CLLocationCoordinate2D]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ latitude,
longitude]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[public]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[encode]{.s9}[(to encoder: ]{.s1}[Encoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ container
]{.s1}[=]{.s9}[ encoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(latitude, forKey: .latitude)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(longitude, forKey: .longitude)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[public]{.s8}[
]{.s1}[init]{.s8}[(from decoder: ]{.s1}[Decoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ container
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
decoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ lat ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .latitude)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ lng ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .longitude)]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.]{.s1}[init]{.s8}[(latitude:
lat, longitude: lng)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/Weather.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherCondition]{.s1}[: ]{.s6}[Codable]{.s1}[,
]{.s6}[Equatable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ condition:
]{.s1}[WeatherType]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempFahrenheit:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ feelsLikeFahrenheit:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ humidity:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ windSpeedMph:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ windDirection:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ precipProbability:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ precipIntensity:
]{.s1}[PrecipIntensity]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ uvIndex:
]{.s1}[Int]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ visibility:
]{.s1}[Double]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[WeatherType]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[,
]{.s6}[CaseIterable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ clear,
partlyCloudy, cloudy, overcast]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ lightRain, rain,
heavyRain]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ lightSnow, snow,
heavySnow]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ fog, mist,
haze]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ thunderstorm]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ unknown]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ icon:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .clear:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .partlyCloudy:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[⛅]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .cloudy,
.overcast: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[☁️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightRain,
.rain: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🌧️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .heavyRain,
.thunderstorm: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[⛈️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightSnow,
.snow, .heavySnow: ]{.s1}[return]{.s8}[
]{.s1}[\"]{.s10}[🌨️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .fog, .mist,
.haze: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🌫️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .unknown:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[❓]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ color:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .clear:
]{.s1}[return]{.s8}[ .weatherClear]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .partlyCloudy,
.cloudy, .overcast: ]{.s1}[return]{.s8}[ .weatherCloudy]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightRain,
.rain: ]{.s1}[return]{.s8}[ .weatherRain]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .heavyRain,
.thunderstorm: ]{.s1}[return]{.s8}[ .weatherHeavyRain]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightSnow,
.snow, .heavySnow: ]{.s1}[return]{.s8}[ .weatherSnow]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .fog, .mist,
.haze: ]{.s1}[return]{.s8}[ .weatherFog]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .unknown:
]{.s1}[return]{.s8}[ .gray]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[PrecipIntensity]{.s1}[: ]{.s6}[String]{.s1}[,
]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[none]{.s8}[, light, moderate, heavy]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTimeline]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ points:
\[]{.s6}[WeatherTimelinePoint]{.s1}[\]]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transitions:
\[]{.s1}[WeatherTransition]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ summary:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTimelinePoint]{.s1}[:
]{.s6}[Codable]{.s1}[, ]{.s6}[Identifiable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ id:
]{.s1}[String]{.s11}[ {
]{.s1}[\"]{.s10}[\\(time.timeIntervalSince1970)]{.s1}[\"]{.s10}[ }]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ time:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ location:
]{.s6}[CLLocationCoordinate2D]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ weather:
]{.s6}[WeatherCondition]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTransition]{.s1}[: ]{.s6}[Codable]{.s1}[,
]{.s6}[Identifiable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ id:
]{.s1}[String]{.s11}[ {
]{.s1}[\"]{.s10}[\\(time.timeIntervalSince1970)]{.s1}[-]{.s10}[\\(from)]{.s1}[-]{.s10}[\\(to)]{.s1}[\"]{.s10}[
}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ time:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ from:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ to:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ locationDescription:
]{.s1}[String]{.s11}[?]{.s9}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/Route.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[CoreLocation]{.s1}

[import]{.s1}[ ]{.s6}[MapKit]{.s11}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[Route]{.s1}[: ]{.s6}[Identifiable]{.s1}[,
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id: ]{.s1}[UUID]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[Location]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[Location]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ polyline:
]{.s6}[String]{.s11}[?]{.s9}[ ]{.s6}[*// Encoded polyline*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ distanceMeters:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportMode:
]{.s1}[TransportMode]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[TransportMode]{.s1}[: ]{.s6}[String]{.s1}[,
]{.s6}[Codable]{.s1}[, ]{.s6}[CaseIterable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ car, bike, walk,
transit]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ icon:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .car:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚗]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .bike:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚴]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .walk:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚶]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .transit:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚇]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ displayName:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .car:
]{.s1}[return]{.s8}[ ]{.s1}[\"Drive\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .bike:
]{.s1}[return]{.s8}[ ]{.s1}[\"Bike\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .walk:
]{.s1}[return]{.s8}[ ]{.s1}[\"Walk\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .transit:
]{.s1}[return]{.s8}[ ]{.s1}[\"Transit\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[RouteWeatherResult]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ route:
]{.s1}[Route]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherTimeline:
]{.s1}[WeatherTimeline]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ arrivalTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherScore:
]{.s1}[Int]{.s11}[ ]{.s1}[*// 0-10*]{.s13}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[DepartureOption]{.s1}[:
]{.s6}[Identifiable]{.s1}[, ]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ id:
]{.s1}[String]{.s11}[ { departureTime.]{.s1}[ISO8601Format]{.s11}[()
}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ arrivalTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherScore:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSummary:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ isRecommended:
]{.s1}[Bool]{.s11}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/TransportComparison.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportComparison]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ mode:
]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSuitability:
]{.s1}[Suitability]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ conditions:
]{.s1}[ModeConditions]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ recommendation:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[Suitability]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ excellent, good,
fair, poor]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ color:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .excellent:
]{.s1}[return]{.s8}[ .green]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .good:
]{.s1}[return]{.s8}[ .blue]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .fair:
]{.s1}[return]{.s8}[ .orange]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .poor:
]{.s1}[return]{.s8}[ .red]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[ModeConditions]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// For all modes*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ rainExposure:
]{.s1}[String]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// For bike/walk*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempF:
]{.s1}[Double]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ wind:
]{.s1}[String]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ uvIndex:
]{.s1}[Int]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Gear suggestions
(bike/walk)*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ gearSuggestions:
\[]{.s1}[String]{.s11}[\]]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[A2A Client]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// SERVICES/A2AClient.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[actor]{.s8}[ ]{.s6}[A2AClient]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
baseURL: ]{.s1}[URL]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
session: ]{.s1}[URLSession]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
authToken: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[init]{.s8}[(baseURL:
]{.s6}[URL]{.s11}[ ]{.s6}[=]{.s9}[ ]{.s6}[URL]{.s9}[(string:
]{.s6}[\"https://api.liquidcrypto.app/v1\"]{.s1}[)]{.s6}[!]{.s9}[)
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.baseURL
]{.s1}[=]{.s9}[ baseURL]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ config
]{.s6}[=]{.s9}[
]{.s6}[URLSessionConfiguration]{.s1}[.]{.s6}[default]{.s8}

[[        ]{.Apple-converted-space}config.timeoutIntervalForRequest
]{.s1}[=]{.s9}[ ]{.s1}[30]{.s11}

[[        ]{.Apple-converted-space}config.timeoutIntervalForResource
]{.s1}[=]{.s9}[ ]{.s1}[60]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.session
]{.s1}[=]{.s9}[ ]{.s1}[URLSession]{.s11}[(configuration: config)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setAuthToken]{.s9}[(]{.s1}[\_]{.s8}[ token:
]{.s1}[String]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.authToken
]{.s1}[=]{.s9}[ token]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// ROUTE WEATHER*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getRouteWeather]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}departureTime: ]{.s1}[Date]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}transportMode:
]{.s1}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[ ]{.s1}[=]{.s9}[
.car]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[ ]{.s6}[RouteWeatherResult]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[RouteWeatherRequest]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}departureTime:
departureTime.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}transportMode:
transportMode.rawValue]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/route/weather\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DEPARTURE OPTIMIZER*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[optimizeDeparture]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}arriveBy: ]{.s1}[Date]{.s11}[?]{.s9}[
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}preferences:
]{.s1}[DeparturePreferences]{.s11}[ ]{.s1}[=]{.s9}[
.]{.s1}[init]{.s8}[()]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[ \[]{.s6}[DepartureOption]{.s1}[\]
{]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[OptimizeDepartureRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}arriveBy:
arriveBy]{.s1}[?]{.s9}[.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}preferences: preferences]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ response:
]{.s6}[OptimizeDepartureResponse]{.s1}[ ]{.s6}[=]{.s9}[
]{.s6}[try]{.s8}[ ]{.s6}[await]{.s8}[ ]{.s6}[post]{.s9}[(]{.s6}

[[            ]{.Apple-converted-space}endpoint:
]{.s6}[\"/route/optimize-departure\"]{.s1}[,]{.s6}

[[            ]{.Apple-converted-space}body: request]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
response.options]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// TRANSPORT COMPARISON*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[compareTransport]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}departureTime: ]{.s1}[Date]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}modes:
\[]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}[\] ]{.s6}[=]{.s9}[
]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}[.allCases]{.s6}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[
]{.s6}[TransportComparisonResult]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[CompareTransportRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}departureTime:
departureTime.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}modes: modes.map { \$0.rawValue
}]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/transport/compare\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// REMINDERS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setReminder]{.s9}[(]{.s1}[\_]{.s8}[ reminder:
]{.s1}[ReminderRequest]{.s11}[) ]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[
]{.s1}[-\>]{.s9}[ ]{.s1}[Reminder]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/reminders\"]{.s10}[, body: reminder)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// VOICE QUERY (Non-streaming,
for simple queries)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[voiceQuery]{.s9}[(]{.s1}[\_]{.s8}[ query: ]{.s1}[String]{.s11}[,
context: ]{.s1}[VoiceContext]{.s11}[?]{.s9}[ ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}[) ]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[
]{.s1}[-\>]{.s9}[ ]{.s1}[VoiceResponse]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[VoiceQueryRequest]{.s11}[(query: query, context:
context)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/voice/query\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// GENERIC HTTP METHODS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[post\<]{.s9}[Request]{.s1}[: ]{.s6}[Encodable]{.s1}[,
]{.s6}[Response]{.s1}[: ]{.s6}[Decodable]{.s1}[\>]{.s9}[(]{.s6}

[[        ]{.Apple-converted-space}endpoint:
]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}body: ]{.s1}[Request]{.s11}

[[    ]{.Apple-converted-space}) ]{.s1}[async]{.s8}[
]{.s1}[throws]{.s8}[ ]{.s1}[-\>]{.s9}[ ]{.s1}[Response]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ urlRequest
]{.s1}[=]{.s9}[ ]{.s1}[URLRequest]{.s11}[(url:
baseURL.]{.s1}[appendingPathComponent]{.s9}[(endpoint))]{.s1}

[[        ]{.Apple-converted-space}urlRequest.httpMethod ]{.s1}[=]{.s9}[
]{.s1}[\"POST\"]{.s10}

[[       
]{.Apple-converted-space}urlRequest.]{.s1}[setValue]{.s9}[(]{.s1}[\"application/json\"]{.s10}[,
forHTTPHeaderField: ]{.s1}[\"Content-Type\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
token ]{.s1}[=]{.s9}[ authToken {]{.s1}

[[           
]{.Apple-converted-space}urlRequest.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(token)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ encoder
]{.s1}[=]{.s9}[ ]{.s1}[JSONEncoder]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}encoder.dateEncodingStrategy
]{.s1}[=]{.s9}[ .iso8601]{.s1}

[[        ]{.Apple-converted-space}urlRequest.httpBody ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[ encoder.]{.s1}[encode]{.s9}[(body)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ (data, response)
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
session.]{.s1}[data]{.s9}[(]{.s1}[for]{.s8}[: urlRequest)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
httpResponse ]{.s1}[=]{.s9}[ response ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[HTTPURLResponse]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[throw]{.s8}[
]{.s1}[A2AError]{.s11}[.invalidResponse]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[
(]{.s1}[200]{.s11}[\...]{.s9}[299]{.s11}[).]{.s1}[contains]{.s9}[(httpResponse.statusCode)
]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ error
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[A2AErrorResponse]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[throw]{.s8}[
]{.s1}[A2AError]{.s11}[.]{.s1}[serverError]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}code:
error]{.s1}[?]{.s9}[.code ]{.s1}[??]{.s9}[
]{.s1}[\"UNKNOWN\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}message:
error]{.s1}[?]{.s9}[.message ]{.s1}[??]{.s9}[ ]{.s1}[\"Unknown
error\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ decoder
]{.s1}[=]{.s9}[ ]{.s1}[JSONDecoder]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}decoder.dateDecodingStrategy
]{.s1}[=]{.s9}[ .iso8601]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[
decoder.]{.s1}[decode]{.s9}[(]{.s1}[Response]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// REQUEST/RESPONSE TYPES*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[LocationInput]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ currentLocation]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[savedLocation]{.s1}[(id: ]{.s6}[String]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[coordinates]{.s9}[(lat: ]{.s1}[Double]{.s11}[, lng:
]{.s1}[Double]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[address]{.s9}[(]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ type, id, lat,
lng, address]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[encode]{.s9}[(to encoder: ]{.s1}[Encoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ container
]{.s1}[=]{.s9}[ encoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.currentLocation:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"current_location\"]{.s10}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[savedLocation]{.s9}[(]{.s1}[let]{.s8}[ id):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"saved_location\"]{.s10}[,
forKey: .type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(id, forKey: .id)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[coordinates]{.s9}[(]{.s1}[let]{.s8}[ lat, ]{.s1}[let]{.s8}[
lng):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"coordinates\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(lat, forKey: .lat)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(lng, forKey: .lng)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[address]{.s9}[(]{.s1}[let]{.s8}[ address):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"address\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(address, forKey: .address)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(from decoder:
]{.s1}[Decoder]{.s11}[) ]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ container
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
decoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ type
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ type {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"current_location\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .currentLocation]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"saved_location\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[savedLocation]{.s9}[(id: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .id))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"coordinates\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[coordinates]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}lat: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .lat),]{.s1}

[[                ]{.Apple-converted-space}lng: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .lng)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"address\"]{.s10}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[address]{.s9}[(]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .address))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[throw]{.s8}[
]{.s6}[DecodingError]{.s11}[.]{.s6}[dataCorruptedError]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}forKey: .type,]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[in]{.s8}[:
container,]{.s1}

[[                ]{.Apple-converted-space}debugDescription:
]{.s1}[\"Unknown location type\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[DeparturePreferences]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ avoidRain:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ minimizeTime:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[RouteWeatherRequest]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportMode:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[OptimizeDepartureRequest]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ arriveBy:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ preferences:
]{.s6}[DeparturePreferences]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[OptimizeDepartureResponse]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ options:
\[]{.s1}[DepartureOption]{.s11}[\]]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CompareTransportRequest]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ modes:
\[]{.s1}[String]{.s11}[\]]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportComparisonResult]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ comparisons:
\[]{.s1}[TransportComparison]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ suggestion:
]{.s6}[TransportSuggestion]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[TransportSuggestion]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ mode:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ reason:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[A2AError]{.s1}[: ]{.s6}[Error]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ invalidResponse]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[serverError]{.s9}[(code: ]{.s1}[String]{.s11}[, message:
]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[networkError]{.s1}[(]{.s6}[Error]{.s11}[)]{.s6}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[A2AErrorResponse]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ code:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[Voice Service]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// SERVICES/VoiceService.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[AVFoundation]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[VoiceService]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// PUBLISHED STATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ state: ]{.s1}[VoiceState]{.s11}[ ]{.s1}[=]{.s9}[
.idle]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ partialTranscript: ]{.s1}[String]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ finalTranscript: ]{.s1}[String]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ responseText: ]{.s1}[String]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ audioLevel: ]{.s1}[Float]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ error: ]{.s6}[VoiceError]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[VoiceState]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ idle]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ connecting]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ listening]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ processing]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ speaking]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ error]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// PRIVATE PROPERTIES*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[var]{.s8}[
webSocket: ]{.s6}[URLSessionWebSocketTask]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioEngine: ]{.s1}[AVAudioEngine]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
inputNode: ]{.s1}[AVAudioInputNode]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioPlayer: ]{.s1}[AVAudioPlayerNode]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioSession: ]{.s1}[AVAudioSession]{.s11}[ {
.]{.s1}[sharedInstance]{.s9}[() }]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[let]{.s8}[
baseURL ]{.s6}[=]{.s9}[ ]{.s6}[URL]{.s9}[(string:
]{.s6}[\"wss://api.liquidcrypto.app/v1/voice\"]{.s1}[)]{.s6}[!]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
authToken: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
sessionId: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioBuffer ]{.s1}[=]{.s9}[ ]{.s1}[Data]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
audioFormat ]{.s1}[=]{.s9}[ ]{.s1}[AVAudioFormat]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}commonFormat: .pcmFormatInt16,]{.s1}

[[        ]{.Apple-converted-space}sampleRate:
]{.s1}[16000]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}channels: ]{.s1}[1]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}interleaved: ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space})]{.s1}[!]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// PUBLIC METHODS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setAuthToken]{.s9}[(]{.s1}[\_]{.s8}[ token:
]{.s1}[String]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.authToken
]{.s1}[=]{.s9}[ token]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s1}[
]{.s6}[startSession]{.s9}[() ]{.s6}[async]{.s1}[ ]{.s6}[throws]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ state
]{.s1}[==]{.s9}[ .idle ]{.s1}[else]{.s8}[ { ]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.connecting]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Configure audio
session*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[
]{.s6}[configureAudioSession]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Connect WebSocket*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[ ]{.s6}[await]{.s8}[
]{.s6}[connectWebSocket]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start audio capture*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[
]{.s6}[startAudioCapture]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.listening]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[endSession]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[stopAudioCapture]{.s1}[()]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[disconnectWebSocket]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[ .idle]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Reset state*]{.s1}

[[        ]{.Apple-converted-space}partialTranscript ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[        ]{.Apple-converted-space}finalTranscript ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[        ]{.Apple-converted-space}responseText ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[commitAudio]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// User manually ended speech
(e.g., released button)*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.audioCommit)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[interruptResponse]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// User wants to stop the AI
from speaking*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.responseInterrupt)]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[stopPlayback]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.listening]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[sendTextInput]{.s9}[(]{.s1}[\_]{.s8}[ text:
]{.s1}[String]{.s11}[) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.]{.s1}[textInput]{.s9}[(text:
text))]{.s1}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.processing]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUDIO SESSION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[configureAudioSession]{.s1}[() ]{.s6}[throws]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
audioSession.]{.s1}[setCategory]{.s9}[(]{.s1}

[[            ]{.Apple-converted-space}.playAndRecord,]{.s1}

[[            ]{.Apple-converted-space}mode: .voiceChat,]{.s1}

[[            ]{.Apple-converted-space}options: \[.defaultToSpeaker,
.allowBluetooth\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
audioSession.]{.s1}[setActive]{.s9}[(]{.s1}[true]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEBSOCKET*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[connectWebSocket]{.s9}[() ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[URLRequest]{.s11}[(url: baseURL)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
token ]{.s1}[=]{.s9}[ authToken {]{.s1}

[[           
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(token)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
sessionId ]{.s1}[=]{.s9}[ sessionId {]{.s1}

[[           
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(sessionId,
forHTTPHeaderField: ]{.s1}[\"X-Session-ID\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}webSocket ]{.s1}[=]{.s9}[
]{.s1}[URLSession]{.s11}[.shared.]{.s1}[webSocketTask]{.s9}[(with:
request)]{.s1}

[[       
]{.Apple-converted-space}webSocket]{.s1}[?]{.s9}[.]{.s1}[resume]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Send session start*]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[sendMessage]{.s1}[(]{.s6}[VoiceMessage]{.s11}[.]{.s6}[sessionStart]{.s1}[(config:
.]{.s6}[init]{.s8}[(]{.s6}

[[            ]{.Apple-converted-space}inputFormat:
]{.s1}[\"pcm_16khz_mono\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}outputFormat:
]{.s1}[\"pcm_24khz_mono\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}vadEnabled:
]{.s1}[true]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}interruptEnabled:
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space})))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start receiving
messages*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[await]{.s8}[ ]{.s1}[receiveMessages]{.s9}[() }]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[disconnectWebSocket]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.sessionEnd)]{.s1}

[[       
]{.Apple-converted-space}webSocket]{.s1}[?]{.s9}[.]{.s1}[cancel]{.s9}[(with:
.goingAway, reason: ]{.s1}[nil]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}webSocket ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[sendMessage]{.s9}[(]{.s1}[\_]{.s8}[ message:
]{.s1}[VoiceMessage]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
webSocket ]{.s1}[=]{.s9}[ webSocket ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
]{.s1}[JSONEncoder]{.s11}[().]{.s1}[encode]{.s9}[(message)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ string
]{.s1}[=]{.s9}[ ]{.s1}[String]{.s11}[(data: data, encoding:
.utf8)]{.s1}[!]{.s9}

[[           
]{.Apple-converted-space}webSocket.]{.s1}[send]{.s9}[(.]{.s1}[string]{.s9}[(string))
{ error ]{.s1}[in]{.s8}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ error ]{.s1}[=]{.s9}[ error {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[print]{.s9}[(]{.s1}[\"WebSocket send
error: ]{.s10}[\\(error)]{.s1}[\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to encode
message: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[receiveMessages]{.s9}[() ]{.s6}[async]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
webSocket ]{.s1}[=]{.s9}[ webSocket ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[while]{.s8}[
]{.s1}[true]{.s11}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
webSocket.]{.s1}[receive]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ message
{]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[string]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[handleTextMessage]{.s9}[(text)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[data]{.s9}[(]{.s1}[let]{.s8}[ data):]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[handleBinaryMessage]{.s9}[(data)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\@unknown]{.s11}[
]{.s1}[default]{.s8}[:]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[break]{.s8}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .error]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.error
]{.s1}[=]{.s9}[ .connectionLost]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[handleTextMessage]{.s9}[(]{.s1}[\_]{.s8}[ text:
]{.s1}[String]{.s11}[) ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
data ]{.s1}[=]{.s9}[ text.]{.s1}[data]{.s9}[(using: .utf8),]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[ServerMessage]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ message
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[sessionStarted]{.s9}[(]{.s1}[let]{.s8}[ sessionId):]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.sessionId
]{.s1}[=]{.s9}[ sessionId]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.speechStarted:]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.partialTranscript
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[transcriptPartial]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.partialTranscript
]{.s1}[=]{.s9}[ text]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[transcriptFinal]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.finalTranscript
]{.s1}[=]{.s9}[ text]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.partialTranscript
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .processing]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.processingStarted:]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .processing]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[textOutput]{.s9}[(]{.s1}[let]{.s8}[ text, ]{.s1}[let]{.s8}[
isFinal):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.responseText ]{.s1}[=]{.s9}[
text]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[ isFinal
{]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .listening]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[responseComplete]{.s9}[(]{.s1}[let]{.s8}[ data):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.responseText ]{.s1}[=]{.s9}[
data.text]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .listening]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Handle structured
data and suggested actions*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[error]{.s9}[(]{.s1}[let]{.s8}[ code, ]{.s1}[let]{.s8}[
message):]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.error
]{.s1}[=]{.s9}[ .]{.s1}[serverError]{.s9}[(code: code, message:
message)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .error]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[handleBinaryMessage]{.s1}[(]{.s6}[\_]{.s8}[ data:
]{.s6}[Data]{.s11}[) ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Audio output from
server*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .speaking]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[playAudio]{.s9}[(data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUDIO CAPTURE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[startAudioCapture]{.s1}[() ]{.s6}[throws]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}audioEngine ]{.s1}[=]{.s9}[
]{.s1}[AVAudioEngine]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
audioEngine ]{.s1}[=]{.s9}[ audioEngine ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}inputNode ]{.s1}[=]{.s9}[
audioEngine.inputNode]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
inputNode ]{.s1}[=]{.s9}[ inputNode ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ recordingFormat
]{.s1}[=]{.s9}[ inputNode.]{.s1}[outputFormat]{.s9}[(forBus:
]{.s1}[0]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Install tap to capture
audio*]{.s1}

[[       
]{.Apple-converted-space}inputNode.]{.s1}[installTap]{.s9}[(]{.s1}

[[            ]{.Apple-converted-space}onBus: ]{.s1}[0]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}bufferSize:
]{.s1}[1024]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}format: recordingFormat]{.s1}

[[        ]{.Apple-converted-space}) { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] buffer, time ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[processAudioBuffer]{.s9}[(buffer)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
audioEngine.]{.s1}[start]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[stopAudioCapture]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}inputNode]{.s1}[?]{.s9}[.]{.s1}[removeTap]{.s9}[(onBus:
]{.s1}[0]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}audioEngine]{.s1}[?]{.s9}[.]{.s1}[stop]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}audioEngine ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[processAudioBuffer]{.s9}[(]{.s1}[\_]{.s8}[ buffer:
]{.s1}[AVAudioPCMBuffer]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Convert to 16-bit PCM at
16kHz*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
channelData ]{.s1}[=]{.s9}[
buffer.floatChannelData]{.s1}[?]{.s9}[\[]{.s1}[0]{.s11}[\]
]{.s1}[else]{.s8}[ { ]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ frameCount
]{.s1}[=]{.s9}[ ]{.s1}[Int]{.s11}[(buffer.frameLength)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Calculate audio level for
UI*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ sum:
]{.s1}[Float]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[0]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ i ]{.s1}[in]{.s8}[
]{.s1}[0]{.s11}[..\<]{.s9}[frameCount {]{.s1}

[[            ]{.Apple-converted-space}sum ]{.s1}[+=]{.s9}[
]{.s1}[abs]{.s9}[(channelData\[i\])]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ level
]{.s1}[=]{.s9}[ sum ]{.s1}[/]{.s9}[
]{.s1}[Float]{.s11}[(frameCount)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[Task]{.s1}[ {
]{.s6}[\@MainActor]{.s1}[ ]{.s6}[in]{.s8}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[.audioLevel
]{.s1}[=]{.s9}[ level]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Convert float to
int16*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ int16Data
]{.s1}[=]{.s9}[ \[]{.s1}[Int16]{.s11}[\](repeating: ]{.s1}[0]{.s11}[,
count: frameCount)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ i ]{.s1}[in]{.s8}[
]{.s1}[0]{.s11}[..\<]{.s9}[frameCount {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ sample
]{.s1}[=]{.s9}[ ]{.s1}[max]{.s9}[(]{.s1}[-]{.s9}[1.0]{.s11}[,
]{.s1}[min]{.s9}[(]{.s1}[1.0]{.s11}[, channelData\[i\]))]{.s1}

[[            ]{.Apple-converted-space}int16Data\[i\] ]{.s1}[=]{.s9}[
]{.s1}[Int16]{.s11}[(sample ]{.s1}[\*]{.s9}[
]{.s1}[Float]{.s11}[(]{.s1}[Int16]{.s11}[.max))]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Resample to 16kHz if
needed (simplified - use proper resampler in production)*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ audioData
]{.s1}[=]{.s9}[ ]{.s1}[Data]{.s11}[(bytes: int16Data, count: frameCount
]{.s1}[\*]{.s9}[ ]{.s1}[2]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Send to server*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendAudioChunk]{.s9}[(audioData)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[sendAudioChunk]{.s9}[(]{.s1}[\_]{.s8}[ data: ]{.s1}[Data]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ base64
]{.s1}[=]{.s9}[ data.]{.s1}[base64EncodedString]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.]{.s1}[audioInput]{.s9}[(data:
base64))]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUDIO PLAYBACK*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[playAudio]{.s9}[(]{.s1}[\_]{.s8}[ data: ]{.s1}[Data]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Decode base64 and play PCM
audio*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation depends on
audio format from server*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Using AVAudioPlayerNode
for low-latency playback*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[stopPlayback]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}audioPlayer]{.s1}[?]{.s9}[.]{.s1}[stop]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// MESSAGE TYPES*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[VoiceMessage]{.s1}[: ]{.s6}[Encodable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[sessionStart]{.s9}[(config: ]{.s1}[SessionConfig]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[audioInput]{.s9}[(data: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ audioCommit]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
responseInterrupt]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[textInput]{.s9}[(text: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ sessionEnd]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[SessionConfig]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ inputFormat:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ outputFormat:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ vadEnabled:
]{.s1}[Bool]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ interruptEnabled:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ type, config,
data, text]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[encode]{.s9}[(to encoder: ]{.s1}[Encoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ container
]{.s1}[=]{.s9}[ encoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[sessionStart]{.s9}[(]{.s1}[let]{.s8}[ config):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"session.start\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(config, forKey: .config)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[audioInput]{.s9}[(]{.s1}[let]{.s8}[ data):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"audio.input\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(data, forKey: .data)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.audioCommit:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"audio.commit\"]{.s10}[, forKey:
.type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.responseInterrupt:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"response.interrupt\"]{.s10}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[textInput]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"text.input\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(text, forKey: .text)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .sessionEnd:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"session.end\"]{.s10}[, forKey:
.type)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[ServerMessage]{.s1}[: ]{.s6}[Decodable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[sessionStarted]{.s9}[(sessionId: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ speechStarted]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[transcriptPartial]{.s1}[(text: ]{.s6}[String]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[transcriptFinal]{.s1}[(text: ]{.s6}[String]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
processingStarted]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[textOutput]{.s9}[(text: ]{.s1}[String]{.s11}[, isFinal:
]{.s1}[Bool]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[responseComplete]{.s1}[(data: ]{.s6}[ResponseData]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[error]{.s9}[(code: ]{.s1}[String]{.s11}[, message:
]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[ResponseData]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ text:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ structuredData:
\[]{.s1}[String]{.s11}[: ]{.s1}[AnyCodable]{.s11}[\]]{.s1}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ suggestedActions:
\[]{.s1}[SuggestedAction]{.s11}[\]]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[SuggestedAction]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ label:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ skillId:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ type, sessionId,
text, isFinal, data, code, message]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(from decoder:
]{.s1}[Decoder]{.s11}[) ]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ container
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
decoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ type
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ type {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"session.started\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[sessionStarted]{.s9}[(sessionId:
]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .sessionId))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"speech.started\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .speechStarted]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"transcript.partial\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[transcriptPartial]{.s9}[(text: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .text))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"transcript.final\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[transcriptFinal]{.s9}[(text: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .text))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"processing.started\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .processingStarted]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"text.output\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[textOutput]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}text: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .text),]{.s1}

[[                ]{.Apple-converted-space}isFinal: ]{.s1}[try]{.s8}[
container.]{.s1}[decodeIfPresent]{.s9}[(]{.s1}[Bool]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .isFinal) ]{.s1}[??]{.s9}[ ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"response.complete\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[responseComplete]{.s9}[(data: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[ResponseData]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .data))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"error\"]{.s10}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[error]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}code: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .code),]{.s1}

[[                ]{.Apple-converted-space}message: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .message)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[throw]{.s8}[
]{.s6}[DecodingError]{.s11}[.]{.s6}[dataCorruptedError]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}forKey: .type,]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[in]{.s8}[:
container,]{.s1}

[[                ]{.Apple-converted-space}debugDescription:
]{.s1}[\"Unknown message type: ]{.s10}[\\(type)]{.s1}[\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[VoiceError]{.s1}[: ]{.s6}[Error]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ connectionLost]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
audioSessionFailed]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[serverError]{.s9}[(code: ]{.s1}[String]{.s11}[, message:
]{.s1}[String]{.s11}[)]{.s1}

[}]{.s1}

[]{.s1}\

[Design System Components]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Theme/Colors.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[extension]{.s1}[ ]{.s6}[Color]{.s11}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SURFACE COLORS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
surfaceBackground ]{.s1}[=]{.s9}[
]{.s1}[Color]{.s11}[(]{.s1}[\"SurfaceBackground\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
surfaceCard ]{.s1}[=]{.s9}[
]{.s1}[Color]{.s11}[(]{.s1}[\"SurfaceCard\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
surfaceElevated ]{.s1}[=]{.s9}[
]{.s1}[Color]{.s11}[(]{.s1}[\"SurfaceElevated\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEATHER COLORS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherClear ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"3B82F6\"]{.s10}[)[      ]{.Apple-converted-space}]{.s1}[*//
Blue*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherCloudy ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"94A3B8\"]{.s10}[) [    ]{.Apple-converted-space}]{.s1}[*//
Slate*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherRain ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"6366F1\"]{.s10}[) [      ]{.Apple-converted-space}]{.s1}[*//
Indigo*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherHeavyRain ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"7C3AED\"]{.s10}[)[  ]{.Apple-converted-space}]{.s1}[*//
Violet*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherSnow ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"E2E8F0\"]{.s10}[) [      ]{.Apple-converted-space}]{.s1}[*//
Light gray*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherFog ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"64748B\"]{.s10}[)[        ]{.Apple-converted-space}]{.s1}[*//
Gray*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// ALERT COLORS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
alertWarning ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"F59E0B\"]{.s10}[)[      ]{.Apple-converted-space}]{.s1}[*//
Amber*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
alertDanger ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"EF4444\"]{.s10}[) [      ]{.Apple-converted-space}]{.s1}[*//
Red*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
alertSuccess ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"10B981\"]{.s10}[)[      ]{.Apple-converted-space}]{.s1}[*//
Emerald*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HELPER*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(hex:
]{.s1}[String]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hex ]{.s1}[=]{.s9}[
hex.]{.s1}[trimmingCharacters]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[CharacterSet]{.s11}[.alphanumerics.inverted)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ int:
]{.s1}[UInt64]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[0]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[Scanner]{.s11}[(string:
hex).]{.s1}[scanHexInt64]{.s9}[(]{.s1}[&]{.s9}[int)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ a, r, g, b:
]{.s1}[UInt64]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ hex.count
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[3]{.s11}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[
(]{.s1}[255]{.s11}[, (int ]{.s1}[\>\>]{.s9}[ ]{.s1}[8]{.s11}[)
]{.s1}[\*]{.s9}[ ]{.s1}[17]{.s11}[, (int ]{.s1}[\>\>]{.s9}[
]{.s1}[4]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xF]{.s11}[) ]{.s1}[\*]{.s9}[
]{.s1}[17]{.s11}[, (int ]{.s1}[&]{.s9}[ ]{.s1}[0xF]{.s11}[)
]{.s1}[\*]{.s9}[ ]{.s1}[17]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[6]{.s11}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[
(]{.s1}[255]{.s11}[, int ]{.s1}[\>\>]{.s9}[ ]{.s1}[16]{.s11}[, int
]{.s1}[\>\>]{.s9}[ ]{.s1}[8]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[,
int ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[8]{.s11}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[ (int
]{.s1}[\>\>]{.s9}[ ]{.s1}[24]{.s11}[, int ]{.s1}[\>\>]{.s9}[
]{.s1}[16]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[, int
]{.s1}[\>\>]{.s9}[ ]{.s1}[8]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[,
int ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[
(]{.s1}[1]{.s11}[, ]{.s1}[1]{.s11}[, ]{.s1}[1]{.s11}[,
]{.s1}[0]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.]{.s1}[init]{.s8}[(]{.s1}

[[            ]{.Apple-converted-space}.sRGB,]{.s1}

[[            ]{.Apple-converted-space}red: ]{.s1}[Double]{.s11}[(r)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}green: ]{.s1}[Double]{.s11}[(g)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}blue: ]{.s1}[Double]{.s11}[(b)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}opacity: ]{.s1}[Double]{.s11}[(a)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/GlassCard.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[GlassCard]{.s1}[\<]{.s9}[Content]{.s1}[:
]{.s6}[View]{.s1}[\>]{.s9}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ variant:
]{.s1}[Variant]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ weatherTint:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}[
]{.s6}[let]{.s8}[ content: ]{.s6}[Content]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Variant]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
\`]{.s1}[default]{.s8}[\`]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ elevated]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ tinted]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}

[[        ]{.Apple-converted-space}variant: ]{.s1}[Variant]{.s11}[
]{.s1}[=]{.s9}[ .]{.s1}[default]{.s8}[,]{.s1}

[[        ]{.Apple-converted-space}weatherTint:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}[?]{.s9}[
]{.s6}[=]{.s9}[ ]{.s6}[nil]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\@ViewBuilder]{.s11}[ content:
() ]{.s1}[-\>]{.s9}[ ]{.s1}[Content]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.variant
]{.s1}[=]{.s9}[ variant]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.weatherTint
]{.s1}[=]{.s9}[ weatherTint]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.content
]{.s1}[=]{.s9}[ ]{.s1}[content]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}content]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(]{.s1}[16]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(backgroundView)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[16]{.s11}[, style: .continuous))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[16]{.s11}[, style: .continuous)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[stroke]{.s9}[(]{.s1}[Color]{.s11}[.white.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[),
lineWidth: ]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[shadow]{.s9}[(color:
shadowColor, radius: shadowRadius)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
backgroundView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ variant {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[default]{.s8}[:]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.regular]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .elevated:]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.thick]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .tinted:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ tint ]{.s1}[=]{.s9}[ weatherTint {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[LinearGradient]{.s11}[(]{.s1}

[[                    ]{.Apple-converted-space}colors: \[]{.s1}

[[                       
]{.Apple-converted-space}tint.color.]{.s1}[opacity]{.s9}[(]{.s1}[0.15]{.s11}[),]{.s1}

[[                       
]{.Apple-converted-space}tint.color.]{.s1}[opacity]{.s9}[(]{.s1}[0.05]{.s11}[)]{.s1}

[[                    ]{.Apple-converted-space}\],]{.s1}

[[                    ]{.Apple-converted-space}startPoint:
.topLeading,]{.s1}

[[                    ]{.Apple-converted-space}endPoint:
.bottomTrailing]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Material]{.s11}[.regular)]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.regular]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shadowColor: ]{.s1}[Color]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ variant {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[default]{.s8}[: ]{.s1}[return]{.s8}[
.black.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .elevated:
]{.s1}[return]{.s8}[
.black.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .tinted:
]{.s1}[return]{.s8}[
.black.]{.s1}[opacity]{.s9}[(]{.s1}[0.15]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shadowRadius: ]{.s1}[CGFloat]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ variant {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s1}[
.]{.s6}[default]{.s1}[: ]{.s6}[return]{.s1}[ ]{.s6}[8]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .elevated:
]{.s1}[return]{.s8}[ ]{.s1}[16]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .tinted:
]{.s1}[return]{.s8}[ ]{.s1}[12]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/WeatherTimeline.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTimelineView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ timeline:
]{.s1}[WeatherTimeline]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ orientation:
]{.s1}[Orientation]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[Orientation]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ vertical]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ horizontal]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ orientation
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .vertical:]{.s1}

[[            ]{.Apple-converted-space}verticalTimeline]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .horizontal:]{.s1}

[[            ]{.Apple-converted-space}horizontalTimeline]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
verticalTimeline: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[0]{.s11}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(]{.s1}[Array]{.s11}[(timeline.points.]{.s1}[enumerated]{.s9}[()),
id: \\.element.id) { index, point ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[12]{.s11}[) {]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[*// Timeline
marker*]{.s13}

[[                   
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Circle]{.s11}[()]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[markerColor]{.s9}[(]{.s1}[for]{.s8}[:
index))]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width: ]{.s1}[12]{.s11}[,
height: ]{.s1}[12]{.s11}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
index ]{.s1}[\<]{.s9}[ timeline.points.count ]{.s1}[-]{.s9}[
]{.s1}[1]{.s11}[ {]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[lineGradient]{.s9}[(from:
index))]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width:
]{.s1}[4]{.s11}[)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[*//
Content*]{.s13}

[[                   
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading,
spacing: ]{.s1}[4]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[formatTime]{.s9}[(point.time))]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(point.weather.condition.icon)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(]{.s1}[Int]{.s11}[(point.weather.tempFahrenheit))]{.s1}[°\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(point.weather.condition.rawValue.capitalized)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(minHeight:
]{.s1}[60]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
horizontalTimeline: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(]{.s1}[Array]{.s11}[(timeline.points.]{.s1}[enumerated]{.s9}[()),
id: \\.element.id) { index, point ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[8]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(point.weather.condition.icon)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[formatTime]{.s9}[(point.time))]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(maxWidth: .infinity)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[ index
]{.s1}[\<]{.s9}[ timeline.points.count ]{.s1}[-]{.s9}[ ]{.s1}[1]{.s11}[
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[lineGradient]{.s9}[(]{.s1}

[]{.s1}\

[]{.s1}\

[API Error: Claude\'s response exceeded the 32000 output token maximum.
To configure this behavior, set the CLAUDE_CODE_MAX_OUTPUT_TOKENS
environment variable.]{.s3}

[]{.s1}\

[I\'ll continue from where I left off with the WeatherTimelineView and
then complete the remaining iOS components.]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/WeatherTimeline.swift (continued)*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[[                   
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[lineGradient]{.s9}[(from:
index))]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(height:
]{.s1}[3]{.s11}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(maxWidth:
]{.s1}[40]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[markerColor]{.s9}[(]{.s1}[for]{.s8}[ index: ]{.s1}[Int]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[Color]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ index
]{.s1}[==]{.s9}[ ]{.s1}[0]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ .blue
]{.s1}[*// Current position*]{.s13}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ ]{.s1}[if]{.s8}[
index ]{.s1}[==]{.s9}[ timeline.points.count ]{.s1}[-]{.s9}[
]{.s1}[1]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ .green
]{.s1}[*// Destination*]{.s13}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
timeline.points\[index\].weather.condition.color]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[lineGradient]{.s9}[(from index: ]{.s1}[Int]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[LinearGradient]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ fromColor
]{.s1}[=]{.s9}[ timeline.points\[index\].weather.condition.color]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ toColor
]{.s1}[=]{.s9}[ timeline.points\[index ]{.s1}[+]{.s9}[
]{.s1}[1]{.s11}[\].weather.condition.color]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}colors: \[fromColor,
toColor\],]{.s1}

[[            ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[            ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[formatTime]{.s9}[(]{.s1}[\_]{.s8}[ date: ]{.s1}[Date]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ formatter
]{.s1}[=]{.s9}[ ]{.s1}[DateFormatter]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}formatter.dateFormat ]{.s1}[=]{.s9}[
]{.s1}[\"h:mm a\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
formatter.]{.s1}[string]{.s9}[(from: date)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/WeatherIcon.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherIcon]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ condition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ size:
]{.s1}[Size]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ animated:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Size]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ small, medium,
large, hero]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ dimension:
]{.s1}[CGFloat]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .small:
]{.s1}[return]{.s8}[ ]{.s1}[24]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ ]{.s1}[40]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .large:
]{.s1}[return]{.s8}[ ]{.s1}[64]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .hero:
]{.s1}[return]{.s8}[ ]{.s1}[120]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ fontSize:
]{.s1}[CGFloat]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .small:
]{.s1}[return]{.s8}[ ]{.s1}[20]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ ]{.s1}[32]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .large:
]{.s1}[return]{.s8}[ ]{.s1}[56]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .hero:
]{.s1}[return]{.s8}[ ]{.s1}[100]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}[\_]{.s8}[
condition: ]{.s1}[WeatherCondition]{.s11}[.]{.s1}[WeatherType]{.s11}[,
size: ]{.s1}[Size]{.s11}[ ]{.s1}[=]{.s9}[ .medium, animated:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.condition
]{.s1}[=]{.s9}[ condition]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.size
]{.s1}[=]{.s9}[ size]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.animated
]{.s1}[=]{.s9}[ animated]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(condition.icon)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
size.fontSize))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width:
size.dimension, height: size.dimension)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[modifier]{.s9}[(]{.s1}[WeatherAnimationModifier]{.s11}[(condition:
condition, animated: animated))]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherAnimationModifier]{.s1}[:
]{.s6}[ViewModifier]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ condition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ animated:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ isAnimating ]{.s1}[=]{.s9}[
]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[body]{.s9}[(content: ]{.s1}[Content]{.s11}[) ]{.s1}[-\>]{.s9}[
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}content]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[opacity]{.s9}[(animated
]{.s1}[&&]{.s9}[ shouldPulse ]{.s1}[?]{.s9}[ (isAnimating
]{.s1}[?]{.s9}[ ]{.s1}[0.7]{.s11}[ : ]{.s1}[1.0]{.s11}[) :
]{.s1}[1.0]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[scaleEffect]{.s9}[(animated
]{.s1}[&&]{.s9}[ shouldBounce ]{.s1}[?]{.s9}[ (isAnimating
]{.s1}[?]{.s9}[ ]{.s1}[1.05]{.s11}[ : ]{.s1}[1.0]{.s11}[) :
]{.s1}[1.0]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}.onAppear {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[ animated
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[withAnimation]{.s9}[(.]{.s1}[easeInOut]{.s9}[(duration:
]{.s1}[1.5]{.s11}[).]{.s1}[repeatForever]{.s9}[(autoreverses:
]{.s1}[true]{.s11}[)) {]{.s1}

[[                        ]{.Apple-converted-space}isAnimating
]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shouldPulse: ]{.s1}[Bool]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ condition
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .rain, .heavyRain,
.lightRain, .thunderstorm:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shouldBounce: ]{.s1}[Bool]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}condition ]{.s1}[==]{.s9}[
.clear]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/GlassButton.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[GlassButton]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ title:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ style:
]{.s1}[Style]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ action: ()
]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Style]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ primary]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ secondary]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ destructive]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ backgroundColor:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .primary:
]{.s1}[return]{.s8}[ .blue]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .secondary:
]{.s1}[return]{.s8}[ .clear]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .destructive:
]{.s1}[return]{.s8}[ .red]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ foregroundColor:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .primary,
.destructive: ]{.s1}[return]{.s8}[ .white]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .secondary:
]{.s1}[return]{.s8}[ .primary]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ title:
]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}icon: ]{.s1}[String]{.s11}[?]{.s9}[
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}style: ]{.s1}[Style]{.s11}[
]{.s1}[=]{.s9}[ .primary,]{.s1}

[[        ]{.Apple-converted-space}action: ]{.s1}[\@escaping]{.s11}[ ()
]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.title
]{.s1}[=]{.s9}[ title]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.icon
]{.s1}[=]{.s9}[ icon]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.style
]{.s1}[=]{.s9}[ style]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.action
]{.s1}[=]{.s9}[ action]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Button]{.s11}[(action: action)
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[8]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ icon ]{.s1}[=]{.s9}[ icon {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName: icon)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(title)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.horizontal,
]{.s1}[20]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.vertical,
]{.s1}[14]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(minWidth:
]{.s1}[44]{.s11}[, minHeight: ]{.s1}[44]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(backgroundView)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(style.foregroundColor)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[12]{.s11}[, style: .continuous))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[12]{.s11}[, style: .continuous)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[stroke]{.s9}[(]{.s1}[Color]{.s11}[.white.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[),
lineWidth: ]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[buttonStyle]{.s9}[(]{.s6}[ScaleButtonStyle]{.s1}[())]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
backgroundView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ style {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .primary:]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}colors: \[.blue,
.blue.]{.s1}[opacity]{.s9}[(]{.s1}[0.8]{.s11}[)\],]{.s1}

[[                ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[                ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .secondary:]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.ultraThin]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.destructive:]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}colors: \[.red,
.red.]{.s1}[opacity]{.s9}[(]{.s1}[0.8]{.s11}[)\],]{.s1}

[[                ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[                ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ScaleButtonStyle]{.s1}[: ]{.s6}[ButtonStyle]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[makeBody]{.s9}[(configuration: ]{.s1}[Configuration]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}configuration.label]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[scaleEffect]{.s9}[(configuration.isPressed
]{.s1}[?]{.s9}[ ]{.s1}[0.96]{.s11}[ : ]{.s1}[1.0]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[animation]{.s9}[(.]{.s1}[spring]{.s9}[(response:
]{.s1}[0.2]{.s11}[), value: configuration.isPressed)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[CarPlay Integration]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CARPLAY/CarPlaySceneDelegate.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[CarPlay]{.s1}

[]{.s1}\

[class]{.s8}[ ]{.s6}[CarPlaySceneDelegate]{.s1}[:
]{.s6}[UIResponder]{.s1}[,
]{.s6}[CPTemplateApplicationSceneDelegate]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ interfaceController:
]{.s1}[CPInterfaceController]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
carPlayManager ]{.s1}[=]{.s9}[ ]{.s1}[CarPlayManager]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SCENE LIFECYCLE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[templateApplicationScene]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[
templateApplicationScene:
]{.s1}[CPTemplateApplicationScene]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didConnect interfaceController:
]{.s1}[CPInterfaceController]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.interfaceController
]{.s1}[=]{.s9}[ interfaceController]{.s1}

[[        ]{.Apple-converted-space}carPlayManager.interfaceController
]{.s1}[=]{.s9}[ interfaceController]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Set up the initial
template*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ homeTemplate
]{.s1}[=]{.s9}[ carPlayManager.]{.s1}[createHomeTemplate]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}interfaceController.]{.s1}[setRootTemplate]{.s9}[(homeTemplate,
animated: ]{.s1}[false]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Notify app that CarPlay is
connected*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.carPlayDidConnect, object: ]{.s1}[nil]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[templateApplicationScene]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[
templateApplicationScene:
]{.s1}[CPTemplateApplicationScene]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didDisconnect interfaceController:
]{.s1}[CPInterfaceController]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.interfaceController
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}carPlayManager.interfaceController
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.carPlayDidDisconnect, object: ]{.s1}[nil]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[Notification]{.s1}[.]{.s6}[Name]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
carPlayDidConnect ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"carPlayDidConnect\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
carPlayDidDisconnect ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"carPlayDidDisconnect\"]{.s10}[)]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CARPLAY/CarPlayManager.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[CarPlay]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[CarPlayManager]{.s1}[:
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[weak]{.s8}[ ]{.s1}[var]{.s8}[
interfaceController: ]{.s1}[CPInterfaceController]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
a2aClient: ]{.s1}[A2AClient]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
voiceService: ]{.s1}[VoiceService]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
locationService: ]{.s1}[LocationService]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
cancellables ]{.s1}[=]{.s9}[
]{.s1}[Set]{.s11}[\<]{.s9}[AnyCancellable]{.s11}[\>]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
currentNavigation: ]{.s1}[NavigationSession]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}

[[        ]{.Apple-converted-space}a2aClient: ]{.s1}[A2AClient]{.s11}[
]{.s1}[=]{.s9}[ .shared,]{.s1}

[[        ]{.Apple-converted-space}voiceService:
]{.s1}[VoiceService]{.s11}[ ]{.s1}[=]{.s9}[ .shared,]{.s1}

[[        ]{.Apple-converted-space}locationService:
]{.s1}[LocationService]{.s11}[ ]{.s1}[=]{.s9}[ .shared]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.a2aClient
]{.s1}[=]{.s9}[ a2aClient]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.voiceService
]{.s1}[=]{.s9}[ voiceService]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.locationService
]{.s1}[=]{.s9}[ locationService]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HOME TEMPLATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[createHomeTemplate]{.s1}[() ]{.s6}[-\>]{.s1}[
]{.s6}[CPTemplate]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// For navigation apps, we
use CPMapTemplate as the base*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ mapTemplate
]{.s1}[=]{.s9}[ ]{.s1}[CPMapTemplate]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}mapTemplate.guidanceBackgroundColor
]{.s1}[=]{.s9}[ ]{.s1}[UIColor]{.s11}[.systemBackground]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add map buttons*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceButton
]{.s1}[=]{.s9}[ ]{.s1}[CPMapButton]{.s11}[ { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s6}[self]{.s8}[?]{.s1}[.]{.s6}[startVoiceInteraction]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}voiceButton.image ]{.s1}[=]{.s9}[
]{.s1}[UIImage]{.s11}[(systemName: ]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ searchButton
]{.s1}[=]{.s9}[ ]{.s1}[CPMapButton]{.s11}[ { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s6}[self]{.s8}[?]{.s1}[.]{.s6}[showDestinationSearch]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}searchButton.image ]{.s1}[=]{.s9}[
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"magnifyingglass\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}mapTemplate.mapButtons
]{.s1}[=]{.s9}[ \[voiceButton, searchButton\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add trip previews as
dashboard*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[updateDashboard]{.s9}[(on:
mapTemplate)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
mapTemplate]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[updateDashboard]{.s9}[(on mapTemplate:
]{.s1}[CPMapTemplate]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Fetch commute
data*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[guard]{.s8}[
]{.s1}[let]{.s8}[ homeLocation ]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getUserLocation]{.s9}[(label: .home),]{.s1}

[[                  ]{.Apple-converted-space}]{.s1}[let]{.s8}[
workLocation ]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getUserLocation]{.s9}[(label: .work) ]{.s1}[else]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
routeWeather ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.]{.s1}[savedLocation]{.s9}[(id: homeLocation.id.uuidString),]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: workLocation.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Create trip
preview*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tripPreview
]{.s1}[=]{.s9}[ ]{.s1}[createTripPreview]{.s9}[(from:
routeWeather)]{.s1}

[[               
]{.Apple-converted-space}mapTemplate.]{.s1}[showTripPreviews]{.s9}[(\[tripPreview\],
textConfiguration: ]{.s1}[nil]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to fetch
route weather: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[createTripPreview]{.s9}[(from result:
]{.s1}[RouteWeatherResult]{.s11}[) ]{.s1}[-\>]{.s9}[
]{.s1}[CPTrip]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin
]{.s1}[=]{.s9}[ ]{.s1}[MKMapItem]{.s11}[(placemark:
]{.s1}[MKPlacemark]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}coordinate:
result.route.origin.coordinate]{.s1}

[[        ]{.Apple-converted-space}))]{.s1}

[[        ]{.Apple-converted-space}origin.name ]{.s1}[=]{.s9}[
result.route.origin.name]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination
]{.s1}[=]{.s9}[ ]{.s1}[MKMapItem]{.s11}[(placemark:
]{.s1}[MKPlacemark]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}coordinate:
result.route.destination.coordinate]{.s1}

[[        ]{.Apple-converted-space}))]{.s1}

[[        ]{.Apple-converted-space}destination.name ]{.s1}[=]{.s9}[
result.route.destination.name]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trip
]{.s1}[=]{.s9}[ ]{.s1}[CPTrip]{.s11}[(origin: origin, destination:
destination, routeChoices: \[\])]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add route estimate with
weather info*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ estimate
]{.s6}[=]{.s9}[ ]{.s6}[CPTripPreviewTextConfiguration]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}startButtonTitle: ]{.s1}[\"Go
Now\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}additionalRoutesButtonTitle:
]{.s1}[nil]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}overviewButtonTitle:
]{.s1}[\"Preview\"]{.s10}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ trip]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// ROUTE PREVIEW TEMPLATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[showRoutePreview]{.s9}[(to destination: ]{.s1}[Location]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
routeWeather ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.currentLocation,]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: destination.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
departureOptions ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[optimizeDeparture]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.currentLocation,]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: destination.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Create list of
departure options*]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[let]{.s8}[ template
]{.s6}[=]{.s1}[ ]{.s6}[createDepartureOptionsTemplate]{.s1}[(]{.s6}

[[                    ]{.Apple-converted-space}destination:
destination,]{.s1}

[[                    ]{.Apple-converted-space}options:
departureOptions,]{.s1}

[[                    ]{.Apple-converted-space}routeWeather:
routeWeather]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[pushTemplate]{.s9}[(template,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[showError]{.s9}[(error)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createDepartureOptionsTemplate]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}destination:
]{.s1}[Location]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}options:
\[]{.s1}[DepartureOption]{.s11}[\],]{.s1}

[[        ]{.Apple-converted-space}routeWeather:
]{.s1}[RouteWeatherResult]{.s11}

[[    ]{.Apple-converted-space}) ]{.s6}[-\>]{.s9}[
]{.s6}[CPTemplate]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ items:
\[]{.s1}[CPListItem]{.s11}[\] ]{.s1}[=]{.s9}[ \[\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ option
]{.s1}[in]{.s8}[ options {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ item
]{.s1}[=]{.s9}[ ]{.s1}[CPListItem]{.s11}[(]{.s1}

[[                ]{.Apple-converted-space}text:
]{.s1}[formatDepartureTime]{.s9}[(option.departureTime),]{.s1}

[[                ]{.Apple-converted-space}detailText:
]{.s1}[\"]{.s10}[\\(option.durationMinutes)]{.s1}[ min •
]{.s10}[\\(option.weatherSummary)]{.s1}[\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Weather
indicator*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherIcon
]{.s1}[=]{.s9}[
routeWeather.weatherTimeline.points.first]{.s1}[?]{.s9}[.weather.condition.icon
]{.s1}[??]{.s9}[ ]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}

[[           
]{.Apple-converted-space}item.]{.s1}[setImage]{.s9}[(]{.s1}[createWeatherImage]{.s9}[(weatherIcon))]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
option.isRecommended {]{.s1}

[[                ]{.Apple-converted-space}item.accessoryType
]{.s1}[=]{.s9}[ .disclosureIndicator]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}item.handler ]{.s1}[=]{.s9}[ {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[, completion
]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[startNavigation]{.s9}[(to:
destination, departureOption: option)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[completion]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}items.]{.s1}[append]{.s9}[(item)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ section
]{.s1}[=]{.s9}[ ]{.s1}[CPListSection]{.s11}[(items: items, header:
]{.s1}[\"When to Leave\"]{.s10}[, sectionIndexTitle:
]{.s1}[nil]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ listTemplate
]{.s1}[=]{.s9}[ ]{.s1}[CPListTemplate]{.s11}[(title: destination.name,
sections: \[section\])]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add alert banner if
weather change detected*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
transition ]{.s1}[=]{.s9}[
routeWeather.weatherTimeline.transitions.first {]{.s1}

[[           
]{.Apple-converted-space}listTemplate.]{.s1}[updateSections]{.s9}[(\[section\])]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Note: CarPlay doesn\'t
have native alert banners on list templates*]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// We\'d show this via
the map template instead*]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
listTemplate]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// NAVIGATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[startNavigation]{.s9}[(to destination: ]{.s1}[Location]{.s11}[,
departureOption: ]{.s1}[DepartureOption]{.s11}[?]{.s9}[ ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mapTemplate ]{.s1}[=]{.s9}[
interfaceController]{.s1}[?]{.s9}[.rootTemplate ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[CPMapTemplate]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Create navigation
session*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trip
]{.s1}[=]{.s9}[ ]{.s1}[CPTrip]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}origin:
]{.s1}[MKMapItem]{.s11}[.]{.s1}[forCurrentLocation]{.s9}[(),]{.s1}

[[            ]{.Apple-converted-space}destination:
]{.s1}[MKMapItem]{.s11}[(placemark:
]{.s1}[MKPlacemark]{.s11}[(coordinate: destination.coordinate)),]{.s1}

[[            ]{.Apple-converted-space}routeChoices: \[\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}mapTemplate.]{.s1}[startNavigationSession]{.s9}[(]{.s1}[for]{.s8}[:
trip)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Begin turn-by-turn*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// In production, integrate
with MapKit directions or custom routing*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start weather monitoring
for route*]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[startRouteWeatherMonitoring]{.s1}[(to:
destination)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[startRouteWeatherMonitoring]{.s1}[(to destination:
]{.s6}[Location]{.s11}[) {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Poll for weather changes
every 5 minutes during navigation*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[Timer]{.s11}[.]{.s1}[publish]{.s9}[(every:
]{.s1}[300]{.s11}[, on: .main, ]{.s1}[in]{.s8}[: .common)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[autoconnect]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[checkRouteWeatherUpdate]{.s9}[(to:
destination)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[checkRouteWeatherUpdate]{.s9}[(to destination:
]{.s1}[Location]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
routeWeather ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.currentLocation,]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: destination.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Check for
significant weather changes*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ transition ]{.s1}[=]{.s9}[
routeWeather.weatherTimeline.transitions.first,]{.s1}

[[                  
]{.Apple-converted-space}]{.s1}[shouldAlertUser]{.s9}[(]{.s1}[for]{.s8}[:
transition) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[showWeatherAlert]{.s9}[(transition:
transition)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Silent fail -
don\'t interrupt navigation for monitoring errors*]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[shouldAlertUser]{.s9}[(]{.s1}[for]{.s8}[ transition:
]{.s1}[WeatherTransition]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Bool]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Alert for rain/snow
starting*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ transition.to
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .rain, .heavyRain,
.lightRain, .snow, .heavySnow, .thunderstorm:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEATHER ALERTS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[showWeatherAlert]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mapTemplate ]{.s1}[=]{.s9}[
interfaceController]{.s1}[?]{.s9}[.rootTemplate ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[CPMapTemplate]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alert
]{.s1}[=]{.s9}[ ]{.s1}[CPNavigationAlert]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}titleVariants: \[]{.s1}[\"Weather
Change Ahead\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}subtitleVariants:
\[]{.s1}[\"]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[ in
]{.s10}[\\(transition.locationDescription ]{.s1}[??]{.s9}[
]{.s1}[\"ahead\"]{.s10}[)]{.s1}[\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}image:
]{.s1}[createWeatherImage]{.s9}[(transition.to.icon),]{.s1}

[[            ]{.Apple-converted-space}primaryAction:
]{.s1}[CPAlertAction]{.s11}[(title: ]{.s1}[\"OK\"]{.s10}[, style:
.]{.s1}[default]{.s8}[) { ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}[ },]{.s1}

[[            ]{.Apple-converted-space}secondaryAction:
]{.s1}[CPAlertAction]{.s11}[(title: ]{.s1}[\"Details\"]{.s10}[, style:
.]{.s1}[default]{.s8}[) { \[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\]
]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[speakWeatherDetails]{.s9}[(transition:
transition)]{.s1}

[[            ]{.Apple-converted-space}},]{.s1}

[[            ]{.Apple-converted-space}duration: ]{.s1}[10]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}mapTemplate.]{.s1}[present]{.s9}[(navigationAlert:
alert, animated: ]{.s1}[true]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Also speak the
alert*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[speakWeatherAlert]{.s9}[(transition:
transition)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[speakWeatherAlert]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[\"Heads up.
]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[ expected
]{.s10}[\\(transition.locationDescription ]{.s1}[??]{.s9}[
]{.s1}[\"ahead\"]{.s10}[)]{.s1}[.\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[speak]{.s9}[(message)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[speakWeatherDetails]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// More detailed voice
info*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[\"\"\"]{.s10}

[[       
]{.Apple-converted-space}]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[
is expected starting at ]{.s10}[\\(transition.locationDescription
]{.s1}[??]{.s9}[ ]{.s1}[\"ahead\"]{.s10}[)]{.s1}[.]{.s10}

[[        ]{.Apple-converted-space}Visibility may be reduced. Drive
carefully.]{.s1}

[[        ]{.Apple-converted-space}\"\"\"]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[speak]{.s9}[(message)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// VOICE INTERACTION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[startVoiceInteraction]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mapTemplate ]{.s1}[=]{.s9}[
interfaceController]{.s1}[?]{.s9}[.rootTemplate ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[CPMapTemplate]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Show voice UI*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceTemplate
]{.s1}[=]{.s9}[
]{.s1}[CPVoiceControlTemplate]{.s11}[(voiceControlStates: \[]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CPVoiceControlState]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"listening\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"Listening\...\"]{.s10}[\],]{.s1}

[[                ]{.Apple-converted-space}image:
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}[!]{.s9}[,]{.s1}

[[                ]{.Apple-converted-space}repeats: ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space}),]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CPVoiceControlState]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"processing\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"Thinking\...\"]{.s10}[\],]{.s1}

[[                ]{.Apple-converted-space}image:
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"brain\"]{.s10}[)]{.s1}[!]{.s9}[,]{.s1}

[[                ]{.Apple-converted-space}repeats: ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space}),]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CPVoiceControlState]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"speaking\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"\"]{.s10}[\],]{.s1}

[[                ]{.Apple-converted-space}image:
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"speaker.wave.2.fill\"]{.s10}[)]{.s1}[!]{.s9}[,]{.s1}

[[                ]{.Apple-converted-space}repeats: ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}\])]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[presentTemplate]{.s9}[(voiceTemplate,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start voice service*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[try]{.s8}[
]{.s1}[await]{.s8}[ voiceService.]{.s1}[startSession]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Listen for voice
service state changes*]{.s1}

[[                ]{.Apple-converted-space}voiceService.\$state]{.s1}

[[                    ]{.Apple-converted-space}.sink {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[, ]{.s1}[weak]{.s8}[
voiceTemplate\] state ]{.s1}[in]{.s8}

[[                        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
state {]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.listening:]{.s1}

[[                           
]{.Apple-converted-space}voiceTemplate]{.s1}[?]{.s9}[.]{.s1}[activateVoiceControlState]{.s9}[(withIdentifier:
]{.s1}[\"listening\"]{.s10}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.processing:]{.s1}

[[                           
]{.Apple-converted-space}voiceTemplate]{.s1}[?]{.s9}[.]{.s1}[activateVoiceControlState]{.s9}[(withIdentifier:
]{.s1}[\"processing\"]{.s10}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.speaking:]{.s1}

[[                           
]{.Apple-converted-space}voiceTemplate]{.s1}[?]{.s9}[.]{.s1}[activateVoiceControlState]{.s9}[(withIdentifier:
]{.s1}[\"speaking\"]{.s10}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.idle:]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.interfaceController]{.s1}[?]{.s9}[.]{.s1}[dismissTemplate]{.s9}[(animated:
]{.s1}[true]{.s11}[)]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[break]{.s8}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[dismissTemplate]{.s9}[(animated:
]{.s1}[true]{.s11}[)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[showError]{.s9}[(error)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DESTINATION SEARCH*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[showDestinationSearch]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Get saved
locations*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ locations
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getSavedLocations]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[var]{.s8}[ items:
\[]{.s1}[CPListItem]{.s11}[\] ]{.s1}[=]{.s9}[ \[\]]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[for]{.s8}[ location
]{.s1}[in]{.s8}[ locations {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ item
]{.s1}[=]{.s9}[ ]{.s1}[CPListItem]{.s11}[(]{.s1}

[[                    ]{.Apple-converted-space}text:
location.name,]{.s1}

[[                    ]{.Apple-converted-space}detailText:
location.address]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[               
]{.Apple-converted-space}item.]{.s1}[setImage]{.s9}[(]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"mappin.circle.fill\"]{.s10}[))]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}item.handler ]{.s1}[=]{.s9}[
{ \[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[, completion
]{.s1}[in]{.s8}

[[                   
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[showRoutePreview]{.s9}[(to:
location)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[completion]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}items.]{.s1}[append]{.s9}[(item)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ section
]{.s1}[=]{.s9}[ ]{.s1}[CPListSection]{.s11}[(items: items, header:
]{.s1}[\"Saved Places\"]{.s10}[, sectionIndexTitle:
]{.s1}[nil]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ template
]{.s1}[=]{.s9}[ ]{.s1}[CPListTemplate]{.s11}[(title: ]{.s1}[\"Where
to?\"]{.s10}[, sections: \[section\])]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[pushTemplate]{.s9}[(template,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HELPERS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[speak]{.s9}[(]{.s1}[\_]{.s8}[ message: ]{.s1}[String]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ utterance
]{.s1}[=]{.s9}[ ]{.s1}[AVSpeechUtterance]{.s11}[(string: message)]{.s1}

[[        ]{.Apple-converted-space}utterance.voice ]{.s1}[=]{.s9}[
]{.s1}[AVSpeechSynthesisVoice]{.s11}[(language:
]{.s1}[\"en-US\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}utterance.rate ]{.s1}[=]{.s9}[
]{.s1}[0.5]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ synthesizer
]{.s1}[=]{.s9}[ ]{.s1}[AVSpeechSynthesizer]{.s11}[()]{.s1}

[[       
]{.Apple-converted-space}synthesizer.]{.s1}[speak]{.s9}[(utterance)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createWeatherImage]{.s1}[(]{.s6}[\_]{.s8}[ emoji:
]{.s6}[String]{.s11}[) ]{.s6}[-\>]{.s1}[ ]{.s6}[UIImage]{.s11}[?]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ size
]{.s1}[=]{.s9}[ ]{.s1}[CGSize]{.s11}[(width: ]{.s1}[40]{.s11}[, height:
]{.s1}[40]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[UIGraphicsBeginImageContextWithOptions]{.s1}[(size,
]{.s6}[false]{.s1}[, ]{.s6}[0]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[defer]{.s8}[ {
]{.s6}[UIGraphicsEndImageContext]{.s1}[() }]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ paragraphStyle
]{.s1}[=]{.s9}[ ]{.s1}[NSMutableParagraphStyle]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}paragraphStyle.alignment
]{.s1}[=]{.s9}[ .center]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ attrs:
\[]{.s1}[NSAttributedString]{.s11}[.]{.s1}[Key]{.s11}[:
]{.s1}[Any]{.s8}[\] ]{.s1}[=]{.s9}[ \[]{.s1}

[[            ]{.Apple-converted-space}.font:
]{.s1}[UIFont]{.s11}[.]{.s1}[systemFont]{.s9}[(ofSize:
]{.s1}[30]{.s11}[),]{.s1}

[[            ]{.Apple-converted-space}.paragraphStyle:
paragraphStyle]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ string
]{.s1}[=]{.s9}[ ]{.s1}[NSAttributedString]{.s11}[(string: emoji,
attributes: attrs)]{.s1}

[[       
]{.Apple-converted-space}string.]{.s1}[draw]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[CGRect]{.s11}[(origin: ]{.s1}[CGPoint]{.s11}[(x:
]{.s1}[0]{.s11}[, y: ]{.s1}[2]{.s11}[), size: size))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[UIGraphicsGetImageFromCurrentImageContext]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[formatDepartureTime]{.s1}[(]{.s6}[\_]{.s8}[ date:
]{.s6}[Date]{.s11}[) ]{.s6}[-\>]{.s1}[ ]{.s6}[String]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ formatter
]{.s1}[=]{.s9}[ ]{.s1}[DateFormatter]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}formatter.dateFormat ]{.s1}[=]{.s9}[
]{.s1}[\"h:mm a\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ ]{.s1}[\"Leave
at ]{.s10}[\\(formatter.]{.s1}[string]{.s9}[(from:
date))]{.s1}[\"]{.s10}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[showError]{.s9}[(]{.s1}[\_]{.s8}[ error: ]{.s1}[Error]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alert
]{.s1}[=]{.s9}[ ]{.s1}[CPAlertTemplate]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"Error\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}actions: \[]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[CPAlertAction]{.s11}[(title:
]{.s1}[\"OK\"]{.s10}[, style: .]{.s1}[default]{.s8}[) { ]{.s1}[\_]{.s8}[
]{.s1}[in]{.s8}[ }]{.s1}

[[            ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[       
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[presentTemplate]{.s9}[(alert,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[getSavedLocations]{.s1}[() ]{.s6}[async]{.s8}[ ]{.s6}[-\>]{.s1}[
\[]{.s6}[Location]{.s11}[\] {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch from local storage
or API*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[getUserLocation]{.s9}[(label:
]{.s6}[Location]{.s1}[.]{.s6}[LocationLabel]{.s1}[) ]{.s6}[async]{.s8}[
]{.s6}[-\>]{.s9}[ ]{.s6}[Location]{.s1}[?]{.s9}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch specific
location*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[App State Management]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CORE/State/AppState.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[AppState]{.s1}[: ]{.s6}[ObservableObject]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SINGLETON*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
shared ]{.s1}[=]{.s9}[ ]{.s1}[AppState]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SERVICES*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ a2aClient
]{.s1}[=]{.s9}[ ]{.s1}[A2AClient]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceService
]{.s1}[=]{.s9}[ ]{.s1}[VoiceService]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ locationService
]{.s1}[=]{.s9}[ ]{.s1}[LocationService]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ notificationService
]{.s1}[=]{.s9}[ ]{.s1}[NotificationService]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// USER STATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ user: ]{.s6}[User]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ isAuthenticated ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ savedLocations: \[]{.s1}[Location]{.s11}[\]
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ preferences: ]{.s6}[UserPreferences]{.s1}[
]{.s6}[=]{.s9}[ .]{.s6}[default]{.s8}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// APP STATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ isCarPlayConnected ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentLocation:
]{.s6}[CLLocationCoordinate2D]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ activeTrip: ]{.s1}[Trip]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEATHER STATE (cached for
quick access)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentWeather: ]{.s6}[WeatherCondition]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ commuteWeather:
]{.s6}[RouteWeatherResult]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// INITIALIZATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
cancellables ]{.s1}[=]{.s9}[
]{.s1}[Set]{.s11}[\<]{.s9}[AnyCancellable]{.s11}[\>]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[
]{.s6}[init]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[setupObservers]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[setupObservers]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// CarPlay connection*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.carPlayDidConnect)]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.isCarPlayConnected
]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.carPlayDidDisconnect)]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.isCarPlayConnected
]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Location updates*]{.s1}

[[       
]{.Apple-converted-space}locationService.\$currentLocation]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[assign]{.s9}[(to:
]{.s1}[&]{.s9}[\$currentLocation)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUTHENTICATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[signIn]{.s9}[(with token: ]{.s1}[String]{.s11}[)
]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
a2aClient.]{.s1}[setAuthToken]{.s9}[(token)]{.s1}

[[       
]{.Apple-converted-space}voiceService.]{.s1}[setAuthToken]{.s9}[(token)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch user data*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// user = try await
a2aClient.getUser()*]{.s1}

[[        ]{.Apple-converted-space}isAuthenticated ]{.s1}[=]{.s9}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Load saved data*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[await]{.s8}[
]{.s6}[loadUserData]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[signOut]{.s9}[() {]{.s1}

[[        ]{.Apple-converted-space}user ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}isAuthenticated ]{.s1}[=]{.s9}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}savedLocations ]{.s1}[=]{.s9}[
\[\]]{.s1}

[[        ]{.Apple-converted-space}preferences ]{.s1}[=]{.s9}[
.]{.s1}[default]{.s8}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DATA LOADING*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[loadUserData]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Load from local storage
first (fast)*]{.s1}

[[        ]{.Apple-converted-space}savedLocations ]{.s1}[=]{.s9}[
]{.s1}[LocalStorage]{.s11}[.]{.s1}[loadLocations]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}preferences ]{.s1}[=]{.s9}[
]{.s1}[LocalStorage]{.s11}[.]{.s1}[loadPreferences]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Then sync with
server*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// savedLocations = try?
await a2aClient.getLocations()*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[refreshCommuteWeather]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
home ]{.s1}[=]{.s9}[
savedLocations.]{.s1}[first]{.s9}[(]{.s1}[where]{.s8}[: { \$0.label
]{.s1}[==]{.s9}[ .home }),]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ work
]{.s1}[=]{.s9}[ savedLocations.]{.s1}[first]{.s9}[(]{.s1}[where]{.s8}[:
{ \$0.label ]{.s1}[==]{.s9}[ .work }) ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}commuteWeather ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}origin:
.]{.s1}[savedLocation]{.s9}[(id: home.id.uuidString),]{.s1}

[[                ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: work.id.uuidString)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to refresh
commute weather: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CORE/State/UserPreferences.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[UserPreferences]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ defaultTransportMode:
]{.s1}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[ ]{.s1}[=]{.s9}[
.car]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ enabledTransportModes:
]{.s1}[Set]{.s11}[\<]{.s9}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[\>]{.s9}[
]{.s1}[=]{.s9}[ \[.car, .bike, .walk, .transit\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ rainTolerance:
]{.s1}[Tolerance]{.s11}[ ]{.s1}[=]{.s9}[ .low]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ tempMinComfortableF:
]{.s1}[Int]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[55]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ tempMaxComfortableF:
]{.s1}[Int]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[85]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ windMaxComfortableMph:
]{.s1}[Int]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[15]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notificationsEnabled:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notifyDepartureWindow:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notifyWeatherChange:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notifyOpportunities:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ voiceSpeed:
]{.s1}[Double]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[1.0]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ voiceStyle:
]{.s1}[VoiceStyle]{.s11}[ ]{.s1}[=]{.s9}[ .concise]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[Tolerance]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[none]{.s8}[, low, medium, high]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[VoiceStyle]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ concise,
detailed]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[static]{.s1}[ ]{.s6}[let]{.s1}[
\`]{.s6}[default]{.s1}[\` ]{.s6}[=]{.s9}[
]{.s6}[UserPreferences]{.s11}[()]{.s6}

[}]{.s1}

[]{.s1}\

[Main App Entry Point]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// APP/LiquidCryptoApp.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[\@main]{.s1}

[struct]{.s8}[ ]{.s6}[LiquidCryptoApp]{.s1}[: ]{.s6}[App]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[\@StateObject]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ appState ]{.s1}[=]{.s9}[
]{.s1}[AppState]{.s11}[.shared]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[Scene]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[WindowGroup]{.s1}[ {]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[ContentView]{.s11}[()]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[environmentObject]{.s9}[(appState)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// ContentView.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ContentView]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@EnvironmentObject]{.s1}[
]{.s6}[var]{.s8}[ appState: ]{.s6}[AppState]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ selectedTab ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Group]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
appState.isAuthenticated {]{.s1}

[[                ]{.Apple-converted-space}mainTabView]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[OnboardingView]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
mainTabView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[TabView]{.s11}[(selection:
\$selectedTab) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[TodayView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Today\"]{.s10}[,
systemImage: ]{.s1}[\"sun.max.fill\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[0]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[PlanTripView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Plan\"]{.s10}[,
systemImage: ]{.s1}[\"map.fill\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[WeekAheadView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Week\"]{.s10}[,
systemImage: ]{.s1}[\"calendar\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[2]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[InsightsView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Insights\"]{.s10}[,
systemImage: ]{.s1}[\"chart.bar.fill\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[3]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[SettingsView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Settings\"]{.s10}[,
systemImage: ]{.s1}[\"gear\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[4]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(alignment:
.bottom) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
appState.isCarPlayConnected {]{.s1}

[[                ]{.Apple-converted-space}carPlayIndicator]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
carPlayIndicator: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"car.fill\"]{.s10}[)]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[Text]{.s11}[(]{.s6}[\"CarPlay
Connected\"]{.s1}[)]{.s6}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.horizontal,
]{.s1}[12]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.vertical,
]{.s1}[6]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Material]{.s11}[.regular)]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[Capsule]{.s11}[())]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.bottom,
]{.s1}[60]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Today View (Main Screen)]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// FEATURES/Today/TodayView.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TodayView]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@EnvironmentObject]{.s1}[
]{.s6}[var]{.s8}[ appState: ]{.s6}[AppState]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@StateObject]{.s1}[
]{.s6}[private]{.s8}[ ]{.s6}[var]{.s8}[ viewModel ]{.s6}[=]{.s9}[
]{.s6}[TodayViewModel]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[NavigationStack]{.s1}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[ScrollView]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[20]{.s11}[) {]{.s1}

[[                    ]{.Apple-converted-space}greetingSection]{.s1}

[[                    ]{.Apple-converted-space}currentWeatherCard]{.s1}

[[                    ]{.Apple-converted-space}commutesSection]{.s1}

[[                    ]{.Apple-converted-space}smartSuggestionCard]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[navigationTitle]{.s9}[(]{.s1}[\"Today\"]{.s10}[)]{.s1}

[[            ]{.Apple-converted-space}.toolbar {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[ToolbarItem]{.s11}[(placement:
.navigationBarTrailing) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Button]{.s11}[(action: {
viewModel.showVoice ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}[ }) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}.refreshable {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[await]{.s8}[
viewModel.]{.s1}[refresh]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[sheet]{.s9}[(isPresented:
\$viewModel.showVoice) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VoiceView]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.task {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
viewModel.]{.s1}[load]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SECTIONS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
greetingSection: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[4]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(viewModel.greeting)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.bold)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ user ]{.s1}[=]{.s9}[ appState.user {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(user.displayName
]{.s1}[??]{.s9}[ ]{.s1}[\"\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
currentWeatherCard: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[GlassCard]{.s11}[(variant:
.tinted, weatherTint: viewModel.currentWeather]{.s1}[?]{.s9}[.condition)
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[16]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ weather ]{.s1}[=]{.s9}[ viewModel.currentWeather
{]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[WeatherIcon]{.s11}[(weather.condition,
size: .hero)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading)
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(]{.s1}[Int]{.s11}[(weather.tempFahrenheit))]{.s1}[°F\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
]{.s1}[48]{.s11}[, weight: .medium))]{.s1}

[[                            ]{.Apple-converted-space}]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(weather.condition.rawValue.capitalized)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                            ]{.Apple-converted-space}]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Feels like
]{.s10}[\\(]{.s1}[Int]{.s11}[(weather.feelsLikeFahrenheit))]{.s1}[°\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Hourly
forecast*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[!]{.s9}[viewModel.hourlyForecast.isEmpty {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[HourlyForecastRow]{.s11}[(forecast:
viewModel.hourlyForecast)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
commutesSection: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[Text]{.s11}[(]{.s6}[\"Your
Commutes\"]{.s1}[)]{.s6}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(viewModel.commutes) {
commute ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[CommuteCard]{.s11}[(commute:
commute)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
smartSuggestionCard: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Group]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ suggestion ]{.s1}[=]{.s9}[ viewModel.smartSuggestion
{]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[GlassCard]{.s11}[
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading,
spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(suggestion.icon)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(suggestion.title)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(suggestion.description)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[GlassButton]{.s11}[(suggestion.actionTitle,
style: .secondary) {]{.s1}

[[                           
]{.Apple-converted-space}viewModel.]{.s1}[handleSuggestionAction]{.s9}[(suggestion)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// FEATURES/Today/TodayViewModel.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[TodayViewModel]{.s1}[:
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentWeather: ]{.s6}[WeatherCondition]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ hourlyForecast: \[]{.s1}[HourlyForecast]{.s11}[\]
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ commutes: \[]{.s1}[CommuteInfo]{.s11}[\]
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ smartSuggestion: ]{.s6}[SmartSuggestion]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ showVoice ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
a2aClient ]{.s1}[=]{.s9}[ ]{.s1}[A2AClient]{.s11}[.shared]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ greeting:
]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hour
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[component]{.s9}[(.hour, from:
]{.s1}[Date]{.s11}[())]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ hour {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[0]{.s11}[..\<]{.s9}[12]{.s11}[: ]{.s6}[return]{.s8}[
]{.s6}[\"Good morning,\"]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[12]{.s11}[..\<]{.s9}[17]{.s11}[: ]{.s6}[return]{.s8}[
]{.s6}[\"Good afternoon,\"]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[default]{.s8}[:
]{.s6}[return]{.s8}[ ]{.s6}[\"Good evening,\"]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[ ]{.s1}[load]{.s9}[()
]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[refresh]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[refresh]{.s9}[() ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch current weather,
commutes, and suggestions in parallel*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[async]{.s8}[ ]{.s1}[let]{.s8}[
weatherTask ]{.s1}[=]{.s9}[ ]{.s1}[fetchCurrentWeather]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[async]{.s8}[ ]{.s1}[let]{.s8}[
commutesTask ]{.s1}[=]{.s9}[ ]{.s1}[fetchCommutes]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[async]{.s8}[ ]{.s1}[let]{.s8}[
suggestionTask ]{.s1}[=]{.s9}[
]{.s1}[fetchSmartSuggestion]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ ]{.s1}[=]{.s9}[
]{.s1}[await]{.s8}[ (weatherTask, commutesTask, suggestionTask)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[fetchCurrentWeather]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[fetchCommutes]{.s9}[() ]{.s6}[async]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[fetchSmartSuggestion]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[handleSuggestionAction]{.s9}[(]{.s1}[\_]{.s8}[ suggestion:
]{.s1}[SmartSuggestion]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Handle action*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteInfo]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[Location]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSummary:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherIcon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hasAlert:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertMessage:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportOptions:
\[]{.s1}[TransportOption]{.s11}[\]]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportOption]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ mode:
]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSuitability:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[SmartSuggestion]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ title:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ description:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ actionTitle:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ action:
]{.s6}[SuggestionAction]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[SuggestionAction]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
planBikeRoute]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[leaveNow]{.s9}[(destination: ]{.s1}[Location]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[setReminder]{.s9}[(time: ]{.s1}[Date]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[HourlyForecast]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ time:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ condition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempF:
]{.s1}[Int]{.s11}

[}]{.s1}

[]{.s1}\

[]{.s1}\

[This completes the comprehensive iOS app technical architecture
covering:]{.s3}

1.  [Database Schema - PostgreSQL tables for users, locations, trips,
    patterns, reminders, and conversations]{.s3}
2.  [A2A Protocol - Agent cards, task lifecycle, inter-agent
    communication, and voice WebSocket protocol]{.s3}
3.  [iOS App Architecture - Project structure, data models, A2A client,
    voice service, design system components, CarPlay integration, and
    state management]{.s3}

[Would you like me to continue with any specific area in more detail,
such as:]{.s3}

- [Widget implementation]{.s3}
- [Watch app integration]{.s3}
- [Push notification handling]{.s3}
- [Onboarding flow implementation]{.s3}
- [Unit and UI testing setup]{.s3}

[let\'s do 1,2 and then 3]{.s7}

[]{.s1}\

[I\'ll continue with the remaining iOS components: Widgets, Watch App,
and Push Notification handling.]{.s3}

[]{.s1}\

[iOS Widgets Implementation]{.s3}

[Widget Bundle Structure]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/WidgetBundle.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WidgetKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[\@main]{.s1}

[struct]{.s8}[ ]{.s6}[LiquidCryptoWidgets]{.s1}[:
]{.s6}[WidgetBundle]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[Widget]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[CommuteWidget]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[WeatherWidget]{.s1}[()]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[QuickActionsWidget]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Lock Screen widgets (iOS
16+)*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[#available]{.s5}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CommuteLockScreenWidget]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Commute Widget]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/CommuteWidget.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WidgetKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[import]{.s8}[ ]{.s6}[Intents]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// TIMELINE PROVIDER*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteProvider]{.s1}[:
]{.s6}[IntentTimelineProvider]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[typealias]{.s8}[
]{.s6}[Entry]{.s1}[ ]{.s6}[=]{.s9}[ ]{.s6}[CommuteEntry]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[typealias]{.s8}[
]{.s6}[Intent]{.s1}[ ]{.s6}[=]{.s9}[ ]{.s6}[SelectCommuteIntent]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[placeholder]{.s9}[(]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[CommuteEntry]{.s11}[
{]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[CommuteEntry]{.s11}[.placeholder]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getSnapshot]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ configuration:
]{.s1}[SelectCommuteIntent]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}completion: ]{.s1}[\@escaping]{.s11}[
(]{.s1}[CommuteEntry]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ context.isPreview
{]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(.placeholder)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ entry
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetchCommuteData]{.s9}[(]{.s1}[for]{.s8}[: configuration)]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(entry)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getTimeline]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ configuration:
]{.s1}[SelectCommuteIntent]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}completion: ]{.s6}[\@escaping]{.s1}[
(]{.s6}[Timeline]{.s1}[\<]{.s9}[CommuteEntry]{.s1}[\>]{.s9}[)
]{.s6}[-\>]{.s9}[ ]{.s6}[Void]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ entry
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetchCommuteData]{.s9}[(]{.s1}[for]{.s8}[: configuration)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Refresh every 15
minutes*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ nextUpdate
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[date]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}byAdding: .minute,]{.s1}

[[                ]{.Apple-converted-space}value:
]{.s1}[15]{.s11}[,]{.s1}

[[                ]{.Apple-converted-space}to:
]{.s1}[Date]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space})]{.s1}[!]{.s9}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ timeline
]{.s1}[=]{.s9}[ ]{.s1}[Timeline]{.s11}[(entries: \[entry\], policy:
.]{.s1}[after]{.s9}[(nextUpdate))]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(timeline)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[fetchCommuteData]{.s9}[(]{.s6}[for]{.s8}[ configuration:
]{.s6}[SelectCommuteIntent]{.s1}[) ]{.s6}[async]{.s8}[ ]{.s6}[-\>]{.s9}[
]{.s6}[CommuteEntry]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Get commute destination
from configuration or default to work*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationId
]{.s1}[=]{.s9}[ configuration.destination]{.s1}[?]{.s9}[.identifier
]{.s1}[??]{.s9}[ ]{.s1}[\"work\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Fetch from shared App
Group container or API*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
]{.s1}[WidgetDataService]{.s11}[.shared.]{.s1}[fetchCommuteWeather]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}destinationId:
destinationId]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[CommuteEntry]{.s11}[(]{.s1}

[[                ]{.Apple-converted-space}date:
]{.s1}[Date]{.s11}[(),]{.s1}

[[                ]{.Apple-converted-space}destinationName:
data.destinationName,]{.s1}

[[                ]{.Apple-converted-space}durationMinutes:
data.durationMinutes,]{.s1}

[[                ]{.Apple-converted-space}currentCondition:
data.currentCondition,]{.s1}

[[                ]{.Apple-converted-space}destinationCondition:
data.destinationCondition,]{.s1}

[[                ]{.Apple-converted-space}weatherTransition:
data.weatherTransition,]{.s1}

[[                ]{.Apple-converted-space}alertMessage:
data.alertMessage,]{.s1}

[[                ]{.Apple-converted-space}hasAlert: data.alertMessage
]{.s1}[!=]{.s9}[ ]{.s1}[nil]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[CommuteEntry]{.s11}[.error]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// ENTRY*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteEntry]{.s1}[: ]{.s6}[TimelineEntry]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ date:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationName:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ currentCondition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationCondition:
]{.s1}[WeatherCondition]{.s11}[.]{.s1}[WeatherType]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherTransition:
]{.s1}[String]{.s11}[?]{.s9}[ ]{.s1}[*// e.g., \"Rain at 12pm\"*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertMessage:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hasAlert:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ weatherSummary:
]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ currentCondition
]{.s1}[==]{.s9}[ destinationCondition {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[\"]{.s10}[\\(currentCondition.icon)]{.s1}[
]{.s10}[\\(currentCondition.rawValue.capitalized)]{.s1}[\"]{.s10}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[\"]{.s10}[\\(currentCondition.icon)]{.s1}[ →
]{.s10}[\\(destinationCondition.icon)]{.s1}[\"]{.s10}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
placeholder ]{.s1}[=]{.s9}[ ]{.s1}[CommuteEntry]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}date: ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}destinationName:
]{.s1}[\"Work\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}durationMinutes:
]{.s1}[28]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}currentCondition: .clear,]{.s1}

[[        ]{.Apple-converted-space}destinationCondition: .rain,]{.s1}

[[        ]{.Apple-converted-space}weatherTransition: ]{.s1}[\"Rain at
12pm\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}alertMessage: ]{.s6}[\"Leave by 11:45
to stay dry\"]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}hasAlert: ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
error ]{.s1}[=]{.s9}[ ]{.s1}[CommuteEntry]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}date: ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}destinationName:
]{.s1}[\"---\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}durationMinutes:
]{.s1}[0]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}currentCondition: .unknown,]{.s1}

[[        ]{.Apple-converted-space}destinationCondition: .unknown,]{.s1}

[[        ]{.Apple-converted-space}weatherTransition:
]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}alertMessage: ]{.s1}[\"Unable to
load\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}hasAlert: ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space})]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// WIDGET VIEW*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteWidgetEntryView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[   
]{.Apple-converted-space}]{.s1}[\@Environment]{.s11}[(\\.widgetFamily)
]{.s1}[var]{.s8}[ family]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ entry:
]{.s1}[CommuteEntry]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ family {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.systemSmall:]{.s1}

[[            ]{.Apple-converted-space}smallView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.systemMedium:]{.s1}

[[            ]{.Apple-converted-space}mediumView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.systemLarge:]{.s1}

[[            ]{.Apple-converted-space}largeView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}smallView]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SMALL (2x2)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
smallView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[8]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"car.fill\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Commute\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationName)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherSummary)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[ entry.hasAlert
{]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.circle.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Alert\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[widgetBackground]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// MEDIUM (4x2)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
mediumView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[16]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Left side - main
info*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[8]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"car.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Commute\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationName)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"•\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherSummary)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ entry.alertMessage {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.circle.fill\"]{.s10}[)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.primary)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Right side - weather
timeline*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.currentCondition.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(weatherGradient)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width: ]{.s1}[4]{.s11}[,
height: ]{.s1}[40]{.s11}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[2]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationCondition.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ transition ]{.s1}[=]{.s9}[ entry.weatherTransition
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(transition)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[widgetBackground]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// LARGE (4x4)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
largeView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[16]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[*// Header*]{.s13}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading)
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Travel
Weather\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(\"]{.s1}[Updated]{.s11}[
\\(entry.date.]{.s1}[formatted]{.s9}[(.]{.s1}[relative]{.s9}[(presentation:
.named)))\")]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.currentCondition.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.largeTitle)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Divider]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Commute details*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"building.2.fill\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationName)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Weather
timeline*]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(]{.s1}[0]{.s11}[..\<]{.s9}[5]{.s11}[)
{ i ]{.s1}[in]{.s8}

[[                       
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(\[]{.s1}[\"Now\"]{.s10}[,
]{.s1}[\"+10m\"]{.s10}[, ]{.s1}[\"+20m\"]{.s10}[,
]{.s1}[\"+30m\"]{.s10}[, ]{.s1}[\"Arrive\"]{.s10}[\]\[i\])]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                            ]{.Apple-converted-space}]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(i ]{.s1}[\<]{.s9}[
]{.s1}[3]{.s11}[ ]{.s1}[?]{.s9}[ entry.currentCondition.icon :
entry.destinationCondition.icon)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(maxWidth: .infinity)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.vertical,
]{.s1}[8]{.s11}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.secondary.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[))]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Alert section*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ entry.alertMessage {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.triangle.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.orange.]{.s1}[opacity]{.s9}[(]{.s1}[0.15]{.s11}[))]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Suggestion*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"lightbulb.fill\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.yellow)]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[Text]{.s11}[(]{.s6}[\"Tap to see
departure options\"]{.s1}[)]{.s6}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[widgetBackground]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
weatherGradient: ]{.s1}[LinearGradient]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}colors: \[]{.s1}

[[               
]{.Apple-converted-space}entry.currentCondition.color,]{.s1}

[[               
]{.Apple-converted-space}entry.destinationCondition.color]{.s1}

[[            ]{.Apple-converted-space}\],]{.s1}

[[            ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[            ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// WIDGET DEFINITION*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteWidget]{.s1}[: ]{.s6}[Widget]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ kind:
]{.s6}[String]{.s11}[ ]{.s6}[=]{.s9}[ ]{.s6}[\"CommuteWidget\"]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ body:
]{.s6}[some]{.s8}[ ]{.s6}[WidgetConfiguration]{.s1}[ {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[IntentConfiguration]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}kind: kind,]{.s1}

[[            ]{.Apple-converted-space}intent:
]{.s1}[SelectCommuteIntent]{.s11}[.]{.s1}[self]{.s8}[,]{.s1}

[[            ]{.Apple-converted-space}provider:
]{.s1}[CommuteProvider]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}) { entry ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[CommuteWidgetEntryView]{.s11}[(entry:
entry)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[configurationDisplayName]{.s1}[(]{.s6}[\"Commute
Weather\"]{.s10}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s6}[description]{.s9}[(]{.s6}[\"See weather
conditions for your commute.\"]{.s1}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s1}[supportedFamilies]{.s9}[(\[.systemSmall,
.systemMedium, .systemLarge\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// HELPER EXTENSION*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[extension]{.s1}[ ]{.s6}[View]{.s11}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[widgetBackground]{.s1}[() ]{.s6}[-\>]{.s1}[ ]{.s6}[some]{.s8}[
]{.s6}[View]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[#available]{.s5}[(iOSApplicationExtension ]{.s1}[17.0]{.s11}[,
]{.s1}[\*]{.s9}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[self]{.s8}[.]{.s1}[containerBackground]{.s9}[(]{.s1}[for]{.s8}[:
.widget) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Color]{.s11}[(.systemBackground)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[self]{.s8}[.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[(.systemBackground))]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Lock Screen Widget]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/CommuteLockScreenWidget.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WidgetKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[\@available]{.s11}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[)]{.s1}

[struct]{.s8}[ ]{.s6}[CommuteLockScreenWidget]{.s1}[:
]{.s6}[Widget]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ kind:
]{.s6}[String]{.s11}[ ]{.s6}[=]{.s9}[
]{.s6}[\"CommuteLockScreenWidget\"]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ body:
]{.s6}[some]{.s8}[ ]{.s6}[WidgetConfiguration]{.s1}[ {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[StaticConfiguration]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}kind: kind,]{.s1}

[[            ]{.Apple-converted-space}provider:
]{.s6}[CommuteLockScreenProvider]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}) { entry ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[CommuteLockScreenView]{.s11}[(entry:
entry)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[configurationDisplayName]{.s1}[(]{.s6}[\"Commute\"]{.s10}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s6}[description]{.s9}[(]{.s6}[\"Quick
commute weather at a glance.\"]{.s1}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s6}[supportedFamilies]{.s1}[(\[]{.s6}

[[            ]{.Apple-converted-space}.accessoryInline,]{.s1}

[[            ]{.Apple-converted-space}.accessoryCircular,]{.s1}

[[            ]{.Apple-converted-space}.accessoryRectangular]{.s1}

[[        ]{.Apple-converted-space}\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[┌─────────────────────────────────────────────────────────────────────────┐]{.s1}

[│[  ]{.Apple-converted-space}XCODE PROJECT STRUCTURE[                 
                              ]{.Apple-converted-space}│]{.s1}

[├─────────────────────────────────────────────────────────────────────────┤]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}LiquidCrypto/ [                           
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCrypto.xcodeproj[               
                            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCrypto/ [                   
]{.Apple-converted-space}\# Main iOS App[                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── App/[   
                                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── LiquidCryptoApp.swift [   
]{.Apple-converted-space}\# App entry point [             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── AppDelegate.swift [       
]{.Apple-converted-space}\# UIKit lifecycle [             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── SceneDelegate.swift [     
]{.Apple-converted-space}\# Scene management[             
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Features/ [                    ]{.Apple-converted-space}\# Feature
modules [              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Today/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
TodayView.swift [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
TodayViewModel.swift[                                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Components/
[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── PlanTrip/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
PlanTripView.swift[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
RouteResultsView.swift[                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
DepartureOptimizerView.swift[                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── WeekAhead/[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Insights/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Settings/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Voice/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── VoiceView.swift [                         
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── VoiceViewModel.swift[                     
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── WaveformView.swift[                       
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Core/ [ 
                      ]{.Apple-converted-space}\# Core functionality[   
        ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Services/ [                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
A2AClient.swift [      ]{.Apple-converted-space}\# API client[         
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
VoiceService.swift[    ]{.Apple-converted-space}\# Voice handling[     
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
LocationService.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CalendarService.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
NotificationService.swift [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Models/ [                                 
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── User.swift[ 
                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Location.swift[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Route.swift
[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Weather.swift
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Trip.swift[ 
                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── State/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
AppState.swift[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
UserState.swift [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
NavigationState.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Utilities/[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── Extensions/ [                             
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── Helpers/[                                 
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── Constants.swift [                         
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
DesignSystem/ [                ]{.Apple-converted-space}\# Liquid Glass
UI [              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Theme/[                                   
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Colors.swift[                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Typography.swift[                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Spacing.swift
[                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Components/ [                             
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
GlassCard.swift [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
GlassButton.swift [                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
WeatherIcon.swift [                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
WeatherTimeline.swift [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
RouteWeatherOverlay.swift [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
TransportModePicker.swift [                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}│ [                                           
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── Modifiers/[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}├── GlassModifier.swift [                     
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [     
]{.Apple-converted-space}└── WeatherTintModifier.swift [               
            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Resources/[                                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}├──
Assets.xcassets [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}├──
Localizable.strings [                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}└──
Info.plist[                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCryptoCarPlay/[             
]{.Apple-converted-space}\# CarPlay App [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CarPlaySceneDelegate.swift[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
Templates/[                                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── HomeTemplate.swift[                       
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── RoutePreviewTemplate.swift[               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── NavigationTemplate.swift[                 
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── AlertTemplate.swift [                     
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Info.plist[                    ]{.Apple-converted-space}\# CarPlay
entitlements[          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCryptoWatch/[               
]{.Apple-converted-space}\# Watch App [                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
LiquidCryptoWatchApp.swift[                                   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├── Views/[ 
                                                     
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── CommuteGlanceView.swift [                 
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── DetailView.swift[                         
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
Complications/[                                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── LiquidCryptoWidgets/[             
]{.Apple-converted-space}\# iOS Widgets [                 
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
CommuteWidget.swift [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
WeatherWidget.swift [                                         
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└──
WidgetBundle.swift[                                           
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}├── Shared/ [                         
]{.Apple-converted-space}\# Shared code across targets[   
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}├──
A2AProtocol/[                  ]{.Apple-converted-space}\# A2A types &
client[            ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── AgentCard.swift [                         
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── Task.swift[                               
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}├── StreamEvent.swift [                       
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│ [ 
]{.Apple-converted-space}└── A2AClient.swift [                         
                ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}│[         
                                                       
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [  ]{.Apple-converted-space}└── Models/
[                      ]{.Apple-converted-space}\# Shared data models[ 
          ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│ [      ]{.Apple-converted-space}└──
(symlinked from main app) [                               
]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}│[                                       
                              ]{.Apple-converted-space}│]{.s1}

[│[  ]{.Apple-converted-space}└── Tests/[                               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}├── LiquidCryptoTests/[               
                            ]{.Apple-converted-space}│]{.s1}

[│[      ]{.Apple-converted-space}└── LiquidCryptoUITests/[             
                            ]{.Apple-converted-space}│]{.s1}

[│ [                                                                   
    ]{.Apple-converted-space}│]{.s1}

[└─────────────────────────────────────────────────────────────────────────┘]{.s1}

[]{.s1}\

[Core Data Models]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/Location.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[CoreLocation]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[Location]{.s1}[: ]{.s6}[Identifiable]{.s1}[,
]{.s6}[Codable]{.s1}[, ]{.s6}[Equatable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id: ]{.s1}[UUID]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ name:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ label:
]{.s6}[LocationLabel]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ address:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ coordinate:
]{.s6}[CLLocationCoordinate2D]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ icon:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ color:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ isFavorite:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ visitCount:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ lastVisitedAt:
]{.s1}[Date]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[LocationLabel]{.s1}[: ]{.s6}[String]{.s1}[,
]{.s6}[Codable]{.s1}[, ]{.s6}[CaseIterable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ home]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ work]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ gym]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ school]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ custom]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ defaultIcon:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .home:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🏠]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .work:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🏢]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .gym:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🏋️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .school:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🎓]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .custom:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[📍]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[CLLocationCoordinate2D]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ latitude,
longitude]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[public]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[encode]{.s9}[(to encoder: ]{.s1}[Encoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ container
]{.s1}[=]{.s9}[ encoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(latitude, forKey: .latitude)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(longitude, forKey: .longitude)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[public]{.s8}[
]{.s1}[init]{.s8}[(from decoder: ]{.s1}[Decoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ container
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
decoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ lat ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .latitude)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ lng ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .longitude)]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.]{.s1}[init]{.s8}[(latitude:
lat, longitude: lng)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/Weather.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherCondition]{.s1}[: ]{.s6}[Codable]{.s1}[,
]{.s6}[Equatable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ condition:
]{.s1}[WeatherType]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempFahrenheit:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ feelsLikeFahrenheit:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ humidity:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ windSpeedMph:
]{.s1}[Double]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ windDirection:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ precipProbability:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ precipIntensity:
]{.s1}[PrecipIntensity]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ uvIndex:
]{.s1}[Int]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ visibility:
]{.s1}[Double]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[WeatherType]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[,
]{.s6}[CaseIterable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ clear,
partlyCloudy, cloudy, overcast]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ lightRain, rain,
heavyRain]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ lightSnow, snow,
heavySnow]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ fog, mist,
haze]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ thunderstorm]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ unknown]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ icon:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .clear:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .partlyCloudy:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[⛅]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .cloudy,
.overcast: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[☁️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightRain,
.rain: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🌧️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .heavyRain,
.thunderstorm: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[⛈️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightSnow,
.snow, .heavySnow: ]{.s1}[return]{.s8}[
]{.s1}[\"]{.s10}[🌨️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .fog, .mist,
.haze: ]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🌫️]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .unknown:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[❓]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ color:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .clear:
]{.s1}[return]{.s8}[ .weatherClear]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .partlyCloudy,
.cloudy, .overcast: ]{.s1}[return]{.s8}[ .weatherCloudy]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightRain,
.rain: ]{.s1}[return]{.s8}[ .weatherRain]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .heavyRain,
.thunderstorm: ]{.s1}[return]{.s8}[ .weatherHeavyRain]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .lightSnow,
.snow, .heavySnow: ]{.s1}[return]{.s8}[ .weatherSnow]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .fog, .mist,
.haze: ]{.s1}[return]{.s8}[ .weatherFog]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .unknown:
]{.s1}[return]{.s8}[ .gray]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[PrecipIntensity]{.s1}[: ]{.s6}[String]{.s1}[,
]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[none]{.s8}[, light, moderate, heavy]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTimeline]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ points:
\[]{.s6}[WeatherTimelinePoint]{.s1}[\]]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transitions:
\[]{.s1}[WeatherTransition]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ summary:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTimelinePoint]{.s1}[:
]{.s6}[Codable]{.s1}[, ]{.s6}[Identifiable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ id:
]{.s1}[String]{.s11}[ {
]{.s1}[\"]{.s10}[\\(time.timeIntervalSince1970)]{.s1}[\"]{.s10}[ }]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ time:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ location:
]{.s6}[CLLocationCoordinate2D]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ weather:
]{.s6}[WeatherCondition]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTransition]{.s1}[: ]{.s6}[Codable]{.s1}[,
]{.s6}[Identifiable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ id:
]{.s1}[String]{.s11}[ {
]{.s1}[\"]{.s10}[\\(time.timeIntervalSince1970)]{.s1}[-]{.s10}[\\(from)]{.s1}[-]{.s10}[\\(to)]{.s1}[\"]{.s10}[
}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ time:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ from:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ to:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ locationDescription:
]{.s1}[String]{.s11}[?]{.s9}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/Route.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[CoreLocation]{.s1}

[import]{.s1}[ ]{.s6}[MapKit]{.s11}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[Route]{.s1}[: ]{.s6}[Identifiable]{.s1}[,
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id: ]{.s1}[UUID]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[Location]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[Location]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ polyline:
]{.s6}[String]{.s11}[?]{.s9}[ ]{.s6}[*// Encoded polyline*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ distanceMeters:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportMode:
]{.s1}[TransportMode]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[TransportMode]{.s1}[: ]{.s6}[String]{.s1}[,
]{.s6}[Codable]{.s1}[, ]{.s6}[CaseIterable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ car, bike, walk,
transit]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ icon:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .car:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚗]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .bike:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚴]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .walk:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚶]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .transit:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[🚇]{.s19}[\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ displayName:
]{.s1}[String]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .car:
]{.s1}[return]{.s8}[ ]{.s1}[\"Drive\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .bike:
]{.s1}[return]{.s8}[ ]{.s1}[\"Bike\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .walk:
]{.s1}[return]{.s8}[ ]{.s1}[\"Walk\"]{.s10}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .transit:
]{.s1}[return]{.s8}[ ]{.s1}[\"Transit\"]{.s10}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[RouteWeatherResult]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ route:
]{.s1}[Route]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherTimeline:
]{.s1}[WeatherTimeline]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ arrivalTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherScore:
]{.s1}[Int]{.s11}[ ]{.s1}[*// 0-10*]{.s13}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[DepartureOption]{.s1}[:
]{.s6}[Identifiable]{.s1}[, ]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ id:
]{.s1}[String]{.s11}[ { departureTime.]{.s1}[ISO8601Format]{.s11}[()
}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ arrivalTime:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherScore:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSummary:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ isRecommended:
]{.s1}[Bool]{.s11}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// MODELS/TransportComparison.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportComparison]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ mode:
]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSuitability:
]{.s1}[Suitability]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ conditions:
]{.s1}[ModeConditions]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ recommendation:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[Suitability]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ excellent, good,
fair, poor]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ color:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .excellent:
]{.s1}[return]{.s8}[ .green]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .good:
]{.s1}[return]{.s8}[ .blue]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .fair:
]{.s1}[return]{.s8}[ .orange]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .poor:
]{.s1}[return]{.s8}[ .red]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[ModeConditions]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// For all modes*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ rainExposure:
]{.s1}[String]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// For bike/walk*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempF:
]{.s1}[Double]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ wind:
]{.s1}[String]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ uvIndex:
]{.s1}[Int]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Gear suggestions
(bike/walk)*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ gearSuggestions:
\[]{.s1}[String]{.s11}[\]]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[A2A Client]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// SERVICES/A2AClient.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[actor]{.s8}[ ]{.s6}[A2AClient]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
baseURL: ]{.s1}[URL]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
session: ]{.s1}[URLSession]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
authToken: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[init]{.s8}[(baseURL:
]{.s6}[URL]{.s11}[ ]{.s6}[=]{.s9}[ ]{.s6}[URL]{.s9}[(string:
]{.s6}[\"https://api.liquidcrypto.app/v1\"]{.s1}[)]{.s6}[!]{.s9}[)
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.baseURL
]{.s1}[=]{.s9}[ baseURL]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ config
]{.s6}[=]{.s9}[
]{.s6}[URLSessionConfiguration]{.s1}[.]{.s6}[default]{.s8}

[[        ]{.Apple-converted-space}config.timeoutIntervalForRequest
]{.s1}[=]{.s9}[ ]{.s1}[30]{.s11}

[[        ]{.Apple-converted-space}config.timeoutIntervalForResource
]{.s1}[=]{.s9}[ ]{.s1}[60]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.session
]{.s1}[=]{.s9}[ ]{.s1}[URLSession]{.s11}[(configuration: config)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setAuthToken]{.s9}[(]{.s1}[\_]{.s8}[ token:
]{.s1}[String]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.authToken
]{.s1}[=]{.s9}[ token]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// ROUTE WEATHER*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getRouteWeather]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}departureTime: ]{.s1}[Date]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}transportMode:
]{.s1}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[ ]{.s1}[=]{.s9}[
.car]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[ ]{.s6}[RouteWeatherResult]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[RouteWeatherRequest]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}departureTime:
departureTime.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}transportMode:
transportMode.rawValue]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/route/weather\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DEPARTURE OPTIMIZER*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[optimizeDeparture]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}arriveBy: ]{.s1}[Date]{.s11}[?]{.s9}[
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}preferences:
]{.s1}[DeparturePreferences]{.s11}[ ]{.s1}[=]{.s9}[
.]{.s1}[init]{.s8}[()]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[ \[]{.s6}[DepartureOption]{.s1}[\]
{]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[OptimizeDepartureRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}arriveBy:
arriveBy]{.s1}[?]{.s9}[.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}preferences: preferences]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ response:
]{.s6}[OptimizeDepartureResponse]{.s1}[ ]{.s6}[=]{.s9}[
]{.s6}[try]{.s8}[ ]{.s6}[await]{.s8}[ ]{.s6}[post]{.s9}[(]{.s6}

[[            ]{.Apple-converted-space}endpoint:
]{.s6}[\"/route/optimize-departure\"]{.s1}[,]{.s6}

[[            ]{.Apple-converted-space}body: request]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
response.options]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// TRANSPORT COMPARISON*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[compareTransport]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}departureTime: ]{.s1}[Date]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}modes:
\[]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}[\] ]{.s6}[=]{.s9}[
]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}[.allCases]{.s6}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[
]{.s6}[TransportComparisonResult]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[CompareTransportRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}departureTime:
departureTime.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}modes: modes.map { \$0.rawValue
}]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/transport/compare\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// REMINDERS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setReminder]{.s9}[(]{.s1}[\_]{.s8}[ reminder:
]{.s1}[ReminderRequest]{.s11}[) ]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[
]{.s1}[-\>]{.s9}[ ]{.s1}[Reminder]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/reminders\"]{.s10}[, body: reminder)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// VOICE QUERY (Non-streaming,
for simple queries)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[voiceQuery]{.s9}[(]{.s1}[\_]{.s8}[ query: ]{.s1}[String]{.s11}[,
context: ]{.s1}[VoiceContext]{.s11}[?]{.s9}[ ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}[) ]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[
]{.s1}[-\>]{.s9}[ ]{.s1}[VoiceResponse]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[VoiceQueryRequest]{.s11}[(query: query, context:
context)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/voice/query\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// GENERIC HTTP METHODS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[post\<]{.s9}[Request]{.s1}[: ]{.s6}[Encodable]{.s1}[,
]{.s6}[Response]{.s1}[: ]{.s6}[Decodable]{.s1}[\>]{.s9}[(]{.s6}

[[        ]{.Apple-converted-space}endpoint:
]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}body: ]{.s1}[Request]{.s11}

[[    ]{.Apple-converted-space}) ]{.s1}[async]{.s8}[
]{.s1}[throws]{.s8}[ ]{.s1}[-\>]{.s9}[ ]{.s1}[Response]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ urlRequest
]{.s1}[=]{.s9}[ ]{.s1}[URLRequest]{.s11}[(url:
baseURL.]{.s1}[appendingPathComponent]{.s9}[(endpoint))]{.s1}

[[        ]{.Apple-converted-space}urlRequest.httpMethod ]{.s1}[=]{.s9}[
]{.s1}[\"POST\"]{.s10}

[[       
]{.Apple-converted-space}urlRequest.]{.s1}[setValue]{.s9}[(]{.s1}[\"application/json\"]{.s10}[,
forHTTPHeaderField: ]{.s1}[\"Content-Type\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
token ]{.s1}[=]{.s9}[ authToken {]{.s1}

[[           
]{.Apple-converted-space}urlRequest.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(token)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ encoder
]{.s1}[=]{.s9}[ ]{.s1}[JSONEncoder]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}encoder.dateEncodingStrategy
]{.s1}[=]{.s9}[ .iso8601]{.s1}

[[        ]{.Apple-converted-space}urlRequest.httpBody ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[ encoder.]{.s1}[encode]{.s9}[(body)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ (data, response)
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
session.]{.s1}[data]{.s9}[(]{.s1}[for]{.s8}[: urlRequest)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
httpResponse ]{.s1}[=]{.s9}[ response ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[HTTPURLResponse]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[throw]{.s8}[
]{.s1}[A2AError]{.s11}[.invalidResponse]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[
(]{.s1}[200]{.s11}[\...]{.s9}[299]{.s11}[).]{.s1}[contains]{.s9}[(httpResponse.statusCode)
]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ error
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[A2AErrorResponse]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[throw]{.s8}[
]{.s1}[A2AError]{.s11}[.]{.s1}[serverError]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}code:
error]{.s1}[?]{.s9}[.code ]{.s1}[??]{.s9}[
]{.s1}[\"UNKNOWN\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}message:
error]{.s1}[?]{.s9}[.message ]{.s1}[??]{.s9}[ ]{.s1}[\"Unknown
error\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ decoder
]{.s1}[=]{.s9}[ ]{.s1}[JSONDecoder]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}decoder.dateDecodingStrategy
]{.s1}[=]{.s9}[ .iso8601]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[
decoder.]{.s1}[decode]{.s9}[(]{.s1}[Response]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// REQUEST/RESPONSE TYPES*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[LocationInput]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ currentLocation]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[savedLocation]{.s1}[(id: ]{.s6}[String]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[coordinates]{.s9}[(lat: ]{.s1}[Double]{.s11}[, lng:
]{.s1}[Double]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[address]{.s9}[(]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ type, id, lat,
lng, address]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[encode]{.s9}[(to encoder: ]{.s1}[Encoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ container
]{.s1}[=]{.s9}[ encoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.currentLocation:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"current_location\"]{.s10}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[savedLocation]{.s9}[(]{.s1}[let]{.s8}[ id):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"saved_location\"]{.s10}[,
forKey: .type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(id, forKey: .id)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[coordinates]{.s9}[(]{.s1}[let]{.s8}[ lat, ]{.s1}[let]{.s8}[
lng):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"coordinates\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(lat, forKey: .lat)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(lng, forKey: .lng)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[address]{.s9}[(]{.s1}[let]{.s8}[ address):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"address\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(address, forKey: .address)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(from decoder:
]{.s1}[Decoder]{.s11}[) ]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ container
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
decoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ type
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ type {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"current_location\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .currentLocation]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"saved_location\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[savedLocation]{.s9}[(id: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .id))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"coordinates\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[coordinates]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}lat: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .lat),]{.s1}

[[                ]{.Apple-converted-space}lng: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[Double]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .lng)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"address\"]{.s10}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[address]{.s9}[(]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .address))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[throw]{.s8}[
]{.s6}[DecodingError]{.s11}[.]{.s6}[dataCorruptedError]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}forKey: .type,]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[in]{.s8}[:
container,]{.s1}

[[                ]{.Apple-converted-space}debugDescription:
]{.s1}[\"Unknown location type\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[DeparturePreferences]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ avoidRain:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ minimizeTime:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[RouteWeatherRequest]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportMode:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[OptimizeDepartureRequest]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ arriveBy:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ preferences:
]{.s6}[DeparturePreferences]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[OptimizeDepartureResponse]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ options:
\[]{.s1}[DepartureOption]{.s11}[\]]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CompareTransportRequest]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[LocationInput]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureTime:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ modes:
\[]{.s1}[String]{.s11}[\]]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportComparisonResult]{.s1}[:
]{.s6}[Codable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ comparisons:
\[]{.s1}[TransportComparison]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ suggestion:
]{.s6}[TransportSuggestion]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[TransportSuggestion]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ mode:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ reason:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[A2AError]{.s1}[: ]{.s6}[Error]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ invalidResponse]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[serverError]{.s9}[(code: ]{.s1}[String]{.s11}[, message:
]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[networkError]{.s1}[(]{.s6}[Error]{.s11}[)]{.s6}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[A2AErrorResponse]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ code:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[Voice Service]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// SERVICES/VoiceService.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[import]{.s8}[ ]{.s6}[AVFoundation]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[VoiceService]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// PUBLISHED STATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ state: ]{.s1}[VoiceState]{.s11}[ ]{.s1}[=]{.s9}[
.idle]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ partialTranscript: ]{.s1}[String]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ finalTranscript: ]{.s1}[String]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ responseText: ]{.s1}[String]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ audioLevel: ]{.s1}[Float]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ error: ]{.s6}[VoiceError]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[VoiceState]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ idle]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ connecting]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ listening]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ processing]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ speaking]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ error]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// PRIVATE PROPERTIES*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[var]{.s8}[
webSocket: ]{.s6}[URLSessionWebSocketTask]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioEngine: ]{.s1}[AVAudioEngine]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
inputNode: ]{.s1}[AVAudioInputNode]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioPlayer: ]{.s1}[AVAudioPlayerNode]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioSession: ]{.s1}[AVAudioSession]{.s11}[ {
.]{.s1}[sharedInstance]{.s9}[() }]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[let]{.s8}[
baseURL ]{.s6}[=]{.s9}[ ]{.s6}[URL]{.s9}[(string:
]{.s6}[\"wss://api.liquidcrypto.app/v1/voice\"]{.s1}[)]{.s6}[!]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
authToken: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
sessionId: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
audioBuffer ]{.s1}[=]{.s9}[ ]{.s1}[Data]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
audioFormat ]{.s1}[=]{.s9}[ ]{.s1}[AVAudioFormat]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}commonFormat: .pcmFormatInt16,]{.s1}

[[        ]{.Apple-converted-space}sampleRate:
]{.s1}[16000]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}channels: ]{.s1}[1]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}interleaved: ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space})]{.s1}[!]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// PUBLIC METHODS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setAuthToken]{.s9}[(]{.s1}[\_]{.s8}[ token:
]{.s1}[String]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.authToken
]{.s1}[=]{.s9}[ token]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s1}[
]{.s6}[startSession]{.s9}[() ]{.s6}[async]{.s1}[ ]{.s6}[throws]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ state
]{.s1}[==]{.s9}[ .idle ]{.s1}[else]{.s8}[ { ]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.connecting]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Configure audio
session*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[
]{.s6}[configureAudioSession]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Connect WebSocket*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[ ]{.s6}[await]{.s8}[
]{.s6}[connectWebSocket]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start audio capture*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[
]{.s6}[startAudioCapture]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.listening]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[endSession]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[stopAudioCapture]{.s1}[()]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[disconnectWebSocket]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[ .idle]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Reset state*]{.s1}

[[        ]{.Apple-converted-space}partialTranscript ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[        ]{.Apple-converted-space}finalTranscript ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[        ]{.Apple-converted-space}responseText ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[commitAudio]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// User manually ended speech
(e.g., released button)*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.audioCommit)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[interruptResponse]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// User wants to stop the AI
from speaking*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.responseInterrupt)]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[stopPlayback]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.listening]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[sendTextInput]{.s9}[(]{.s1}[\_]{.s8}[ text:
]{.s1}[String]{.s11}[) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.]{.s1}[textInput]{.s9}[(text:
text))]{.s1}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.processing]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUDIO SESSION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[configureAudioSession]{.s1}[() ]{.s6}[throws]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
audioSession.]{.s1}[setCategory]{.s9}[(]{.s1}

[[            ]{.Apple-converted-space}.playAndRecord,]{.s1}

[[            ]{.Apple-converted-space}mode: .voiceChat,]{.s1}

[[            ]{.Apple-converted-space}options: \[.defaultToSpeaker,
.allowBluetooth\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
audioSession.]{.s1}[setActive]{.s9}[(]{.s1}[true]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEBSOCKET*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[connectWebSocket]{.s9}[() ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[URLRequest]{.s11}[(url: baseURL)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
token ]{.s1}[=]{.s9}[ authToken {]{.s1}

[[           
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(token)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
sessionId ]{.s1}[=]{.s9}[ sessionId {]{.s1}

[[           
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(sessionId,
forHTTPHeaderField: ]{.s1}[\"X-Session-ID\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}webSocket ]{.s1}[=]{.s9}[
]{.s1}[URLSession]{.s11}[.shared.]{.s1}[webSocketTask]{.s9}[(with:
request)]{.s1}

[[       
]{.Apple-converted-space}webSocket]{.s1}[?]{.s9}[.]{.s1}[resume]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Send session start*]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[sendMessage]{.s1}[(]{.s6}[VoiceMessage]{.s11}[.]{.s6}[sessionStart]{.s1}[(config:
.]{.s6}[init]{.s8}[(]{.s6}

[[            ]{.Apple-converted-space}inputFormat:
]{.s1}[\"pcm_16khz_mono\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}outputFormat:
]{.s1}[\"pcm_24khz_mono\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}vadEnabled:
]{.s1}[true]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}interruptEnabled:
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space})))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start receiving
messages*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[await]{.s8}[ ]{.s1}[receiveMessages]{.s9}[() }]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[disconnectWebSocket]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.sessionEnd)]{.s1}

[[       
]{.Apple-converted-space}webSocket]{.s1}[?]{.s9}[.]{.s1}[cancel]{.s9}[(with:
.goingAway, reason: ]{.s1}[nil]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}webSocket ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[sendMessage]{.s9}[(]{.s1}[\_]{.s8}[ message:
]{.s1}[VoiceMessage]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
webSocket ]{.s1}[=]{.s9}[ webSocket ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
]{.s1}[JSONEncoder]{.s11}[().]{.s1}[encode]{.s9}[(message)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ string
]{.s1}[=]{.s9}[ ]{.s1}[String]{.s11}[(data: data, encoding:
.utf8)]{.s1}[!]{.s9}

[[           
]{.Apple-converted-space}webSocket.]{.s1}[send]{.s9}[(.]{.s1}[string]{.s9}[(string))
{ error ]{.s1}[in]{.s8}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ error ]{.s1}[=]{.s9}[ error {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[print]{.s9}[(]{.s1}[\"WebSocket send
error: ]{.s10}[\\(error)]{.s1}[\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to encode
message: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[receiveMessages]{.s9}[() ]{.s6}[async]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
webSocket ]{.s1}[=]{.s9}[ webSocket ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[while]{.s8}[
]{.s1}[true]{.s11}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
webSocket.]{.s1}[receive]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ message
{]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[string]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[handleTextMessage]{.s9}[(text)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[data]{.s9}[(]{.s1}[let]{.s8}[ data):]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[handleBinaryMessage]{.s9}[(data)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[\@unknown]{.s11}[
]{.s1}[default]{.s8}[:]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[break]{.s8}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .error]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.error
]{.s1}[=]{.s9}[ .connectionLost]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[handleTextMessage]{.s9}[(]{.s1}[\_]{.s8}[ text:
]{.s1}[String]{.s11}[) ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
data ]{.s1}[=]{.s9}[ text.]{.s1}[data]{.s9}[(using: .utf8),]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[ServerMessage]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ message
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[sessionStarted]{.s9}[(]{.s1}[let]{.s8}[ sessionId):]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.sessionId
]{.s1}[=]{.s9}[ sessionId]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.speechStarted:]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.partialTranscript
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[transcriptPartial]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.partialTranscript
]{.s1}[=]{.s9}[ text]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[transcriptFinal]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.finalTranscript
]{.s1}[=]{.s9}[ text]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.partialTranscript
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .processing]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.processingStarted:]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .processing]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[textOutput]{.s9}[(]{.s1}[let]{.s8}[ text, ]{.s1}[let]{.s8}[
isFinal):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.responseText ]{.s1}[=]{.s9}[
text]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[ isFinal
{]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .listening]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[responseComplete]{.s9}[(]{.s1}[let]{.s8}[ data):]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.responseText ]{.s1}[=]{.s9}[
data.text]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .listening]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Handle structured
data and suggested actions*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[error]{.s9}[(]{.s1}[let]{.s8}[ code, ]{.s1}[let]{.s8}[
message):]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.error
]{.s1}[=]{.s9}[ .]{.s1}[serverError]{.s9}[(code: code, message:
message)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .error]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[handleBinaryMessage]{.s1}[(]{.s6}[\_]{.s8}[ data:
]{.s6}[Data]{.s11}[) ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Audio output from
server*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[.state
]{.s1}[=]{.s9}[ .speaking]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[playAudio]{.s9}[(data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUDIO CAPTURE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[startAudioCapture]{.s1}[() ]{.s6}[throws]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}audioEngine ]{.s1}[=]{.s9}[
]{.s1}[AVAudioEngine]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
audioEngine ]{.s1}[=]{.s9}[ audioEngine ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}inputNode ]{.s1}[=]{.s9}[
audioEngine.inputNode]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
inputNode ]{.s1}[=]{.s9}[ inputNode ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ recordingFormat
]{.s1}[=]{.s9}[ inputNode.]{.s1}[outputFormat]{.s9}[(forBus:
]{.s1}[0]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Install tap to capture
audio*]{.s1}

[[       
]{.Apple-converted-space}inputNode.]{.s1}[installTap]{.s9}[(]{.s1}

[[            ]{.Apple-converted-space}onBus: ]{.s1}[0]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}bufferSize:
]{.s1}[1024]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}format: recordingFormat]{.s1}

[[        ]{.Apple-converted-space}) { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] buffer, time ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[processAudioBuffer]{.s9}[(buffer)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[
audioEngine.]{.s1}[start]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[stopAudioCapture]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}inputNode]{.s1}[?]{.s9}[.]{.s1}[removeTap]{.s9}[(onBus:
]{.s1}[0]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}audioEngine]{.s1}[?]{.s9}[.]{.s1}[stop]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}audioEngine ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[processAudioBuffer]{.s9}[(]{.s1}[\_]{.s8}[ buffer:
]{.s1}[AVAudioPCMBuffer]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Convert to 16-bit PCM at
16kHz*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
channelData ]{.s1}[=]{.s9}[
buffer.floatChannelData]{.s1}[?]{.s9}[\[]{.s1}[0]{.s11}[\]
]{.s1}[else]{.s8}[ { ]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ frameCount
]{.s1}[=]{.s9}[ ]{.s1}[Int]{.s11}[(buffer.frameLength)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Calculate audio level for
UI*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ sum:
]{.s1}[Float]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[0]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ i ]{.s1}[in]{.s8}[
]{.s1}[0]{.s11}[..\<]{.s9}[frameCount {]{.s1}

[[            ]{.Apple-converted-space}sum ]{.s1}[+=]{.s9}[
]{.s1}[abs]{.s9}[(channelData\[i\])]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ level
]{.s1}[=]{.s9}[ sum ]{.s1}[/]{.s9}[
]{.s1}[Float]{.s11}[(frameCount)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[Task]{.s1}[ {
]{.s6}[\@MainActor]{.s1}[ ]{.s6}[in]{.s8}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[.audioLevel
]{.s1}[=]{.s9}[ level]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Convert float to
int16*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ int16Data
]{.s1}[=]{.s9}[ \[]{.s1}[Int16]{.s11}[\](repeating: ]{.s1}[0]{.s11}[,
count: frameCount)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ i ]{.s1}[in]{.s8}[
]{.s1}[0]{.s11}[..\<]{.s9}[frameCount {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ sample
]{.s1}[=]{.s9}[ ]{.s1}[max]{.s9}[(]{.s1}[-]{.s9}[1.0]{.s11}[,
]{.s1}[min]{.s9}[(]{.s1}[1.0]{.s11}[, channelData\[i\]))]{.s1}

[[            ]{.Apple-converted-space}int16Data\[i\] ]{.s1}[=]{.s9}[
]{.s1}[Int16]{.s11}[(sample ]{.s1}[\*]{.s9}[
]{.s1}[Float]{.s11}[(]{.s1}[Int16]{.s11}[.max))]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Resample to 16kHz if
needed (simplified - use proper resampler in production)*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ audioData
]{.s1}[=]{.s9}[ ]{.s1}[Data]{.s11}[(bytes: int16Data, count: frameCount
]{.s1}[\*]{.s9}[ ]{.s1}[2]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Send to server*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendAudioChunk]{.s9}[(audioData)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[sendAudioChunk]{.s9}[(]{.s1}[\_]{.s8}[ data: ]{.s1}[Data]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ base64
]{.s1}[=]{.s9}[ data.]{.s1}[base64EncodedString]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[sendMessage]{.s9}[(]{.s1}[VoiceMessage]{.s11}[.]{.s1}[audioInput]{.s9}[(data:
base64))]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUDIO PLAYBACK*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[playAudio]{.s9}[(]{.s1}[\_]{.s8}[ data: ]{.s1}[Data]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Decode base64 and play PCM
audio*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation depends on
audio format from server*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Using AVAudioPlayerNode
for low-latency playback*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[stopPlayback]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}audioPlayer]{.s1}[?]{.s9}[.]{.s1}[stop]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// MESSAGE TYPES*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[VoiceMessage]{.s1}[: ]{.s6}[Encodable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[sessionStart]{.s9}[(config: ]{.s1}[SessionConfig]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[audioInput]{.s9}[(data: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ audioCommit]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
responseInterrupt]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[textInput]{.s9}[(text: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ sessionEnd]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[SessionConfig]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ inputFormat:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ outputFormat:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ vadEnabled:
]{.s1}[Bool]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ interruptEnabled:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ type, config,
data, text]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[encode]{.s9}[(to encoder: ]{.s1}[Encoder]{.s11}[)
]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ container
]{.s1}[=]{.s9}[ encoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[sessionStart]{.s9}[(]{.s1}[let]{.s8}[ config):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"session.start\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(config, forKey: .config)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[audioInput]{.s9}[(]{.s1}[let]{.s8}[ data):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"audio.input\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(data, forKey: .data)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.audioCommit:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"audio.commit\"]{.s10}[, forKey:
.type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.responseInterrupt:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"response.interrupt\"]{.s10}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[textInput]{.s9}[(]{.s1}[let]{.s8}[ text):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"text.input\"]{.s10}[, forKey:
.type)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(text, forKey: .text)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .sessionEnd:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[try]{.s8}[
container.]{.s1}[encode]{.s9}[(]{.s1}[\"session.end\"]{.s10}[, forKey:
.type)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[ServerMessage]{.s1}[: ]{.s6}[Decodable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[sessionStarted]{.s9}[(sessionId: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ speechStarted]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[transcriptPartial]{.s1}[(text: ]{.s6}[String]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[transcriptFinal]{.s1}[(text: ]{.s6}[String]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
processingStarted]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[textOutput]{.s9}[(text: ]{.s1}[String]{.s11}[, isFinal:
]{.s1}[Bool]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[responseComplete]{.s1}[(data: ]{.s6}[ResponseData]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[error]{.s9}[(code: ]{.s1}[String]{.s11}[, message:
]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[ResponseData]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ text:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ structuredData:
\[]{.s1}[String]{.s11}[: ]{.s1}[AnyCodable]{.s11}[\]]{.s1}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ suggestedActions:
\[]{.s1}[SuggestedAction]{.s11}[\]]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[SuggestedAction]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ label:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ skillId:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[CodingKeys]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[CodingKey]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ type, sessionId,
text, isFinal, data, code, message]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(from decoder:
]{.s1}[Decoder]{.s11}[) ]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ container
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
decoder.]{.s1}[container]{.s9}[(keyedBy:
]{.s1}[CodingKeys]{.s11}[.]{.s1}[self]{.s8}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ type
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .type)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ type {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"session.started\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[sessionStarted]{.s9}[(sessionId:
]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .sessionId))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"speech.started\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .speechStarted]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"transcript.partial\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[transcriptPartial]{.s9}[(text: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .text))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"transcript.final\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[transcriptFinal]{.s9}[(text: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .text))]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"processing.started\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .processingStarted]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"text.output\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[textOutput]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}text: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .text),]{.s1}

[[                ]{.Apple-converted-space}isFinal: ]{.s1}[try]{.s8}[
container.]{.s1}[decodeIfPresent]{.s9}[(]{.s1}[Bool]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .isFinal) ]{.s1}[??]{.s9}[ ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"response.complete\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[responseComplete]{.s9}[(data: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[ResponseData]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .data))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"error\"]{.s10}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[self]{.s8}[
]{.s1}[=]{.s9}[ .]{.s1}[error]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}code: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .code),]{.s1}

[[                ]{.Apple-converted-space}message: ]{.s1}[try]{.s8}[
container.]{.s1}[decode]{.s9}[(]{.s1}[String]{.s11}[.]{.s1}[self]{.s8}[,
forKey: .message)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[throw]{.s8}[
]{.s6}[DecodingError]{.s11}[.]{.s6}[dataCorruptedError]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}forKey: .type,]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[in]{.s8}[:
container,]{.s1}

[[                ]{.Apple-converted-space}debugDescription:
]{.s1}[\"Unknown message type: ]{.s10}[\\(type)]{.s1}[\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[VoiceError]{.s1}[: ]{.s6}[Error]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ connectionLost]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
audioSessionFailed]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[serverError]{.s9}[(code: ]{.s1}[String]{.s11}[, message:
]{.s1}[String]{.s11}[)]{.s1}

[}]{.s1}

[]{.s1}\

[Design System Components]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Theme/Colors.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[extension]{.s1}[ ]{.s6}[Color]{.s11}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SURFACE COLORS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
surfaceBackground ]{.s1}[=]{.s9}[
]{.s1}[Color]{.s11}[(]{.s1}[\"SurfaceBackground\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
surfaceCard ]{.s1}[=]{.s9}[
]{.s1}[Color]{.s11}[(]{.s1}[\"SurfaceCard\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
surfaceElevated ]{.s1}[=]{.s9}[
]{.s1}[Color]{.s11}[(]{.s1}[\"SurfaceElevated\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEATHER COLORS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherClear ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"3B82F6\"]{.s10}[)[      ]{.Apple-converted-space}]{.s1}[*//
Blue*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherCloudy ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"94A3B8\"]{.s10}[) [    ]{.Apple-converted-space}]{.s1}[*//
Slate*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherRain ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"6366F1\"]{.s10}[) [      ]{.Apple-converted-space}]{.s1}[*//
Indigo*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherHeavyRain ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"7C3AED\"]{.s10}[)[  ]{.Apple-converted-space}]{.s1}[*//
Violet*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherSnow ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"E2E8F0\"]{.s10}[) [      ]{.Apple-converted-space}]{.s1}[*//
Light gray*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
weatherFog ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"64748B\"]{.s10}[)[        ]{.Apple-converted-space}]{.s1}[*//
Gray*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// ALERT COLORS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
alertWarning ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"F59E0B\"]{.s10}[)[      ]{.Apple-converted-space}]{.s1}[*//
Amber*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
alertDanger ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"EF4444\"]{.s10}[) [      ]{.Apple-converted-space}]{.s1}[*//
Red*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
alertSuccess ]{.s1}[=]{.s9}[ ]{.s1}[Color]{.s11}[(hex:
]{.s1}[\"10B981\"]{.s10}[)[      ]{.Apple-converted-space}]{.s1}[*//
Emerald*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HELPER*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(hex:
]{.s1}[String]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hex ]{.s1}[=]{.s9}[
hex.]{.s1}[trimmingCharacters]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[CharacterSet]{.s11}[.alphanumerics.inverted)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ int:
]{.s1}[UInt64]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[0]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[Scanner]{.s11}[(string:
hex).]{.s1}[scanHexInt64]{.s9}[(]{.s1}[&]{.s9}[int)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ a, r, g, b:
]{.s1}[UInt64]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ hex.count
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[3]{.s11}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[
(]{.s1}[255]{.s11}[, (int ]{.s1}[\>\>]{.s9}[ ]{.s1}[8]{.s11}[)
]{.s1}[\*]{.s9}[ ]{.s1}[17]{.s11}[, (int ]{.s1}[\>\>]{.s9}[
]{.s1}[4]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xF]{.s11}[) ]{.s1}[\*]{.s9}[
]{.s1}[17]{.s11}[, (int ]{.s1}[&]{.s9}[ ]{.s1}[0xF]{.s11}[)
]{.s1}[\*]{.s9}[ ]{.s1}[17]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[6]{.s11}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[
(]{.s1}[255]{.s11}[, int ]{.s1}[\>\>]{.s9}[ ]{.s1}[16]{.s11}[, int
]{.s1}[\>\>]{.s9}[ ]{.s1}[8]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[,
int ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[8]{.s11}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[ (int
]{.s1}[\>\>]{.s9}[ ]{.s1}[24]{.s11}[, int ]{.s1}[\>\>]{.s9}[
]{.s1}[16]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[, int
]{.s1}[\>\>]{.s9}[ ]{.s1}[8]{.s11}[ ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[,
int ]{.s1}[&]{.s9}[ ]{.s1}[0xFF]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}(a, r, g, b) ]{.s1}[=]{.s9}[
(]{.s1}[1]{.s11}[, ]{.s1}[1]{.s11}[, ]{.s1}[1]{.s11}[,
]{.s1}[0]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.]{.s1}[init]{.s8}[(]{.s1}

[[            ]{.Apple-converted-space}.sRGB,]{.s1}

[[            ]{.Apple-converted-space}red: ]{.s1}[Double]{.s11}[(r)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}green: ]{.s1}[Double]{.s11}[(g)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}blue: ]{.s1}[Double]{.s11}[(b)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}opacity: ]{.s1}[Double]{.s11}[(a)
]{.s1}[/]{.s9}[ ]{.s1}[255]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/GlassCard.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[GlassCard]{.s1}[\<]{.s9}[Content]{.s1}[:
]{.s6}[View]{.s1}[\>]{.s9}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ variant:
]{.s1}[Variant]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ weatherTint:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}[
]{.s6}[let]{.s8}[ content: ]{.s6}[Content]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Variant]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
\`]{.s1}[default]{.s8}[\`]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ elevated]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ tinted]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}

[[        ]{.Apple-converted-space}variant: ]{.s1}[Variant]{.s11}[
]{.s1}[=]{.s9}[ .]{.s1}[default]{.s8}[,]{.s1}

[[        ]{.Apple-converted-space}weatherTint:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}[?]{.s9}[
]{.s6}[=]{.s9}[ ]{.s6}[nil]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\@ViewBuilder]{.s11}[ content:
() ]{.s1}[-\>]{.s9}[ ]{.s1}[Content]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.variant
]{.s1}[=]{.s9}[ variant]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.weatherTint
]{.s1}[=]{.s9}[ weatherTint]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.content
]{.s1}[=]{.s9}[ ]{.s1}[content]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}content]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(]{.s1}[16]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(backgroundView)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[16]{.s11}[, style: .continuous))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[16]{.s11}[, style: .continuous)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[stroke]{.s9}[(]{.s1}[Color]{.s11}[.white.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[),
lineWidth: ]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[shadow]{.s9}[(color:
shadowColor, radius: shadowRadius)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
backgroundView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ variant {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[default]{.s8}[:]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.regular]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .elevated:]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.thick]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .tinted:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ tint ]{.s1}[=]{.s9}[ weatherTint {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[LinearGradient]{.s11}[(]{.s1}

[[                    ]{.Apple-converted-space}colors: \[]{.s1}

[[                       
]{.Apple-converted-space}tint.color.]{.s1}[opacity]{.s9}[(]{.s1}[0.15]{.s11}[),]{.s1}

[[                       
]{.Apple-converted-space}tint.color.]{.s1}[opacity]{.s9}[(]{.s1}[0.05]{.s11}[)]{.s1}

[[                    ]{.Apple-converted-space}\],]{.s1}

[[                    ]{.Apple-converted-space}startPoint:
.topLeading,]{.s1}

[[                    ]{.Apple-converted-space}endPoint:
.bottomTrailing]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Material]{.s11}[.regular)]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.regular]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shadowColor: ]{.s1}[Color]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ variant {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[default]{.s8}[: ]{.s1}[return]{.s8}[
.black.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .elevated:
]{.s1}[return]{.s8}[
.black.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .tinted:
]{.s1}[return]{.s8}[
.black.]{.s1}[opacity]{.s9}[(]{.s1}[0.15]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shadowRadius: ]{.s1}[CGFloat]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ variant {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s1}[
.]{.s6}[default]{.s1}[: ]{.s6}[return]{.s1}[ ]{.s6}[8]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .elevated:
]{.s1}[return]{.s8}[ ]{.s1}[16]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .tinted:
]{.s1}[return]{.s8}[ ]{.s1}[12]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/WeatherTimeline.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherTimelineView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ timeline:
]{.s1}[WeatherTimeline]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ orientation:
]{.s1}[Orientation]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[Orientation]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ vertical]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ horizontal]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ orientation
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .vertical:]{.s1}

[[            ]{.Apple-converted-space}verticalTimeline]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .horizontal:]{.s1}

[[            ]{.Apple-converted-space}horizontalTimeline]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
verticalTimeline: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[0]{.s11}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(]{.s1}[Array]{.s11}[(timeline.points.]{.s1}[enumerated]{.s9}[()),
id: \\.element.id) { index, point ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[12]{.s11}[) {]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[*// Timeline
marker*]{.s13}

[[                   
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Circle]{.s11}[()]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[markerColor]{.s9}[(]{.s1}[for]{.s8}[:
index))]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width: ]{.s1}[12]{.s11}[,
height: ]{.s1}[12]{.s11}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
index ]{.s1}[\<]{.s9}[ timeline.points.count ]{.s1}[-]{.s9}[
]{.s1}[1]{.s11}[ {]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[lineGradient]{.s9}[(from:
index))]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width:
]{.s1}[4]{.s11}[)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[*//
Content*]{.s13}

[[                   
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading,
spacing: ]{.s1}[4]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[formatTime]{.s9}[(point.time))]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(point.weather.condition.icon)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(]{.s1}[Int]{.s11}[(point.weather.tempFahrenheit))]{.s1}[°\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(point.weather.condition.rawValue.capitalized)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(minHeight:
]{.s1}[60]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
horizontalTimeline: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(]{.s1}[Array]{.s11}[(timeline.points.]{.s1}[enumerated]{.s9}[()),
id: \\.element.id) { index, point ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[8]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(point.weather.condition.icon)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[formatTime]{.s9}[(point.time))]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(maxWidth: .infinity)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[ index
]{.s1}[\<]{.s9}[ timeline.points.count ]{.s1}[-]{.s9}[ ]{.s1}[1]{.s11}[
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[lineGradient]{.s9}[(]{.s1}

[]{.s1}\

[]{.s1}\

[API Error: Claude\'s response exceeded the 32000 output token maximum.
To configure this behavior, set the CLAUDE_CODE_MAX_OUTPUT_TOKENS
environment variable.]{.s3}

[]{.s1}\

[I\'ll continue from where I left off with the WeatherTimelineView and
then complete the remaining iOS components.]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/WeatherTimeline.swift (continued)*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[[                   
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[lineGradient]{.s9}[(from:
index))]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(height:
]{.s1}[3]{.s11}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(maxWidth:
]{.s1}[40]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[markerColor]{.s9}[(]{.s1}[for]{.s8}[ index: ]{.s1}[Int]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[Color]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ index
]{.s1}[==]{.s9}[ ]{.s1}[0]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ .blue
]{.s1}[*// Current position*]{.s13}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ ]{.s1}[if]{.s8}[
index ]{.s1}[==]{.s9}[ timeline.points.count ]{.s1}[-]{.s9}[
]{.s1}[1]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ .green
]{.s1}[*// Destination*]{.s13}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
timeline.points\[index\].weather.condition.color]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[lineGradient]{.s9}[(from index: ]{.s1}[Int]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[LinearGradient]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ fromColor
]{.s1}[=]{.s9}[ timeline.points\[index\].weather.condition.color]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ toColor
]{.s1}[=]{.s9}[ timeline.points\[index ]{.s1}[+]{.s9}[
]{.s1}[1]{.s11}[\].weather.condition.color]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}colors: \[fromColor,
toColor\],]{.s1}

[[            ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[            ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[formatTime]{.s9}[(]{.s1}[\_]{.s8}[ date: ]{.s1}[Date]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ formatter
]{.s1}[=]{.s9}[ ]{.s1}[DateFormatter]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}formatter.dateFormat ]{.s1}[=]{.s9}[
]{.s1}[\"h:mm a\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
formatter.]{.s1}[string]{.s9}[(from: date)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/WeatherIcon.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherIcon]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ condition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ size:
]{.s1}[Size]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ animated:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Size]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ small, medium,
large, hero]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ dimension:
]{.s1}[CGFloat]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .small:
]{.s1}[return]{.s8}[ ]{.s1}[24]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ ]{.s1}[40]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .large:
]{.s1}[return]{.s8}[ ]{.s1}[64]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .hero:
]{.s1}[return]{.s8}[ ]{.s1}[120]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ fontSize:
]{.s1}[CGFloat]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .small:
]{.s1}[return]{.s8}[ ]{.s1}[20]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ ]{.s1}[32]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .large:
]{.s1}[return]{.s8}[ ]{.s1}[56]{.s11}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .hero:
]{.s1}[return]{.s8}[ ]{.s1}[100]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}[\_]{.s8}[
condition: ]{.s1}[WeatherCondition]{.s11}[.]{.s1}[WeatherType]{.s11}[,
size: ]{.s1}[Size]{.s11}[ ]{.s1}[=]{.s9}[ .medium, animated:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.condition
]{.s1}[=]{.s9}[ condition]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.size
]{.s1}[=]{.s9}[ size]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.animated
]{.s1}[=]{.s9}[ animated]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(condition.icon)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
size.fontSize))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width:
size.dimension, height: size.dimension)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[modifier]{.s9}[(]{.s1}[WeatherAnimationModifier]{.s11}[(condition:
condition, animated: animated))]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WeatherAnimationModifier]{.s1}[:
]{.s6}[ViewModifier]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ condition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ animated:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ isAnimating ]{.s1}[=]{.s9}[
]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[body]{.s9}[(content: ]{.s1}[Content]{.s11}[) ]{.s1}[-\>]{.s9}[
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}content]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[opacity]{.s9}[(animated
]{.s1}[&&]{.s9}[ shouldPulse ]{.s1}[?]{.s9}[ (isAnimating
]{.s1}[?]{.s9}[ ]{.s1}[0.7]{.s11}[ : ]{.s1}[1.0]{.s11}[) :
]{.s1}[1.0]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[scaleEffect]{.s9}[(animated
]{.s1}[&&]{.s9}[ shouldBounce ]{.s1}[?]{.s9}[ (isAnimating
]{.s1}[?]{.s9}[ ]{.s1}[1.05]{.s11}[ : ]{.s1}[1.0]{.s11}[) :
]{.s1}[1.0]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}.onAppear {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[ animated
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[withAnimation]{.s9}[(.]{.s1}[easeInOut]{.s9}[(duration:
]{.s1}[1.5]{.s11}[).]{.s1}[repeatForever]{.s9}[(autoreverses:
]{.s1}[true]{.s11}[)) {]{.s1}

[[                        ]{.Apple-converted-space}isAnimating
]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shouldPulse: ]{.s1}[Bool]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ condition
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .rain, .heavyRain,
.lightRain, .thunderstorm:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
shouldBounce: ]{.s1}[Bool]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}condition ]{.s1}[==]{.s9}[
.clear]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// DESIGNSYSTEM/Components/GlassButton.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[GlassButton]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ title:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ style:
]{.s1}[Style]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ action: ()
]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Style]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ primary]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ secondary]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ destructive]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ backgroundColor:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .primary:
]{.s1}[return]{.s8}[ .blue]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .secondary:
]{.s1}[return]{.s8}[ .clear]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .destructive:
]{.s1}[return]{.s8}[ .red]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ foregroundColor:
]{.s1}[Color]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .primary,
.destructive: ]{.s1}[return]{.s8}[ .white]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .secondary:
]{.s1}[return]{.s8}[ .primary]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ title:
]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}icon: ]{.s1}[String]{.s11}[?]{.s9}[
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}style: ]{.s1}[Style]{.s11}[
]{.s1}[=]{.s9}[ .primary,]{.s1}

[[        ]{.Apple-converted-space}action: ]{.s1}[\@escaping]{.s11}[ ()
]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.title
]{.s1}[=]{.s9}[ title]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.icon
]{.s1}[=]{.s9}[ icon]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.style
]{.s1}[=]{.s9}[ style]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.action
]{.s1}[=]{.s9}[ action]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Button]{.s11}[(action: action)
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[8]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ icon ]{.s1}[=]{.s9}[ icon {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName: icon)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(title)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.horizontal,
]{.s1}[20]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.vertical,
]{.s1}[14]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(minWidth:
]{.s1}[44]{.s11}[, minHeight: ]{.s1}[44]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(backgroundView)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(style.foregroundColor)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[12]{.s11}[, style: .continuous))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[12]{.s11}[, style: .continuous)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[stroke]{.s9}[(]{.s1}[Color]{.s11}[.white.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[),
lineWidth: ]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[buttonStyle]{.s9}[(]{.s6}[ScaleButtonStyle]{.s1}[())]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
backgroundView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ style {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .primary:]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}colors: \[.blue,
.blue.]{.s1}[opacity]{.s9}[(]{.s1}[0.8]{.s11}[)\],]{.s1}

[[                ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[                ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .secondary:]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Material]{.s11}[.ultraThin]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.destructive:]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}colors: \[.red,
.red.]{.s1}[opacity]{.s9}[(]{.s1}[0.8]{.s11}[)\],]{.s1}

[[                ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[                ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ScaleButtonStyle]{.s1}[: ]{.s6}[ButtonStyle]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[makeBody]{.s9}[(configuration: ]{.s1}[Configuration]{.s11}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}configuration.label]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[scaleEffect]{.s9}[(configuration.isPressed
]{.s1}[?]{.s9}[ ]{.s1}[0.96]{.s11}[ : ]{.s1}[1.0]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[animation]{.s9}[(.]{.s1}[spring]{.s9}[(response:
]{.s1}[0.2]{.s11}[), value: configuration.isPressed)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[CarPlay Integration]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CARPLAY/CarPlaySceneDelegate.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[CarPlay]{.s1}

[]{.s1}\

[class]{.s8}[ ]{.s6}[CarPlaySceneDelegate]{.s1}[:
]{.s6}[UIResponder]{.s1}[,
]{.s6}[CPTemplateApplicationSceneDelegate]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ interfaceController:
]{.s1}[CPInterfaceController]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
carPlayManager ]{.s1}[=]{.s9}[ ]{.s1}[CarPlayManager]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SCENE LIFECYCLE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[templateApplicationScene]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[
templateApplicationScene:
]{.s1}[CPTemplateApplicationScene]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didConnect interfaceController:
]{.s1}[CPInterfaceController]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.interfaceController
]{.s1}[=]{.s9}[ interfaceController]{.s1}

[[        ]{.Apple-converted-space}carPlayManager.interfaceController
]{.s1}[=]{.s9}[ interfaceController]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Set up the initial
template*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ homeTemplate
]{.s1}[=]{.s9}[ carPlayManager.]{.s1}[createHomeTemplate]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}interfaceController.]{.s1}[setRootTemplate]{.s9}[(homeTemplate,
animated: ]{.s1}[false]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Notify app that CarPlay is
connected*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.carPlayDidConnect, object: ]{.s1}[nil]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[templateApplicationScene]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[
templateApplicationScene:
]{.s1}[CPTemplateApplicationScene]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didDisconnect interfaceController:
]{.s1}[CPInterfaceController]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.interfaceController
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}carPlayManager.interfaceController
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.carPlayDidDisconnect, object: ]{.s1}[nil]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[Notification]{.s1}[.]{.s6}[Name]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
carPlayDidConnect ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"carPlayDidConnect\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
carPlayDidDisconnect ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"carPlayDidDisconnect\"]{.s10}[)]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CARPLAY/CarPlayManager.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[CarPlay]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[CarPlayManager]{.s1}[:
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[weak]{.s8}[ ]{.s1}[var]{.s8}[
interfaceController: ]{.s1}[CPInterfaceController]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
a2aClient: ]{.s1}[A2AClient]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
voiceService: ]{.s1}[VoiceService]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
locationService: ]{.s1}[LocationService]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
cancellables ]{.s1}[=]{.s9}[
]{.s1}[Set]{.s11}[\<]{.s9}[AnyCancellable]{.s11}[\>]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
currentNavigation: ]{.s1}[NavigationSession]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[(]{.s1}

[[        ]{.Apple-converted-space}a2aClient: ]{.s1}[A2AClient]{.s11}[
]{.s1}[=]{.s9}[ .shared,]{.s1}

[[        ]{.Apple-converted-space}voiceService:
]{.s1}[VoiceService]{.s11}[ ]{.s1}[=]{.s9}[ .shared,]{.s1}

[[        ]{.Apple-converted-space}locationService:
]{.s1}[LocationService]{.s11}[ ]{.s1}[=]{.s9}[ .shared]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.a2aClient
]{.s1}[=]{.s9}[ a2aClient]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.voiceService
]{.s1}[=]{.s9}[ voiceService]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.locationService
]{.s1}[=]{.s9}[ locationService]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HOME TEMPLATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[createHomeTemplate]{.s1}[() ]{.s6}[-\>]{.s1}[
]{.s6}[CPTemplate]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// For navigation apps, we
use CPMapTemplate as the base*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ mapTemplate
]{.s1}[=]{.s9}[ ]{.s1}[CPMapTemplate]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}mapTemplate.guidanceBackgroundColor
]{.s1}[=]{.s9}[ ]{.s1}[UIColor]{.s11}[.systemBackground]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add map buttons*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceButton
]{.s1}[=]{.s9}[ ]{.s1}[CPMapButton]{.s11}[ { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s6}[self]{.s8}[?]{.s1}[.]{.s6}[startVoiceInteraction]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}voiceButton.image ]{.s1}[=]{.s9}[
]{.s1}[UIImage]{.s11}[(systemName: ]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ searchButton
]{.s1}[=]{.s9}[ ]{.s1}[CPMapButton]{.s11}[ { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s6}[self]{.s8}[?]{.s1}[.]{.s6}[showDestinationSearch]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}searchButton.image ]{.s1}[=]{.s9}[
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"magnifyingglass\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}mapTemplate.mapButtons
]{.s1}[=]{.s9}[ \[voiceButton, searchButton\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add trip previews as
dashboard*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[updateDashboard]{.s9}[(on:
mapTemplate)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
mapTemplate]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[updateDashboard]{.s9}[(on mapTemplate:
]{.s1}[CPMapTemplate]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Fetch commute
data*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[guard]{.s8}[
]{.s1}[let]{.s8}[ homeLocation ]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getUserLocation]{.s9}[(label: .home),]{.s1}

[[                  ]{.Apple-converted-space}]{.s1}[let]{.s8}[
workLocation ]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getUserLocation]{.s9}[(label: .work) ]{.s1}[else]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
routeWeather ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.]{.s1}[savedLocation]{.s9}[(id: homeLocation.id.uuidString),]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: workLocation.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Create trip
preview*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tripPreview
]{.s1}[=]{.s9}[ ]{.s1}[createTripPreview]{.s9}[(from:
routeWeather)]{.s1}

[[               
]{.Apple-converted-space}mapTemplate.]{.s1}[showTripPreviews]{.s9}[(\[tripPreview\],
textConfiguration: ]{.s1}[nil]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to fetch
route weather: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[createTripPreview]{.s9}[(from result:
]{.s1}[RouteWeatherResult]{.s11}[) ]{.s1}[-\>]{.s9}[
]{.s1}[CPTrip]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ origin
]{.s1}[=]{.s9}[ ]{.s1}[MKMapItem]{.s11}[(placemark:
]{.s1}[MKPlacemark]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}coordinate:
result.route.origin.coordinate]{.s1}

[[        ]{.Apple-converted-space}))]{.s1}

[[        ]{.Apple-converted-space}origin.name ]{.s1}[=]{.s9}[
result.route.origin.name]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination
]{.s1}[=]{.s9}[ ]{.s1}[MKMapItem]{.s11}[(placemark:
]{.s1}[MKPlacemark]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}coordinate:
result.route.destination.coordinate]{.s1}

[[        ]{.Apple-converted-space}))]{.s1}

[[        ]{.Apple-converted-space}destination.name ]{.s1}[=]{.s9}[
result.route.destination.name]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trip
]{.s1}[=]{.s9}[ ]{.s1}[CPTrip]{.s11}[(origin: origin, destination:
destination, routeChoices: \[\])]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add route estimate with
weather info*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ estimate
]{.s6}[=]{.s9}[ ]{.s6}[CPTripPreviewTextConfiguration]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}startButtonTitle: ]{.s1}[\"Go
Now\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}additionalRoutesButtonTitle:
]{.s1}[nil]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}overviewButtonTitle:
]{.s1}[\"Preview\"]{.s10}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ trip]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// ROUTE PREVIEW TEMPLATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[showRoutePreview]{.s9}[(to destination: ]{.s1}[Location]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
routeWeather ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.currentLocation,]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: destination.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
departureOptions ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[optimizeDeparture]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.currentLocation,]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: destination.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Create list of
departure options*]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[let]{.s8}[ template
]{.s6}[=]{.s1}[ ]{.s6}[createDepartureOptionsTemplate]{.s1}[(]{.s6}

[[                    ]{.Apple-converted-space}destination:
destination,]{.s1}

[[                    ]{.Apple-converted-space}options:
departureOptions,]{.s1}

[[                    ]{.Apple-converted-space}routeWeather:
routeWeather]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[pushTemplate]{.s9}[(template,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[showError]{.s9}[(error)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createDepartureOptionsTemplate]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}destination:
]{.s1}[Location]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}options:
\[]{.s1}[DepartureOption]{.s11}[\],]{.s1}

[[        ]{.Apple-converted-space}routeWeather:
]{.s1}[RouteWeatherResult]{.s11}

[[    ]{.Apple-converted-space}) ]{.s6}[-\>]{.s9}[
]{.s6}[CPTemplate]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ items:
\[]{.s1}[CPListItem]{.s11}[\] ]{.s1}[=]{.s9}[ \[\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ option
]{.s1}[in]{.s8}[ options {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ item
]{.s1}[=]{.s9}[ ]{.s1}[CPListItem]{.s11}[(]{.s1}

[[                ]{.Apple-converted-space}text:
]{.s1}[formatDepartureTime]{.s9}[(option.departureTime),]{.s1}

[[                ]{.Apple-converted-space}detailText:
]{.s1}[\"]{.s10}[\\(option.durationMinutes)]{.s1}[ min •
]{.s10}[\\(option.weatherSummary)]{.s1}[\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Weather
indicator*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherIcon
]{.s1}[=]{.s9}[
routeWeather.weatherTimeline.points.first]{.s1}[?]{.s9}[.weather.condition.icon
]{.s1}[??]{.s9}[ ]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}

[[           
]{.Apple-converted-space}item.]{.s1}[setImage]{.s9}[(]{.s1}[createWeatherImage]{.s9}[(weatherIcon))]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
option.isRecommended {]{.s1}

[[                ]{.Apple-converted-space}item.accessoryType
]{.s1}[=]{.s9}[ .disclosureIndicator]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}item.handler ]{.s1}[=]{.s9}[ {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[, completion
]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[startNavigation]{.s9}[(to:
destination, departureOption: option)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[completion]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}items.]{.s1}[append]{.s9}[(item)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ section
]{.s1}[=]{.s9}[ ]{.s1}[CPListSection]{.s11}[(items: items, header:
]{.s1}[\"When to Leave\"]{.s10}[, sectionIndexTitle:
]{.s1}[nil]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ listTemplate
]{.s1}[=]{.s9}[ ]{.s1}[CPListTemplate]{.s11}[(title: destination.name,
sections: \[section\])]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Add alert banner if
weather change detected*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
transition ]{.s1}[=]{.s9}[
routeWeather.weatherTimeline.transitions.first {]{.s1}

[[           
]{.Apple-converted-space}listTemplate.]{.s1}[updateSections]{.s9}[(\[section\])]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Note: CarPlay doesn\'t
have native alert banners on list templates*]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// We\'d show this via
the map template instead*]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
listTemplate]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// NAVIGATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[startNavigation]{.s9}[(to destination: ]{.s1}[Location]{.s11}[,
departureOption: ]{.s1}[DepartureOption]{.s11}[?]{.s9}[ ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mapTemplate ]{.s1}[=]{.s9}[
interfaceController]{.s1}[?]{.s9}[.rootTemplate ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[CPMapTemplate]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Create navigation
session*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trip
]{.s1}[=]{.s9}[ ]{.s1}[CPTrip]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}origin:
]{.s1}[MKMapItem]{.s11}[.]{.s1}[forCurrentLocation]{.s9}[(),]{.s1}

[[            ]{.Apple-converted-space}destination:
]{.s1}[MKMapItem]{.s11}[(placemark:
]{.s1}[MKPlacemark]{.s11}[(coordinate: destination.coordinate)),]{.s1}

[[            ]{.Apple-converted-space}routeChoices: \[\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}mapTemplate.]{.s1}[startNavigationSession]{.s9}[(]{.s1}[for]{.s8}[:
trip)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Begin turn-by-turn*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// In production, integrate
with MapKit directions or custom routing*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start weather monitoring
for route*]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[startRouteWeatherMonitoring]{.s1}[(to:
destination)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[startRouteWeatherMonitoring]{.s1}[(to destination:
]{.s6}[Location]{.s11}[) {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Poll for weather changes
every 5 minutes during navigation*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[Timer]{.s11}[.]{.s1}[publish]{.s9}[(every:
]{.s1}[300]{.s11}[, on: .main, ]{.s1}[in]{.s8}[: .common)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[autoconnect]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[checkRouteWeatherUpdate]{.s9}[(to:
destination)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[checkRouteWeatherUpdate]{.s9}[(to destination:
]{.s1}[Location]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[
routeWeather ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}origin:
.currentLocation,]{.s1}

[[                    ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: destination.id.uuidString)]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Check for
significant weather changes*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ transition ]{.s1}[=]{.s9}[
routeWeather.weatherTimeline.transitions.first,]{.s1}

[[                  
]{.Apple-converted-space}]{.s1}[shouldAlertUser]{.s9}[(]{.s1}[for]{.s8}[:
transition) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[showWeatherAlert]{.s9}[(transition:
transition)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Silent fail -
don\'t interrupt navigation for monitoring errors*]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[shouldAlertUser]{.s9}[(]{.s1}[for]{.s8}[ transition:
]{.s1}[WeatherTransition]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Bool]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Alert for rain/snow
starting*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ transition.to
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .rain, .heavyRain,
.lightRain, .snow, .heavySnow, .thunderstorm:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEATHER ALERTS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[showWeatherAlert]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mapTemplate ]{.s1}[=]{.s9}[
interfaceController]{.s1}[?]{.s9}[.rootTemplate ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[CPMapTemplate]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alert
]{.s1}[=]{.s9}[ ]{.s1}[CPNavigationAlert]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}titleVariants: \[]{.s1}[\"Weather
Change Ahead\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}subtitleVariants:
\[]{.s1}[\"]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[ in
]{.s10}[\\(transition.locationDescription ]{.s1}[??]{.s9}[
]{.s1}[\"ahead\"]{.s10}[)]{.s1}[\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}image:
]{.s1}[createWeatherImage]{.s9}[(transition.to.icon),]{.s1}

[[            ]{.Apple-converted-space}primaryAction:
]{.s1}[CPAlertAction]{.s11}[(title: ]{.s1}[\"OK\"]{.s10}[, style:
.]{.s1}[default]{.s8}[) { ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}[ },]{.s1}

[[            ]{.Apple-converted-space}secondaryAction:
]{.s1}[CPAlertAction]{.s11}[(title: ]{.s1}[\"Details\"]{.s10}[, style:
.]{.s1}[default]{.s8}[) { \[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\]
]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[speakWeatherDetails]{.s9}[(transition:
transition)]{.s1}

[[            ]{.Apple-converted-space}},]{.s1}

[[            ]{.Apple-converted-space}duration: ]{.s1}[10]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}mapTemplate.]{.s1}[present]{.s9}[(navigationAlert:
alert, animated: ]{.s1}[true]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Also speak the
alert*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[speakWeatherAlert]{.s9}[(transition:
transition)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[speakWeatherAlert]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[\"Heads up.
]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[ expected
]{.s10}[\\(transition.locationDescription ]{.s1}[??]{.s9}[
]{.s1}[\"ahead\"]{.s10}[)]{.s1}[.\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[speak]{.s9}[(message)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[speakWeatherDetails]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// More detailed voice
info*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ message
]{.s1}[=]{.s9}[ ]{.s1}[\"\"\"]{.s10}

[[       
]{.Apple-converted-space}]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[
is expected starting at ]{.s10}[\\(transition.locationDescription
]{.s1}[??]{.s9}[ ]{.s1}[\"ahead\"]{.s10}[)]{.s1}[.]{.s10}

[[        ]{.Apple-converted-space}Visibility may be reduced. Drive
carefully.]{.s1}

[[        ]{.Apple-converted-space}\"\"\"]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[speak]{.s9}[(message)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// VOICE INTERACTION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[startVoiceInteraction]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mapTemplate ]{.s1}[=]{.s9}[
interfaceController]{.s1}[?]{.s9}[.rootTemplate ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[CPMapTemplate]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Show voice UI*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceTemplate
]{.s1}[=]{.s9}[
]{.s1}[CPVoiceControlTemplate]{.s11}[(voiceControlStates: \[]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CPVoiceControlState]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"listening\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"Listening\...\"]{.s10}[\],]{.s1}

[[                ]{.Apple-converted-space}image:
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}[!]{.s9}[,]{.s1}

[[                ]{.Apple-converted-space}repeats: ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space}),]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CPVoiceControlState]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"processing\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"Thinking\...\"]{.s10}[\],]{.s1}

[[                ]{.Apple-converted-space}image:
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"brain\"]{.s10}[)]{.s1}[!]{.s9}[,]{.s1}

[[                ]{.Apple-converted-space}repeats: ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space}),]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CPVoiceControlState]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"speaking\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"\"]{.s10}[\],]{.s1}

[[                ]{.Apple-converted-space}image:
]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"speaker.wave.2.fill\"]{.s10}[)]{.s1}[!]{.s9}[,]{.s1}

[[                ]{.Apple-converted-space}repeats: ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}\])]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[presentTemplate]{.s9}[(voiceTemplate,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Start voice service*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[try]{.s8}[
]{.s1}[await]{.s8}[ voiceService.]{.s1}[startSession]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Listen for voice
service state changes*]{.s1}

[[                ]{.Apple-converted-space}voiceService.\$state]{.s1}

[[                    ]{.Apple-converted-space}.sink {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[, ]{.s1}[weak]{.s8}[
voiceTemplate\] state ]{.s1}[in]{.s8}

[[                        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
state {]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.listening:]{.s1}

[[                           
]{.Apple-converted-space}voiceTemplate]{.s1}[?]{.s9}[.]{.s1}[activateVoiceControlState]{.s9}[(withIdentifier:
]{.s1}[\"listening\"]{.s10}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.processing:]{.s1}

[[                           
]{.Apple-converted-space}voiceTemplate]{.s1}[?]{.s9}[.]{.s1}[activateVoiceControlState]{.s9}[(withIdentifier:
]{.s1}[\"processing\"]{.s10}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.speaking:]{.s1}

[[                           
]{.Apple-converted-space}voiceTemplate]{.s1}[?]{.s9}[.]{.s1}[activateVoiceControlState]{.s9}[(withIdentifier:
]{.s1}[\"speaking\"]{.s10}[)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.idle:]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.interfaceController]{.s1}[?]{.s9}[.]{.s1}[dismissTemplate]{.s9}[(animated:
]{.s1}[true]{.s11}[)]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[break]{.s8}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[dismissTemplate]{.s9}[(animated:
]{.s1}[true]{.s11}[)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[showError]{.s9}[(error)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DESTINATION SEARCH*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[showDestinationSearch]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Get saved
locations*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ locations
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getSavedLocations]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[var]{.s8}[ items:
\[]{.s1}[CPListItem]{.s11}[\] ]{.s1}[=]{.s9}[ \[\]]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[for]{.s8}[ location
]{.s1}[in]{.s8}[ locations {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ item
]{.s1}[=]{.s9}[ ]{.s1}[CPListItem]{.s11}[(]{.s1}

[[                    ]{.Apple-converted-space}text:
location.name,]{.s1}

[[                    ]{.Apple-converted-space}detailText:
location.address]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[               
]{.Apple-converted-space}item.]{.s1}[setImage]{.s9}[(]{.s1}[UIImage]{.s11}[(systemName:
]{.s1}[\"mappin.circle.fill\"]{.s10}[))]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}item.handler ]{.s1}[=]{.s9}[
{ \[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[, completion
]{.s1}[in]{.s8}

[[                   
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[showRoutePreview]{.s9}[(to:
location)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[completion]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}items.]{.s1}[append]{.s9}[(item)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ section
]{.s1}[=]{.s9}[ ]{.s1}[CPListSection]{.s11}[(items: items, header:
]{.s1}[\"Saved Places\"]{.s10}[, sectionIndexTitle:
]{.s1}[nil]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ template
]{.s1}[=]{.s9}[ ]{.s1}[CPListTemplate]{.s11}[(title: ]{.s1}[\"Where
to?\"]{.s10}[, sections: \[section\])]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[pushTemplate]{.s9}[(template,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HELPERS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[speak]{.s9}[(]{.s1}[\_]{.s8}[ message: ]{.s1}[String]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ utterance
]{.s1}[=]{.s9}[ ]{.s1}[AVSpeechUtterance]{.s11}[(string: message)]{.s1}

[[        ]{.Apple-converted-space}utterance.voice ]{.s1}[=]{.s9}[
]{.s1}[AVSpeechSynthesisVoice]{.s11}[(language:
]{.s1}[\"en-US\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}utterance.rate ]{.s1}[=]{.s9}[
]{.s1}[0.5]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ synthesizer
]{.s1}[=]{.s9}[ ]{.s1}[AVSpeechSynthesizer]{.s11}[()]{.s1}

[[       
]{.Apple-converted-space}synthesizer.]{.s1}[speak]{.s9}[(utterance)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createWeatherImage]{.s1}[(]{.s6}[\_]{.s8}[ emoji:
]{.s6}[String]{.s11}[) ]{.s6}[-\>]{.s1}[ ]{.s6}[UIImage]{.s11}[?]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ size
]{.s1}[=]{.s9}[ ]{.s1}[CGSize]{.s11}[(width: ]{.s1}[40]{.s11}[, height:
]{.s1}[40]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[UIGraphicsBeginImageContextWithOptions]{.s1}[(size,
]{.s6}[false]{.s1}[, ]{.s6}[0]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[defer]{.s8}[ {
]{.s6}[UIGraphicsEndImageContext]{.s1}[() }]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ paragraphStyle
]{.s1}[=]{.s9}[ ]{.s1}[NSMutableParagraphStyle]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}paragraphStyle.alignment
]{.s1}[=]{.s9}[ .center]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ attrs:
\[]{.s1}[NSAttributedString]{.s11}[.]{.s1}[Key]{.s11}[:
]{.s1}[Any]{.s8}[\] ]{.s1}[=]{.s9}[ \[]{.s1}

[[            ]{.Apple-converted-space}.font:
]{.s1}[UIFont]{.s11}[.]{.s1}[systemFont]{.s9}[(ofSize:
]{.s1}[30]{.s11}[),]{.s1}

[[            ]{.Apple-converted-space}.paragraphStyle:
paragraphStyle]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ string
]{.s1}[=]{.s9}[ ]{.s1}[NSAttributedString]{.s11}[(string: emoji,
attributes: attrs)]{.s1}

[[       
]{.Apple-converted-space}string.]{.s1}[draw]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[CGRect]{.s11}[(origin: ]{.s1}[CGPoint]{.s11}[(x:
]{.s1}[0]{.s11}[, y: ]{.s1}[2]{.s11}[), size: size))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[UIGraphicsGetImageFromCurrentImageContext]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[formatDepartureTime]{.s1}[(]{.s6}[\_]{.s8}[ date:
]{.s6}[Date]{.s11}[) ]{.s6}[-\>]{.s1}[ ]{.s6}[String]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ formatter
]{.s1}[=]{.s9}[ ]{.s1}[DateFormatter]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}formatter.dateFormat ]{.s1}[=]{.s9}[
]{.s1}[\"h:mm a\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ ]{.s1}[\"Leave
at ]{.s10}[\\(formatter.]{.s1}[string]{.s9}[(from:
date))]{.s1}[\"]{.s10}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[showError]{.s9}[(]{.s1}[\_]{.s8}[ error: ]{.s1}[Error]{.s11}[)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alert
]{.s1}[=]{.s9}[ ]{.s1}[CPAlertTemplate]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}titleVariants:
\[]{.s1}[\"Error\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}actions: \[]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[CPAlertAction]{.s11}[(title:
]{.s1}[\"OK\"]{.s10}[, style: .]{.s1}[default]{.s8}[) { ]{.s1}[\_]{.s8}[
]{.s1}[in]{.s8}[ }]{.s1}

[[            ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[       
]{.Apple-converted-space}interfaceController]{.s1}[?]{.s9}[.]{.s1}[presentTemplate]{.s9}[(alert,
animated: ]{.s1}[true]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[getSavedLocations]{.s1}[() ]{.s6}[async]{.s8}[ ]{.s6}[-\>]{.s1}[
\[]{.s6}[Location]{.s11}[\] {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch from local storage
or API*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[getUserLocation]{.s9}[(label:
]{.s6}[Location]{.s1}[.]{.s6}[LocationLabel]{.s1}[) ]{.s6}[async]{.s8}[
]{.s6}[-\>]{.s9}[ ]{.s6}[Location]{.s1}[?]{.s9}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch specific
location*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[App State Management]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CORE/State/AppState.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[AppState]{.s1}[: ]{.s6}[ObservableObject]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SINGLETON*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
shared ]{.s1}[=]{.s9}[ ]{.s1}[AppState]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SERVICES*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ a2aClient
]{.s1}[=]{.s9}[ ]{.s1}[A2AClient]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceService
]{.s1}[=]{.s9}[ ]{.s1}[VoiceService]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ locationService
]{.s1}[=]{.s9}[ ]{.s1}[LocationService]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ notificationService
]{.s1}[=]{.s9}[ ]{.s1}[NotificationService]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// USER STATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ user: ]{.s6}[User]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ isAuthenticated ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ savedLocations: \[]{.s1}[Location]{.s11}[\]
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ preferences: ]{.s6}[UserPreferences]{.s1}[
]{.s6}[=]{.s9}[ .]{.s6}[default]{.s8}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// APP STATE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ isCarPlayConnected ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentLocation:
]{.s6}[CLLocationCoordinate2D]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ activeTrip: ]{.s1}[Trip]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// WEATHER STATE (cached for
quick access)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentWeather: ]{.s6}[WeatherCondition]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ commuteWeather:
]{.s6}[RouteWeatherResult]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// INITIALIZATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
cancellables ]{.s1}[=]{.s9}[
]{.s1}[Set]{.s11}[\<]{.s9}[AnyCancellable]{.s11}[\>]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[
]{.s6}[init]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[setupObservers]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[setupObservers]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// CarPlay connection*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.carPlayDidConnect)]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.isCarPlayConnected
]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.carPlayDidDisconnect)]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.isCarPlayConnected
]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Location updates*]{.s1}

[[       
]{.Apple-converted-space}locationService.\$currentLocation]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[assign]{.s9}[(to:
]{.s1}[&]{.s9}[\$currentLocation)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUTHENTICATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[signIn]{.s9}[(with token: ]{.s1}[String]{.s11}[)
]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
a2aClient.]{.s1}[setAuthToken]{.s9}[(token)]{.s1}

[[       
]{.Apple-converted-space}voiceService.]{.s1}[setAuthToken]{.s9}[(token)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch user data*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// user = try await
a2aClient.getUser()*]{.s1}

[[        ]{.Apple-converted-space}isAuthenticated ]{.s1}[=]{.s9}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Load saved data*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[await]{.s8}[
]{.s6}[loadUserData]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[signOut]{.s9}[() {]{.s1}

[[        ]{.Apple-converted-space}user ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}isAuthenticated ]{.s1}[=]{.s9}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}savedLocations ]{.s1}[=]{.s9}[
\[\]]{.s1}

[[        ]{.Apple-converted-space}preferences ]{.s1}[=]{.s9}[
.]{.s1}[default]{.s8}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DATA LOADING*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[loadUserData]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Load from local storage
first (fast)*]{.s1}

[[        ]{.Apple-converted-space}savedLocations ]{.s1}[=]{.s9}[
]{.s1}[LocalStorage]{.s11}[.]{.s1}[loadLocations]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}preferences ]{.s1}[=]{.s9}[
]{.s1}[LocalStorage]{.s11}[.]{.s1}[loadPreferences]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Then sync with
server*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// savedLocations = try?
await a2aClient.getLocations()*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[refreshCommuteWeather]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
home ]{.s1}[=]{.s9}[
savedLocations.]{.s1}[first]{.s9}[(]{.s1}[where]{.s8}[: { \$0.label
]{.s1}[==]{.s9}[ .home }),]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ work
]{.s1}[=]{.s9}[ savedLocations.]{.s1}[first]{.s9}[(]{.s1}[where]{.s8}[:
{ \$0.label ]{.s1}[==]{.s9}[ .work }) ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}commuteWeather ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
a2aClient.]{.s1}[getRouteWeather]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}origin:
.]{.s1}[savedLocation]{.s9}[(id: home.id.uuidString),]{.s1}

[[                ]{.Apple-converted-space}destination:
.]{.s1}[savedLocation]{.s9}[(id: work.id.uuidString)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to refresh
commute weather: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CORE/State/UserPreferences.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[UserPreferences]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ defaultTransportMode:
]{.s1}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[ ]{.s1}[=]{.s9}[
.car]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ enabledTransportModes:
]{.s1}[Set]{.s11}[\<]{.s9}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[\>]{.s9}[
]{.s1}[=]{.s9}[ \[.car, .bike, .walk, .transit\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ rainTolerance:
]{.s1}[Tolerance]{.s11}[ ]{.s1}[=]{.s9}[ .low]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ tempMinComfortableF:
]{.s1}[Int]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[55]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ tempMaxComfortableF:
]{.s1}[Int]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[85]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ windMaxComfortableMph:
]{.s1}[Int]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[15]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notificationsEnabled:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notifyDepartureWindow:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notifyWeatherChange:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ notifyOpportunities:
]{.s1}[Bool]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ voiceSpeed:
]{.s1}[Double]{.s11}[ ]{.s1}[=]{.s9}[ ]{.s1}[1.0]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ voiceStyle:
]{.s1}[VoiceStyle]{.s11}[ ]{.s1}[=]{.s9}[ .concise]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[Tolerance]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[none]{.s8}[, low, medium, high]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[VoiceStyle]{.s1}[: ]{.s6}[String]{.s1}[, ]{.s6}[Codable]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ concise,
detailed]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[static]{.s1}[ ]{.s6}[let]{.s1}[
\`]{.s6}[default]{.s1}[\` ]{.s6}[=]{.s9}[
]{.s6}[UserPreferences]{.s11}[()]{.s6}

[}]{.s1}

[]{.s1}\

[Main App Entry Point]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// APP/LiquidCryptoApp.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[\@main]{.s1}

[struct]{.s8}[ ]{.s6}[LiquidCryptoApp]{.s1}[: ]{.s6}[App]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[\@StateObject]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ appState ]{.s1}[=]{.s9}[
]{.s1}[AppState]{.s11}[.shared]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[Scene]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[WindowGroup]{.s1}[ {]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[ContentView]{.s11}[()]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[environmentObject]{.s9}[(appState)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// ContentView.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ContentView]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@EnvironmentObject]{.s1}[
]{.s6}[var]{.s8}[ appState: ]{.s6}[AppState]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ selectedTab ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Group]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
appState.isAuthenticated {]{.s1}

[[                ]{.Apple-converted-space}mainTabView]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[OnboardingView]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
mainTabView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[TabView]{.s11}[(selection:
\$selectedTab) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[TodayView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Today\"]{.s10}[,
systemImage: ]{.s1}[\"sun.max.fill\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[0]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[PlanTripView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Plan\"]{.s10}[,
systemImage: ]{.s1}[\"map.fill\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[WeekAheadView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Week\"]{.s10}[,
systemImage: ]{.s1}[\"calendar\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[2]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[InsightsView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Insights\"]{.s10}[,
systemImage: ]{.s1}[\"chart.bar.fill\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[3]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[SettingsView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Label]{.s11}[(]{.s1}[\"Settings\"]{.s10}[,
systemImage: ]{.s1}[\"gear\"]{.s10}[)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[4]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(alignment:
.bottom) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
appState.isCarPlayConnected {]{.s1}

[[                ]{.Apple-converted-space}carPlayIndicator]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
carPlayIndicator: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"car.fill\"]{.s10}[)]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[Text]{.s11}[(]{.s6}[\"CarPlay
Connected\"]{.s1}[)]{.s6}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.horizontal,
]{.s1}[12]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.vertical,
]{.s1}[6]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Material]{.s11}[.regular)]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[Capsule]{.s11}[())]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.bottom,
]{.s1}[60]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Today View (Main Screen)]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// FEATURES/Today/TodayView.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TodayView]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@EnvironmentObject]{.s1}[
]{.s6}[var]{.s8}[ appState: ]{.s6}[AppState]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@StateObject]{.s1}[
]{.s6}[private]{.s8}[ ]{.s6}[var]{.s8}[ viewModel ]{.s6}[=]{.s9}[
]{.s6}[TodayViewModel]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[NavigationStack]{.s1}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[ScrollView]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[20]{.s11}[) {]{.s1}

[[                    ]{.Apple-converted-space}greetingSection]{.s1}

[[                    ]{.Apple-converted-space}currentWeatherCard]{.s1}

[[                    ]{.Apple-converted-space}commutesSection]{.s1}

[[                    ]{.Apple-converted-space}smartSuggestionCard]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[navigationTitle]{.s9}[(]{.s1}[\"Today\"]{.s10}[)]{.s1}

[[            ]{.Apple-converted-space}.toolbar {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[ToolbarItem]{.s11}[(placement:
.navigationBarTrailing) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Button]{.s11}[(action: {
viewModel.showVoice ]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}[ }) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}.refreshable {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[await]{.s8}[
viewModel.]{.s1}[refresh]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[sheet]{.s9}[(isPresented:
\$viewModel.showVoice) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VoiceView]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.task {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
viewModel.]{.s1}[load]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SECTIONS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
greetingSection: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[4]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(viewModel.greeting)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.bold)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ user ]{.s1}[=]{.s9}[ appState.user {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(user.displayName
]{.s1}[??]{.s9}[ ]{.s1}[\"\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
currentWeatherCard: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[GlassCard]{.s11}[(variant:
.tinted, weatherTint: viewModel.currentWeather]{.s1}[?]{.s9}[.condition)
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[16]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ weather ]{.s1}[=]{.s9}[ viewModel.currentWeather
{]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[WeatherIcon]{.s11}[(weather.condition,
size: .hero)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading)
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(]{.s1}[Int]{.s11}[(weather.tempFahrenheit))]{.s1}[°F\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
]{.s1}[48]{.s11}[, weight: .medium))]{.s1}

[[                            ]{.Apple-converted-space}]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(weather.condition.rawValue.capitalized)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                            ]{.Apple-converted-space}]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Feels like
]{.s10}[\\(]{.s1}[Int]{.s11}[(weather.feelsLikeFahrenheit))]{.s1}[°\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Hourly
forecast*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[!]{.s9}[viewModel.hourlyForecast.isEmpty {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[HourlyForecastRow]{.s11}[(forecast:
viewModel.hourlyForecast)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
commutesSection: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[Text]{.s11}[(]{.s6}[\"Your
Commutes\"]{.s1}[)]{.s6}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(viewModel.commutes) {
commute ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[CommuteCard]{.s11}[(commute:
commute)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
smartSuggestionCard: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Group]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ suggestion ]{.s1}[=]{.s9}[ viewModel.smartSuggestion
{]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[GlassCard]{.s11}[
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading,
spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(suggestion.icon)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(suggestion.title)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(suggestion.description)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[GlassButton]{.s11}[(suggestion.actionTitle,
style: .secondary) {]{.s1}

[[                           
]{.Apple-converted-space}viewModel.]{.s1}[handleSuggestionAction]{.s9}[(suggestion)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// FEATURES/Today/TodayViewModel.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[TodayViewModel]{.s1}[:
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentWeather: ]{.s6}[WeatherCondition]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ hourlyForecast: \[]{.s1}[HourlyForecast]{.s11}[\]
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ commutes: \[]{.s1}[CommuteInfo]{.s11}[\]
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ smartSuggestion: ]{.s6}[SmartSuggestion]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ showVoice ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
a2aClient ]{.s1}[=]{.s9}[ ]{.s1}[A2AClient]{.s11}[.shared]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ greeting:
]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hour
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[component]{.s9}[(.hour, from:
]{.s1}[Date]{.s11}[())]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ hour {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[0]{.s11}[..\<]{.s9}[12]{.s11}[: ]{.s6}[return]{.s8}[
]{.s6}[\"Good morning,\"]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[12]{.s11}[..\<]{.s9}[17]{.s11}[: ]{.s6}[return]{.s8}[
]{.s6}[\"Good afternoon,\"]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[default]{.s8}[:
]{.s6}[return]{.s8}[ ]{.s6}[\"Good evening,\"]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[ ]{.s1}[load]{.s9}[()
]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[refresh]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[refresh]{.s9}[() ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch current weather,
commutes, and suggestions in parallel*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[async]{.s8}[ ]{.s1}[let]{.s8}[
weatherTask ]{.s1}[=]{.s9}[ ]{.s1}[fetchCurrentWeather]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[async]{.s8}[ ]{.s1}[let]{.s8}[
commutesTask ]{.s1}[=]{.s9}[ ]{.s1}[fetchCommutes]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[async]{.s8}[ ]{.s1}[let]{.s8}[
suggestionTask ]{.s1}[=]{.s9}[
]{.s1}[fetchSmartSuggestion]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ ]{.s1}[=]{.s9}[
]{.s1}[await]{.s8}[ (weatherTask, commutesTask, suggestionTask)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[fetchCurrentWeather]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[fetchCommutes]{.s9}[() ]{.s6}[async]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[fetchSmartSuggestion]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[handleSuggestionAction]{.s9}[(]{.s1}[\_]{.s8}[ suggestion:
]{.s1}[SmartSuggestion]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Handle action*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteInfo]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destination:
]{.s1}[Location]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSummary:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherIcon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hasAlert:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertMessage:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportOptions:
\[]{.s1}[TransportOption]{.s11}[\]]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportOption]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ mode:
]{.s6}[Route]{.s1}[.]{.s6}[TransportMode]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherSuitability:
]{.s1}[String]{.s11}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[SmartSuggestion]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ title:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ description:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ actionTitle:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ action:
]{.s6}[SuggestionAction]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[SuggestionAction]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
planBikeRoute]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[leaveNow]{.s9}[(destination: ]{.s1}[Location]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[setReminder]{.s9}[(time: ]{.s1}[Date]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[HourlyForecast]{.s1}[: ]{.s6}[Identifiable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ time:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ condition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempF:
]{.s1}[Int]{.s11}

[}]{.s1}

[]{.s1}\

[]{.s1}\

[This completes the comprehensive iOS app technical architecture
covering:]{.s3}

1.  [Database Schema - PostgreSQL tables for users, locations, trips,
    patterns, reminders, and conversations]{.s3}
2.  [A2A Protocol - Agent cards, task lifecycle, inter-agent
    communication, and voice WebSocket protocol]{.s3}
3.  [iOS App Architecture - Project structure, data models, A2A client,
    voice service, design system components, CarPlay integration, and
    state management]{.s3}

[Would you like me to continue with any specific area in more detail,
such as:]{.s3}

- [Widget implementation]{.s3}
- [Watch app integration]{.s3}
- [Push notification handling]{.s3}
- [Onboarding flow implementation]{.s3}
- [Unit and UI testing setup]{.s3}

[let\'s do 1,2 and then 3]{.s7}

[]{.s1}\

[I\'ll continue with the remaining iOS components: Widgets, Watch App,
and Push Notification handling.]{.s3}

[]{.s1}\

[iOS Widgets Implementation]{.s3}

[Widget Bundle Structure]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/WidgetBundle.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WidgetKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[\@main]{.s1}

[struct]{.s8}[ ]{.s6}[LiquidCryptoWidgets]{.s1}[:
]{.s6}[WidgetBundle]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[Widget]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[CommuteWidget]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[WeatherWidget]{.s1}[()]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[QuickActionsWidget]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Lock Screen widgets (iOS
16+)*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[#available]{.s5}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CommuteLockScreenWidget]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Commute Widget]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/CommuteWidget.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WidgetKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[import]{.s8}[ ]{.s6}[Intents]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// TIMELINE PROVIDER*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteProvider]{.s1}[:
]{.s6}[IntentTimelineProvider]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[typealias]{.s8}[
]{.s6}[Entry]{.s1}[ ]{.s6}[=]{.s9}[ ]{.s6}[CommuteEntry]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[typealias]{.s8}[
]{.s6}[Intent]{.s1}[ ]{.s6}[=]{.s9}[ ]{.s6}[SelectCommuteIntent]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[placeholder]{.s9}[(]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[CommuteEntry]{.s11}[
{]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[CommuteEntry]{.s11}[.placeholder]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getSnapshot]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ configuration:
]{.s1}[SelectCommuteIntent]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}completion: ]{.s1}[\@escaping]{.s11}[
(]{.s1}[CommuteEntry]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ context.isPreview
{]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(.placeholder)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ entry
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetchCommuteData]{.s9}[(]{.s1}[for]{.s8}[: configuration)]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(entry)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getTimeline]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ configuration:
]{.s1}[SelectCommuteIntent]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}completion: ]{.s6}[\@escaping]{.s1}[
(]{.s6}[Timeline]{.s1}[\<]{.s9}[CommuteEntry]{.s1}[\>]{.s9}[)
]{.s6}[-\>]{.s9}[ ]{.s6}[Void]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ entry
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetchCommuteData]{.s9}[(]{.s1}[for]{.s8}[: configuration)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Refresh every 15
minutes*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ nextUpdate
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[date]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}byAdding: .minute,]{.s1}

[[                ]{.Apple-converted-space}value:
]{.s1}[15]{.s11}[,]{.s1}

[[                ]{.Apple-converted-space}to:
]{.s1}[Date]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space})]{.s1}[!]{.s9}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ timeline
]{.s1}[=]{.s9}[ ]{.s1}[Timeline]{.s11}[(entries: \[entry\], policy:
.]{.s1}[after]{.s9}[(nextUpdate))]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(timeline)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[fetchCommuteData]{.s9}[(]{.s6}[for]{.s8}[ configuration:
]{.s6}[SelectCommuteIntent]{.s1}[) ]{.s6}[async]{.s8}[ ]{.s6}[-\>]{.s9}[
]{.s6}[CommuteEntry]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Get commute destination
from configuration or default to work*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationId
]{.s1}[=]{.s9}[ configuration.destination]{.s1}[?]{.s9}[.identifier
]{.s1}[??]{.s9}[ ]{.s1}[\"work\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Fetch from shared App
Group container or API*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
]{.s1}[WidgetDataService]{.s11}[.shared.]{.s1}[fetchCommuteWeather]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}destinationId:
destinationId]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[CommuteEntry]{.s11}[(]{.s1}

[[                ]{.Apple-converted-space}date:
]{.s1}[Date]{.s11}[(),]{.s1}

[[                ]{.Apple-converted-space}destinationName:
data.destinationName,]{.s1}

[[                ]{.Apple-converted-space}durationMinutes:
data.durationMinutes,]{.s1}

[[                ]{.Apple-converted-space}currentCondition:
data.currentCondition,]{.s1}

[[                ]{.Apple-converted-space}destinationCondition:
data.destinationCondition,]{.s1}

[[                ]{.Apple-converted-space}weatherTransition:
data.weatherTransition,]{.s1}

[[                ]{.Apple-converted-space}alertMessage:
data.alertMessage,]{.s1}

[[                ]{.Apple-converted-space}hasAlert: data.alertMessage
]{.s1}[!=]{.s9}[ ]{.s1}[nil]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[CommuteEntry]{.s11}[.error]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// ENTRY*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteEntry]{.s1}[: ]{.s6}[TimelineEntry]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ date:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationName:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ currentCondition:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationCondition:
]{.s1}[WeatherCondition]{.s11}[.]{.s1}[WeatherType]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherTransition:
]{.s1}[String]{.s11}[?]{.s9}[ ]{.s1}[*// e.g., \"Rain at 12pm\"*]{.s13}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertMessage:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hasAlert:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ weatherSummary:
]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ currentCondition
]{.s1}[==]{.s9}[ destinationCondition {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[\"]{.s10}[\\(currentCondition.icon)]{.s1}[
]{.s10}[\\(currentCondition.rawValue.capitalized)]{.s1}[\"]{.s10}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[\"]{.s10}[\\(currentCondition.icon)]{.s1}[ →
]{.s10}[\\(destinationCondition.icon)]{.s1}[\"]{.s10}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
placeholder ]{.s1}[=]{.s9}[ ]{.s1}[CommuteEntry]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}date: ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}destinationName:
]{.s1}[\"Work\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}durationMinutes:
]{.s1}[28]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}currentCondition: .clear,]{.s1}

[[        ]{.Apple-converted-space}destinationCondition: .rain,]{.s1}

[[        ]{.Apple-converted-space}weatherTransition: ]{.s1}[\"Rain at
12pm\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}alertMessage: ]{.s6}[\"Leave by 11:45
to stay dry\"]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}hasAlert: ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
error ]{.s1}[=]{.s9}[ ]{.s1}[CommuteEntry]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}date: ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}destinationName:
]{.s1}[\"---\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}durationMinutes:
]{.s1}[0]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}currentCondition: .unknown,]{.s1}

[[        ]{.Apple-converted-space}destinationCondition: .unknown,]{.s1}

[[        ]{.Apple-converted-space}weatherTransition:
]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}alertMessage: ]{.s1}[\"Unable to
load\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}hasAlert: ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space})]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// WIDGET VIEW*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteWidgetEntryView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[   
]{.Apple-converted-space}]{.s1}[\@Environment]{.s11}[(\\.widgetFamily)
]{.s1}[var]{.s8}[ family]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ entry:
]{.s1}[CommuteEntry]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ family {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.systemSmall:]{.s1}

[[            ]{.Apple-converted-space}smallView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.systemMedium:]{.s1}

[[            ]{.Apple-converted-space}mediumView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.systemLarge:]{.s1}

[[            ]{.Apple-converted-space}largeView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}smallView]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SMALL (2x2)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
smallView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[8]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"car.fill\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Commute\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationName)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherSummary)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[ entry.hasAlert
{]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.circle.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Alert\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[widgetBackground]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// MEDIUM (4x2)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
mediumView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[16]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Left side - main
info*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[8]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"car.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Commute\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationName)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"•\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherSummary)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ entry.alertMessage {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.circle.fill\"]{.s10}[)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.primary)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Right side - weather
timeline*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.currentCondition.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Rectangle]{.s11}[()]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(weatherGradient)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(width: ]{.s1}[4]{.s11}[,
height: ]{.s1}[40]{.s11}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[2]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationCondition.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ transition ]{.s1}[=]{.s9}[ entry.weatherTransition
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(transition)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[widgetBackground]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// LARGE (4x4)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
largeView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[16]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[*// Header*]{.s13}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .leading)
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Travel
Weather\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(\"]{.s1}[Updated]{.s11}[
\\(entry.date.]{.s1}[formatted]{.s9}[(.]{.s1}[relative]{.s9}[(presentation:
.named)))\")]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.currentCondition.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.largeTitle)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Divider]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Commute details*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"building.2.fill\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.destinationName)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Weather
timeline*]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(]{.s1}[0]{.s11}[..\<]{.s9}[5]{.s11}[)
{ i ]{.s1}[in]{.s8}

[[                       
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(\[]{.s1}[\"Now\"]{.s10}[,
]{.s1}[\"+10m\"]{.s10}[, ]{.s1}[\"+20m\"]{.s10}[,
]{.s1}[\"+30m\"]{.s10}[, ]{.s1}[\"Arrive\"]{.s10}[\]\[i\])]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                            ]{.Apple-converted-space}]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(i ]{.s1}[\<]{.s9}[
]{.s1}[3]{.s11}[ ]{.s1}[?]{.s9}[ entry.currentCondition.icon :
entry.destinationCondition.icon)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[frame]{.s9}[(maxWidth: .infinity)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(.vertical,
]{.s1}[8]{.s11}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.secondary.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[))]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Alert section*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ entry.alertMessage {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.triangle.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.subheadline)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.orange.]{.s1}[opacity]{.s9}[(]{.s1}[0.15]{.s11}[))]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Suggestion*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"lightbulb.fill\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.yellow)]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[Text]{.s11}[(]{.s6}[\"Tap to see
departure options\"]{.s1}[)]{.s6}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[widgetBackground]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
weatherGradient: ]{.s1}[LinearGradient]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[LinearGradient]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}colors: \[]{.s1}

[[               
]{.Apple-converted-space}entry.currentCondition.color,]{.s1}

[[               
]{.Apple-converted-space}entry.destinationCondition.color]{.s1}

[[            ]{.Apple-converted-space}\],]{.s1}

[[            ]{.Apple-converted-space}startPoint: .top,]{.s1}

[[            ]{.Apple-converted-space}endPoint: .bottom]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// WIDGET DEFINITION*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteWidget]{.s1}[: ]{.s6}[Widget]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ kind:
]{.s6}[String]{.s11}[ ]{.s6}[=]{.s9}[ ]{.s6}[\"CommuteWidget\"]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ body:
]{.s6}[some]{.s8}[ ]{.s6}[WidgetConfiguration]{.s1}[ {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[IntentConfiguration]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}kind: kind,]{.s1}

[[            ]{.Apple-converted-space}intent:
]{.s1}[SelectCommuteIntent]{.s11}[.]{.s1}[self]{.s8}[,]{.s1}

[[            ]{.Apple-converted-space}provider:
]{.s1}[CommuteProvider]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}) { entry ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[CommuteWidgetEntryView]{.s11}[(entry:
entry)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[configurationDisplayName]{.s1}[(]{.s6}[\"Commute
Weather\"]{.s10}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s6}[description]{.s9}[(]{.s6}[\"See weather
conditions for your commute.\"]{.s1}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s1}[supportedFamilies]{.s9}[(\[.systemSmall,
.systemMedium, .systemLarge\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// HELPER EXTENSION*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[extension]{.s1}[ ]{.s6}[View]{.s11}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[widgetBackground]{.s1}[() ]{.s6}[-\>]{.s1}[ ]{.s6}[some]{.s8}[
]{.s6}[View]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[#available]{.s5}[(iOSApplicationExtension ]{.s1}[17.0]{.s11}[,
]{.s1}[\*]{.s9}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[self]{.s8}[.]{.s1}[containerBackground]{.s9}[(]{.s1}[for]{.s8}[:
.widget) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Color]{.s11}[(.systemBackground)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[self]{.s8}[.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[(.systemBackground))]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Lock Screen Widget]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/CommuteLockScreenWidget.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WidgetKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[\@available]{.s11}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[)]{.s1}

[struct]{.s8}[ ]{.s6}[CommuteLockScreenWidget]{.s1}[:
]{.s6}[Widget]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ kind:
]{.s6}[String]{.s11}[ ]{.s6}[=]{.s9}[
]{.s6}[\"CommuteLockScreenWidget\"]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ body:
]{.s6}[some]{.s8}[ ]{.s6}[WidgetConfiguration]{.s1}[ {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[StaticConfiguration]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}kind: kind,]{.s1}

[[            ]{.Apple-converted-space}provider:
]{.s6}[CommuteLockScreenProvider]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}) { entry ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[CommuteLockScreenView]{.s11}[(entry:
entry)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[configurationDisplayName]{.s1}[(]{.s6}[\"Commute\"]{.s10}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s6}[description]{.s9}[(]{.s6}[\"Quick
commute weather at a glance.\"]{.s1}[)]{.s6}

[[       
]{.Apple-converted-space}.]{.s6}[supportedFamilies]{.s1}[(\[]{.s6}

[[            ]{.Apple-converted-space}.accessoryInline,]{.s1}

[[            ]{.Apple-converted-space}.accessoryCircular,]{.s1}

[[            ]{.Apple-converted-space}.accessoryRectangular]{.s1}

[[        ]{.Apple-converted-space}\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// PROVIDER*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[\@available]{.s11}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[)]{.s1}

[struct]{.s8}[ ]{.s6}[CommuteLockScreenProvider]{.s1}[:
]{.s6}[TimelineProvider]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[typealias]{.s8}[
]{.s6}[Entry]{.s1}[ ]{.s6}[=]{.s9}[ ]{.s6}[CommuteLockScreenEntry]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[placeholder]{.s9}[(]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Entry]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}.placeholder]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[getSnapshot]{.s9}[(]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[, completion: ]{.s1}[\@escaping]{.s11}[
(]{.s1}[Entry]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}[) {]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(.placeholder)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[getTimeline]{.s9}[(]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[, completion: ]{.s1}[\@escaping]{.s11}[
(]{.s1}[Timeline]{.s11}[\<]{.s9}[Entry]{.s11}[\>]{.s9}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[WidgetDataService]{.s11}[.shared.]{.s1}[fetchCommuteWeather]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}destinationId:
]{.s1}[\"work\"]{.s10}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[let]{.s8}[ entry
]{.s6}[=]{.s9}[ ]{.s6}[CommuteLockScreenEntry]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}date:
]{.s1}[Date]{.s11}[(),]{.s1}

[[                ]{.Apple-converted-space}durationMinutes:
data]{.s1}[?]{.s9}[.durationMinutes ]{.s1}[??]{.s9}[
]{.s1}[0]{.s11}[,]{.s1}

[[                ]{.Apple-converted-space}weatherIcon:
data]{.s1}[?]{.s9}[.currentCondition.icon ]{.s1}[??]{.s9}[
]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}weatherTo:
data]{.s1}[?]{.s9}[.destinationCondition.icon ]{.s1}[??]{.s9}[
]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}alertText:
data]{.s1}[?]{.s9}[.alertMessage]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ nextUpdate
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[date]{.s9}[(byAdding: .minute,
value: ]{.s1}[15]{.s11}[, to: ]{.s1}[Date]{.s11}[())]{.s1}[!]{.s9}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ timeline
]{.s1}[=]{.s9}[ ]{.s1}[Timeline]{.s11}[(entries: \[entry\], policy:
.]{.s1}[after]{.s9}[(nextUpdate))]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(timeline)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[\@available]{.s11}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[)]{.s1}

[struct]{.s8}[ ]{.s6}[CommuteLockScreenEntry]{.s1}[:
]{.s6}[TimelineEntry]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ date:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherIcon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherTo:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertText:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[static]{.s8}[ ]{.s6}[let]{.s8}[
placeholder ]{.s6}[=]{.s9}[ ]{.s6}[CommuteLockScreenEntry]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}date: ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}durationMinutes:
]{.s1}[28]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}weatherIcon:
]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}weatherTo:
]{.s1}[\"]{.s10}[🌧️]{.s19}[\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}alertText: ]{.s1}[\"Rain at
12pm\"]{.s10}

[[    ]{.Apple-converted-space})]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// VIEWS*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[\@available]{.s11}[(iOSApplicationExtension ]{.s1}[16.0]{.s11}[,
]{.s1}[\*]{.s9}[)]{.s1}

[struct]{.s8}[ ]{.s6}[CommuteLockScreenView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[   
]{.Apple-converted-space}]{.s1}[\@Environment]{.s11}[(\\.widgetFamily)
]{.s1}[var]{.s8}[ family]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ entry:
]{.s6}[CommuteLockScreenEntry]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ family {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.accessoryInline:]{.s1}

[[            ]{.Apple-converted-space}inlineView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.accessoryCircular:]{.s1}

[[            ]{.Apple-converted-space}circularView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.accessoryRectangular:]{.s1}

[[            ]{.Apple-converted-space}rectangularView]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[EmptyView]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Inline:
\"*]{.s1}[☀️]{.s12}[*→*]{.s15}[🌧️]{.s12}[ *Rain 12pm • 28m\"*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
inlineView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.weatherIcon)]{.s1}[→]{.s10}[\\(entry.weatherTo)]{.s1}[\"]{.s10}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ entry.alertText {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"•\"]{.s10}[)]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[m\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Circular: Weather icon with
duration*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
circularView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[ZStack]{.s11}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[AccessoryWidgetBackground]{.s1}[()]{.s6}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[2]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherIcon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[m\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Rectangular: More
detail*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
rectangularView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[4]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherIcon)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"→\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(entry.weatherTo)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ entry.alertText {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(entry.durationMinutes)]{.s1}[\"]{.s10}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.bold)]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"min\"]{.s10}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Widget Data Service]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWIDGETS/Services/WidgetDataService.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[]{.s1}\

[actor]{.s8}[ ]{.s6}[WidgetDataService]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[static]{.s8}[ ]{.s6}[let]{.s8}[
shared ]{.s6}[=]{.s9}[ ]{.s6}[WidgetDataService]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[let]{.s8}[
appGroupId ]{.s6}[=]{.s9}[ ]{.s6}[\"group.com.liquidcrypto.app\"]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[let]{.s8}[
cacheKey ]{.s6}[=]{.s9}[ ]{.s6}[\"widget_commute_data\"]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[struct]{.s8}[
]{.s6}[CommuteWidgetData]{.s1}[: ]{.s6}[Codable]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationName:
]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ currentCondition:
]{.s1}[WeatherCondition]{.s11}[.]{.s1}[WeatherType]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[
destinationCondition:
]{.s1}[WeatherCondition]{.s11}[.]{.s1}[WeatherType]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherTransition:
]{.s1}[String]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertMessage:
]{.s1}[String]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ fetchedAt:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// FETCH DATA*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[fetchCommuteWeather]{.s9}[(destinationId: ]{.s1}[String]{.s11}[)
]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[ ]{.s1}[-\>]{.s9}[
]{.s1}[CommuteWidgetData]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// First, try to get cached
data from App Group*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
cached ]{.s1}[=]{.s9}[
]{.s1}[getCachedData]{.s9}[(),[ ]{.Apple-converted-space}]{.s1}

[[          
]{.Apple-converted-space}]{.s1}[Date]{.s11}[().]{.s1}[timeIntervalSince]{.s9}[(cached.fetchedAt)
]{.s1}[\<]{.s9}[ ]{.s1}[300]{.s11}[ { ]{.s1}[*// 5 min cache*]{.s13}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ cached]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Fetch fresh data*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
]{.s1}[fetchFromAPI]{.s9}[(destinationId: destinationId)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Cache it*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[cacheData]{.s9}[(data)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ data]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[fetchFromAPI]{.s9}[(destinationId: ]{.s1}[String]{.s11}[)
]{.s1}[async]{.s8}[ ]{.s1}[throws]{.s8}[ ]{.s1}[-\>]{.s9}[
]{.s1}[CommuteWidgetData]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// In production, this would
call your A2A API*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// For now, we use shared
keychain/UserDefaults from App Group*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
containerURL ]{.s1}[=]{.s9}[
]{.s1}[FileManager]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[containerURL]{.s9}[(]{.s1}

[[           
]{.Apple-converted-space}forSecurityApplicationGroupIdentifier:
appGroupId]{.s1}

[[        ]{.Apple-converted-space}) ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[throw]{.s8}[
]{.s1}[WidgetError]{.s11}[.appGroupNotAvailable]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Read auth token from
shared keychain*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ token
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
]{.s1}[getSharedAuthToken]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Make API call*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[var]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[URLRequest]{.s11}[(url: ]{.s6}[URL]{.s9}[(string:
]{.s6}[\"https://api.liquidcrypto.app/v1/widget/commute\"]{.s1}[)]{.s6}[!]{.s9}[)]{.s6}

[[       
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(token)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[       
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(destinationId,
forHTTPHeaderField: ]{.s1}[\"X-Destination-ID\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ (data,
]{.s1}[\_]{.s8}[) ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
]{.s1}[URLSession]{.s11}[.shared.]{.s1}[data]{.s9}[(]{.s1}[for]{.s8}[:
request)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ decoder
]{.s1}[=]{.s9}[ ]{.s1}[JSONDecoder]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}decoder.dateDecodingStrategy
]{.s1}[=]{.s9}[ .iso8601]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[
decoder.]{.s1}[decode]{.s9}[(]{.s1}[CommuteWidgetData]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// CACHING*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[getCachedData]{.s9}[() ]{.s6}[-\>]{.s9}[
]{.s6}[CommuteWidgetData]{.s1}[?]{.s9}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
defaults ]{.s1}[=]{.s9}[ ]{.s1}[UserDefaults]{.s11}[(suiteName:
appGroupId),]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ defaults.]{.s1}[data]{.s9}[(forKey: cacheKey)
]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[CommuteWidgetData]{.s11}[.]{.s1}[self]{.s8}[,
from: data)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[cacheData]{.s9}[(]{.s1}[\_]{.s8}[ data:
]{.s1}[CommuteWidgetData]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
defaults ]{.s1}[=]{.s9}[ ]{.s1}[UserDefaults]{.s11}[(suiteName:
appGroupId),]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ encoded
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONEncoder]{.s11}[().]{.s1}[encode]{.s9}[(data)
]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}defaults.]{.s1}[set]{.s8}[(encoded,
forKey: cacheKey)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[getSharedAuthToken]{.s1}[() ]{.s6}[throws]{.s8}[
]{.s6}[-\>]{.s1}[ ]{.s6}[String]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Read from shared
Keychain*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ query:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\] ]{.s1}[=]{.s9}[ \[]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[kSecClass]{.s1}[
]{.s6}[as]{.s8}[ ]{.s6}[String]{.s1}[:
]{.s6}[kSecClassGenericPassword]{.s1}[,]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[kSecAttrAccount]{.s1}[
]{.s6}[as]{.s8}[ ]{.s6}[String]{.s1}[:
]{.s6}[\"auth_token\"]{.s10}[,]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[kSecAttrAccessGroup]{.s11}[
]{.s1}[as]{.s8}[ ]{.s1}[String]{.s11}[: appGroupId,]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[kSecReturnData]{.s1}[
]{.s6}[as]{.s8}[ ]{.s6}[String]{.s1}[: ]{.s6}[true]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ result:
]{.s1}[AnyObject]{.s11}[?]{.s9}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ status
]{.s1}[=]{.s9}[ ]{.s1}[SecItemCopyMatching]{.s11}[(query
]{.s1}[as]{.s8}[ ]{.s1}[CFDictionary]{.s11}[,
]{.s1}[&]{.s9}[result)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ status
]{.s1}[==]{.s9}[ errSecSuccess,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ data
]{.s1}[=]{.s9}[ result ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[Data]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ token
]{.s1}[=]{.s9}[ ]{.s1}[String]{.s11}[(data: data, encoding: .utf8)
]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[throw]{.s8}[
]{.s1}[WidgetError]{.s11}[.authTokenNotFound]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[ token]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[WidgetError]{.s1}[: ]{.s6}[Error]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
appGroupNotAvailable]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
authTokenNotFound]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ networkError]{.s1}

[}]{.s1}

[]{.s1}\

[]{.s1}\

[Apple Watch App]{.s3}

[Watch App Structure]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWATCH/LiquidCryptoWatchApp.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[import]{.s8}[ ]{.s6}[WatchKit]{.s1}

[]{.s1}\

[\@main]{.s1}

[struct]{.s8}[ ]{.s6}[LiquidCryptoWatch]{.s1}[: ]{.s6}[App]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@StateObject]{.s1}[
]{.s6}[private]{.s8}[ ]{.s6}[var]{.s8}[ appState ]{.s6}[=]{.s9}[
]{.s6}[WatchAppState]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[Scene]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[WindowGroup]{.s1}[ {]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[NavigationStack]{.s1}[
{]{.s6}

[[               
]{.Apple-converted-space}]{.s1}[CommuteGlanceView]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[environmentObject]{.s9}[(appState)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[WKNotificationScene]{.s1}[(controller:
]{.s6}[NotificationController]{.s1}[.]{.s6}[self]{.s8}[, category:
]{.s6}[\"COMMUTE_ALERT\"]{.s10}[)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWATCH/State/WatchAppState.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[WatchConnectivity]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[WatchAppState]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ currentWeather: ]{.s6}[WatchWeatherData]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[\@Published]{.s1}[
]{.s6}[var]{.s8}[ commuteData: ]{.s6}[WatchCommuteData]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ isLoading ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ errorMessage: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
wcSession: ]{.s1}[WCSession]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[override]{.s1}[
]{.s6}[init]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}]{.s1}[super]{.s8}[.]{.s1}[init]{.s8}[()]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[setupWatchConnectivity]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[setupWatchConnectivity]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[WCSession]{.s11}[.]{.s1}[isSupported]{.s9}[() {]{.s1}

[[            ]{.Apple-converted-space}wcSession ]{.s1}[=]{.s9}[
]{.s1}[WCSession]{.s11}[.]{.s1}[default]{.s8}

[[            ]{.Apple-converted-space}wcSession]{.s1}[?]{.s9}[.delegate
]{.s1}[=]{.s9}[ ]{.s1}[self]{.s8}

[[           
]{.Apple-converted-space}wcSession]{.s1}[?]{.s9}[.]{.s1}[activate]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[refresh]{.s9}[() ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}isLoading ]{.s1}[=]{.s9}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[defer]{.s8}[ { isLoading
]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Request data from
iPhone*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
session ]{.s1}[=]{.s9}[ wcSession, session.isReachable
]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Try to load cached
data*]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[loadCachedData]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}session.]{.s1}[sendMessage]{.s9}[(]{.s1}

[[            ]{.Apple-converted-space}\[]{.s6}[\"request\"]{.s1}[:
]{.s6}[\"commute_data\"]{.s1}[\],]{.s6}

[[            ]{.Apple-converted-space}replyHandler: {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] response ]{.s1}[in]{.s8}

[[                ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[\@MainActor]{.s11}[ ]{.s1}[in]{.s8}

[[                   
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[handleResponse]{.s9}[(response)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}},]{.s1}

[[            ]{.Apple-converted-space}errorHandler: {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] error ]{.s1}[in]{.s8}

[[                ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[\@MainActor]{.s11}[ ]{.s1}[in]{.s8}

[[                   
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.errorMessage
]{.s1}[=]{.s9}[ error.localizedDescription]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[handleResponse]{.s9}[(]{.s1}[\_]{.s8}[ response:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\]) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
weatherDict ]{.s1}[=]{.s9}[ response\[]{.s1}[\"weather\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ \[]{.s1}[String]{.s11}[:
]{.s1}[Any]{.s8}[\],]{.s1}

[[           ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weather
]{.s1}[=]{.s9}[ ]{.s1}[WatchWeatherData]{.s11}[(from: weatherDict)
{]{.s1}

[[            ]{.Apple-converted-space}currentWeather ]{.s1}[=]{.s9}[
weather]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
commuteDict ]{.s1}[=]{.s9}[ response\[]{.s1}[\"commute\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ \[]{.s1}[String]{.s11}[:
]{.s1}[Any]{.s8}[\],]{.s1}

[[           ]{.Apple-converted-space}]{.s1}[let]{.s8}[ commute
]{.s1}[=]{.s9}[ ]{.s1}[WatchCommuteData]{.s11}[(from: commuteDict)
{]{.s1}

[[            ]{.Apple-converted-space}commuteData ]{.s1}[=]{.s9}[
commute]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[cacheCommuteData]{.s9}[(commute)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[loadCachedData]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
data ]{.s1}[=]{.s9}[
]{.s1}[UserDefaults]{.s11}[.standard.]{.s1}[data]{.s9}[(forKey:
]{.s1}[\"cached_commute\"]{.s10}[),]{.s1}

[[           ]{.Apple-converted-space}]{.s1}[let]{.s8}[ commute
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[WatchCommuteData]{.s11}[.]{.s1}[self]{.s8}[,
from: data) {]{.s1}

[[            ]{.Apple-converted-space}commuteData ]{.s1}[=]{.s9}[
commute]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[cacheCommuteData]{.s9}[(]{.s1}[\_]{.s8}[ commute:
]{.s1}[WatchCommuteData]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
data ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONEncoder]{.s11}[().]{.s1}[encode]{.s9}[(commute) {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[UserDefaults]{.s11}[.standard.]{.s1}[set]{.s8}[(data,
forKey: ]{.s1}[\"cached_commute\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[WatchAppState]{.s1}[:
]{.s6}[WCSessionDelegate]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[nonisolated]{.s1}[
]{.s6}[func]{.s1}[ ]{.s6}[session]{.s9}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ session:
]{.s1}[WCSession]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}activationDidCompleteWith
activationState: ]{.s1}[WCSessionActivationState]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}error: ]{.s1}[Error]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ activationState
]{.s1}[==]{.s9}[ .activated {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[\@MainActor]{.s11}[ ]{.s1}[in]{.s8}

[[                ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[refresh]{.s9}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[nonisolated]{.s1}[
]{.s6}[func]{.s1}[ ]{.s6}[session]{.s9}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ session:
]{.s1}[WCSession]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didReceiveApplicationContext
applicationContext: \[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\]]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[Task]{.s1}[ {
]{.s6}[\@MainActor]{.s1}[ ]{.s6}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[handleResponse]{.s9}[(applicationContext)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[nonisolated]{.s1}[
]{.s6}[func]{.s1}[ ]{.s6}[session]{.s9}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ session:
]{.s1}[WCSession]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didReceiveUserInfo userInfo:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\]]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[Task]{.s1}[ {
]{.s6}[\@MainActor]{.s1}[ ]{.s6}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[handleResponse]{.s9}[(userInfo)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Watch Data Models]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWATCH/Models/WatchModels.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[Foundation]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WatchWeatherData]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ condition:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempF:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[?]{.s9}[(from dict:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\]) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
condition ]{.s1}[=]{.s9}[ dict\[]{.s1}[\"condition\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tempF
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"tempF\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[Int]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"icon\"]{.s10}[\] ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[String]{.s11}[ ]{.s1}[else]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.condition
]{.s1}[=]{.s9}[ condition]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.tempF
]{.s1}[=]{.s9}[ tempF]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.icon
]{.s1}[=]{.s9}[ icon]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WatchCommuteData]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationName:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherNow:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherDestination:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alertMessage:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[
departureRecommendation: ]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ transportOptions:
\[]{.s1}[WatchTransportOption]{.s11}[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ lastUpdated:
]{.s1}[Date]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[?]{.s9}[(from dict:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\]) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
name ]{.s1}[=]{.s9}[ dict\[]{.s1}[\"destinationName\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ duration
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"durationMinutes\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[Int]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ now
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"weatherNow\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ dest
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"weatherDestination\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ ]{.s1}[else]{.s8}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.destinationName
]{.s1}[=]{.s9}[ name]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.durationMinutes
]{.s1}[=]{.s9}[ duration]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.weatherNow
]{.s1}[=]{.s9}[ now]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.weatherDestination
]{.s1}[=]{.s9}[ dest]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.alertMessage
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"alertMessage\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}

[[       
]{.Apple-converted-space}]{.s1}[self]{.s8}[.departureRecommendation
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"departureRecommendation\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.lastUpdated
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
optionsArray ]{.s1}[=]{.s9}[ dict\[]{.s1}[\"transportOptions\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ \[\[]{.s1}[String]{.s11}[:
]{.s1}[Any]{.s8}[\]\] {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[self]{.s8}[.transportOptions
]{.s1}[=]{.s9}[ optionsArray.compactMap {
]{.s1}[WatchTransportOption]{.s11}[(from: \$0) }]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[self]{.s8}[.transportOptions
]{.s1}[=]{.s9}[ \[\]]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[WatchTransportOption]{.s1}[:
]{.s6}[Codable]{.s1}[, ]{.s6}[Identifiable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ id ]{.s1}[=]{.s9}[
]{.s1}[UUID]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ mode:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherNote:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[?]{.s9}[(from dict:
\[]{.s1}[String]{.s11}[: ]{.s1}[Any]{.s8}[\]) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
mode ]{.s1}[=]{.s9}[ dict\[]{.s1}[\"mode\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ icon
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"icon\"]{.s10}[\] ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[String]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ duration
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"durationMinutes\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[Int]{.s11}[,]{.s1}

[[              ]{.Apple-converted-space}]{.s1}[let]{.s8}[ note
]{.s1}[=]{.s9}[ dict\[]{.s1}[\"weatherNote\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ ]{.s1}[else]{.s8}[
{]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.mode
]{.s1}[=]{.s9}[ mode]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.icon
]{.s1}[=]{.s9}[ icon]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.durationMinutes
]{.s1}[=]{.s9}[ duration]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[self]{.s8}[.weatherNote
]{.s1}[=]{.s9}[ note]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Watch Views]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWATCH/Views/CommuteGlanceView.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[CommuteGlanceView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@EnvironmentObject]{.s1}[
]{.s6}[var]{.s8}[ appState: ]{.s6}[WatchAppState]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[ScrollView]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[16]{.s11}[) {]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[*// Current
weather*]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ weather ]{.s1}[=]{.s9}[ appState.currentWeather
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[currentWeatherSection]{.s9}[(weather)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[*// Commute
info*]{.s13}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ commute ]{.s1}[=]{.s9}[ appState.commuteData {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[commuteSection]{.s9}[(commute)]{.s1}

[[                ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[
]{.s1}[if]{.s8}[ appState.isLoading {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[ProgressView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Pull to
refresh\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[navigationTitle]{.s1}[(]{.s6}[\"Commute\"]{.s10}[)]{.s6}

[[        ]{.Apple-converted-space}.refreshable {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
appState.]{.s1}[refresh]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.onAppear {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[await]{.s8}[ appState.]{.s1}[refresh]{.s9}[() }]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[currentWeatherSection]{.s9}[(]{.s1}[\_]{.s8}[ weather:
]{.s1}[WatchWeatherData]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[some]{.s8}[
]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(weather.icon)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(weather.tempF)]{.s1}[°\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(weather.condition)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.secondary.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[))]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[cornerRadius]{.s1}[(]{.s6}[12]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[commuteSection]{.s9}[(]{.s1}[\_]{.s8}[ commute:
]{.s1}[WatchCommuteData]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[some]{.s8}[
]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[12]{.s11}[) {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Destination
header*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"To:
]{.s10}[\\(commute.destinationName)]{.s1}[\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Weather
timeline*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[8]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(commute.weatherNow)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"arrow.right\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(commute.weatherDestination)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment: .trailing)
{]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(commute.durationMinutes)]{.s1}[\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.bold)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"min\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[*// Alert*]{.s13}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ alert ]{.s1}[=]{.s9}[ commute.alertMessage {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.triangle.fill\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(alert)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.orange.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[))]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Recommendation*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ recommendation ]{.s1}[=]{.s9}[
commute.departureRecommendation {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(recommendation)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Transport
options*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[!]{.s9}[commute.transportOptions.isEmpty {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Divider]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[ForEach]{.s11}[(commute.transportOptions)
{ option ]{.s1}[in]{.s8}

[[                   
]{.Apple-converted-space}]{.s1}[NavigationLink]{.s11}[(destination:
]{.s1}[TransportDetailView]{.s11}[(option: option)) {]{.s1}

[[                        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[
{]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(option.icon)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(option.mode)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[                           
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(option.durationMinutes)]{.s1}[
min\"]{.s10}[)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                               
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                        ]{.Apple-converted-space}}]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.secondary.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[))]{.s1}

[[       
]{.Apple-converted-space}.]{.s6}[cornerRadius]{.s1}[(]{.s6}[12]{.s11}[)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWATCH/Views/TransportDetailView.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[TransportDetailView]{.s1}[: ]{.s6}[View]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ option:
]{.s6}[WatchTransportOption]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[ScrollView]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[16]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(option.icon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
]{.s1}[60]{.s11}[))]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(option.mode.capitalized)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title3)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.semibold)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[
{]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(option.durationMinutes)]{.s1}[\"]{.s10}[)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.bold)]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"minutes\"]{.s10}[)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(option.weatherNote)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[multilineTextAlignment]{.s9}[(.center)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(]{.s1}[Color]{.s11}[.secondary.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[))]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[cornerRadius]{.s9}[(]{.s1}[8]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Button]{.s11}[(]{.s1}[\"Start
Navigation\"]{.s10}[) {]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[*// Open on
iPhone*]{.s13}

[[                   
]{.Apple-converted-space}]{.s1}[startNavigation]{.s9}[()]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[buttonStyle]{.s9}[(.borderedProminent)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[padding]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[       
]{.Apple-converted-space}.]{.s1}[navigationTitle]{.s9}[(option.mode.capitalized)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[startNavigation]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Send message to iPhone to
start navigation*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[WCSession]{.s11}[.]{.s1}[default]{.s8}[.isReachable {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[WCSession]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[sendMessage]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}\[]{.s1}[\"action\"]{.s10}[:
]{.s1}[\"start_navigation\"]{.s10}[, ]{.s1}[\"mode\"]{.s10}[:
option.mode\],]{.s1}

[[                ]{.Apple-converted-space}replyHandler:
]{.s1}[nil]{.s11}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Watch Complications]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// LIQUIDCRYPTOWATCH/Complications/CommuteComplication.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[ClockKit]{.s1}

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[]{.s1}\

[class]{.s8}[ ]{.s6}[ComplicationController]{.s1}[:
]{.s6}[NSObject]{.s1}[, ]{.s6}[CLKComplicationDataSource]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SUPPORTED FAMILIES*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getComplicationDescriptors]{.s9}[(handler:
]{.s6}[\@escaping]{.s1}[ (\[]{.s6}[CLKComplicationDescriptor]{.s1}[\])
]{.s6}[-\>]{.s9}[ ]{.s6}[Void]{.s1}[) {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ descriptors
]{.s1}[=]{.s9}[ \[]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[CLKComplicationDescriptor]{.s1}[(]{.s6}

[[                ]{.Apple-converted-space}identifier:
]{.s1}[\"commuteWeather\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}displayName: ]{.s1}[\"Commute
Weather\"]{.s10}[,]{.s1}

[[                ]{.Apple-converted-space}supportedFamilies: \[]{.s1}

[[                    ]{.Apple-converted-space}.modularSmall,]{.s1}

[[                    ]{.Apple-converted-space}.modularLarge,]{.s1}

[[                    ]{.Apple-converted-space}.utilitarianSmall,]{.s1}

[[                   
]{.Apple-converted-space}.utilitarianSmallFlat,]{.s1}

[[                    ]{.Apple-converted-space}.utilitarianLarge,]{.s1}

[[                    ]{.Apple-converted-space}.circularSmall,]{.s1}

[[                    ]{.Apple-converted-space}.extraLarge,]{.s1}

[[                    ]{.Apple-converted-space}.graphicCorner,]{.s1}

[[                    ]{.Apple-converted-space}.graphicBezel,]{.s1}

[[                    ]{.Apple-converted-space}.graphicCircular,]{.s1}

[[                   
]{.Apple-converted-space}.graphicRectangular,]{.s1}

[[                    ]{.Apple-converted-space}.graphicExtraLarge]{.s1}

[[                ]{.Apple-converted-space}\]]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[handler]{.s9}[(descriptors)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// TIMELINE*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getCurrentTimelineEntry]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ complication:
]{.s1}[CLKComplication]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}withHandler handler:
]{.s6}[\@escaping]{.s1}[
(]{.s6}[CLKComplicationTimelineEntry]{.s1}[?]{.s9}[) ]{.s6}[-\>]{.s9}[
]{.s6}[Void]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ data
]{.s6}[=]{.s1}[ ]{.s6}[loadCachedCommuteData]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ template
]{.s1}[=]{.s9}[ ]{.s1}[createTemplate]{.s9}[(]{.s1}[for]{.s8}[:
complication.family, with: data)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
template ]{.s1}[=]{.s9}[ template {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ entry
]{.s1}[=]{.s9}[ ]{.s1}[CLKComplicationTimelineEntry]{.s11}[(date:
]{.s1}[Date]{.s11}[(), complicationTemplate: template)]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[handler]{.s9}[(entry)]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[handler]{.s9}[(]{.s1}[nil]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getTimelineEndDate]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ complication:
]{.s1}[CLKComplication]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}withHandler handler:
]{.s1}[\@escaping]{.s11}[ (]{.s1}[Date]{.s11}[?]{.s9}[)
]{.s1}[-\>]{.s9}[ ]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Timeline valid for 15
minutes*]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[handler]{.s1}[(]{.s6}[Date]{.s11}[().]{.s6}[addingTimeInterval]{.s1}[(]{.s6}[15]{.s11}[
]{.s6}[\*]{.s1}[ ]{.s6}[60]{.s11}[))]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// TEMPLATES*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createTemplate]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[for]{.s8}[ family:
]{.s6}[CLKComplicationFamily]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}with data:
]{.s1}[ComplicationData]{.s11}

[[    ]{.Apple-converted-space}) ]{.s6}[-\>]{.s9}[
]{.s6}[CLKComplicationTemplate]{.s1}[?]{.s9}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ family {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.graphicCircular:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[createGraphicCircularTemplate]{.s1}[(with: data)]{.s6}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.graphicRectangular:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[createGraphicRectangularTemplate]{.s1}[(with: data)]{.s6}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.graphicCorner:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[createGraphicCornerTemplate]{.s1}[(with: data)]{.s6}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.modularSmall:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[createModularSmallTemplate]{.s1}[(with: data)]{.s6}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.utilitarianSmallFlat:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[createUtilitarianSmallFlatTemplate]{.s1}[(with: data)]{.s6}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createGraphicCircularTemplate]{.s9}[(with data:
]{.s6}[ComplicationData]{.s1}[) ]{.s6}[-\>]{.s9}[
]{.s6}[CLKComplicationTemplate]{.s1}[ {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[CLKComplicationTemplateGraphicCircularView]{.s1}[(]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[ComplicationCircularView]{.s11}[(data:
data)]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createGraphicRectangularTemplate]{.s9}[(with data:
]{.s6}[ComplicationData]{.s1}[) ]{.s6}[-\>]{.s9}[
]{.s6}[CLKComplicationTemplate]{.s1}[ {]{.s6}

[[       
]{.Apple-converted-space}]{.s6}[CLKComplicationTemplateGraphicRectangularFullView]{.s1}[(]{.s6}

[[           
]{.Apple-converted-space}]{.s6}[ComplicationRectangularView]{.s1}[(data:
data)]{.s6}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createGraphicCornerTemplate]{.s9}[(with data:
]{.s6}[ComplicationData]{.s1}[) ]{.s6}[-\>]{.s9}[
]{.s6}[CLKComplicationTemplate]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ textProvider
]{.s1}[=]{.s9}[ ]{.s1}[CLKSimpleTextProvider]{.s11}[(text:
]{.s1}[\"]{.s10}[\\(data.durationMinutes)]{.s1}[m\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ imageProvider
]{.s1}[=]{.s9}[ ]{.s1}[CLKFullColorImageProvider]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}fullColorImage:
]{.s1}[createWeatherImage]{.s9}[(data.weatherIcon)]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[CLKComplicationTemplateGraphicCornerTextImage]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}textProvider: textProvider,]{.s1}

[[            ]{.Apple-converted-space}imageProvider:
imageProvider]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createModularSmallTemplate]{.s9}[(with data:
]{.s6}[ComplicationData]{.s1}[) ]{.s6}[-\>]{.s9}[
]{.s6}[CLKComplicationTemplate]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ line1
]{.s1}[=]{.s9}[ ]{.s1}[CLKSimpleTextProvider]{.s11}[(text:
data.weatherIcon)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ line2
]{.s1}[=]{.s9}[ ]{.s1}[CLKSimpleTextProvider]{.s11}[(text:
]{.s1}[\"]{.s10}[\\(data.durationMinutes)]{.s1}[m\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[CLKComplicationTemplateModularSmallStackText]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}line1TextProvider: line1,]{.s1}

[[            ]{.Apple-converted-space}line2TextProvider: line2]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[createUtilitarianSmallFlatTemplate]{.s9}[(with data:
]{.s6}[ComplicationData]{.s1}[) ]{.s6}[-\>]{.s9}[
]{.s6}[CLKComplicationTemplate]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ text
]{.s1}[=]{.s9}[
]{.s1}[\"]{.s10}[\\(data.weatherIcon)]{.s1}[→]{.s10}[\\(data.destinationWeather)]{.s1}[
]{.s10}[\\(data.durationMinutes)]{.s1}[m\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ textProvider
]{.s1}[=]{.s9}[ ]{.s1}[CLKSimpleTextProvider]{.s11}[(text: text)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[CLKComplicationTemplateUtilitarianSmallFlat]{.s1}[(textProvider:
textProvider)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// DATA*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[loadCachedCommuteData]{.s1}[() ]{.s6}[-\>]{.s1}[
]{.s6}[ComplicationData]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[if]{.s8}[ ]{.s1}[let]{.s8}[
data ]{.s1}[=]{.s9}[
]{.s1}[UserDefaults]{.s11}[.standard.]{.s1}[data]{.s9}[(forKey:
]{.s1}[\"complication_data\"]{.s10}[),]{.s1}

[[           ]{.Apple-converted-space}]{.s1}[let]{.s8}[ decoded
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[JSONDecoder]{.s11}[().]{.s1}[decode]{.s9}[(]{.s1}[ComplicationData]{.s11}[.]{.s1}[self]{.s8}[,
from: data) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
decoded]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
.placeholder]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[createWeatherImage]{.s9}[(]{.s1}[\_]{.s8}[ emoji:
]{.s1}[String]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[UIImage]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ size
]{.s1}[=]{.s9}[ ]{.s1}[CGSize]{.s11}[(width: ]{.s1}[30]{.s11}[, height:
]{.s1}[30]{.s11}[)]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[UIGraphicsBeginImageContextWithOptions]{.s1}[(size,
]{.s6}[false]{.s1}[, ]{.s6}[0]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[defer]{.s8}[ {
]{.s6}[UIGraphicsEndImageContext]{.s1}[() }]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ string
]{.s1}[=]{.s9}[ ]{.s1}[NSAttributedString]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}string: emoji,]{.s1}

[[            ]{.Apple-converted-space}attributes: \[.font:
]{.s1}[UIFont]{.s11}[.]{.s1}[systemFont]{.s9}[(ofSize:
]{.s1}[24]{.s11}[)\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}string.]{.s1}[draw]{.s9}[(at:
]{.s1}[CGPoint]{.s11}[(x: ]{.s1}[3]{.s11}[, y: ]{.s1}[0]{.s11}[))]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[UIGraphicsGetImageFromCurrentImageContext]{.s1}[()
]{.s6}[??]{.s9}[ ]{.s6}[UIImage]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// COMPLICATION VIEWS*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ComplicationData]{.s1}[: ]{.s6}[Codable]{.s1}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherIcon:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ destinationWeather:
]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ durationMinutes:
]{.s1}[Int]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ hasAlert:
]{.s1}[Bool]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
placeholder ]{.s1}[=]{.s9}[ ]{.s1}[ComplicationData]{.s11}[(]{.s1}

[[        ]{.Apple-converted-space}weatherIcon:
]{.s1}[\"]{.s10}[☀️]{.s19}[\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}destinationWeather:
]{.s1}[\"]{.s10}[🌧️]{.s19}[\"]{.s10}[,]{.s1}

[[        ]{.Apple-converted-space}durationMinutes:
]{.s1}[28]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}hasAlert: ]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space})]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ComplicationCircularView]{.s1}[:
]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ data:
]{.s6}[ComplicationData]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[ZStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Circle]{.s11}[()]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[fill]{.s9}[(]{.s1}[Color]{.s11}[.secondary.]{.s1}[opacity]{.s9}[(]{.s1}[0.2]{.s11}[))]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(spacing:
]{.s1}[0]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(data.weatherIcon)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
]{.s1}[18]{.s11}[))]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(data.durationMinutes)]{.s1}[\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.]{.s1}[system]{.s9}[(size:
]{.s1}[14]{.s11}[, weight: .bold))]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ComplicationRectangularView]{.s1}[:
]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ data:
]{.s6}[ComplicationData]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[HStack]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[(alignment:
.leading, spacing: ]{.s1}[2]{.s11}[) {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Commute\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[4]{.s11}[) {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(data.weatherIcon)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"→\"]{.s10}[)]{.s1}

[[                       
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(data.destinationWeather)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.headline)]{.s1}

[[                ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[if]{.s8}[
data.hasAlert {]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[HStack]{.s11}[(spacing:
]{.s1}[2]{.s11}[) {]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Image]{.s11}[(systemName:
]{.s1}[\"exclamationmark.triangle.fill\"]{.s10}[)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                       
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"Weather
alert\"]{.s10}[)]{.s1}

[[                           
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.orange)]{.s1}

[[                    ]{.Apple-converted-space}}]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[Spacer]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[VStack]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"]{.s10}[\\(data.durationMinutes)]{.s1}[\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.title2)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[fontWeight]{.s9}[(.bold)]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[Text]{.s11}[(]{.s1}[\"min\"]{.s10}[)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[font]{.s9}[(.caption2)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[foregroundColor]{.s9}[(.secondary)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[]{.s1}\

[Push Notification Handling]{.s3}

[Notification Service]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// CORE/Services/NotificationService.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[UserNotifications]{.s1}

[import]{.s1}[ ]{.s6}[UIKit]{.s11}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[NotificationService]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[static]{.s8}[ ]{.s6}[let]{.s8}[
shared ]{.s6}[=]{.s9}[ ]{.s6}[NotificationService]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ isAuthorized ]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ pendingNotifications:
\[]{.s1}[UNNotificationRequest]{.s11}[\] ]{.s1}[=]{.s9}[ \[\]]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[let]{.s8}[
center ]{.s6}[=]{.s9}[
]{.s6}[UNUserNotificationCenter]{.s1}[.]{.s6}[current]{.s9}[()]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[override]{.s1}[
]{.s6}[init]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}]{.s1}[super]{.s8}[.]{.s1}[init]{.s8}[()]{.s1}

[[        ]{.Apple-converted-space}center.delegate ]{.s1}[=]{.s9}[
]{.s1}[self]{.s8}

[[       
]{.Apple-converted-space}]{.s6}[checkAuthorizationStatus]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// AUTHORIZATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[requestAuthorization]{.s1}[() ]{.s6}[async]{.s8}[
]{.s6}[-\>]{.s1}[ ]{.s6}[Bool]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ granted
]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
center.]{.s1}[requestAuthorization]{.s9}[(]{.s1}

[[                ]{.Apple-converted-space}options: \[.alert, .sound,
.badge, .criticalAlert, .providesAppNotificationSettings\]]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[MainActor]{.s11}[.run {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[.isAuthorized ]{.s1}[=]{.s9}[
granted]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[ granted {]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[await]{.s8}[
]{.s6}[registerForRemoteNotifications]{.s1}[()]{.s6}

[[               
]{.Apple-converted-space}]{.s6}[registerNotificationCategories]{.s1}[()]{.s6}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
granted]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Notification
authorization failed: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[checkAuthorizationStatus]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}center.getNotificationSettings {
\[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] settings ]{.s1}[in]{.s8}

[[            ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {
]{.s1}[\@MainActor]{.s11}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.isAuthorized
]{.s1}[=]{.s9}[ settings.authorizationStatus ]{.s1}[==]{.s9}[
.authorized]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[registerForRemoteNotifications]{.s1}[() ]{.s6}[async]{.s8}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[await]{.s8}[
]{.s6}[UIApplication]{.s11}[.shared.]{.s6}[registerForRemoteNotifications]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// NOTIFICATION CATEGORIES
(Action Buttons)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[registerNotificationCategories]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Departure Alert
Category*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ navigateAction
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationAction]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"NAVIGATE\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}title: ]{.s1}[\"Start
Navigation\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}options: \[.foreground\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ remindAction
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationAction]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"REMIND_LATER\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}title: ]{.s1}[\"Remind in 10
min\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}options: \[\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ dismissAction
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationAction]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"DISMISS\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}title:
]{.s1}[\"Dismiss\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}options: \[.destructive\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ departureCategory
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationCategory]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"DEPARTURE_ALERT\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}actions: \[navigateAction,
remindAction, dismissAction\],]{.s1}

[[            ]{.Apple-converted-space}intentIdentifiers: \[\],]{.s1}

[[            ]{.Apple-converted-space}hiddenPreviewsBodyPlaceholder:
]{.s1}[\"Departure alert\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}categorySummaryFormat:
]{.s1}[\"%u departure alerts\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}options:
\[.customDismissAction\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Weather Change
Category*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ viewDetailsAction
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationAction]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"VIEW_DETAILS\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}title: ]{.s1}[\"View
Details\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}options: \[.foreground\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ weatherCategory
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationCategory]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"WEATHER_CHANGE\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}actions: \[viewDetailsAction,
dismissAction\],]{.s1}

[[            ]{.Apple-converted-space}intentIdentifiers: \[\],]{.s1}

[[            ]{.Apple-converted-space}options: \[\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Opportunity Category
(e.g., \"Great day to bike!\")*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ planRouteAction
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationAction]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"PLAN_ROUTE\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}title: ]{.s1}[\"Plan
Route\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}options: \[.foreground\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ opportunityCategory
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationCategory]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"OPPORTUNITY\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}actions: \[planRouteAction,
dismissAction\],]{.s1}

[[            ]{.Apple-converted-space}intentIdentifiers: \[\],]{.s1}

[[            ]{.Apple-converted-space}options: \[\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Tomorrow Preview
Category*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ tomorrowCategory
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationCategory]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"TOMORROW_PREVIEW\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}actions:
\[viewDetailsAction\],]{.s1}

[[            ]{.Apple-converted-space}intentIdentifiers: \[\],]{.s1}

[[            ]{.Apple-converted-space}options: \[\]]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}center.]{.s6}[setNotificationCategories]{.s1}[(\[]{.s6}

[[            ]{.Apple-converted-space}departureCategory,]{.s1}

[[            ]{.Apple-converted-space}weatherCategory,]{.s1}

[[            ]{.Apple-converted-space}opportunityCategory,]{.s1}

[[            ]{.Apple-converted-space}tomorrowCategory]{.s1}

[[        ]{.Apple-converted-space}\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// LOCAL NOTIFICATIONS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[scheduleDepartureReminder]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}at time: ]{.s1}[Date]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}message: ]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}routeId: ]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ content
]{.s6}[=]{.s9}[ ]{.s6}[UNMutableNotificationContent]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}content.title ]{.s1}[=]{.s9}[
]{.s1}[\"Time to Leave\"]{.s10}

[[        ]{.Apple-converted-space}content.subtitle ]{.s1}[=]{.s9}[
]{.s1}[\"To ]{.s10}[\\(destination)]{.s1}[\"]{.s10}

[[        ]{.Apple-converted-space}content.body ]{.s1}[=]{.s9}[
message]{.s1}

[[        ]{.Apple-converted-space}content.sound ]{.s1}[=]{.s9}[
.]{.s1}[default]{.s8}

[[        ]{.Apple-converted-space}content.categoryIdentifier
]{.s1}[=]{.s9}[ ]{.s1}[\"DEPARTURE_ALERT\"]{.s10}

[[        ]{.Apple-converted-space}content.userInfo ]{.s1}[=]{.s9}[
\[]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"type\"]{.s1}[:
]{.s6}[\"departure_reminder\"]{.s1}[,]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"routeId\"]{.s10}[:
routeId,]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[\"destination\"]{.s10}[:
destination]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space}content.interruptionLevel
]{.s1}[=]{.s9}[ .timeSensitive]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ components
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[dateComponents]{.s9}[(]{.s1}

[[            ]{.Apple-converted-space}\[.year, .month, .day, .hour,
.minute\],]{.s1}

[[            ]{.Apple-converted-space}from: time]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trigger
]{.s1}[=]{.s9}[
]{.s1}[UNCalendarNotificationTrigger]{.s11}[(dateMatching: components,
repeats: ]{.s1}[false]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[UNNotificationRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"departure\_]{.s10}[\\(routeId)]{.s1}[\_]{.s10}[\\(time.timeIntervalSince1970)]{.s1}[\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}content: content,]{.s1}

[[            ]{.Apple-converted-space}trigger: trigger]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
center.]{.s1}[add]{.s9}[(request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[scheduleWeatherChangeAlert]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}message: ]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}severity:
]{.s1}[AlertSeverity]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}data: \[]{.s1}[String]{.s11}[:
]{.s1}[Any]{.s8}[\]]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ content
]{.s6}[=]{.s9}[ ]{.s6}[UNMutableNotificationContent]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}content.title ]{.s1}[=]{.s9}[
severity.title]{.s1}

[[        ]{.Apple-converted-space}content.body ]{.s1}[=]{.s9}[
message]{.s1}

[[        ]{.Apple-converted-space}content.sound ]{.s1}[=]{.s9}[
severity.sound]{.s1}

[[        ]{.Apple-converted-space}content.categoryIdentifier
]{.s1}[=]{.s9}[ ]{.s1}[\"WEATHER_CHANGE\"]{.s10}

[[        ]{.Apple-converted-space}content.userInfo ]{.s1}[=]{.s9}[
data]{.s1}

[[        ]{.Apple-converted-space}content.interruptionLevel
]{.s1}[=]{.s9}[ severity.interruptionLevel]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Deliver immediately*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[UNNotificationRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"weather\_]{.s10}[\\(]{.s1}[UUID]{.s9}[().uuidString)]{.s1}[\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}content: content,]{.s1}

[[            ]{.Apple-converted-space}trigger: ]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
center.]{.s1}[add]{.s9}[(request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[scheduleOpportunityAlert]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}title: ]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}message: ]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}transportMode: ]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ content
]{.s6}[=]{.s9}[ ]{.s6}[UNMutableNotificationContent]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}content.title ]{.s1}[=]{.s9}[
title]{.s1}

[[        ]{.Apple-converted-space}content.body ]{.s1}[=]{.s9}[
message]{.s1}

[[        ]{.Apple-converted-space}content.sound ]{.s1}[=]{.s9}[
.]{.s1}[default]{.s8}

[[        ]{.Apple-converted-space}content.categoryIdentifier
]{.s1}[=]{.s9}[ ]{.s1}[\"OPPORTUNITY\"]{.s10}

[[        ]{.Apple-converted-space}content.userInfo ]{.s1}[=]{.s9}[
\[]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[\"type\"]{.s1}[:
]{.s6}[\"opportunity\"]{.s1}[,]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[\"transportMode\"]{.s10}[:
transportMode]{.s1}

[[        ]{.Apple-converted-space}\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[UNNotificationRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}identifier:
]{.s1}[\"opportunity\_]{.s10}[\\(]{.s1}[UUID]{.s9}[().uuidString)]{.s1}[\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}content: content,]{.s1}

[[            ]{.Apple-converted-space}trigger: ]{.s1}[nil]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
center.]{.s1}[add]{.s9}[(request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[scheduleTomorrowPreview]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}summary: ]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}details: \[]{.s1}[String]{.s11}[:
]{.s1}[Any]{.s8}[\]]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ content
]{.s6}[=]{.s9}[ ]{.s6}[UNMutableNotificationContent]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}content.title ]{.s1}[=]{.s9}[
]{.s1}[\"Tomorrow\'s Commute\"]{.s10}

[[        ]{.Apple-converted-space}content.body ]{.s1}[=]{.s9}[
summary]{.s1}

[[        ]{.Apple-converted-space}content.sound ]{.s1}[=]{.s9}[
.]{.s1}[default]{.s8}

[[        ]{.Apple-converted-space}content.categoryIdentifier
]{.s1}[=]{.s9}[ ]{.s1}[\"TOMORROW_PREVIEW\"]{.s10}

[[        ]{.Apple-converted-space}content.userInfo ]{.s1}[=]{.s9}[
details]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Schedule for 9 PM
tonight*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ components
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[dateComponents]{.s9}[(\[.year,
.month, .day\], from: ]{.s1}[Date]{.s11}[())]{.s1}

[[        ]{.Apple-converted-space}components.hour ]{.s1}[=]{.s9}[
]{.s1}[21]{.s11}

[[        ]{.Apple-converted-space}components.minute ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trigger
]{.s1}[=]{.s9}[
]{.s1}[UNCalendarNotificationTrigger]{.s11}[(dateMatching: components,
repeats: ]{.s1}[false]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[UNNotificationRequest]{.s1}[(]{.s6}

[[            ]{.Apple-converted-space}identifier:
\"tomorrow_preview\_\\(]{.s1}[Date]{.s11}[().]{.s1}[formatted]{.s9}[(.dateTime.]{.s1}[year]{.s9}[().]{.s1}[month]{.s9}[().]{.s1}[day]{.s9}[()))\",]{.s1}

[[            ]{.Apple-converted-space}content: content,]{.s1}

[[            ]{.Apple-converted-space}trigger: trigger]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
center.]{.s1}[add]{.s9}[(request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// CANCEL NOTIFICATIONS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[cancelNotification]{.s9}[(identifier: ]{.s1}[String]{.s11}[)
{]{.s1}

[[       
]{.Apple-converted-space}center.]{.s1}[removePendingNotificationRequests]{.s9}[(withIdentifiers:
\[identifier\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[cancelAllDepartureReminders]{.s1}[(]{.s6}[for]{.s8}[ routeId:
]{.s6}[String]{.s11}[) {]{.s6}

[[        ]{.Apple-converted-space}center.getPendingNotificationRequests
{ \[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\] requests ]{.s1}[in]{.s8}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ identifiers
]{.s1}[=]{.s9}[ requests]{.s1}

[[                ]{.Apple-converted-space}.filter {
\$0.identifier.]{.s1}[starts]{.s9}[(with:
]{.s1}[\"departure\_]{.s10}[\\(routeId)]{.s1}[\"]{.s10}[) }]{.s1}

[[                ]{.Apple-converted-space}.map { \$0.identifier }]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.center.]{.s1}[removePendingNotificationRequests]{.s9}[(withIdentifiers:
identifiers)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[cancelAllNotifications]{.s1}[() {]{.s6}

[[       
]{.Apple-converted-space}center.]{.s6}[removeAllPendingNotificationRequests]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// BADGE MANAGEMENT*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[clearBadge]{.s9}[() ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[await]{.s8}[
center.]{.s1}[setBadgeCount]{.s9}[(]{.s1}[0]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[setBadge]{.s9}[(count: ]{.s1}[Int]{.s11}[) ]{.s1}[async]{.s8}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[?]{.s9}[
]{.s1}[await]{.s8}[ center.]{.s1}[setBadgeCount]{.s9}[(count)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// ALERT SEVERITY*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[AlertSeverity]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ low]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ medium]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ high]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ critical]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ title:
]{.s1}[String]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .low:
]{.s1}[return]{.s8}[ ]{.s1}[\"Weather Update\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ ]{.s1}[\"Weather Change\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .high:
]{.s1}[return]{.s8}[ ]{.s1}[\"Weather Alert\"]{.s10}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .critical:
]{.s1}[return]{.s8}[ ]{.s1}[\"]{.s10}[⚠️]{.s19}[ Severe Weather\"]{.s10}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ sound:
]{.s6}[UNNotificationSound]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .low:
]{.s1}[return]{.s8}[ .]{.s1}[default]{.s8}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ .]{.s1}[default]{.s8}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[ .high:
]{.s6}[return]{.s8}[ ]{.s6}[UNNotificationSound]{.s1}[(named:
]{.s6}[UNNotificationSoundName]{.s1}[(]{.s6}[\"alert.wav\"]{.s10}[))]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .critical:
]{.s1}[return]{.s8}[ .defaultCritical]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[var]{.s8}[ interruptionLevel:
]{.s6}[UNNotificationInterruptionLevel]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[
]{.s1}[self]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .low:
]{.s1}[return]{.s8}[ .passive]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .medium:
]{.s1}[return]{.s8}[ .active]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .high:
]{.s1}[return]{.s8}[ .timeSensitive]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .critical:
]{.s1}[return]{.s8}[ .critical]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// DELEGATE (Handling Notification Responses)*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[NotificationService]{.s1}[:
]{.s6}[UNUserNotificationCenterDelegate]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Handle notification when app
is in foreground*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[nonisolated]{.s8}[
]{.s6}[func]{.s8}[ ]{.s6}[userNotificationCenter]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\_]{.s8}[ center:
]{.s6}[UNUserNotificationCenter]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}willPresent notification:
]{.s1}[UNNotification]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}withCompletionHandler
completionHandler: ]{.s1}[\@escaping]{.s11}[
(]{.s1}[UNNotificationPresentationOptions]{.s11}[) ]{.s1}[-\>]{.s9}[
]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Show notification even
when app is open*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[completionHandler]{.s9}[(\[.banner,
.sound, .badge\])]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// Handle notification action
response*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[nonisolated]{.s8}[
]{.s6}[func]{.s8}[ ]{.s6}[userNotificationCenter]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[\_]{.s8}[ center:
]{.s6}[UNUserNotificationCenter]{.s1}[,]{.s6}

[[        ]{.Apple-converted-space}didReceive response:
]{.s1}[UNNotificationResponse]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}withCompletionHandler
completionHandler: ]{.s1}[\@escaping]{.s11}[ () ]{.s1}[-\>]{.s9}[
]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ userInfo
]{.s1}[=]{.s9}[ response.notification.request.content.userInfo]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ actionIdentifier
]{.s1}[=]{.s9}[ response.actionIdentifier]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[Task]{.s1}[ {
]{.s6}[\@MainActor]{.s1}[ ]{.s6}[in]{.s8}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[handleNotificationAction]{.s9}[(actionIdentifier, userInfo:
userInfo)]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[completionHandler]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\@MainActor]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[handleNotificationAction]{.s9}[(]{.s1}[\_]{.s8}[ action:
]{.s1}[String]{.s11}[, userInfo: \[]{.s1}[AnyHashable]{.s11}[:
]{.s1}[Any]{.s8}[\]) ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ action {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"NAVIGATE\"]{.s10}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Start
navigation*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ routeId ]{.s1}[=]{.s9}[
userInfo\[]{.s1}[\"routeId\"]{.s10}[\] ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[String]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}name:
.startNavigation,]{.s1}

[[                    ]{.Apple-converted-space}object:
]{.s1}[nil]{.s11}[,]{.s1}

[[                    ]{.Apple-converted-space}userInfo:
\[]{.s1}[\"routeId\"]{.s10}[: routeId\]]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"REMIND_LATER\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[*// Reschedule for 10
minutes later*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ destination ]{.s1}[=]{.s9}[
userInfo\[]{.s1}[\"destination\"]{.s10}[\] ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[String]{.s11}[,]{.s1}

[[               ]{.Apple-converted-space}]{.s1}[let]{.s8}[ routeId
]{.s1}[=]{.s9}[ userInfo\[]{.s1}[\"routeId\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ newTime
]{.s1}[=]{.s9}[
]{.s1}[Date]{.s11}[().]{.s1}[addingTimeInterval]{.s9}[(]{.s1}[10]{.s11}[
]{.s1}[\*]{.s9}[ ]{.s1}[60]{.s11}[)]{.s1}

[[                ]{.Apple-converted-space}]{.s6}[try]{.s8}[?]{.s1}[
]{.s6}[await]{.s8}[ ]{.s6}[scheduleDepartureReminder]{.s1}[(]{.s6}

[[                    ]{.Apple-converted-space}at: newTime,]{.s1}

[[                    ]{.Apple-converted-space}destination:
destination,]{.s1}

[[                    ]{.Apple-converted-space}message: ]{.s1}[\"Time to
leave for ]{.s10}[\\(destination)]{.s1}[\"]{.s10}[,]{.s1}

[[                    ]{.Apple-converted-space}routeId: routeId]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"VIEW_DETAILS\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[*// Open app to
details*]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[NotificationCenter]{.s1}[.]{.s6}[default]{.s8}[.]{.s6}[post]{.s9}[(]{.s6}

[[                ]{.Apple-converted-space}name:
.showWeatherDetails,]{.s1}

[[                ]{.Apple-converted-space}object:
]{.s1}[nil]{.s11}[,]{.s1}

[[                ]{.Apple-converted-space}userInfo: userInfo]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"PLAN_ROUTE\"]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[*// Open route
planner*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ mode ]{.s1}[=]{.s9}[
userInfo\[]{.s1}[\"transportMode\"]{.s10}[\] ]{.s1}[as]{.s8}[?]{.s9}[
]{.s1}[String]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(]{.s1}

[[                    ]{.Apple-converted-space}name:
.openRoutePlanner,]{.s1}

[[                    ]{.Apple-converted-space}object:
]{.s1}[nil]{.s11}[,]{.s1}

[[                    ]{.Apple-converted-space}userInfo:
\[]{.s1}[\"mode\"]{.s10}[: mode\]]{.s1}

[[                ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[UNNotificationDefaultActionIdentifier]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[*// Tapped notification
body - open app*]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[handleDefaultTap]{.s9}[(userInfo:
userInfo)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[UNNotificationDismissActionIdentifier]{.s1}[:]{.s6}

[[            ]{.Apple-converted-space}]{.s6}[*// Dismissed - track for
analytics*]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[trackDismissed]{.s9}[(userInfo:
userInfo)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[break]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[handleDefaultTap]{.s9}[(userInfo: \[]{.s1}[AnyHashable]{.s11}[:
]{.s1}[Any]{.s8}[\]) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
type ]{.s1}[=]{.s9}[ userInfo\[]{.s1}[\"type\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ type {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"departure_reminder\"]{.s1}[:]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.showTodayTab, object: ]{.s1}[nil]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"weather_change\"]{.s1}[:]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.showWeatherDetails, object: ]{.s1}[nil]{.s11}[, userInfo:
userInfo)]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
]{.s6}[\"opportunity\"]{.s1}[:]{.s6}

[[           
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[post]{.s9}[(name:
.openRoutePlanner, object: ]{.s1}[nil]{.s11}[, userInfo: userInfo)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[break]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[trackDismissed]{.s9}[(userInfo: \[]{.s1}[AnyHashable]{.s11}[:
]{.s1}[Any]{.s8}[\]) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Analytics tracking*]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Notification
dismissed: ]{.s1}[\\(userInfo)]{.s6}[\"]{.s1}[)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[*// NOTIFICATION NAMES*]{.s1}

[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────────*]{.s1}

[]{.s1}\

[extension]{.s8}[ ]{.s6}[Notification]{.s1}[.]{.s6}[Name]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
startNavigation ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"startNavigation\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
showWeatherDetails ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"showWeatherDetails\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
openRoutePlanner ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"openRoutePlanner\"]{.s10}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
showTodayTab ]{.s1}[=]{.s9}[
]{.s1}[Notification]{.s11}[.]{.s1}[Name]{.s11}[(]{.s1}[\"showTodayTab\"]{.s10}[)]{.s1}

[}]{.s1}

[]{.s1}\

[Push Notification Handler (Remote)]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// APP/AppDelegate.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s1}[ ]{.s6}[UIKit]{.s11}

[import]{.s8}[ ]{.s6}[UserNotifications]{.s1}

[]{.s1}\

[class]{.s8}[ ]{.s6}[AppDelegate]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[UIApplicationDelegate]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[application]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ application:
]{.s1}[UIApplication]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didFinishLaunchingWithOptions
launchOptions:
\[]{.s1}[UIApplication]{.s11}[.]{.s1}[LaunchOptionsKey]{.s11}[:
]{.s1}[Any]{.s8}[\]]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}) ]{.s1}[-\>]{.s9}[ ]{.s1}[Bool]{.s11}[
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// REMOTE NOTIFICATION
REGISTRATION*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[application]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ application:
]{.s1}[UIApplication]{.s11}[,]{.s1}

[[       
]{.Apple-converted-space}didRegisterForRemoteNotificationsWithDeviceToken
deviceToken: ]{.s1}[Data]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ token
]{.s1}[=]{.s9}[ deviceToken.map { ]{.s1}[String]{.s11}[(format:
]{.s1}[\"%02.2hhx\"]{.s10}[, \$0) }.]{.s1}[joined]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[print]{.s9}[(]{.s1}[\"APNs
token: ]{.s10}[\\(token)]{.s1}[\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Send token to your
server*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[registerDeviceToken]{.s9}[(token)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[application]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ application:
]{.s1}[UIApplication]{.s11}[,]{.s1}

[[       
]{.Apple-converted-space}didFailToRegisterForRemoteNotificationsWithError
error: ]{.s1}[Error]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed
to register for remote notifications:
]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// SILENT PUSH (Background
Updates)*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[application]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[\_]{.s8}[ application:
]{.s1}[UIApplication]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}didReceiveRemoteNotification
userInfo: \[]{.s1}[AnyHashable]{.s11}[: ]{.s1}[Any]{.s8}[\],]{.s1}

[[        ]{.Apple-converted-space}fetchCompletionHandler
completionHandler: ]{.s1}[\@escaping]{.s11}[
(]{.s1}[UIBackgroundFetchResult]{.s11}[) ]{.s1}[-\>]{.s9}[
]{.s1}[Void]{.s11}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Handle silent push for
background weather updates*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
type ]{.s1}[=]{.s9}[ userInfo\[]{.s1}[\"type\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ ]{.s1}[else]{.s8}[
{]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completionHandler]{.s9}[(.noData)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ type
{]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"weather_update\"]{.s10}[:]{.s1}

[[                    ]{.Apple-converted-space}]{.s6}[*// Refresh
weather data in background*]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[refreshWeatherData]{.s9}[()]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[completionHandler]{.s9}[(.newData)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[\"route_update\"]{.s10}[:]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}[*// Update route
data*]{.s13}

[[                    ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[refreshRouteData]{.s9}[()]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[completionHandler]{.s9}[(.newData)]{.s1}

[[                    ]{.Apple-converted-space}]{.s1}

[[                ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[                   
]{.Apple-converted-space}]{.s1}[completionHandler]{.s9}[(.noData)]{.s1}

[[                ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[*// HELPERS*]{.s1}

[[    ]{.Apple-converted-space}]{.s20}[*//*
]{.s18}[*─────────────────────────────────────────────────────────────────────*]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[registerDeviceToken]{.s9}[(]{.s1}[\_]{.s8}[ token:
]{.s1}[String]{.s11}[) ]{.s1}[async]{.s8}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Send to your API*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[do]{.s8}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[var]{.s8}[ request
]{.s6}[=]{.s9}[ ]{.s6}[URLRequest]{.s11}[(url: ]{.s6}[URL]{.s9}[(string:
]{.s6}[\"https://api.liquidcrypto.app/v1/devices/token\"]{.s1}[)]{.s6}[!]{.s9}[)]{.s6}

[[            ]{.Apple-converted-space}request.httpMethod
]{.s1}[=]{.s9}[ ]{.s1}[\"POST\"]{.s10}

[[           
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"application/json\"]{.s10}[,
forHTTPHeaderField: ]{.s1}[\"Content-Type\"]{.s10}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[*// Add auth header*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ authToken ]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[getAuthToken]{.s9}[() {]{.s1}

[[               
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(authToken)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ body
]{.s1}[=]{.s9}[ \[]{.s1}[\"token\"]{.s10}[: token,
]{.s1}[\"platform\"]{.s10}[: ]{.s1}[\"ios\"]{.s10}[\]]{.s1}

[[            ]{.Apple-converted-space}request.httpBody ]{.s1}[=]{.s9}[
]{.s1}[try]{.s8}[
]{.s1}[JSONEncoder]{.s11}[().]{.s1}[encode]{.s9}[(body)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[
(]{.s1}[\_]{.s8}[, response) ]{.s1}[=]{.s9}[ ]{.s1}[try]{.s8}[
]{.s1}[await]{.s8}[
]{.s1}[URLSession]{.s11}[.shared.]{.s1}[data]{.s9}[(]{.s1}[for]{.s8}[:
request)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ httpResponse ]{.s1}[=]{.s9}[ response
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[HTTPURLResponse]{.s11}[,]{.s1}

[[               ]{.Apple-converted-space}httpResponse.statusCode
]{.s1}[==]{.s9}[ ]{.s1}[200]{.s11}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Device token
registered successfully\"]{.s1}[)]{.s6}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}} ]{.s1}[catch]{.s8}[ {]{.s1}

[[           
]{.Apple-converted-space}]{.s6}[print]{.s9}[(]{.s6}[\"Failed to register
device token: ]{.s1}[\\(error)]{.s6}[\"]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[refreshWeatherData]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Background weather
refresh*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[await]{.s8}[
]{.s6}[AppState]{.s11}[.shared.]{.s6}[refreshCommuteWeather]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Update widgets*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[WidgetCenter]{.s11}[.shared.]{.s1}[reloadAllTimelines]{.s9}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Update
complications*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[#if
os]{.s1}[(]{.s6}[watchOS]{.s1}[)]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ server
]{.s6}[=]{.s9}[
]{.s6}[CLKComplicationServer]{.s1}[.]{.s6}[sharedInstance]{.s9}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ complication
]{.s1}[in]{.s8}[ server.activeComplications ]{.s1}[??]{.s9}[ \[\]
{]{.s1}

[[           
]{.Apple-converted-space}server.]{.s1}[reloadTimeline]{.s9}[(]{.s1}[for]{.s8}[:
complication)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[#endif]{.s5}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[refreshRouteData]{.s1}[() ]{.s6}[async]{.s8}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Background route/traffic
refresh*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[await]{.s8}[
]{.s1}[AppState]{.s11}[.shared.]{.s1}[loadUserData]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[getAuthToken]{.s9}[() ]{.s6}[async]{.s1}[ ]{.s6}[-\>]{.s9}[
]{.s6}[String]{.s11}[?]{.s9}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Retrieve from
Keychain*]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[nil]{.s11}[ ]{.s6}[*// Implementation*]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// PUSH PAYLOAD EXAMPLES*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[*/\**]{.s1}

[*[ ]{.Apple-converted-space}*]{.s1}

[*[ ]{.Apple-converted-space}1. DEPARTURE ALERT (Visible
notification)*]{.s1}

[*[ ]{.Apple-converted-space}{*]{.s1}

[*[   ]{.Apple-converted-space}\"aps\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"alert\": {*]{.s1}

[*[       ]{.Apple-converted-space}\"title\": \"Rain starting
soon\",*]{.s1}

[*[       ]{.Apple-converted-space}\"subtitle\": \"To Work\",*]{.s1}

[*[       ]{.Apple-converted-space}\"body\": \"Leave in the next 15
minutes to stay dry, or wait until after 10am.\"*]{.s1}

[*[     ]{.Apple-converted-space}},*]{.s1}

[*[     ]{.Apple-converted-space}\"sound\": \"default\",*]{.s1}

[*[     ]{.Apple-converted-space}\"category\":
\"DEPARTURE_ALERT\",*]{.s1}

[*[     ]{.Apple-converted-space}\"interruption-level\":
\"time-sensitive\"*]{.s1}

[*[   ]{.Apple-converted-space}},*]{.s1}

[*[   ]{.Apple-converted-space}\"type\": \"departure_alert\",*]{.s1}

[*[   ]{.Apple-converted-space}\"routeId\": \"route_123\",*]{.s1}

[*[   ]{.Apple-converted-space}\"destination\": \"Work\",*]{.s1}

[*[   ]{.Apple-converted-space}\"windowClosesAt\":
\"2026-01-20T09:00:00-08:00\",*]{.s1}

[*[   ]{.Apple-converted-space}\"weatherSummary\": \"Rain starts at 9:15
on I-280\"*]{.s1}

[*[ ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}*]{.s1}

[*[ ]{.Apple-converted-space}2. WEATHER CHANGE ALERT*]{.s1}

[*[ ]{.Apple-converted-space}{*]{.s1}

[*[   ]{.Apple-converted-space}\"aps\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"alert\": {*]{.s1}

[*[       ]{.Apple-converted-space}\"title\": \"Weather Change\",*]{.s1}

[*[       ]{.Apple-converted-space}\"body\": \"Rain expected during your
evening commute. Consider leaving early.\"*]{.s1}

[*[     ]{.Apple-converted-space}},*]{.s1}

[*[     ]{.Apple-converted-space}\"sound\": \"default\",*]{.s1}

[*[     ]{.Apple-converted-space}\"category\": \"WEATHER_CHANGE\"*]{.s1}

[*[   ]{.Apple-converted-space}},*]{.s1}

[*[   ]{.Apple-converted-space}\"type\": \"weather_change\",*]{.s1}

[*[   ]{.Apple-converted-space}\"routeId\": \"route_123\",*]{.s1}

[*[   ]{.Apple-converted-space}\"changeType\": \"rain_incoming\",*]{.s1}

[*[   ]{.Apple-converted-space}\"startTime\":
\"2026-01-20T17:00:00-08:00\"*]{.s1}

[*[ ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}*]{.s1}

[*[ ]{.Apple-converted-space}3. OPPORTUNITY ALERT*]{.s1}

[*[ ]{.Apple-converted-space}{*]{.s1}

[*[   ]{.Apple-converted-space}\"aps\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"alert\": {*]{.s1}

[*[       ]{.Apple-converted-space}\"title\": \"*]{.s1}[🚴]{.s12}[
*Great day to bike!\",*]{.s1}

[*[       ]{.Apple-converted-space}\"body\": \"Clear skies, 68°F, light
winds. Perfect cycling weather both ways.\"*]{.s1}

[*[     ]{.Apple-converted-space}},*]{.s1}

[*[     ]{.Apple-converted-space}\"sound\": \"default\",*]{.s1}

[*[     ]{.Apple-converted-space}\"category\": \"OPPORTUNITY\"*]{.s1}

[*[   ]{.Apple-converted-space}},*]{.s1}

[*[   ]{.Apple-converted-space}\"type\": \"opportunity\",*]{.s1}

[*[   ]{.Apple-converted-space}\"transportMode\": \"bike\",*]{.s1}

[*[   ]{.Apple-converted-space}\"conditions\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"tempF\": 68,*]{.s1}

[*[     ]{.Apple-converted-space}\"wind\": \"5 mph\",*]{.s1}

[*[     ]{.Apple-converted-space}\"precip\": 0*]{.s1}

[*[   ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}*]{.s1}

[*[ ]{.Apple-converted-space}4. SILENT PUSH (Background update)*]{.s1}

[*[ ]{.Apple-converted-space}{*]{.s1}

[*[   ]{.Apple-converted-space}\"aps\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"content-available\": 1*]{.s1}

[*[   ]{.Apple-converted-space}},*]{.s1}

[*[   ]{.Apple-converted-space}\"type\": \"weather_update\",*]{.s1}

[*[   ]{.Apple-converted-space}\"timestamp\":
\"2026-01-20T08:00:00Z\"*]{.s1}

[*[ ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}*]{.s1}

[*[ ]{.Apple-converted-space}5. TOMORROW PREVIEW*]{.s1}

[*[ ]{.Apple-converted-space}{*]{.s1}

[*[   ]{.Apple-converted-space}\"aps\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"alert\": {*]{.s1}

[*[       ]{.Apple-converted-space}\"title\": \"Tomorrow\'s
Commute\",*]{.s1}

[*[       ]{.Apple-converted-space}\"body\": \"Rain all morning*
]{.s1}[☔]{.s12}[ *Consider working from home or leaving early.\"*]{.s1}

[*[     ]{.Apple-converted-space}},*]{.s1}

[*[     ]{.Apple-converted-space}\"sound\": \"default\",*]{.s1}

[*[     ]{.Apple-converted-space}\"category\":
\"TOMORROW_PREVIEW\"*]{.s1}

[*[   ]{.Apple-converted-space}},*]{.s1}

[*[   ]{.Apple-converted-space}\"type\": \"tomorrow_preview\",*]{.s1}

[*[   ]{.Apple-converted-space}\"forecast\": {*]{.s1}

[*[     ]{.Apple-converted-space}\"morning\": \"rain\",*]{.s1}

[*[     ]{.Apple-converted-space}\"afternoon\": \"clearing\",*]{.s1}

[*[     ]{.Apple-converted-space}\"recommendation\":
\"wfh_or_early\"*]{.s1}

[*[   ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}}*]{.s1}

[*[ ]{.Apple-converted-space}*]{.s1}

[*[ ]{.Apple-converted-space}\*/*]{.s1}

[]{.s1}\

[Notification Deep Linking]{.s3}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// APP/DeepLinkHandler.swift*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[import]{.s8}[ ]{.s6}[SwiftUI]{.s1}

[import]{.s8}[ ]{.s6}[Combine]{.s1}

[]{.s1}\

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[DeepLinkHandler]{.s1}[:
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[let]{.s8}[
shared ]{.s1}[=]{.s9}[ ]{.s1}[DeepLinkHandler]{.s11}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ pendingDeepLink: ]{.s1}[DeepLink]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
cancellables ]{.s1}[=]{.s9}[
]{.s1}[Set]{.s11}[\<]{.s9}[AnyCancellable]{.s11}[\>]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[init]{.s8}[() {]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[setupObservers]{.s1}[()]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s8}[ ]{.s6}[func]{.s8}[
]{.s6}[setupObservers]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[*// Navigation from
notification*]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.startNavigation)]{.s1}

[[            ]{.Apple-converted-space}.compactMap {
\$0.userInfo]{.s1}[?]{.s9}[\[]{.s1}[\"routeId\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ }]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] routeId ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.pendingDeepLink
]{.s1}[=]{.s9}[ .]{.s1}[startNavigation]{.s9}[(routeId: routeId)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.showWeatherDetails)]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] notification ]{.s1}[in]{.s8}

[[                ]{.Apple-converted-space}]{.s1}[let]{.s8}[ userInfo
]{.s1}[=]{.s9}[ notification.userInfo ]{.s1}[??]{.s9}[ \[:\]]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.pendingDeepLink
]{.s1}[=]{.s9}[ .]{.s1}[weatherDetails]{.s9}[(data: userInfo)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.openRoutePlanner)]{.s1}

[[            ]{.Apple-converted-space}.compactMap {
\$0.userInfo]{.s1}[?]{.s9}[\[]{.s1}[\"mode\"]{.s10}[\]
]{.s1}[as]{.s8}[?]{.s9}[ ]{.s1}[String]{.s11}[ }]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] mode ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.pendingDeepLink
]{.s1}[=]{.s9}[ .]{.s1}[routePlanner]{.s9}[(mode: mode)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[       
]{.Apple-converted-space}]{.s1}[NotificationCenter]{.s11}[.]{.s1}[default]{.s8}[.]{.s1}[publisher]{.s9}[(]{.s1}[for]{.s8}[:
.showTodayTab)]{.s1}

[[            ]{.Apple-converted-space}.sink { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.pendingDeepLink
]{.s1}[=]{.s9}[ .todayTab]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[store]{.s9}[(]{.s1}[in]{.s8}[:
]{.s1}[&]{.s9}[cancellables)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[clearPendingDeepLink]{.s1}[() {]{.s6}

[[        ]{.Apple-converted-space}pendingDeepLink ]{.s1}[=]{.s9}[
]{.s1}[nil]{.s11}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[enum]{.s8}[ ]{.s6}[DeepLink]{.s1}[: ]{.s6}[Equatable]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ todayTab]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[startNavigation]{.s9}[(routeId: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[weatherDetails]{.s9}[(data: \[]{.s1}[AnyHashable]{.s11}[:
]{.s1}[Any]{.s8}[\])]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[
]{.s1}[routePlanner]{.s9}[(mode: ]{.s1}[String]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[case]{.s8}[ settings]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[static]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[==]{.s9}[ (lhs: ]{.s1}[DeepLink]{.s11}[, rhs:
]{.s1}[DeepLink]{.s11}[) ]{.s1}[-\>]{.s9}[ ]{.s1}[Bool]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ (lhs, rhs)
{]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ (.todayTab,
.todayTab):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s6}[case]{.s8}[
(.]{.s6}[startNavigation]{.s1}[(]{.s6}[let]{.s8}[ l),
.]{.s6}[startNavigation]{.s1}[(]{.s6}[let]{.s8}[ r)):]{.s6}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ l
]{.s1}[==]{.s9}[ r]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
(.]{.s1}[routePlanner]{.s9}[(]{.s1}[let]{.s8}[ l),
.]{.s1}[routePlanner]{.s9}[(]{.s1}[let]{.s8}[ r)):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[ l
]{.s1}[==]{.s9}[ r]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ (.settings,
.settings):]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ (.weatherDetails,
.weatherDetails):]{.s1}

[[            ]{.Apple-converted-space}]{.s6}[return]{.s8}[
]{.s6}[true]{.s11}[ ]{.s6}[*// Simplified comparison*]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[default]{.s8}[:]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[false]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[*// INTEGRATE WITH CONTENT VIEW*]{.s1}

[*//*
]{.s18}[*═══════════════════════════════════════════════════════════════════════*]{.s1}

[]{.s1}\

[struct]{.s8}[ ]{.s6}[ContentView]{.s1}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\@EnvironmentObject]{.s1}[
]{.s6}[var]{.s8}[ appState: ]{.s6}[AppState]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@StateObject]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ deepLinkHandler ]{.s1}[=]{.s9}[
]{.s1}[DeepLinkHandler]{.s11}[.shared]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ selectedTab ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ showNavigationSheet
]{.s1}[=]{.s9}[ ]{.s1}[false]{.s11}

[[    ]{.Apple-converted-space}]{.s1}[\@State]{.s11}[
]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[ navigationRouteId:
]{.s1}[String]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Group]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
appState.isAuthenticated {]{.s1}

[[                ]{.Apple-converted-space}mainTabView]{.s1}

[[            ]{.Apple-converted-space}} ]{.s1}[else]{.s8}[ {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[OnboardingView]{.s11}[()]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[onChange]{.s9}[(of:
deepLinkHandler.pendingDeepLink) { ]{.s1}[\_]{.s8}[, deepLink
]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s1}[handleDeepLink]{.s9}[(deepLink)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[var]{.s8}[
mainTabView: ]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[TabView]{.s11}[(selection:
\$selectedTab) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[TodayView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {
]{.s1}[Label]{.s11}[(]{.s1}[\"Today\"]{.s10}[, systemImage:
]{.s1}[\"sun.max.fill\"]{.s10}[) }]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[0]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[PlanTripView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {
]{.s1}[Label]{.s11}[(]{.s1}[\"Plan\"]{.s10}[, systemImage:
]{.s1}[\"map.fill\"]{.s10}[) }]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[WeekAheadView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {
]{.s1}[Label]{.s11}[(]{.s1}[\"Week\"]{.s10}[, systemImage:
]{.s1}[\"calendar\"]{.s10}[) }]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[2]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[InsightsView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {
]{.s1}[Label]{.s11}[(]{.s1}[\"Insights\"]{.s10}[, systemImage:
]{.s1}[\"chart.bar.fill\"]{.s10}[) }]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[3]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[SettingsView]{.s11}[()]{.s1}

[[                ]{.Apple-converted-space}.tabItem {
]{.s1}[Label]{.s11}[(]{.s1}[\"Settings\"]{.s10}[, systemImage:
]{.s1}[\"gear\"]{.s10}[) }]{.s1}

[[               
]{.Apple-converted-space}.]{.s1}[tag]{.s9}[(]{.s1}[4]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}.]{.s1}[sheet]{.s9}[(isPresented:
\$showNavigationSheet) {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[if]{.s8}[
]{.s1}[let]{.s8}[ routeId ]{.s1}[=]{.s9}[ navigationRouteId {]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[NavigationStartView]{.s11}[(routeId:
routeId)]{.s1}

[[            ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[func]{.s8}[
]{.s1}[handleDeepLink]{.s9}[(]{.s1}[\_]{.s8}[ deepLink:
]{.s1}[DeepLink]{.s11}[?]{.s9}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[guard]{.s8}[ ]{.s1}[let]{.s8}[
deepLink ]{.s1}[=]{.s9}[ deepLink ]{.s1}[else]{.s8}[ {
]{.s1}[return]{.s8}[ }]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[switch]{.s8}[ deepLink {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .todayTab:]{.s1}

[[            ]{.Apple-converted-space}selectedTab ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[startNavigation]{.s9}[(]{.s1}[let]{.s8}[ routeId):]{.s1}

[[            ]{.Apple-converted-space}navigationRouteId ]{.s1}[=]{.s9}[
routeId]{.s1}

[[            ]{.Apple-converted-space}showNavigationSheet
]{.s1}[=]{.s9}[ ]{.s1}[true]{.s11}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.weatherDetails:]{.s1}

[[            ]{.Apple-converted-space}selectedTab ]{.s1}[=]{.s9}[
]{.s1}[0]{.s11}

[[            ]{.Apple-converted-space}]{.s6}[*// Post to TodayView to
show details*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[
.]{.s1}[routePlanner]{.s9}[(]{.s1}[let]{.s8}[ mode):]{.s1}

[[            ]{.Apple-converted-space}selectedTab ]{.s1}[=]{.s9}[
]{.s1}[1]{.s11}

[[            ]{.Apple-converted-space}]{.s6}[*// Post to PlanTripView
to select mode*]{.s1}

[[            ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ .settings:]{.s1}

[[            ]{.Apple-converted-space}selectedTab ]{.s1}[=]{.s9}[
]{.s1}[4]{.s11}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s6}[*// Clear the deep link after
handling*]{.s1}

[[       
]{.Apple-converted-space}deepLinkHandler.]{.s1}[clearPendingDeepLink]{.s9}[()]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[]{.s1}\

[This completes the comprehensive implementation covering:]{.s3}

1.  [Widgets - Small, medium, large home screen widgets and lock screen
    widgets with timeline providers]{.s3}
2.  [Apple Watch - Companion app with glance views, transport details,
    complications, and WatchConnectivity]{.s3}
3.  [Push Notifications - Local and remote notification handling,
    categories with actions, deep linking, and background updates]{.s3}

[Would you like me to continue with any additional components such
as:]{.s3}

- [Unit and UI testing setup]{.s3}
- [Onboarding flow implementation]{.s3}
- [Settings/Preferences screens]{.s3}
- [Analytics integration]{.s3}

[Onboarding flow implementation]{.s7}[\
]{.s1}[Settings/Preferences screens]{.s7}[\
]{.s1}[Analytics integration]{.s7}

[This session is being continued from a previous conversation that ran
out of context. The summary below covers the earlier portion of the
conversation.]{.s7}

[Analysis:]{.s7}[\
]{.s1}[Let me chronologically analyze this extensive conversation about
building a CarPlay weather intelligence app called LiquidCrypto.]{.s7}

1.  [Initial Question: User asked what tool is needed to get an app onto
    iPhone]{.s7}
    - [I provided comprehensive info about Xcode, Apple Developer
      accounts, and CarPlay requirements]{.s7}
2.  [Project Structure Question: User asked about having a separate
    project from their LiquidCrypto project and how design
    guidelines/A2A server knowledge would transfer]{.s7}
    - [I recommended a monorepo approach with ios/ directory]{.s7}
    - [Outlined how knowledge transfers between TypeScript backend and
      Swift iOS app]{.s7}
    - [Proposed phased next steps]{.s7}
3.  [UX Concept Request: User asked me to \"ruminate\" on making a great
    user experience with examples like:]{.s7}
    - [Weather along navigation route]{.s7}
    - [Best day/hour to leave]{.s7}
    - [Real-time speech API integration (OpenAI Whisper, Google)]{.s7}
    - [Create comprehensive concept without coding]{.s7}
    - [Awareness that additional A2A servers could be created]{.s7}
4.  [I created an extensive concept document covering:]{.s7}
    - [Route weather timeline]{.s7}
    - [Departure time optimizer]{.s7}
    - [Conversational voice interface]{.s7}
    - [Proactive alerts]{.s7}
    - [Visual design (Liquid Glass in motion)]{.s7}
    - [Technical architecture with multiple A2A servers]{.s7}
    - [Voice technology comparison]{.s7}
    - [User journey map]{.s7}
    - [Privacy considerations]{.s7}
    - [MVP vs Full Vision phases]{.s7}
5.  [CarPlay UI Patterns Deep Dive: User asked specifically about
    CarPlay UI patterns]{.s7}[\
    ]{.s1}[I created detailed documentation on:]{.s7}
    - [CarPlay constraints and opportunities]{.s7}
    - [Screen anatomy and aspect ratios]{.s7}
    - [Core UI states (Home, Route Preview, Active Navigation, Weather
      Alert, Voice Active, Dashboard Widget)]{.s7}
    - [Liquid Glass design system for CarPlay (colors, typography,
      spacing, touch targets, corners)]{.s7}
    - [Component library (GlassCard, WeatherTimeline,
      RouteWeatherOverlay, DepartureOptimizer, VoiceInterface)]{.s7}
    - [Animation principles]{.s7}
    - [Accessibility and safety considerations]{.s7}
    - [Screen flow diagram]{.s7}
6.  [iOS Companion App Concept: User requested iOS companion app design
    with light version for non-CarPlay scenarios (bike, not connected to
    CarPlay)]{.s7}[\
    ]{.s1}[I created comprehensive concept covering:]{.s7}
    - [Three modes: Standalone, CarPlay Active (Companion),
      Background]{.s7}
    - [Tab structure (Today, Plan Trip, Week Ahead, Insights,
      Settings)]{.s7}
    - [Multi-modal transport support (car, bike, walk, transit)]{.s7}
    - [Voice interface in-app]{.s7}
    - [Widgets (small, medium, large, lock screen)]{.s7}
    - [Apple Watch integration]{.s7}
    - [Siri integration]{.s7}
    - [Onboarding flow]{.s7}
    - [iOS Design System]{.s7}
7.  [Voice Interaction Flow (Step 4): User requested this first]{.s7}[\
    ]{.s1}[I created detailed conversation trees for:]{.s7}
    - [Route weather queries]{.s7}
    - [Departure time optimization]{.s7}
    - [Transport mode decisions]{.s7}
    - [Forecast queries]{.s7}
    - [Reminders and actions]{.s7}
    - [Proactive conversations]{.s7}
    - [Context management]{.s7}
    - [Error handling]{.s7}
    - [Voice persona and tone]{.s7}
    - [CarPlay-specific voice patterns]{.s7}
8.  [A2A Server Architecture (Step 2): User requested this after voice
    flow]{.s7}[\
    ]{.s1}[I documented:]{.s7}
    - [System architecture overview]{.s7}
    - [Agent specifications for:]{.s7}
      - [Orchestrator Hub]{.s7}
      - [Weather Agent]{.s7}
      - [Traffic Agent]{.s7}
      - [Calendar Agent]{.s7}
      - [Route Intelligence Agent]{.s7}
      - [Voice Gateway Agent]{.s7}
      - [Pattern Learning Agent]{.s7}
    - [Data flow examples]{.s7}
    - [API contracts (REST and WebSocket)]{.s7}
    - [Infrastructure deployment architecture]{.s7}
    - [Cost estimates]{.s7}
9.  [Database Schema (1): First of user\'s \"1, 2, and then 3\"
    request]{.s7}
    - [PostgreSQL schema with tables for users, devices, locations,
      routes, trips, trip_weather, trip_events, user_preferences,
      user_patterns, reminders, alerts, calendar_connections,
      calendar_events, conversation_sessions, conversation_turns]{.s7}
    - [Redis schema for sessions, weather cache, traffic cache, rate
      limiting, user location, pub/sub]{.s7}
    - [Migrations and RLS policies]{.s7}
10. [A2A Protocol Details (2): Second part]{.s7}
    - [Agent Card JSON Schema]{.s7}
    - [Full agent cards for Orchestrator and Weather agents]{.s7}
    - [Task protocol (lifecycle, request/response)]{.s7}
    - [Streaming protocol (SSE)]{.s7}
    - [Inter-agent communication]{.s7}
    - [Agent registry and client]{.s7}
    - [Voice WebSocket protocol]{.s7}
11. [iOS App Technical Architecture (3): Third part]{.s7}
    - [Xcode project structure]{.s7}
    - [Core data models (Location, Weather, Route,
      TransportComparison)]{.s7}
    - [A2AClient Swift implementation]{.s7}
    - [VoiceService with WebSocket]{.s7}
    - [Design system components (GlassCard, WeatherTimeline,
      WeatherIcon, GlassButton)]{.s7}
    - [CarPlay integration (CarPlaySceneDelegate, CarPlayManager)]{.s7}
    - [App state management]{.s7}
    - [Main app entry point and ContentView]{.s7}
    - [TodayView and TodayViewModel]{.s7}
12. [Widgets, Watch, Push Notifications: User\'s second \"1, 2, and then
    3\" request]{.s7}
    - [Widget implementation (CommuteWidget, Lock Screen widgets,
      WidgetDataService)]{.s7}
    - [Apple Watch app (WatchAppState, views, complications)]{.s7}
    - [Push notification handling (NotificationService, AppDelegate,
      deep linking)]{.s7}
13. [Final Request: User asked for:]{.s7}
    - [Onboarding flow implementation]{.s7}
    - [Settings/Preferences screens]{.s7}
    - [Analytics integration]{.s7}
14. [Then immediately asked for a summary.]{.s7}

[The user\'s requests were conceptual/documentation focused - they
explicitly said \"don\'t code yet\" initially, then gradually moved into
implementation details. The project is about creating a CarPlay weather
intelligence app with voice interaction, proactive alerts, and
multi-modal transport recommendations.]{.s7}

[Summary:]{.s7}

[1. Primary Request and Intent]{.s7}

[The user is building LiquidCrypto, a CarPlay weather intelligence app
that:]{.s7}

- [Shows weather along navigation routes at the time you\'ll pass
  through each segment]{.s7}
- [Optimizes departure times based on weather, traffic, and
  calendar]{.s7}
- [Supports voice-first interaction for driving safety]{.s7}
- [Works across iOS, CarPlay, Apple Watch, and widgets]{.s7}
- [Supports multiple transport modes (car, bike, walk, transit)]{.s7}
- [Sends proactive alerts about weather changes]{.s7}

[The user explicitly requested:]{.s7}

1.  [Comprehensive UX concept with weather along routes, optimal
    departure times, real-time speech APIs]{.s7}
2.  [CarPlay UI patterns deep dive]{.s7}
3.  [iOS companion app concept (including \"light version\" when CarPlay
    not connected)]{.s7}
4.  [Voice interaction flow with conversation trees]{.s7}
5.  [A2A server architecture for multiple agents]{.s7}
6.  [Database schema (PostgreSQL + Redis)]{.s7}
7.  [A2A protocol details for inter-agent communication]{.s7}
8.  [iOS app technical architecture with SwiftUI code]{.s7}
9.  [Widget implementation]{.s7}
10. [Apple Watch app]{.s7}
11. [Push notification handling]{.s7}
12. [Onboarding flow implementation, Settings/Preferences screens,
    Analytics integration (most recent, not yet addressed)]{.s7}

[2. Key Technical Concepts]{.s7}

- [A2A Protocol: Agent-to-Agent communication based on Google\'s spec
  with custom extensions]{.s7}
- [CarPlay SDK: CPMapTemplate, CPListTemplate, CPNavigationAlert,
  CPVoiceControlTemplate]{.s7}
- [SwiftUI: Design system with GlassCard, WeatherTimeline
  components]{.s7}
- [Voice: OpenAI Realtime API, WebSocket streaming, STT/TTS]{.s7}
- [Multi-Agent Architecture: Orchestrator, Weather, Traffic, Calendar,
  Route Intel, Voice Gateway, Pattern Learning agents]{.s7}
- [Monorepo Structure: server/, ios/, shared/ directories]{.s7}
- [Liquid Glass Design System: Frosted glass effects, weather-tinted
  cards, 60pt touch targets]{.s7}
- [Route Weather Timeline: Weather at location×time intersections along
  route]{.s7}
- [Departure Optimizer: Scoring departure times by weather + traffic +
  constraints]{.s7}
- [WatchConnectivity: iPhone-Watch communication]{.s7}
- [WidgetKit: Timeline providers, App Groups for data sharing]{.s7}
- [Push Notifications: Categories with actions, silent push, deep
  linking]{.s7}

[3. Files and Code Sections]{.s7}

[Database Schema (PostgreSQL)]{.s7}

[Core tables designed for user data, trips, patterns, and real-time
state:]{.s7}

[\-- Users table with subscription tiers]{.s1}

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ users (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}auth_id [       
]{.Apple-converted-space}UUID ]{.s1}[UNIQUE]{.s8}[
]{.s1}[REFERENCES]{.s8}[ auth.users(id),]{.s1}

[[    ]{.Apple-converted-space}display_name[   
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[100]{.s11}[),]{.s1}

[[    ]{.Apple-converted-space}timezone[       
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[50]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'America/Los_Angeles\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}subscription_tier [ 
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[DEFAULT]{.s8}[ ]{.s1}[\'free\']{.s10}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\-- \...]{.s1}

[);]{.s1}

[]{.s1}\

[\-- Locations with PostGIS]{.s1}

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ locations (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id),]{.s1}

[[    ]{.Apple-converted-space}name[           
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[100]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}label [         
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[50]{.s11}[),
]{.s6}[\-- home, work, gym, custom]{.s1}

[[    ]{.Apple-converted-space}coordinates [   
]{.Apple-converted-space}GEOGRAPHY(]{.s1}[POINT]{.s8}[,
]{.s1}[4326]{.s11}[) ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\-- \...]{.s1}

[);]{.s1}

[]{.s1}\

[\-- Routes between locations]{.s1}

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ routes (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}origin_id [     
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[
locations(id),]{.s1}

[[    ]{.Apple-converted-space}destination_id[ 
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[
locations(id),]{.s1}

[[    ]{.Apple-converted-space}polyline[       
]{.Apple-converted-space}]{.s1}[TEXT]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}typical_duration_car_minutes[   
]{.Apple-converted-space}]{.s1}[INTEGER]{.s8}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\-- \...]{.s1}

[);]{.s1}

[]{.s1}\

[\-- Trip history with weather]{.s1}

[CREATE]{.s1}[ ]{.s6}[TABLE]{.s1}[ trips (]{.s6}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}route_id[       
]{.Apple-converted-space}UUID ]{.s1}[REFERENCES]{.s8}[ routes(id),]{.s1}

[[    ]{.Apple-converted-space}transport_mode[ 
]{.Apple-converted-space}]{.s1}[VARCHAR]{.s8}[(]{.s1}[20]{.s11}[)
]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}planned_departure_at[   
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}actual_arrival_at [     
]{.Apple-converted-space}TIMESTAMPTZ,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\-- \...]{.s1}

[);]{.s1}

[]{.s1}\

[\-- Learned patterns]{.s1}

[CREATE]{.s8}[ ]{.s1}[TABLE]{.s8}[ user_patterns (]{.s1}

[[    ]{.Apple-converted-space}id[             
]{.Apple-converted-space}UUID ]{.s1}[PRIMARY]{.s8}[ ]{.s1}[KEY]{.s8}[
]{.s1}[DEFAULT]{.s8}[ gen_random_uuid(),]{.s1}

[[    ]{.Apple-converted-space}user_id [       
]{.Apple-converted-space}UUID ]{.s1}[NOT]{.s9}[ ]{.s1}[NULL]{.s11}[
]{.s1}[REFERENCES]{.s8}[ users(id),]{.s1}

[[    ]{.Apple-converted-space}pattern_type[   
]{.Apple-converted-space}]{.s6}[VARCHAR]{.s8}[(]{.s6}[50]{.s11}[)
]{.s6}[NOT]{.s9}[ ]{.s6}[NULL]{.s11}[, ]{.s6}[\-- commute_schedule,
transport_preference]{.s1}

[[    ]{.Apple-converted-space}pattern_data[   
]{.Apple-converted-space}JSONB ]{.s1}[NOT]{.s9}[
]{.s1}[NULL]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}confidence[     
]{.Apple-converted-space}]{.s1}[DECIMAL]{.s8}[(]{.s1}[3]{.s11}[,
]{.s1}[2]{.s11}[) ]{.s1}[DEFAULT]{.s8}[ ]{.s1}[0.5]{.s11}[,]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[\-- \...]{.s1}

[);]{.s1}

[]{.s1}\

[A2A Agent Card Schema]{.s7}

[{]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"liquidcrypto-orchestrator\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"version\"]{.s1}[:]{.s9}[
]{.s6}[\"1.0.0\"]{.s10}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"url\"]{.s5}[:]{.s9}[
]{.s6}[\"https://api.liquidcrypto.app/a2a\"]{.s1}[,]{.s6}

[[  ]{.Apple-converted-space}]{.s6}[\"capabilities\"]{.s1}[:]{.s9}[
{]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"streaming\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[   
]{.Apple-converted-space}]{.s6}[\"pushNotifications\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"stateManagement\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}[,]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[\"multiModal\"]{.s1}[:]{.s9}[
]{.s6}[true]{.s11}

[[  ]{.Apple-converted-space}},]{.s1}

[[  ]{.Apple-converted-space}]{.s6}[\"skills\"]{.s1}[:]{.s9}[ \[]{.s6}

[[    ]{.Apple-converted-space}{]{.s1}

[[      ]{.Apple-converted-space}]{.s6}[\"id\"]{.s5}[:]{.s9}[
]{.s6}[\"route-weather\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"name\"]{.s5}[:]{.s9}[
]{.s6}[\"Route Weather Query\"]{.s1}[,]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"inputSchema\"]{.s5}[:]{.s9}[ {
]{.s6}[/\* JSON Schema \*/]{.s1}[ },]{.s6}

[[      ]{.Apple-converted-space}]{.s6}[\"outputSchema\"]{.s5}[:]{.s9}[
{ ]{.s6}[/\* JSON Schema \*/]{.s1}[ }]{.s6}

[[    ]{.Apple-converted-space}}]{.s1}

[[  ]{.Apple-converted-space}\]]{.s1}

[}]{.s1}

[]{.s1}\

[Swift A2AClient]{.s7}

[actor]{.s8}[ ]{.s6}[A2AClient]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[private]{.s8}[ ]{.s1}[let]{.s8}[
baseURL: ]{.s1}[URL]{.s11}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getRouteWeather]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}departureTime: ]{.s1}[Date]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[Date]{.s11}[(),]{.s1}

[[        ]{.Apple-converted-space}transportMode:
]{.s1}[Route]{.s11}[.]{.s1}[TransportMode]{.s11}[ ]{.s1}[=]{.s9}[
.car]{.s1}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s8}[
]{.s6}[throws]{.s8}[ ]{.s6}[-\>]{.s9}[ ]{.s6}[RouteWeatherResult]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[RouteWeatherRequest]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}origin: origin,]{.s1}

[[            ]{.Apple-converted-space}destination: destination,]{.s1}

[[            ]{.Apple-converted-space}departureTime:
departureTime.]{.s1}[ISO8601Format]{.s11}[(),]{.s1}

[[            ]{.Apple-converted-space}transportMode:
transportMode.rawValue]{.s1}

[[        ]{.Apple-converted-space})]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[ ]{.s1}[post]{.s9}[(endpoint:
]{.s1}[\"/route/weather\"]{.s10}[, body: request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[optimizeDeparture]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}origin:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[LocationInput]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}arriveBy: ]{.s1}[Date]{.s11}[?]{.s9}[
]{.s1}[=]{.s9}[ ]{.s1}[nil]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}preferences:
]{.s1}[DeparturePreferences]{.s11}[ ]{.s1}[=]{.s9}[
.]{.s1}[init]{.s8}[()]{.s1}

[[    ]{.Apple-converted-space}) ]{.s1}[async]{.s8}[
]{.s1}[throws]{.s8}[ ]{.s1}[-\>]{.s9}[
\[]{.s1}[DepartureOption]{.s11}[\] { ]{.s1}[/\* \... \*/]{.s13}[ }]{.s1}

[}]{.s1}

[]{.s1}\

[VoiceService with WebSocket]{.s7}

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[VoiceService]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ state: ]{.s1}[VoiceState]{.s11}[ ]{.s1}[=]{.s9}[
.idle]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ partialTranscript: ]{.s1}[String]{.s11}[
]{.s1}[=]{.s9}[ ]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}[\@Published]{.s11}[
]{.s1}[var]{.s8}[ responseText: ]{.s1}[String]{.s11}[ ]{.s1}[=]{.s9}[
]{.s1}[\"\"]{.s10}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[enum]{.s8}[
]{.s6}[VoiceState]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[case]{.s8}[ idle, connecting,
listening, processing, speaking, error]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s1}[
]{.s6}[startSession]{.s9}[() ]{.s6}[async]{.s1}[ ]{.s6}[throws]{.s1}[
{]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[
]{.s6}[configureAudioSession]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[ ]{.s6}[await]{.s8}[
]{.s6}[connectWebSocket]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[try]{.s8}[
]{.s6}[startAudioCapture]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}state ]{.s1}[=]{.s9}[
.listening]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[private]{.s1}[ ]{.s6}[func]{.s1}[
]{.s6}[connectWebSocket]{.s9}[() ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[var]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[URLRequest]{.s11}[(url: baseURL)]{.s1}

[[       
]{.Apple-converted-space}request.]{.s1}[setValue]{.s9}[(]{.s1}[\"Bearer
]{.s10}[\\(authToken)]{.s1}[\"]{.s10}[, forHTTPHeaderField:
]{.s1}[\"Authorization\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}webSocket ]{.s1}[=]{.s9}[
]{.s1}[URLSession]{.s11}[.shared.]{.s1}[webSocketTask]{.s9}[(with:
request)]{.s1}

[[       
]{.Apple-converted-space}webSocket]{.s1}[?]{.s9}[.]{.s1}[resume]{.s9}[()]{.s1}

[[       
]{.Apple-converted-space}]{.s6}[sendMessage]{.s1}[(]{.s6}[VoiceMessage]{.s11}[.]{.s6}[sessionStart]{.s1}[(config:
.]{.s6}[init]{.s8}[(]{.s6}

[[            ]{.Apple-converted-space}inputFormat:
]{.s1}[\"pcm_16khz_mono\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}outputFormat:
]{.s1}[\"pcm_24khz_mono\"]{.s10}[,]{.s1}

[[            ]{.Apple-converted-space}vadEnabled:
]{.s1}[true]{.s11}[,]{.s1}

[[            ]{.Apple-converted-space}interruptEnabled:
]{.s1}[true]{.s11}

[[        ]{.Apple-converted-space})))]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Design System - GlassCard]{.s7}

[struct]{.s8}[ ]{.s6}[GlassCard]{.s1}[\<]{.s9}[Content]{.s1}[:
]{.s6}[View]{.s1}[\>]{.s9}[: ]{.s6}[View]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[let]{.s8}[ variant:
]{.s1}[Variant]{.s11}

[[    ]{.Apple-converted-space}]{.s6}[let]{.s8}[ weatherTint:
]{.s6}[WeatherCondition]{.s1}[.]{.s6}[WeatherType]{.s1}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s6}[\@ViewBuilder]{.s1}[
]{.s6}[let]{.s8}[ content: ]{.s6}[Content]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[enum]{.s8}[ ]{.s1}[Variant]{.s11}[
{ ]{.s1}[case]{.s8}[ \`]{.s1}[default]{.s8}[\`, elevated, tinted }]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[var]{.s8}[ body:
]{.s1}[some]{.s8}[ ]{.s1}[View]{.s11}[ {]{.s1}

[[        ]{.Apple-converted-space}content]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[padding]{.s9}[(]{.s1}[16]{.s11}[)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[background]{.s9}[(backgroundView)]{.s1}

[[           
]{.Apple-converted-space}.]{.s1}[clipShape]{.s9}[(]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[16]{.s11}[, style: .continuous))]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[overlay]{.s9}[(]{.s1}

[[               
]{.Apple-converted-space}]{.s1}[RoundedRectangle]{.s11}[(cornerRadius:
]{.s1}[16]{.s11}[, style: .continuous)]{.s1}

[[                   
]{.Apple-converted-space}.]{.s1}[stroke]{.s9}[(]{.s1}[Color]{.s11}[.white.]{.s1}[opacity]{.s9}[(]{.s1}[0.1]{.s11}[),
lineWidth: ]{.s1}[1]{.s11}[)]{.s1}

[[            ]{.Apple-converted-space})]{.s1}

[[            ]{.Apple-converted-space}.]{.s1}[shadow]{.s9}[(color:
shadowColor, radius: shadowRadius)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[CarPlayManager]{.s7}

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[CarPlayManager]{.s1}[:
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s1}[weak]{.s8}[ ]{.s1}[var]{.s8}[
interfaceController: ]{.s1}[CPInterfaceController]{.s11}[?]{.s9}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[createHomeTemplate]{.s1}[() ]{.s6}[-\>]{.s1}[
]{.s6}[CPTemplate]{.s11}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ mapTemplate
]{.s1}[=]{.s9}[ ]{.s1}[CPMapTemplate]{.s11}[()]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ voiceButton
]{.s1}[=]{.s9}[ ]{.s1}[CPMapButton]{.s11}[ { \[]{.s1}[weak]{.s8}[
]{.s1}[self]{.s8}[\] ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[           
]{.Apple-converted-space}]{.s6}[self]{.s8}[?]{.s1}[.]{.s6}[startVoiceInteraction]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}}]{.s1}

[[        ]{.Apple-converted-space}voiceButton.image ]{.s1}[=]{.s9}[
]{.s1}[UIImage]{.s11}[(systemName: ]{.s1}[\"mic.fill\"]{.s10}[)]{.s1}

[[        ]{.Apple-converted-space}mapTemplate.mapButtons
]{.s1}[=]{.s9}[ \[voiceButton, searchButton\]]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[return]{.s8}[
mapTemplate]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}

[[    ]{.Apple-converted-space}]{.s1}[func]{.s8}[
]{.s1}[showWeatherAlert]{.s9}[(transition:
]{.s1}[WeatherTransition]{.s11}[) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ alert
]{.s1}[=]{.s9}[ ]{.s1}[CPNavigationAlert]{.s11}[(]{.s1}

[[            ]{.Apple-converted-space}titleVariants: \[]{.s1}[\"Weather
Change Ahead\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}subtitleVariants:
\[]{.s1}[\"]{.s10}[\\(transition.to.rawValue.capitalized)]{.s1}[ in
]{.s10}[\\(transition.locationDescription ]{.s1}[??]{.s9}[
]{.s1}[\"ahead\"]{.s10}[)]{.s1}[\"]{.s10}[\],]{.s1}

[[            ]{.Apple-converted-space}image:
]{.s1}[createWeatherImage]{.s9}[(transition.to.icon),]{.s1}

[[            ]{.Apple-converted-space}primaryAction:
]{.s1}[CPAlertAction]{.s11}[(title: ]{.s1}[\"OK\"]{.s10}[, style:
.]{.s1}[default]{.s8}[) { ]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}[ },]{.s1}

[[            ]{.Apple-converted-space}secondaryAction:
]{.s1}[CPAlertAction]{.s11}[(title: ]{.s1}[\"Details\"]{.s10}[, style:
.]{.s1}[default]{.s8}[) { \[]{.s1}[weak]{.s8}[ ]{.s1}[self]{.s8}[\]
]{.s1}[\_]{.s8}[ ]{.s1}[in]{.s8}

[[               
]{.Apple-converted-space}]{.s1}[self]{.s8}[?]{.s9}[.]{.s1}[speakWeatherDetails]{.s9}[(transition:
transition)]{.s1}

[[            ]{.Apple-converted-space}},]{.s1}

[[            ]{.Apple-converted-space}duration: ]{.s1}[10]{.s11}

[[        ]{.Apple-converted-space})]{.s1}

[[       
]{.Apple-converted-space}mapTemplate.]{.s1}[present]{.s9}[(navigationAlert:
alert, animated: ]{.s1}[true]{.s11}[)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[Widget Timeline Provider]{.s7}

[struct]{.s8}[ ]{.s6}[CommuteProvider]{.s1}[:
]{.s6}[IntentTimelineProvider]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[getTimeline]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}]{.s1}[for]{.s8}[ configuration:
]{.s1}[SelectCommuteIntent]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[in]{.s8}[ context:
]{.s1}[Context]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}completion: ]{.s6}[\@escaping]{.s1}[
(]{.s6}[Timeline]{.s1}[\<]{.s9}[CommuteEntry]{.s1}[\>]{.s9}[)
]{.s6}[-\>]{.s9}[ ]{.s6}[Void]{.s1}

[[    ]{.Apple-converted-space}) {]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[Task]{.s11}[ {]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ entry
]{.s1}[=]{.s9}[ ]{.s1}[await]{.s8}[
]{.s1}[fetchCommuteData]{.s9}[(]{.s1}[for]{.s8}[: configuration)]{.s1}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ nextUpdate
]{.s1}[=]{.s9}[
]{.s1}[Calendar]{.s11}[.current.]{.s1}[date]{.s9}[(byAdding: .minute,
value: ]{.s1}[15]{.s11}[, to: ]{.s1}[Date]{.s11}[())]{.s1}[!]{.s9}

[[            ]{.Apple-converted-space}]{.s1}[let]{.s8}[ timeline
]{.s1}[=]{.s9}[ ]{.s1}[Timeline]{.s11}[(entries: \[entry\], policy:
.]{.s1}[after]{.s9}[(nextUpdate))]{.s1}

[[           
]{.Apple-converted-space}]{.s1}[completion]{.s9}[(timeline)]{.s1}

[[        ]{.Apple-converted-space}}]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[NotificationService]{.s7}

[\@MainActor]{.s1}

[class]{.s8}[ ]{.s6}[NotificationService]{.s1}[: ]{.s6}[NSObject]{.s1}[,
]{.s6}[ObservableObject]{.s1}[ {]{.s6}

[[    ]{.Apple-converted-space}]{.s6}[func]{.s8}[
]{.s6}[scheduleDepartureReminder]{.s1}[(]{.s6}

[[        ]{.Apple-converted-space}at time: ]{.s1}[Date]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}destination:
]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}message: ]{.s1}[String]{.s11}[,]{.s1}

[[        ]{.Apple-converted-space}routeId: ]{.s1}[String]{.s11}

[[    ]{.Apple-converted-space}) ]{.s6}[async]{.s1}[
]{.s6}[throws]{.s1}[ {]{.s6}

[[        ]{.Apple-converted-space}]{.s6}[let]{.s8}[ content
]{.s6}[=]{.s9}[ ]{.s6}[UNMutableNotificationContent]{.s1}[()]{.s6}

[[        ]{.Apple-converted-space}content.title ]{.s1}[=]{.s9}[
]{.s1}[\"Time to Leave\"]{.s10}

[[        ]{.Apple-converted-space}content.subtitle ]{.s1}[=]{.s9}[
]{.s1}[\"To ]{.s10}[\\(destination)]{.s1}[\"]{.s10}

[[        ]{.Apple-converted-space}content.body ]{.s1}[=]{.s9}[
message]{.s1}

[[        ]{.Apple-converted-space}content.categoryIdentifier
]{.s1}[=]{.s9}[ ]{.s1}[\"DEPARTURE_ALERT\"]{.s10}

[[        ]{.Apple-converted-space}content.interruptionLevel
]{.s1}[=]{.s9}[ .timeSensitive]{.s1}

[[        ]{.Apple-converted-space}]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ trigger
]{.s1}[=]{.s9}[
]{.s1}[UNCalendarNotificationTrigger]{.s11}[(dateMatching: components,
repeats: ]{.s1}[false]{.s11}[)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[let]{.s8}[ request
]{.s1}[=]{.s9}[ ]{.s1}[UNNotificationRequest]{.s11}[(identifier:
]{.s1}[\"departure\_]{.s10}[\\(routeId)]{.s1}[\"]{.s10}[, content:
content, trigger: trigger)]{.s1}

[[        ]{.Apple-converted-space}]{.s1}[try]{.s8}[ ]{.s1}[await]{.s8}[
center.]{.s1}[add]{.s9}[(request)]{.s1}

[[    ]{.Apple-converted-space}}]{.s1}

[}]{.s1}

[]{.s1}\

[4. Errors and Fixes]{.s7}

[No runtime errors encountered - this was a design/documentation
session, not implementation/debugging.]{.s7}

[5. Problem Solving]{.s7}

- [Project structure: Solved by recommending monorepo with ios/
  directory alongside existing server/]{.s7}
- [Knowledge transfer: Solved with shared/ directory for API types,
  generated Swift from TypeScript]{.s7}
- [CarPlay UI constraints: Worked within Apple\'s template-based system
  while maximizing visual impact with Liquid Glass]{.s7}
- [Voice while driving: Designed shorter, more direct responses for
  CarPlay mode vs stationary]{.s7}
- [Multi-modal transport: Created comparison views that show weather
  suitability per mode]{.s7}
- [Background updates: Silent push + WidgetKit timeline providers +
  WatchConnectivity]{.s7}

[6. All User Messages]{.s7}

1.  [\"what tool do i need to get the app onto my iphone?\"]{.s7}
2.  [\"would i have a separate project from my current LiquidCrytro
    Project? How my my design guidelines and all nowledge about by a2a
    server get to the new project? What next steps would you
    propose?\"]{.s7}
3.  [\"before that, maybe ruminate on how to make this a really great
    user experience. e.g. show weather along a navigation route or a
    simulated navigation route. where it tells you what day or our best
    to lave. also, we may want to integrate a realtiem speech api?
    openai whisper or sometjign similar from google? just create. a
    comprehensive concept, don\'t code yet. also be aware, that we can
    create additional a2a servers if needed\"]{.s7}
4.  [\"the carplay ui patterns\"]{.s7}
5.  [\"Design the iOS companion app . don\'t yet, just create the
    comprhensive concept. also a ligt version, in case carplay is not
    activated yet. (e.g. if i use a biek today or are not connect to my
    carplay yet).\"]{.s7}
6.  [\"Ste 4 and then and then Step 2\" (requesting Voice Interaction
    Flow then A2A Architecture)]{.s7}
7.  [\"let\'s do 1,2 and then 3\" (requesting Database Schema, A2A
    Protocol, iOS App Architecture)]{.s7}
8.  [\"let\'s do 1,2 and then 3\" (requesting Widgets, Watch App, Push
    Notifications)]{.s7}
9.  [\"Onboarding flow implementation Settings/Preferences screens
    Analytics integration\" followed by summary request]{.s7}

[7. Pending Tasks]{.s7}

[User explicitly requested but not yet addressed:]{.s7}

1.  [Onboarding flow implementation - SwiftUI screens for first-run
    experience]{.s7}
2.  [Settings/Preferences screens - Full settings UI
    implementation]{.s7}
3.  [Analytics integration - Event tracking, user behavior
    analytics]{.s7}

[8. Current Work]{.s7}

[The conversation had just completed comprehensive documentation and
code for:]{.s7}

- [Widgets (CommuteWidget, Lock Screen widgets, WidgetDataService)]{.s7}
- [Apple Watch app (WatchAppState, CommuteGlanceView,
  Complications)]{.s7}
- [Push Notifications (NotificationService, AppDelegate,
  DeepLinkHandler)]{.s7}

[The user then requested three more items:]{.s7}

[\"Onboarding flow implementation Settings/Preferences screens Analytics
integration\"]{.s7}

[Immediately after that request, the user asked for this summary, so
these three items have NOT been implemented yet.]{.s7}

[9. Optional Next Step]{.s7}

[Based on the user\'s most recent explicit request:]{.s7}

[\"Onboarding flow implementation Settings/Preferences screens Analytics
integration\"]{.s7}

[The next step would be to implement:]{.s7}

1.  [Onboarding flow - Multi-screen SwiftUI onboarding with:]{.s7}
    - [Welcome/value proposition]{.s7}
    - [Location permission request]{.s7}
    - [Commute setup (home/work)]{.s7}
    - [Transport mode preferences]{.s7}
    - [Notification permission]{.s7}
    - [Calendar integration (optional)]{.s7}
    - [Completion screen]{.s7}

[This directly follows the user\'s request and the established pattern
of comprehensive SwiftUI implementations with the Liquid Glass design
system.]{.s7}

[If you need specific details from before compaction (like exact code
snippets, error messages, or content you generated), read the full
transcript at:
/Users/mario/.claude/projects/-Users-mario\--claude-worktrees-LiquidCrypto-stoic-bouman/8251e33f-02de-4237-8968-e38569434e80.jsonl]{.s7}[\
]{.s1}[Please continue the conversation from where we left it off
without asking the user any further questions. Continue with the last
task that you were asked to work on.]{.s7}

[]{.s1}\

[Show more]{.s1}

[]{.s1}\

[I\'ll continue with implementing the three items you requested:
Onboarding flow, Settings/Preferences screens, and Analytics
integration.]{.s3}

[Let me first check the current project structure to understand where
these should be placed.]{.s3}

[]{.s1}\

[Found 3 patterns]{.s3}

[]{.s1}\

[The iOS app hasn\'t been created yet in this codebase - the previous
session was focused on comprehensive conceptual documentation. Let me
check what documentation exists from the previous conversation.]{.s3}

[]{.s1}\

[Found 2 patterns]{.s3}

[]{.s1}\

[Bash]{.s3}

[ls -la /Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/]{.s3}

[-rw-r\--r\--@[  ]{.Apple-converted-space}1 mario[ 
]{.Apple-converted-space}staff[    ]{.Apple-converted-space}1567 Jan 20
09:49 vite.lib.config.ts]{.s1}

[-rw-r\--r\--@[  ]{.Apple-converted-space}1 mario[ 
]{.Apple-converted-space}staff[    ]{.Apple-converted-space}1535 Jan 20
09:49 vitest.config.ts]{.s1}

[-rw-r\--r\--@[  ]{.Apple-converted-space}1 mario[ 
]{.Apple-converted-space}staff[      ]{.Apple-converted-space}52 Jan 20
09:49 vitest.shims.d.ts]{.s3}

[\... +69 lines]{.s3}

[]{.s1}\

[]{.s1}\

[I can see this is a TypeScript/React project with an existing Liquid
Glass design system. The previous conversation was focused on conceptual
documentation for the iOS CarPlay weather app. Since no iOS directory
exists yet, I\'ll create the comprehensive Swift implementation
documentation for the three requested features: Onboarding flow,
Settings/Preferences screens, and Analytics integration.]{.s3}

[]{.s1}\

[Update Todos]{.s3}

[]{.s1}\

[ Creating Onboarding flow implementation]{.s21}[ Create
Settings/Preferences screens implementation Create Analytics integration
implementation]{.s3}

[]{.s1}\

[Let me create the iOS app structure with the three requested
implementations. I\'ll create an ]{.s3}[ios/]{.s4}[ directory with the
complete SwiftUI implementation.]{.s3}

[]{.s1}\

[Bash]{.s3}

[mkdir -p
/Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/ios/LiquidWeather/Sources/{App,Features/{Onboarding,Settings},Services/Analytics,Design}]{.s3}

[(No content)]{.s3}

[]{.s1}\

[Write]{.s3}

[/Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/ios/LiquidWeather/Sources/Features/Onboarding/OnboardingView.swift]{.s3}

[import SwiftUI]{.s22}

[import CoreLocation]{.s22}

[ ]{.s22}

[// MARK: - Onboarding Coordinator]{.s22}

[ ]{.s22}

[\@MainActor]{.s22}

[class OnboardingCoordinator: ObservableObject {]{.s22}

[[    ]{.Apple-converted-space}\@Published var currentStep:
OnboardingStep = .welcome]{.s22}

[[    ]{.Apple-converted-space}\@Published var isComplete = false]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}// Collected data]{.s22}

[[    ]{.Apple-converted-space}\@Published var homeLocation:
SavedLocation?]{.s22}

[[    ]{.Apple-converted-space}\@Published var workLocation:
SavedLocation?]{.s22}

[[    ]{.Apple-converted-space}\@Published var preferredTransportModes:
Set\<TransportMode\> = \[.car\]]{.s22}

[[    ]{.Apple-converted-space}\@Published var notificationsEnabled =
false]{.s22}

[[    ]{.Apple-converted-space}\@Published var calendarConnected =
false]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}private let locationService:
LocationService]{.s22}

[[    ]{.Apple-converted-space}private let analyticsService:
AnalyticsService]{.s22}

[[    ]{.Apple-converted-space}private let userDefaults:
UserDefaults]{.s22}

[Show full diff (1651 more lines)]{.s1}

[]{.s1}\

[Update Todos]{.s3}

[]{.s1}\

[ Create Onboarding flow implementation (SwiftUI)]{.s23}[ Creating
Settings/Preferences screens]{.s21}[ Create Analytics integration
implementation]{.s3}

[]{.s1}\

[Write]{.s3}

[/Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/ios/LiquidWeather/Sources/Features/Settings/SettingsView.swift]{.s3}

[import SwiftUI]{.s22}

[import EventKit]{.s22}

[import UserNotifications]{.s22}

[ ]{.s22}

[// MARK: - Settings View Model]{.s22}

[ ]{.s22}

[\@MainActor]{.s22}

[class SettingsViewModel: ObservableObject {]{.s22}

[[    ]{.Apple-converted-space}// MARK: - Locations]{.s22}

[[    ]{.Apple-converted-space}\@Published var homeLocation:
SavedLocation?]{.s22}

[[    ]{.Apple-converted-space}\@Published var workLocation:
SavedLocation?]{.s22}

[[    ]{.Apple-converted-space}\@Published var savedLocations:
\[SavedLocation\] = \[\]]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}// MARK: - Transport]{.s22}

[[    ]{.Apple-converted-space}\@Published var preferredTransportModes:
Set\<TransportMode\> = \[.car\]]{.s22}

[[    ]{.Apple-converted-space}\@Published var defaultTransportMode:
TransportMode = .car]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}// MARK: - Weather Preferences]{.s22}

[[    ]{.Apple-converted-space}\@Published var temperatureUnit:
TemperatureUnit = .fahrenheit]{.s22}

[[    ]{.Apple-converted-space}\@Published var windSpeedUnit:
WindSpeedUnit = .mph]{.s22}

[Show full diff (1364 more lines)]{.s1}

[]{.s1}\

[Update Todos]{.s3}

[]{.s1}\

[ Create Onboarding flow implementation (SwiftUI) Create
Settings/Preferences screens implementation]{.s23}[ Creating Analytics
integration]{.s21}

[]{.s1}\

[Write]{.s3}

[/Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/ios/LiquidWeather/Sources/Services/Analytics/AnalyticsService.swift]{.s3}

[import Foundation]{.s22}

[import OSLog]{.s22}

[ ]{.s22}

[// MARK: - Analytics Event Types]{.s22}

[ ]{.s22}

[enum AnalyticsEvent {]{.s22}

[[    ]{.Apple-converted-space}// Onboarding Events]{.s22}

[[    ]{.Apple-converted-space}case onboardingStarted]{.s22}

[[    ]{.Apple-converted-space}case onboardingStepCompleted(step:
String)]{.s22}

[[    ]{.Apple-converted-space}case onboardingStepSkipped(step:
String)]{.s22}

[[    ]{.Apple-converted-space}case onboardingCompleted(homeSet: Bool,
workSet: Bool, transportModes: \[String\], notificationsEnabled: Bool,
calendarConnected: Bool)]{.s22}

[[    ]{.Apple-converted-space}case onboardingAbandoned(lastStep:
String)]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}// Session Events]{.s22}

[[    ]{.Apple-converted-space}case appLaunched(isFirstLaunch:
Bool)]{.s22}

[[    ]{.Apple-converted-space}case appForegrounded]{.s22}

[[    ]{.Apple-converted-space}case appBackgrounded]{.s22}

[[    ]{.Apple-converted-space}case sessionStarted(sessionId:
String)]{.s22}

[[    ]{.Apple-converted-space}case sessionEnded(duration:
TimeInterval)]{.s22}

[ ]{.s22}

[Show full diff (771 more lines)]{.s1}

[]{.s1}\

[Now let me create the supporting services and the main app entry point
that ties everything together.]{.s3}

[]{.s1}\

[Write]{.s3}

[/Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/ios/LiquidWeather/Sources/Services/LocationService.swift]{.s3}

[import Foundation]{.s22}

[import CoreLocation]{.s22}

[import Combine]{.s22}

[ ]{.s22}

[\@MainActor]{.s22}

[final class LocationService: NSObject, ObservableObject {]{.s22}

[[    ]{.Apple-converted-space}static let shared =
LocationService()]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}\@Published var currentLocation:
CLLocation?]{.s22}

[[    ]{.Apple-converted-space}\@Published var authorizationStatus:
CLAuthorizationStatus = .notDetermined]{.s22}

[[    ]{.Apple-converted-space}\@Published var isLoading = false]{.s22}

[[    ]{.Apple-converted-space}\@Published var error: Error?]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}private let locationManager =
CLLocationManager()]{.s22}

[[    ]{.Apple-converted-space}private var locationContinuation:
CheckedContinuation\<CLLocation, Error\>?]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}override init() {]{.s22}

[[        ]{.Apple-converted-space}super.init()]{.s22}

[[        ]{.Apple-converted-space}locationManager.delegate =
self]{.s22}

[[        ]{.Apple-converted-space}locationManager.desiredAccuracy =
kCLLocationAccuracyBest]{.s22}

[Show full diff (63 more lines)]{.s1}

[]{.s1}\

[Write]{.s3}

[/Users/mario/.claude-worktrees/LiquidCrypto/stoic-bouman/ios/LiquidWeather/Sources/App/LiquidWeatherApp.swift]{.s3}

[import SwiftUI]{.s22}

[ ]{.s22}

[\@main]{.s22}

[struct LiquidWeatherApp: App {]{.s22}

[[   
]{.Apple-converted-space}\@UIApplicationDelegateAdaptor(AppDelegate.self)
var appDelegate]{.s22}

[[    ]{.Apple-converted-space}\@StateObject private var appState =
AppState()]{.s22}

[[    ]{.Apple-converted-space}\@Environment(\\.scenePhase) private var
scenePhase]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}private let startupTime = Date()]{.s22}

[ ]{.s22}

[[    ]{.Apple-converted-space}var body: some Scene {]{.s22}

[[        ]{.Apple-converted-space}WindowGroup {]{.s22}

[[            ]{.Apple-converted-space}RootView()]{.s22}

[[               
]{.Apple-converted-space}.environmentObject(appState)]{.s22}

[[                ]{.Apple-converted-space}.onAppear {]{.s22}

[[                    ]{.Apple-converted-space}trackStartup()]{.s22}

[[                ]{.Apple-converted-space}}]{.s22}

[[        ]{.Apple-converted-space}}]{.s22}

[[        ]{.Apple-converted-space}.onChange(of: scenePhase) { \_,
newPhase in]{.s22}

[[            ]{.Apple-converted-space}handleScenePhase(newPhase)]{.s22}

[Show full diff (329 more lines)]{.s1}

[]{.s1}\

[Update Todos]{.s3}

[]{.s1}\

[ Create Onboarding flow implementation (SwiftUI) Create
Settings/Preferences screens implementation Create Analytics integration
implementation]{.s23}

[]{.s1}\

[All three implementations are complete. Here\'s a summary of what was
created:]{.s3}

[Implementation Summary]{.s3}

[1. Onboarding Flow
(]{.s24}[ios/LiquidWeather/Sources/Features/Onboarding/OnboardingView.swift]{.s3}[)]{.s24}

[A complete multi-step onboarding experience with:]{.s3}

- [OnboardingCoordinator: Manages state across all steps, collects user
  data, tracks analytics]{.s3}
- [8 Onboarding Steps:]{.s3}
  - [Welcome - App introduction with feature highlights]{.s3}
  - [Location Permission - Request location access with status
    indicator]{.s3}
  - [Home Setup - Location search with autocomplete]{.s3}
  - [Work Setup - Same pattern for work location]{.s3}
  - [Transport Modes - Multi-select grid for car/bike/walk/transit]{.s3}
  - [Notifications - Permission request with preview of notification
    types]{.s3}
  - [Calendar - Optional calendar integration]{.s3}
  - [Complete - Success screen with confetti animation and setup
    summary]{.s3}
- [UI Components:]{.s3}
  - [OnboardingBackground]{.s4}[ - Animated gradient that changes per
    step]{.s3}
  - [OnboardingProgressBar]{.s4}[ - Shows completion progress]{.s3}
  - [GlassButton]{.s4}[ - Liquid Glass styled button]{.s3}
  - [LocationSearchField]{.s4}[ - Address search with results
    dropdown]{.s3}
  - [ConfettiView]{.s4}[ - Celebration animation on completion]{.s3}

[2. Settings/Preferences
(]{.s24}[ios/LiquidWeather/Sources/Features/Settings/SettingsView.swift]{.s3}[)]{.s24}

[Comprehensive settings with 10 sections:]{.s3}

- [Account - Sign in/out, subscription tier badge, upgrade option]{.s3}
- [Locations - Home/Work with picker, saved locations list]{.s3}
- [Transport - Mode selection with weather sensitivity info]{.s3}
- [Weather Display - Units (temp, wind, precipitation), display
  toggles]{.s3}
- [Notifications - Master toggle, notification types, quiet hours, lead
  time]{.s3}
- [Calendar - Connection status, event filtering options]{.s3}
- [Appearance - Theme, map style, animations, haptics]{.s3}
- [CarPlay - Enable/disable, voice control, simplified UI]{.s3}
- [Privacy - Analytics opt-in/out, crash reports, data deletion]{.s3}
- [About - What\'s new, help, legal, version]{.s3}

[3. Analytics Integration
(]{.s24}[ios/LiquidWeather/Sources/Services/Analytics/AnalyticsService.swift]{.s3}[)]{.s24}

[Production-ready analytics system:]{.s3}

- [60+ Event Types covering:]{.s3}
  - [Onboarding funnel]{.s3}
  - [Session lifecycle]{.s3}
  - [Screen/navigation tracking]{.s3}
  - [Weather feature usage]{.s3}
  - [Voice interactions]{.s3}
  - [CarPlay events]{.s3}
  - [Widget/Watch events]{.s3}
  - [Notifications]{.s3}
  - [Settings changes]{.s3}
  - [Errors and performance]{.s3}
- [Multiple Providers:]{.s3}
  - [Firebase Analytics]{.s3}
  - [Mixpanel]{.s3}
  - [PostHog]{.s3}
  - [Console (debug)]{.s3}
- [Features:]{.s3}
  - [Event batching with queue]{.s3}
  - [Automatic flush timer]{.s3}
  - [User properties (device, locale, subscription)]{.s3}
  - [Performance tracking (startup, screen load, API response
    times)]{.s3}
  - [SwiftUI ]{.s3}[.trackScreen()]{.s4}[ modifier]{.s3}

[Supporting Files]{.s3}

- [LocationService.swift]{.s4}[ - Core Location wrapper with
  async/await]{.s3}
- [LiquidWeatherApp.swift]{.s4}[ - Main app entry point with:]{.s3}
  - [AppDelegate for push notifications]{.s3}
  - [AppState for global state]{.s3}
  - [Tab-based navigation]{.s3}
  - [Deep link handling]{.s3}
  - [Scene phase tracking]{.s3}

[The implementation follows the Liquid Glass design system with dark
backgrounds, frosted glass effects, and smooth animations
throughout.]{.s3}

[]{.s1}\
